(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["143"],{"1536":function(e,t,n){"use strict";var r;(function(e){e[e.white=1]="white";e[e.themePrimary=2]="themePrimary";e[e.neutralLighterAlt=3]="neutralLighterAlt";e[e.themeTertiary=4]="themeTertiary"})(r||(r={}));t.e=r},"1551":function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(259),i=n(900);function s(e,t,n){void 0===n&&(n=!0);for(;e&&e!==document.body;){if(i.e.hasClass(e,t))return e;e=Object(r.e)(e,n)}return null}},"1585":function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.notConfigured=0]="notConfigured";e[e.visible=1]="visible";e[e.notVisible=2]="notVisible"})(r||(r={}))},"1601":function(e,t,n){"use strict";var r=n("knockout-lib"),i=n(900),s=n(1551),o=n(486),u=n(1536),a=n(1622),f=(function(){function e(){}e.init=function(t,n){var f,l=r.utils.unwrapObservable(n())||{},c=r.utils.unwrapObservable(l.anchorElement),h=l.isVisible,p=void 0===h?r.observable(!0):h,d=l.beakColorVariation,v=l.isBeakCenterAligned,m=void 0===v?r.observable(!1):v,g=l.beakSize,y=void 0===g?e.size:g;(c||(c=Object(s.e)(t,"beak-anchor")))&&r.computed(function(){r.utils.unwrapObservable(l.trigger);f&&r.removeNode(f);(f=document.createElement("div")).className="Beak-container";var n=document.createElement("div");n.className="Beak-arrow";var s=i.e.calculateRect(t),h=i.e.calculateRect(c);0===h.x&&(h=a.e.calculateParentRect(c,h));var v,g,b=y/2,w=e.determineBeakDirection(s,h),E=0;if(0===w||1===w){E=h.getCenter().y-s.getTop();E=e.clamp(E,2*y,s.height-2*y)}else{E=o.e.isRightToLeft?s.getRight()-h.getCenter().x:h.getCenter().x-s.getLeft();s.width>2&&(E=e.clamp(E,2*y,s.width-2*y))}switch(w){case 0:g=-b;v=E-y;break;case 1:g=s.width-y-b;v=E-y;break;case 2:g=E-y;v=-b;break;case 3:g=E-y;v=s.height-y-b}r.utils.unwrapObservable(m)?n.className+=" Beak-arrow--centered":o.e.isRightToLeft?n.style.right=g+"px":n.style.left=g+"px";n.style.top=v+"px";switch(d){case u.e.themePrimary:n.className+=" Beak--themePrimary";break;case u.e.neutralLighterAlt:n.className+=" Beak--neutralLighterAlt";break;case u.e.themeTertiary:n.className+=" Beak--themeTertiary";break;default:n.className+=" Beak--white"}f.appendChild(n);t.insertBefore(f,t.firstChild);f.style.display=p()?"":"none"},null,{disposeWhenNodeIsRemoved:t})};e.clamp=function(e,t,n){return Math.max(Math.min(e,n),t)};e.determineBeakDirection=function(e,t){var n=e.getCenter(),r=t.getCenter();return r.y>=e.getTop()&&r.y<e.getBottom()?r.x<n.x?0:1:r.y<n.y?2:3};e.after=["component"];e.size=10;return e})();t.e=f},"1629":function(e,t,n){"use strict";n.d(t,"e",function(){return o});var r=n(1470),i=n(9),s=n(1585),o=new i.t({name:"FirstRunExperienceStatus.key.FirstRunExperienceStatus",factory:{dependencies:{observablesFactoryType:r.i},create:function(e){var t=new e.observablesFactoryType;return{instance:t.create(s.e.notConfigured),disposable:t}}}})},"1727":function(e,t,n){"use strict";n.r(t);n.d(t,"ODB_LEFT_NAV",function(){return c});n.d(t,"NEW_OFFICE_FILE",function(){return h});n.d(t,"ODC_PHOTOS_SEARCH",function(){return p});n.d(t,"DOCSET_PROPERTIES_PANE",function(){return d});n.d(t,"PHOTO_LAYOUT",function(){return m});n.d(t,"ODC_MOBILE_APP_UPSELL",function(){return y});n.d(t,"EXPIRING_SHARING_LINKS",function(){return b});n.d(t,"FLOW_REQUEST_SIGNOFF",function(){return w});n.d(t,"FLOW_REMIND_ME",function(){return E});n.d(t,"FLOW_ODB_COMMAND_BAR_COACHMARK",function(){return S});n.d(t,"RECENT_VIEW",function(){return C});n.d(t,"SAVE_FOR_LATER_COMMAND",function(){return k});n.d(t,"SAVE_FOR_LATER_VIEW",function(){return L});n.d(t,"ODB_SHARED_LIBRARIES",function(){return A});n.d(t,"LEFT_NAV_SITE_PINNING",function(){return O});n.d(t,"GO_TO_SITE",function(){return M});n.d(t,"ADD_TO_ONEDRIVE_COMMAND",function(){return _});n.d(t,"PHOTO_EDIT",function(){return D});var r=n(436),i=n(1956),s=n(1536),o=n(1601),u=n(1572),a=n(796),f=n(4),l=n(645),c={campaignGuid:"49FEA7F9-6B31-4C2C-95EC-A9246E51D22C",startDate:new Date(2014,8,29),endDate:new Date(2016,4,1),title:i.e.odbLeftNavTitle,bodyCopy:i.e.odbLeftNavBodyCopy,flag:a.Off,colorVariation:s.e.themePrimary},h={campaignGuid:"1c2b5f74-1c33-4297-8199-97c78c2284c2",bodyCopy:i.e.createOfficeFileBody,flag:a.On,colorVariation:s.e.themePrimary,isDismissable:!0,isCoachmark:!0},p={campaignGuid:"D3F55EC7-C130-456E-8F27-2EA31F2D5B8D",startDate:new Date(2016,2,23),endDate:new Date(2019,2,23),bodyCopy:i.e.photosSearchBodyCopy,flag:a.PhotosSearchBubble,colorVariation:s.e.themePrimary},d={campaignGuid:"DB44A538-E6D0-4AC6-B735-3D77161E6E83",killSwitchGuid:"714AF444-CE4B-4A21-AFB9-71CAA861CC3D",title:i.e.docsetEditInlineTitle,bodyCopy:i.e.docsetEditInlineBody,colorVariation:s.e.themePrimary,flag:a.DocumentSetsModernView,alignment:u.e.Left,isCoachmark:!0,isDismissable:!0,name:"DOCSET_PROPERTIES_PANE"},v=new r.e(100,o.e.size/2+4),m={campaignGuid:"C847EA02-D118-4C3E-A73E-8B2C5D9944DA",bodyCopy:i.e.photoFolderBodyCopy,flag:a.On,colorVariation:s.e.themePrimary,alignment:u.e.Right,offset:v},g=new r.e(o.e.size/2+4,0),y={campaignGuid:"523F0995-B7E2-4612-BEA5-A7EF9F949C64",title:i.e.mobileAppUpsellTitle,bodyCopy:i.e.mobileAppUpsellBody,flag:a.EnableEnhancedMobileUpsell,alignment:u.e.Left,offset:g},b={campaignGuid:"A4776EC9-2059-4971-AB9C-4003C3C7B3D8",title:i.e.expiringLinksTitle,bodyCopy:i.e.expiringLinksBody,colorVariation:s.e.themePrimary,flag:a.On,alignment:u.e.Left,maxUserViewCount:1,isPremiumFeature:!0},w={campaignGuid:"A41001BA-6205-4730-A670-C89DD0D8451F",killSwitchGuid:"0EC0ED2B-06D2-4375-91E6-3CFF7E48B37D",experimentData:{name:"flowRequestSignOffCoachmarkExperiment2",startDate:"01/22/2019"},flag:a.FlowSignOffCoachmark,maxUserViewCount:1,title:i.e.flowRequestSignOffTitle,isCoachmark:!0,isDismissable:!0,bodyCopy:i.e.flowRequestSignOffBody,automateExperimentBodyCopy:i.e.automateRequestSignOffBody,name:"FLOW_REQUEST_SIGNOFF"},E={campaignGuid:"87802041-45CB-4304-BFD1-E2E98E3CB31B",killSwitchGuid:"98802041-45CB-4304-BFD1-E2E98E3CB31C",compatibleCampaign:w,experimentData:{name:Object(a.isFeatureEnabled)(a.UseLegacyCoachmarkExperiment)?"flowRemindMeCoachmarkExperiment":"flowRemindMeCoachmarkExperiment2",startDate:Object(a.isFeatureEnabled)(a.UseLegacyCoachmarkExperiment)?"10/17/2018":"01/22/2019"},flag:a.FlowRemindMeCoachmark,maxUserViewCount:1,title:i.e.flowRemindMeTitle,isCoachmark:!0,isDismissable:!0,bodyCopy:i.e.flowRemindMeBody,automateExperimentBodyCopy:i.e.automateRemindMeBody,name:"FLOW_REMIND_ME"},S={campaignGuid:"FD86A6D7-F3D9-47EC-994C-D01AAB624F28",killSwitchGuid:"B35D963C-9FFD-4154-9A9B-E112B67E5BCA",experimentData:{name:Object(a.isFeatureEnabled)(a.UseLegacyCoachmarkExperiment)?"flowOdbCommandBarCoachmarkExperiment":"flowOdbCommandBarCoachmarkExperiment2",startDate:Object(a.isFeatureEnabled)(a.UseLegacyCoachmarkExperiment)?"10/17/2018":"01/22/2019"},flag:a.FlowOdbCommandBarCoachmark,maxUserViewCount:1,title:i.e.flowOdbCommandBarCoachmarkTitle,isCoachmark:!0,isDismissable:!0,bodyCopy:i.e.flowOdbCommandBarCoachmarkBody,automateExperimentBodyCopy:i.e.automateOdbCommandBarCoachmarkBody,name:"FLOW_ODB_COMMAND_BAR_COACHMARK"},x=new r.e(0,-40),T=new r.e(0,-100),N=new r.e(40,-36),C={campaignGuid:"696ee2ba-076d-400c-ae9a-0b28e71f567b",title:i.e.recentShortIntroTitle,bodyCopy:i.e.recentShortIntro,colorVariation:s.e.themePrimary,flag:a.On,alignment:u.e.Left,offset:x},k={campaignGuid:"3df3cd3e-39ba-4eba-9fec-1c2f4ba1357c",flag:a.EnableSavedForLater,experimentId:l.e,title:i.e.followCommandCoachmarkTitle,isCoachmark:!0,isDismissable:!0,bodyCopy:i.e.followCommandCoachmarkBody,name:"SAVE_FOR_LATER_COMMAND"},L={campaignGuid:"36dd04ea-0121-462d-9acb-f89a8b06b609",title:i.e.savedIntroTitle,colorVariation:s.e.themePrimary,flag:a.EnableSavedForLater,experimentId:l.e,alignment:u.e.Left,offset:T},A={campaignGuid:"d786bb95-b94b-44ea-b5e9-c29c542dba48",title:i.e.sharedLibrariesIntroTitle,bodyCopy:i.e.sharedLibrariesIntro,colorVariation:s.e.themePrimary,flag:a.On,alignment:u.e.Left,offset:N,name:"ODB_SHARED_LIBRARIES_3"},O={campaignGuid:"108dfc30-090d-4ab7-8575-372a28d7ee3a",title:i.e.leftNavSitePinningBubbleTitle,bodyCopy:i.e.leftNavSitePinningBubbleContent,colorVariation:s.e.themePrimary,flag:a.ODBLeftNavPins,alignment:u.e.Left},M={campaignGuid:"976ef592-f66a-4d08-b837-ba3f9cda70fb",title:i.e.goToSiteBubbleTitle,bodyCopy:i.e.goToSiteBubbleContent,colorVariation:s.e.themePrimary,flag:a.On,alignment:u.e.Left},_={campaignGuid:"94a29c48-ae93-44cc-94fa-bb106da7bb2d",flag:f.hr,title:i.e.addToOneDriveTeachingTitle,isCoachmark:!0,illustrationImage:{src:""+window.require.toUrl("odsp-media/images/addtoonedrive/add2od_1x.gif"),height:200},coachMarkStyles:function(e){var t=e.isCollapsed;return{entityHost:t&&{backgroundColor:"#0078D4"},childrenContainer:{selectors:{".ms-TeachingBubble-subText":{color:"#FFFFFF"},".ms-TeachingBubble-headline":{color:"#FFFFFF"},".ms-TeachingBubble-closebutton":{color:"#FFFFFF",selectors:{":hover":{color:"#FFFFFF"}}}}},rotateAnimationLayer:{selectors:{svg:{fill:t?"#0078D4":"#7BDCEE"}}}}},teachingBubbleStyles:{closeButton:{color:"#0078D4"}},isDismissable:!0,persistentBeak:!0,maxUserViewCount:2,disableCondensedHeadline:!0,bodyCopy:i.e.addToOneDriveTeachingBody,name:"ADD_TO_ONEDRIVE_COMMAND"},D={campaignGuid:"ac1f12bf-bc9e-41f9-84e9-49351392a052",title:i.e.photoEditTitle,bodyCopy:i.e.photoEditBody,flag:a.On,colorVariation:s.e.themePrimary,alignment:u.e.Right,offset:v,isCoachmark:!0,persistentBeak:!0,isDismissable:!0}},"2165":function(e,t,n){"use strict";n.d(t,"e",function(){return v});var r=n(0),i=n(796),s=n(1470),o=n(17),u=n(196),a=n(107),f=n(152),l=n(387),c=n(1629),h=n(1585),p={campaignGuid:"00000000-0000-0000-0000-000000000000",endDate:new Date(1970,1,1),flag:i.Off,isCoachmark:!0},d=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._dataStore=new u.e("CoachmarkProvider",a.e.session);r._currentCampaign=r.createObservable(p);r._isVisible=r.createObservable(!1);r._navigation=n.navigation;r._firstRunExperienceStatus=n.firstRunExperienceStatus;r._currentTeachingBubble=r.createObservable({campaign:r._currentCampaign,isVisible:r._isVisible});r._navigation.viewParams.resetAllBubbles&&r._dataStore.remove("CoachmarkTearDropSeen");return r}Object.defineProperty(t.prototype,"isVisible",{get:function(){return this._isVisible},enumerable:!1,configurable:!0});Object.defineProperty(t.prototype,"currentCampaign",{get:function(){return this._currentCampaign},enumerable:!1,configurable:!0});t.prototype.hideCampaign=function(){this._isVisible(!1);this._currentCampaign(p)};t.prototype.setCampaign=function(e){var t=this;if(e){if(this._firstRunExperienceStatus()!==h.e.visible){var n=e.name+"CoachmarkTearDropSeen";if(!this._dataStore.getValue("CoachmarkTearDropSeen")){this._teachingBubbleProvider||(this._teachingBubbleProvider=this.resources.consume(l.T.optional));this._teachingBubbleProvider&&this._teachingBubbleProvider.shouldBubbleBeAdded(e,!1).then(function(r){if(r){t._currentCampaign(e);t._isVisible(!0);t._dataStore.setValue(n,!0)}})}}}else{this._currentCampaign(p);this._isVisible(!1)}};t.prototype.getCurrentTeachingBubble=function(){return this._currentTeachingBubble};t.dependencies=Object(r.__assign)(Object(r.__assign)({},s.n.dependencies),{navigation:f.e,firstRunExperienceStatus:c.e});return t})(s.n),v=Object(o.s)("CoachmarkProvider",d)},"4018":function(e,t,n){"use strict";n.r(t);n.d(t,"OpenInImageEditorHandler",function(){return E});var r=n(0),i=n(277),s=n(1809),o=n(1470),u=n(94),a=n(327),f=n(1491),l=n(1590),c=n(24),h=n(142),p=n(1815),d=n(796),v=n(1578),m=n(1727),g=n(2165),y=n(231),b={jpg:"image/jpg",jpeg:"image/jpeg"},w={png:"image/png"},E=(function(e){Object(r.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._itemSelectionHelper=new(n.child(f.e))({allowMultiSelect:!1,canFallback:!0});n._isOneDriveWinApp=Object(h.e)();n._urlDataSource=n.resources.consume(a.me);n._itemCommandHelper=n.resources.consume(l.t);n._platformDetection=n.resources.consume(i.e);n._identityDataSource=n.resources.consume(a.S);n._coachmarkProvider=n.resources.consume(g.e.optional);n.state=n.createPureComputed(n._computeState);return n}t.prototype.getParams=function(){return this._itemSelectionHelper.resolveFirst().then(function(e){return{item:e}})};t.prototype._computeState=function(){return{isAvailable:this._isAvailable()}};t.prototype._isAvailable=function(){var e=this._itemSelectionHelper.firstItem();if(!e)return!1;if(e.video&&e.video.burstPhotoType)return!1;var t=this._itemCommandHelper.isCommandSupported(e,p.o),n=this._isSupportedFileType(e),r=this._itemSelectionHelper.currentItem(),i=this._urlDataSource.getKeyParams(r.key),s=this._urlDataSource.getQueryType(i),o=this._shouldEnableImageEditor()&&t&&n&&(!this._platformDetection.isIE||Object(d.isFeatureEnabled)(d.EnableEditUtilityControlIE))&&(!this._platformDetection.isSafari||Object(d.isFeatureEnabled)(d.EnableEditUtilityControlSafari))&&(!this._platformDetection.isMobile||Object(d.isFeatureEnabled)(d.EnableEditUtilityControlMobile))&&!!e&&s!==c.e.SharedWithMe&&!this._isOneDriveWinApp&&!this._urlDataSource.isRecycleBin(s)&&4!==e.itemStatus&&3!==e.itemStatus;o&&this._coachmarkProvider.setCampaign(m.PHOTO_EDIT);return o};t.prototype._shouldEnableImageEditor=function(){if(Object(d.isFeatureEnabled)(d.EnableEditUtilityControl))return!0;if(Object(d.isFeatureEnabled)(d.EnableEditControlExperimentAA)){if(this._identityDataSource){var e=this._identityDataSource.getIdentity();e&&v.t.init({userLoginName:e.email})}var t={name:"EnableEditControlExperiment",startDate:"2/09/2021",version:v.e.v2};return new v.t(t,d.EnableEditControlExperimentAB).isOn()}return!1};t.prototype._isSupportedFileType=function(e){if(e&&e.extension&&(e.type===y.e.File||e.type===y.e.Media)){var t=e.extension;t=((t&&"."===t[0]?t.substring(1):t)||"").toLowerCase();if(b.hasOwnProperty(t))return!0;if(Object(d.isFeatureEnabled)(d.EnableEditPNG)&&w.hasOwnProperty(t))return!0}return!1};return t})(o.n),S=Object(s.e)({name:"OpenInImageEditor",source:{moduleDefinition:{path:"./OpenInImageEditorExecutor",getModule:function(){return u.n.resolve(Promise.all([n.e("ondemand.resx-ondemand"),n.e("144")]).then(n.bind(null,3864)))}}},handlerType:E});t.default=S}}]);