(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["deferred.odsp-datasources"],{"1332":function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(0),i=n(74),s=n(281),o=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,{webAbsoluteUrl:n.pageContext.webAbsoluteUrl,encodeWebAbsoluteUrl:n.encodeWebAbsoluteUrl})||this;r._pageContext=n.pageContext;r._shouldEncodeWebAbsoluteUrl=n.encodeWebAbsoluteUrl;r._itemUrlHelper=n.itemUrlHelper;return r}t.prototype.webByUrl=function(e){return this.webByItemUrl(this._itemUrlHelper.getUrlParts(e))};t.prototype.webByItemUrl=function(e){var t=e.siteRelation,n=e.isCrossDomain,r=e.fullItemUrl,s=this;(n||t===i.r.crossSite)&&(s=s.method("SP.RemoteWeb",r));return s.segment("web")};t.prototype.listById=function(e,t){return this.webByItemUrl(e).segment("lists").method("GetById",t)};t.prototype.clone=function(){return new t({webAbsoluteUrl:this._pageContext.webAbsoluteUrl},{pageContext:this._pageContext,itemUrlHelper:this._itemUrlHelper,encodeWebAbsoluteUrl:this._shouldEncodeWebAbsoluteUrl})};return t})(s.e),u=(function(e){Object(r.__extends)(t,e);function t(t,n){var i=e.call(this,{webAbsoluteUrl:n&&n.pageContext?n.pageContext.webAbsoluteUrl:"",encodeWebAbsoluteUrl:n.encodeWebAbsoluteUrl})||this,s=n.itemUrlHelper,u=n.pageContext,a=n.encodeWebAbsoluteUrl,f=n.apiUrlType,l=void 0===f?(function(e){Object(r.__extends)(t,e);function t(){return e.call(this,{},{itemUrlHelper:s,pageContext:u,encodeWebAbsoluteUrl:a})||this}return t})(o):f;i._apiUrlType=l;return i}t.prototype.build=function(){return new this._apiUrlType};return t})(s.t)},"1481":function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(0),i=n(389),s=(function(){function e(e,t){var n=this._pageContext=t.pageContext,s=t.tokenProvider,o=t.dataRequestorType,u=void 0===o?(function(e){Object(r.__extends)(t,e);function t(t){return e.call(this,t,{pageContext:n,tokenProvider:s})||this}return t})(i.t):o,a=e.dataSourceName,f=void 0===a?"DataSource":a;this.dataRequestor=new u({qosName:f})}e.prototype.getDataSourceName=function(){return this.dataSourceName};e.prototype.needsRequestDigest=function(e){return!0};e.prototype.getData=function(e,t,n,r,i,s,o,u,a,f,l,c,h){void 0===i&&(i="POST");var p=e(),d=r&&r(),v=this.needsRequestDigest(p);return this.dataRequestor.getData({url:p,parseResponse:t,qosName:n,additionalPostData:d,method:i,additionalHeaders:s,contentType:o,maxRetries:u,noRedirect:a,crossSiteCollectionCall:f,telemetryHandler:l,qosExtraData:c,needsRequestDigest:v,authToken:h})};return e})();t.t=s},"1526":function(e,t,n){"use strict";n(1621);var r,i=n(94),s=n(101),o=n(48);(function(e){e[e.InteractionRequired=10013]="InteractionRequired"})(r||(r={}));var u=(function(){function e(e,t){void 0===e&&(e={});this._dataSource=t.oAuthTokenDataSource}e.prototype.getToken=function(e,t){var n=new s.e({name:"getToken"});return this._dataSource.getToken(e,t).then(function(e){n.end({resultType:o.e.Success});return e},function(e){n.end({resultType:o.e.Failure});return i.n.reject(e)})};e.prototype.getInstrumentedToken=function(e,t){var n=new s.e({name:"getToken"});return this._dataSource.getInstrumentedToken(e,t).then(function(e){n.end({resultType:o.e.Success});return e},function(e){n.end({resultType:o.e.Failure});return i.n.reject(e)})};return e})();t.e=u},"1537":function(e,t,n){"use strict";var r;(function(e){e[e.none=0]="none";e[e.user=1]="user";e[e.distributionList=2]="distributionList";e[e.securityGroup=4]="securityGroup";e[e.sharePointGroup=8]="sharePointGroup";e[e.all=15]="all"})(r||(r={}));t.e=r},"1562":function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(0),i=n(1481),s=n(1740),o=n(1711),u=(function(e){Object(r.__extends)(t,e);function t(t,n){var i=e.call(this,t,n)||this,u=n.pageContext;i._legacyRequestCache=new o.e(t,{pageContext:u});t.cacheType;var a=Object(r.__rest)(t,["cacheType"]);i._persistentRequestCache=new s.e(a,{pageContext:u});return i}t.prototype.getDataUtilizingLegacyCache=function(e){var t=this,n=e,i=n.getUrl,s=n.getAdditionalPostData,o=n.cacheRequestKey,u=n.cacheTimeoutTime,a=Object(r.__rest)(n,["getUrl","getAdditionalPostData","cacheRequestKey","cacheTimeoutTime"]);(a=Object(r.__assign)({url:i&&i(),additionalPostData:s&&s(),method:"POST"},a)).url=a.url||i&&i();"needsRequestDigest"in a||(a.needsRequestDigest=this.needsRequestDigest(a.url));a.additionalPostData=a.additionalPostData||s&&s();o=o||this.getRequestKey(a.url,a.method,a.additionalPostData);var f=e.useStale,l=void 0!==f&&f,c=e.bypassCache,h=void 0!==c&&c,p=e.onlyCache,d=void 0!==p&&p,v=e.checkForInvalidation,m=void 0!==v&&v,g=e.setInvalidated,y=void 0!==g&&g;return this._legacyRequestCache.getDataUtilizingCache({cacheRequestKey:o,useStale:l,bypassCache:h,onlyCache:d,checkForInvalidation:m,setInvalidated:y,cacheTimeoutTime:u,getData:function(){return t.dataRequestor.getData(a)}})};t.prototype.getDataUtilizingPersistentCache=function(e){var t=this,n=e,i=n.getUrl,s=n.getAdditionalPostData,o=n.cacheRequestKey,u=n.cacheTimeoutTime,a=n.returnStatistics,f=Object(r.__rest)(n,["getUrl","getAdditionalPostData","cacheRequestKey","cacheTimeoutTime","returnStatistics"]);(f=Object(r.__assign)({url:i&&i(),additionalPostData:s&&s(),method:"POST"},f)).url=f.url||i&&i();"needsRequestDigest"in f||(f.needsRequestDigest=this.needsRequestDigest(f.url));f.additionalPostData=f.additionalPostData||s&&s();o=o||this.getRequestKey(f.url,f.method,f.additionalPostData);var l=e.cachingStrategy;return this._persistentRequestCache.getDataUtilizingCache({cachingStrategy:l,cacheRequestKey:o,cacheTimeoutTime:u,getData:function(){return t.dataRequestor.getData(f)},returnStatistics:a})};t.prototype.isCachedDataInvalidated=function(e){return this._legacyRequestCache.isCachedDataInvalidated&&this._legacyRequestCache.isCachedDataInvalidated(e)};t.prototype.getRequestKey=function(e,t,n){return this._legacyRequestCache.getRequestKey(e,t,n)};Object.defineProperty(t.prototype,"cacheId",{get:function(){return this._legacyRequestCache.cacheId},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"cacheVersionId",{get:function(){return this._legacyRequestCache.cacheVersionId},enumerable:!0,configurable:!0});t.prototype.flushCache=function(e){this._legacyRequestCache.flushCache(e);this._persistentRequestCache.flushCache(e)};return t})(i.t);t.t=u},"1581":function(e,t,n){"use strict";var r,i=n(0),s=(function(){function e(){}e.tokenCacheSessionStorageId="tokenCache";e.aboutToExpireIntervalSeconds=600;e.apiUrl="/_api/SP.OAuth.Token/Acquire";e.retries=3;e.retriableErrorCodes=[10006,10008];e.unexpectedErrorCodeFormat="Expected error code format is <numericCode>, <exception class name>";e.unexpectedTokenMessageFormat="Your token request succeedeed but the token could not be parsed from the response.This is most probably caused by a change in the server response format";e.npmPackageVersion="0.1.5";return e})();(function(e){e[e.unknownError=0]="unknownError";e[e.malformedResponseBody=1]="malformedResponseBody";e[e.serverError=2]="serverError"})(r||(r={}));var o=(function(e){Object(i.__extends)(t,e);function t(n,r){var i=e.call(this,r.message)||this;i.__proto__=t.prototype;i._type=n;i._httpResponseStatus=r.httpResponseStatus;i._cultureName=r.cultureName;i._message=r.message;i._serverErrorCode=r.serverErrorCode;i._correlationId=r.correlationId;i._redirectUrl=r.redirectUrl;return i}Object.defineProperty(t.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"serverErrorCode",{get:function(){if(this.type!==r.serverError)throw new Error("ServerErrorCode can only be obtained for errors of type serverError");return this._serverErrorCode},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"httpResponseStatus",{get:function(){return this._httpResponseStatus},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"message",{get:function(){return this._message},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"cultureName",{get:function(){return this._cultureName},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"correlationId",{get:function(){return this._correlationId},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"redirectUrl",{get:function(){return this._redirectUrl},enumerable:!0,configurable:!0});return t})(Error),u=(function(){function e(e){var t=this;this._context=e;this._dispose=this._dispose.bind(this);window.addEventListener("unload",this._dispose);window._spPageOnMediaTokenReceived=function(){t._receiveMediaServiceFlushedToken()};window._spMSBTLoaded=function(){t._receiveMediaServiceFlushedToken()}}e._getCorrelationId=function(e){return e.headers.get("sprequestguid")};e._extractRealError=function(e){return e.hasOwnProperty("error")?e.error:e};e.prototype.getOAuthToken=function(e,t){return this.getInstrumentedOAuthToken(e,t).then(function(e){if(e)return e.tokenInfo})};e.prototype.getInstrumentedOAuthToken=function(e,t){var n=this;this._receiveMediaServiceFlushedToken();var r=this._getCachedTokenData(e);if(r&&!this._isExpiring(r)){var i={token:r.accessToken,isGuest:!1,expirationTimeMs:r.expiresOn};return Promise.resolve({tokenInfo:i,spRequestId:r.correlationId,spRequestTimestamp:r.requestTimestamp})}return this._retriableFetchWithDigest(e,s.retries,t).then(function(t){n._storeTokenData(e,t);return{tokenInfo:{token:t.accessToken,isGuest:!1,expirationTimeMs:t.expiresOn},spRequestId:t.correlationId,spRequestTimestamp:t.requestTimestamp}})};e.prototype.clearCachedToken=function(e){var t=this._getCacheKey(e);window.sessionStorage.removeItem(t);var n=this._resourceKeys.indexOf(t);!isNaN(n)&&n>-1&&this._resourceKeys.splice(n)};Object.defineProperty(e.prototype,"_resourceKeys",{get:function(){this._keysToDispose||(this._keysToDispose=new Array);return this._keysToDispose},enumerable:!0,configurable:!0});e.prototype._retriableFetchWithDigest=function(t,n,i){var s=this,u=this._context.qosMonitor(),a=Date.now();return this._context.fetchWithDigest(this._buildTokenRequest(t,i)).then(function(f){if(200!==f.status){s._context.logger.logError("fetchWithDigest failed. Server responded with "+f.statusText);var l=new o(r.unknownError,{httpResponseStatus:f.status,message:f.statusText,correlationId:e._getCorrelationId(f)});if(400!==f.status){u.writeUnexpectedFailure("UnknownError",l);return Promise.reject(l)}return f.json().then(function(r){var o=e._extractRealError(r),a=s._getErrorCodeFromResponseCode(o);if(!s._isRetriableError(a)||0===n){var f=s._buildErrorFromResponse(o);u.writeUnexpectedFailure("SharepointServerError",f);return Promise.reject(f)}s._context.logger.logError("fetchWithDigest failed. Retrying. Retries left: "+n);return s._retriableFetchWithDigest(t,n-1,i)})}return s._instrumentedParseResponseData(f,u,a)})};e.prototype._getCachedTokenData=function(e){return JSON.parse(window.sessionStorage.getItem(this._getCacheKey(e)))};e.prototype._storeTokenData=function(e,t){window.sessionStorage.setItem(this._getCacheKey(e),JSON.stringify(t))};e.prototype._getCacheKey=function(e){var t=["sp-client-shared",s.npmPackageVersion,"OAuthUtility",e].join(";");-1===this._resourceKeys.indexOf(t)&&this._resourceKeys.push(t);return t};e.prototype._isExpiring=function(e){return e.expiresOn-Date.now()/1e3<s.aboutToExpireIntervalSeconds};e.prototype._isRetriableError=function(e){return-1!==s.retriableErrorCodes.indexOf(e)};e.prototype._buildTokenRequest=function(e,t){var n=new Headers;n.append("Content-Type","application/json; charset=utf-8");n.append("Odata-Version","4.0");n.append("Accept","application/json;odata.metadata=minimal");var r={method:"POST",headers:n,body:JSON.stringify(this._buildRequestBody(e))},i=t;i&&i.lastIndexOf("/")===i.length-1&&(i=i.substr(0,i.length-1));return new Request(i+s.apiUrl,r)};e.prototype._buildRequestBody=function(e){return{resource:e}};e.prototype._buildErrorFromResponse=function(e){var t,n,i=this._getErrorCodeFromResponseCode(e);if(void 0===i)return new o(r.malformedResponseBody,{httpResponseStatus:400,message:s.unexpectedErrorCodeFormat,correlationId:e.correlationId});if(e.message)if("string"==typeof e.message)t=e.message;else{t=e.message.value;n=e.message.lang}return new o(r.serverError,{httpResponseStatus:400,message:t,cultureName:n,serverErrorCode:i,correlationId:e.correlationId,redirectUrl:e["error.redirectUrl"]||e["@error.redirectUrl"]})};e.prototype._getErrorCodeFromResponseCode=function(e){var t=e.code,n=Number(t);if(isNaN(n)&&"string"==typeof e.message){var r=t.indexOf(",");-1!==r&&(n=Number(t.substr(0,r)))}return n};e.prototype._instrumentedParseResponseData=function(t,n,i){try{return t.json().then(function(r){n.writeSuccess();return{accessToken:r.access_token,expiresOn:Number(r.expires_on),notBefore:Number(r.not_before),resource:r.resource,tokenType:r.token_type,correlationId:e._getCorrelationId(t),requestTimestamp:i}})}catch(i){n.writeUnexpectedFailure("ResponseParseError",i);return Promise.reject(new o(r.malformedResponseBody,{httpResponseStatus:200,message:s.unexpectedTokenMessageFormat,correlationId:e._getCorrelationId(t)}))}};e.prototype._dispose=function(e){window.removeEventListener("unload",this._dispose);for(var t=0,n=this._resourceKeys;t<n.length;t++){var r=n[t];window.sessionStorage.removeItem(r)}};e.prototype._receiveMediaServiceFlushedToken=function(){if(window._spMSBT){var e={tokenType:window._spMSBT.TokenType,expiresOn:window._spMSBT.ExpiresOn,notBefore:void 0,resource:window._spMSBT.Resource,accessToken:window._spMSBT.AccessToken};this._storeTokenData(e.resource,e);window._spMSBT=void 0}};return e})(),a=n(1481),f=n(94),l=n(435),c=n(101),h=n(48),p=(function(){function e(){this._qos=new c.e({name:"OAuthTokenDataSource"})}e.prototype.writeSuccess=function(){this._qos.end({resultType:h.e.Success})};e.prototype.writeUnexpectedFailure=function(e,t){this._qos.end({resultCode:e,resultType:h.e.Failure,error:JSON.stringify(t)})};e.prototype.writeExpectedFailure=function(e,t){this._qos.end({resultCode:e,resultType:h.e.ExpectedFailure,error:JSON.stringify(t)})};return e})(),d=(function(){function e(){}e.prototype.logWarning=function(e){};e.prototype.logError=function(e){};return e})(),v=(function(e){Object(i.__extends)(t,e);function t(t,n){var r=e.call(this,{},{pageContext:t})||this;r.logger=new d;if(n){n.logger&&(r.logger=n.logger);n.useAbsoluteUrlForOAuth&&(r._useAbsoluteUrlForOAuth=n.useAbsoluteUrlForOAuth)}r._oAuthUtility=new u(r);return r}t.prototype.qosMonitor=function(){return new p};Object.defineProperty(t.prototype,"webUrl",{get:function(){return this._useAbsoluteUrlForOAuth?this._pageContext.webAbsoluteUrl:Object(l.n)(this._pageContext)},enumerable:!0,configurable:!0});t.prototype.fetchWithDigest=function(e){var t=this;return e.text().then(function(n){var r=e.headers.get("Content-Type");e.headers.delete("Content-Type");return t._odspPromiseToEs6Promise(t.getData(function(){return e.url},function(e,t){return new Response(e,{status:t.getStatus(),headers:t.getResponseHeadersDictionary()})},"DelegationTokenDataSource",function(){return n},"POST",t._getRequestHeadersDictionary(e),r,void 0,!0).then(function(e){return e},function(e){return new Response(JSON.stringify(e),{status:e.status})}))})};t.prototype.getToken=function(e,t){t&&this._oAuthUtility.clearCachedToken(e);return this._es6PromiseToOdspPromise(this._oAuthUtility.getOAuthToken(e,this.webUrl).then(function(e){return e.token}))};t.prototype.getInstrumentedToken=function(e,t){t&&this._oAuthUtility.clearCachedToken(e);return this._es6PromiseToOdspPromise(this._oAuthUtility.getInstrumentedOAuthToken(e,this.webUrl))};t.prototype._getRequestHeadersDictionary=function(e){var t=e.headers,n={};t.forEach(function(e,t){n[t]=e});return n};t.prototype._odspPromiseToEs6Promise=function(e){return new Promise(function(t,n){e.then(function(e){t(e)},function(e){n(e)})})};t.prototype._es6PromiseToOdspPromise=function(e){return new f.n(function(t,n){e.then(function(e){t(e)},function(e){n(e)})})};return t})(a.t);t.e=v},"1611":function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r,i;(function(e){e[e.queued=0]="queued";e[e.started=1]="started";e[e.completed=2]="completed";e[e.aborted=3]="aborted";e[e.failed=4]="failed";e[e.none=5]="none"})(r||(r={}));(function(e){e[e.none=0]="none";e[e.other=1]="other";e[e.general=2]="general";e[e.conflict=3]="conflict";e[e.similarNameExists=4]="similarNameExists";e[e.invalidName=5]="invalidName";e[e.fileSize=6]="fileSize";e[e.emptyFileOrFolder=7]="emptyFileOrFolder";e[e.emptyFileOrFolderForDocLib=8]="emptyFileOrFolderForDocLib";e[e.overQuota=9]="overQuota";e[e.accessDenied=10]="accessDenied";e[e.lockMismatch=11]="lockMismatch";e[e.overQuotaSharedFolder=12]="overQuotaSharedFolder";e[e.folderUploadNotSupported=13]="folderUploadNotSupported";e[e.versionMismatch=14]="versionMismatch";e[e.authFailure=15]="authFailure";e[e.targetFolderMissing=16]="targetFolderMissing";e[e.itemNotFound=17]="itemNotFound";e[e.malwareDetected=18]="malwareDetected";e[e.throttled=19]="throttled";e[e.pathTooLong=20]="pathTooLong";e[e.disconnected=21]="disconnected";e[e.unlockRequired=22]="unlockRequired";e[e.insufficientVaultQuota=23]="insufficientVaultQuota"})(i||(i={}))},"1617":function(e,t,n){"use strict";n.d(t,"e",function(){return c});n.d(t,"t",function(){return p});var r=n(94),i=n(101),s=n(48),o=n(1560),u=n(196),a=n(107),f=n(141),l=n(75),c="https://outlook.office.com/search",h={ODB:1286},p=(function(){function e(e,t){this._dataRequestor=new o.e({},{});this._pageContext=t.pageContext;this._oAuthTokenProvider=t.oAuthTokenProvider;this._sharingContextInformation&&this._sharingContextInformation.additionalTokens&&(this._substrateToken=this._sharingContextInformation.additionalTokens.substrateToken);this.initializeDataStore()}e.prototype.canUseSubstrate=function(){if(this._substrateToken)return!0;var e=!1;if(this._pageContext&&!this._pageContext.isSPO)return e;if(this._pageContext&&this._pageContext.authToken)return e;this._pageContext&&this._oAuthTokenProvider&&f.n.isFeatureEnabled(h)&&(e=!0);this._dataStore&&(e=e&&!this._dataStore.getValue("DisableSubstrateSearch",a.e.session));return e};e.prototype.disableSubstrateCallsForPicker=function(){this.initializeDataStore();this._dataStore.setValue("DisableSubstrateSearch",!0,a.e.session)};e.prototype.getSubstrateToken=function(){var e=this;if(this._substrateToken)return r.n.resolve(this._substrateToken);if(this._oAuthTokenProvider){var t=new i.e({name:"PeoplePicker.GetSubstrateToken"});return this._oAuthTokenProvider.getToken(c).then(function(e){t.end({resultType:s.e.Success});return e},function(n){if(r.n.isCanceled(n)){t.end({resultType:s.e.ExpectedFailure,resultCode:"Canceled"});return r.n.reject(n)}t.end({resultCode:"PeoplePicker.GetSubstrateTokenError",resultType:s.e.Failure,extraData:{serverErrorCode:n._serverErrorCode,message:n.message}});e.disableSubstrateCallsForPicker();return null})}return null};e.prototype.init=function(e){var t=c+"/api/v1/init?scenario=documentshare";l.e.isActivated("20373606-dfd1-4220-9a96-50f93570a877","07/03/2020","Removing litoken while calling Substrate.")?this._dataRequestor.send({apiName:"Substrate.PeopleSearch.Init",path:t,headers:{Authorization:"Bearer "+e,"X-User-Context":"litoken="+e},needsAuthorization:!1}):this._dataRequestor.send({apiName:"Substrate.PeopleSearch.Init",path:t,headers:{Authorization:"Bearer "+e},needsAuthorization:!1})};e.prototype.initializeDataStore=function(){this._dataStore||(this._dataStore=new u.e("PeoplePicker",a.e.session))};return e})()},"1641":function(e,t,n){"use strict";n.d(t,"t",function(){return i});n.d(t,"n",function(){return s});n.d(t,"e",function(){return o});var r,i=3e5,s=864e5,o="odsp-ds-";(function(e){e[e.useCacheAndUpdateInTheBackground=0]="useCacheAndUpdateInTheBackground";e[e.useCacheIfNotExpired=1]="useCacheIfNotExpired";e[e.onlyCache=2]="onlyCache";e[e.bypassCache=3]="bypassCache"})(r||(r={}))},"1650":function(e,t,n){"use strict";n.d(t,"e",function(){return l});var r=n(94),i=n(141),s=n(101),o=n(48),u=n(196),a=n(107),f={ODB:387},l=(function(){function e(e,t){this._pageContext=t.pageContext;this._sharingContextInformation=t.sharingContextInformation;this._oAuthTokenProvider=t.oAuthTokenProvider;this._sharingContextInformation&&this._sharingContextInformation.additionalTokens&&(this._graphToken=this._sharingContextInformation.additionalTokens.graphToken);this.initializeDataStore()}e.prototype.canUseGraph=function(){if(this._graphToken)return!0;if(this._pageContext&&!this._pageContext.isSPO)return!1;if(this._pageContext&&this._pageContext.authToken)return!1;var e=this._pageContext&&this._oAuthTokenProvider&&i.n.isFeatureEnabled(f);this._dataStore&&(e=e&&!this._dataStore.getValue("DisableGraph",a.e.session));return e};e.prototype.disableGraphCallsForPicker=function(){this.initializeDataStore();this._dataStore.setValue("DisableGraph",!0,a.e.session)};e.prototype.getGraphToken=function(){var e=this;if(this._graphToken)return r.n.resolve(this._graphToken);if(this._oAuthTokenProvider){var t=new s.e({name:"PeoplePicker.GetGraphToken"});return this._oAuthTokenProvider.getToken("https://graph.microsoft.com").then(function(e){t.end({resultType:o.e.Success});return e},function(n){if(r.n.isCanceled(n)){t.end({resultType:o.e.ExpectedFailure,resultCode:"Canceled"});return r.n.reject(n)}t.end({resultCode:"PeoplePicker.GetGraphTokenError",resultType:o.e.Failure,extraData:{serverErrorCode:n._serverErrorCode,message:n.message}});e.disableGraphCallsForPicker();return null})}return null};e.prototype.initializeDataStore=function(){this._dataStore||(this._dataStore=new u.e("PeoplePicker",a.e.session))};return e})()},"1664":function(e,t,n){"use strict";n.d(t,"e",function(){return g});var r=n(0),i=n(435),s=n(1481),o=n(1537),u=n(94),a=n(1617),f=n(1332),l=n(180),c=n(905),h=n(1560),p=n(1528),d=n(75),v=n(1673),m=n(73),g=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=this,i=y(t)?t:n.pageContext;r=e.call(this,{},{pageContext:i})||this;var s=y(t)?t.apiUrlHelper:n.apiUrlHelper;r._apiUrlHelper=s||new f.e({},{itemUrlHelper:new l.e({},{pageContext:i}),pageContext:i});r._capabilities={supportsMruCaching:!0};if(n){r._dataRequestor=n.dataRequestor;r._graphPeoplePickerHelper=n.graphPeoplePickerHelper;r._substratePeoplePickerHelper=n.substratePeoplePickerHelper;r._livePeoplePickerHelper=n.livePeoplePickerHelper;r._getAuthToken=n.getAuthToken}r._invalidPeopleSubTypesKSActivated=d.e.isActivated("daa1be46-12ff-45a4-8c9f-9b3c0f174853","01/19/2021","Ignore invalid PeopleSubtypes.");return r}t.prototype.getCapabilities=function(){return this._capabilities};t.prototype.getPersonaDetails=function(e){var t=this;return u.n.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(n){return t.dataRequestor.getData({url:t._apiUrlHelper.build().segment("sp.publishing.personmagazine.GetPersonMagazineUserProfileDataForUser").parameter("accountName",e).toString(),qosName:"GetPersonaDetails",authToken:n,parseResponse:function(e){var n=function(e){return{name:e.DisplayName,email:e.Email,userId:e.AccountName,office:e.Office,image:e.PictureUrl,job:e.Title,department:e.DepartmentName,phone:e.Phone,sip:e.Lync}},r=JSON.parse(e).d.GetPersonMagazineUserProfileDataForUser,s={personDetails:n(r.Primary),managerChain:r.ManagerChain.results.map(n),directReports:r.DirectReports.results.map(n)};s.personDetails.profilePage=Object(i.r)(t._pageContext)+"/_layouts/15/me.aspx?p="+encodeURIComponent(s.personDetails.sip)+"&origin=ProfileODBCard";return s}})})};t.prototype.getPickerEntityInformation=function(e){var t=this,n=0;e.principalType===o.e.sharePointGroup&&(n=Number(e.rawPersonData.EntityData.SPGroupID));var r=JSON.stringify({entityInformationRequest:{PrincipalType:e.principalType,EmailAddress:e.email,GroupId:n}});return u.n.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(n){return t.dataRequestor.getData({url:t._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.GetPickerEntityInformation").toString(),additionalPostData:r,qosName:"getPickerEntityInformation",authToken:n,noRedirect:!0,parseResponse:function(t){return{totalMemberCount:JSON.parse(t).d.TotalMemberCount,person:e}}})})};t.prototype.resolve=function(e,t){var n=this;return u.n.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(r){return n.dataRequestor.getData({url:n._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.ClientPeoplePickerResolveUser").toString(),additionalPostData:n._constructPostBody(e,t),qosName:"Resolve",authToken:r,parseResponse:function(e){var r=JSON.parse(e),i=JSON.parse(r.d.ClientPeoplePickerResolveUser),s=[];s[0]=i;d.e.isActivated("067ca2b4-2244-4153-8dfa-d11e6b4487bb","03/19/2018","Only overwrite display text if it is null or empty")?i.IsResolved||(s[0].DisplayText=i.Key):i.IsResolved||i.EntityData.IsBlockedOnODB&&"true"===i.EntityData.IsBlockedOnODB.toLowerCase()||(s[0].DisplayText=i.Key);var u=(s=n._transformData(s,t.filterExternalUsers))[0];if(t.filterExternalUsers&&u&&1===u.entityType){u.isResolved=!1;u.entityType=0}else if(t.blockViaPolicy&&!t.filterExternalUsers&&u&&!u.isResolved&&0===u.multipleMatches.length){u.isResolved=!0;u.isExternal=!0;u.entityType=1}if(t.isGraphDistributionList&&t.useGraph&&u.isExternal){u.entityType=2;u.principalType=o.e.distributionList}return u}})})};t.prototype.canUseGraph=function(e){var t=e&&e.useGraph&&this._graphPeoplePickerHelper&&this._graphPeoplePickerHelper.canUseGraph();t&&!this._dataRequestor&&(this._dataRequestor=new h.t({},{}));return t};t.prototype.canUseSubstrate=function(e){var t=e.useSubstrate&&this._substratePeoplePickerHelper&&this._substratePeoplePickerHelper.canUseSubstrate();t&&!this._dataRequestor&&(this._dataRequestor=new h.t({},{}));return t};t.prototype.getLivePersonaPickerHelper=function(){return this._livePeoplePickerHelper};t.prototype.search=function(e,t){return this.canUseSubstrate(t)?this._substrateSearch(e,t):this.canUseGraph(t)?this._graphSearch(e,t):this.sharePointSearch(e,t)};t.prototype.sharePointSearch=function(e,t){var n=this;t.onToggleGetMoreResults&&t.onToggleGetMoreResults(!1);return u.n.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(r){return n.dataRequestor.getData({url:n._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.ClientPeoplePickerSearchUser").toString(),additionalPostData:n._constructPostBody(e,t),qosName:"Search",authToken:r,parseResponse:function(r){var i=t.allowSharePointGroups,s=void 0===i||i,u=t.filterExternalUsers,a=t.forceResolve,f=JSON.parse(r),l=JSON.parse(f.d.ClientPeoplePickerSearchUser),c=n._transformData(l,u);u&&(c=c.filter(function(e){return 1!==e.entityType}));var h=!c.length;c=c.filter(function(e){return e.principalType===o.e.sharePointGroup?s:e.principalType===o.e.securityGroup?s||n._isValidEmail(e.email,!0):n._isValidEmail(e.email,!1)});if(d.e.isActivated("cc7520a8-6922-4e12-81c1-179764750212","3/29/2018","Disable limiting no results behavior to e-mail addresses."))a&&h&&c.push({name:e,userId:e,email:e});else if(!1!==t.resolveEmailIfNoResults&&0===c.length&&n._isValidEmail(e,!1)){var p={Key:e,IsResolved:!1};c.push({email:e,entityType:1,isResolved:!1,job:!1===t.fallbackToEmailIfNoJob?void 0:e,name:e,userId:e,rawData:p,rawPersonData:p,isExternal:!0})}return c}})})};t.prototype.subscribePresence=function(e,t){var n=this;try{this._ensureSkypePresence();if(!O365Shell_Shim.SkypeIntegration.isAvailable())return null;var r=function(e){try{switch(e){case 0:t(0);break;case 1:t(1);break;case 2:t(2);break;case 3:t(3);break;case 4:t(4);break;case 5:t(5);break;case 6:t(6);break;case 8:t(7);break;default:t(0)}}catch(e){}};this._skypeIntegration.TrackPresence(e,r);return{dispose:function(){try{n._skypeIntegration.UntrackPresence(e,r)}catch(e){}}}}catch(e){}return null};t.prototype.sendSourceName=function(){return"PeoplePickerDataSource"};t.prototype._constructPostBody=function(e,t){var n={queryParams:{QueryString:e,MaximumEntitySuggestions:t.maximumEntitySuggestions,AllowEmailAddresses:t.allowEmailAddresses,AllowOnlyEmailAddresses:t.allowOnlyEmailAddresses,PrincipalType:t.principalType,PrincipalSource:t.principalSource,UseSubstrateSearch:t.useSubstrateSearch,SharePointGroupID:t.groupID,QuerySettings:t.querySettings}};return JSON.stringify(n)};t.prototype._ensureSkypePresence=function(){var e=this;try{if(!Boolean(this._skypeIntegration)){var t=new O365Shell_Shim.SkypeIntegration;t.OnApiReady(function(){e._skypeIntegration=t})}}catch(e){}};t.prototype._graphSearch=function(e,n){var r=this;return this._graphPeoplePickerHelper.getGraphToken().then(function(i){if(!i)return r.sharePointSearch(e,n);var s=new m.t("https://graph.microsoft.com/v1.0/me/people");if(e){s.setQueryFromObject({$search:'"'+e+'"',$top:"30",$select:"displayName,scoredEmailAddresses,personType,department,jobTitle,userPrincipalName"});if(d.e.isActivated("08c31a2f-5109-4dd9-b6ab-d6ea8fec0d9f","09/29/2020","Fix bug: Should correctly handle PrincipalType in Graph query filter."))!1!==n.filterPublicDistributionList&&s.setQueryParameter("$filter","personType/subclass ne 'PublicDistributionList'");else{var u=t._getPersonTypeFilter(n);u&&s.setQueryParameter("$filter",u)}}return r._dataRequestor.send({apiName:"Graph.PeopleSearch",path:s.toString(),headers:{Authorization:"Bearer "+i,"X-PeopleQuery-QuerySources":"Mailbox,Directory"},needsAuthorization:!1}).then(function(t){n.onToggleGetMoreResults&&n.onToggleGetMoreResults(!0);if(!t||!t.value||0===t.value.length)return r.sharePointSearch(e,n);var i=t.value,s=[];i.forEach(function(e){if(r._invalidPeopleSubTypesKSActivated||!e.personType.subclass||!r._isIgnorablePeopleSubType(e.personType.subclass)){var t=e.scoredEmailAddresses[0]?e.scoredEmailAddresses[0].address:"",i=e.userPrincipalName&&r._isValidEmail(e.userPrincipalName,!1)?e.userPrincipalName:t,u={Key:i,IsResolved:!1},a="ImplicitContact"===e.personType.subclass,f="OrganizationUser"===e.personType.subclass,l="Group"===e.personType.class&&"UnifiedGroup"===e.personType.subclass,h="PublicDistributionList"===e.personType.subclass,p=Object(c.getUserPhotoUrl)(t),d={department:e.department,email:t,image:a?void 0:p,job:!1===n.fallbackToEmailIfNoJob?e.jobTitle:e.jobTitle||t,name:e.displayName,providerName:f?"Provider":void 0,userId:i,rawData:u,rawPersonData:u,isExternal:!f,aadObjectId:e.id};if(f){d.entityType=0;d.principalType=o.e.user;d.isResolved=!0}else if(l){d.entityType=2;d.principalType=o.e.securityGroup;d.isResolved=!1;d.userId=e.id}else{d.principalType=h?o.e.distributionList:o.e.none;d.entityType="Group"===e.personType.class?2:1;d.isResolved=!1;d.providerName=void 0}d.userId&&s.push(d)}});if(!1!==n.resolveEmailIfNoResults&&0===s.length&&r._isValidEmail(e,!1)){var u={Key:e,IsResolved:!1};s.push({email:e,entityType:1,isResolved:!1,job:!1===n.fallbackToEmailIfNoJob?void 0:e,name:e,userId:e,rawData:u,rawPersonData:u,isExternal:!0})}return s},function(t){if(Object(p.s)(t))switch(t.status){case 400:case 401:case 403:case 404:r._graphPeoplePickerHelper.disableGraphCallsForPicker();return r.sharePointSearch(e,n);default:return r.sharePointSearch(e,n)}else"Canceled"!==t.name&&r._graphPeoplePickerHelper.disableGraphCallsForPicker();return"Canceled"===t.name?null:r.sharePointSearch(e,n)})})};t.prototype._substrateSearch=function(e,t){var n=this;return this._substratePeoplePickerHelper.getSubstrateToken().then(function(r){if(!r)return n.sharePointSearch(e,t);var i=null;t.siteIBSegmentIDs&&t.siteIBSegmentIDs.length>0&&(i=t.siteIBSegmentIDs);var s=["Directory"];d.e.isActivated("9403ac4d-b51a-48b3-a4c0-9007477f73ea","02/18/2020","Mailbox Searching in Substrate People Suggestions.")||s.splice(0,0,"Mailbox");var u={};u=d.e.isActivated("04f09a5b-1c0f-42ef-9b9f-ba8c1e321810","07/03/2020","Removing litoken in Substrate call.")?{Authorization:"Bearer "+r,"X-User-Context":"litoken="+r}:{Authorization:"Bearer "+r};return n._dataRequestor.send({apiName:"Substrate.PeopleSearch",path:a.e+"/api/v1/suggestions",headers:u,needsAuthorization:!1,requestType:"POST",postData:JSON.stringify({EntityRequests:[{EntityType:"People",ProvenanceMergeMode:"Default",Provenances:s,Query:{QueryString:e},From:0,Size:25,Fields:["DisplayName","EmailAddresses","CompanyName","JobTitle","OfficeLocation","Department","UserPrincipalName","PeopleType","PeopleSubtype"],Filter:i?{Or:i.map(function(e){return{Term:{InformationBarrierSegment:e}}})}:null}],TimeZone:"UTC",Cvid:t.conversationId,Scenario:{Name:"documentshare"}})}).then(function(r){t.onToggleGetMoreResults&&t.onToggleGetMoreResults(!0);var i=r.Groups[0]?r.Groups[0].Suggestions:[],s=[];i.forEach(function(e){if(n._invalidPeopleSubTypesKSActivated||!e.PeopleSubtype||!n._isIgnorablePeopleSubType(e.PeopleSubtype)){var r=e.EmailAddresses[0]||e.QueryText||"",i=e.UserPrincipalName&&n._isValidEmail(e.UserPrincipalName,!1)?e.UserPrincipalName:r,u={Key:i,IsResolved:!1},a="ImplicitContact"===e.PeopleSubtype,f="OrganizationUser"===e.PeopleSubtype,l="LinkedIn"===e.PeopleSubtype,h="Group"===e.PeopleType&&"UnifiedGroup"===e.PeopleSubtype,p="PublicDistributionList"===e.PeopleSubtype,d=Object(c.getUserPhotoUrl)(r),v={department:e.Department,office:e.OfficeLocation,email:r,image:a?void 0:d,job:!1===t.fallbackToEmailIfNoJob?e.JobTitle:e.JobTitle||r,name:e.DisplayName,providerName:"Provider",userId:i,rawData:u,rawPersonData:u,isExternal:!f};if(f){v.entityType=0;v.principalType=o.e.user;v.isResolved=!0}else if(h){v.entityType=2;v.principalType=o.e.securityGroup;v.isResolved=!1;v.providerName=void 0}else if(l)v.entityType=4;else{v.principalType=p?o.e.distributionList:o.e.none;v.entityType="Group"===e.PeopleType?2:1;v.isResolved=!1;v.providerName=void 0}v.userId&&s.push(v)}});if(!1!==t.resolveEmailIfNoResults&&0===s.length&&n._isValidEmail(e,!1)){var u={Key:e,IsResolved:!1};s.push({email:e,entityType:1,isResolved:!1,job:!1===t.fallbackToEmailIfNoJob?void 0:e,name:e,userId:e,rawData:u,rawPersonData:u,isExternal:!0})}return s},function(r){if("Canceled"!==r.name){n._substratePeoplePickerHelper.disableSubstrateCallsForPicker();n.sharePointSearch(e,t)}return null})})};t.prototype._isValidEmail=function(e,t){return e?!(e.indexOf(" ")>-1||e.indexOf(";")>-1)&&v.e.isValidEmailSyntax(e,!1):!t};t._getPersonTypeFilter=function(e){if(e.principalType===o.e.user)return"personType/class ne 'Group'";var t="";e.principalType&o.e.distributionList||(t+="personType/subclass ne 'PublicDistributionList'");if(!(e.principalType&o.e.securityGroup)){t&&(t+=" and ");t+="personType/subclass ne 'UnifiedGroup'"}return t||(!1!==e.filterPublicDistributionList?"personType/subclass ne 'PublicDistributionList'":"")};t.prototype._isIgnorablePeopleSubType=function(e){if(!e)return!1;return["PersonalDistributionList","ImplicitGroup","Unknown"].some(function(t){return t===e})};t.prototype._transformData=function(e,t){var n=this;return e.map(function(e){var r=e.EntityData,i={name:e.DisplayText,email:r.Email,userId:e.Key,job:r.Title,department:r.Department,phone:r.MobilePhone,providerName:e.ProviderDisplayName,entityType:e.EntityType,isResolved:e.IsResolved,multipleMatches:e.MultipleMatches,rawPersonData:e,rawData:e};if(i.multipleMatches.length>0){i.multipleMatches=n._transformData(i.multipleMatches,t);t&&(i.multipleMatches=i.multipleMatches.filter(function(e){return 1!==e.entityType}))}var s=i.email;i.isResolved&&(i.image=s?Object(c.getUserPhotoUrl)(s):null);var u=r.PrincipalType||e.EntityType;switch(u){case"UNVALIDATED_EMAIL_ADDRESS":case"GUEST_USER":i.entityType=1;i.principalType=o.e.user;i.isExternal=!0;break;case"SecGroup":case"SharePointGroup":case"FormsRole":i.entityType=2;i.principalType="SharePointGroup"===u?o.e.sharePointGroup:o.e.securityGroup;break;default:i.entityType=0;i.principalType=o.e.user}return i})};return t})(s.t);function y(e){return!!e.webAbsoluteUrl}},"1711":function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(94),i=n(196),s=n(107),o=n(1641),u=(function(){function e(e,t){var n=e.id,r=e.cacheType,u=void 0===r?s.e.session:r,a=t.cacheIdPrefix,f=void 0===a?o.e:a,l=t.pageContext;this._id=n;this._version=l?l.siteClientTag+"_"+l.userDisplayName:"";this._store=new i.e(f,u);this._storeDefaultCacheType=u;this._initCache()}e.prototype.getDataUtilizingCache=function(e){var t=this,n=e,i=n.cacheRequestKey,u=n.useStale,a=void 0!==u&&u,f=n.bypassCache,l=void 0!==f&&f,c=n.onlyCache,h=void 0!==c&&c,p=n.checkForInvalidation,d=n.setInvalidated,v=n.getData,m=n.cacheTimeoutTime,g=void 0===m?o.t:m,y=n.returnStatistics,b=void 0!==y&&y,w=this._cache,E=w[i],S=function(){return b?{data:E._value,cacheStats:{lastModified:NaN,lastRead:E._fetched,reads:NaN}}:E._value};if(h)return E?r.n.resolve(S()):r.n.resolve(void 0);p=p&&!l&&this._storeDefaultCacheType!==s.e.local;var x=E&&this._isCacheExpired(E,i,p,g);return l||!E||x&&!a?v().then(function(e){var n=(new Date).valueOf();w[i]={_fetched:n,_value:e};d&&t._store.setValue(i,n-1,s.e.local);t._updateCache();return b?{data:e,cacheStats:{lastModified:NaN,lastRead:n,reads:NaN}}:e}):r.n.resolve(S())};e.prototype.getRequestKey=function(e,t,n){var r=[];r.push(e);r.push(t);n&&r.push(n.toString());return r.join(",")};e.prototype.isCachedDataInvalidated=function(e){var t=this._cache[e];return this._isCachedDataInvalidated(t,e)};Object.defineProperty(e.prototype,"cacheId",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"cacheVersionId",{get:function(){return this._id+"-version"},enumerable:!0,configurable:!0});e.prototype.flushCache=function(e){if(e){delete this._cache[e];this._updateCache()}else this._clearCache()};e.prototype._initCache=function(){if(this._version!==this._store.getValue(this.cacheVersionId,void 0,!1)){this._clearCache();this._store.setValue(this.cacheVersionId,this._version,void 0,!1)}else this._cache=this._store.getValue(this.cacheId,void 0,!1)||{}};e.prototype._updateCache=function(){this._store.setValue(this.cacheId,this._cache,void 0,!1)};e.prototype._clearCache=function(){this._cache={};this._updateCache()};e.prototype._isCacheExpired=function(e,t,n,r){if(n&&this._isCachedDataInvalidated(e,t))return!0;var i=(new Date).valueOf()-r;return e._fetched<=i};e.prototype._isCachedDataInvalidated=function(e,t){var n=Number(this._store.getValue(t,s.e.local));return!!(e&&n&&e._fetched<n)};return e})()},"1715":function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(270),i=Object(r.e)({eventName:"SuiteNavError,",shortEventName:"SuiteNavError",requiresParent:!1},{message:1,stack:1,type:1})},"1722":function(e,t,n){"use strict";var r=n(1793),i=n(94),s=n(1832),o=n(147),u=n(1544),a=n(1792),f=(function(){function e(e){this._pageContext=e.pageContext?e.pageContext:window._spPageContextInfo;this._getThemeDataSource=e.getThemeDataSource;this._themeProvider=new s.e(this._loadTheme.bind(this))}e.prototype.loadThemeSlotsMap=function(e){var t=this._getThemeCacheToken();return t?this._themeProvider.loadThemeTokenMap(t,e):i.n.resolve()};e.prototype.loadFullFormattedThemeData=function(e){var t=this;return this.loadFullThemeData(e).then(function(e){if(e){var n={},r=e.palette;for(var i in r){var o=r[i];o&&(n[i]=u.e.toHtmlString(o))}e.backgroundImageUri&&(n.backgroundImageUri=s.e.getBackgroundUrl(e));var f={palette:n,isInverted:e.isInverted};return f=Object(a.e)(f,t._pageContext)}})};e.prototype.loadFullThemeData=function(e){var t=this._getThemeCacheToken();if(t)return this._themeProvider.loadThemeData(t,e);return i.n.resolve(void 0)};e.prototype._getThemeCacheToken=function(){var e,t=this._pageContext;if(t){var n=Number(t.webTemplate),r=n===o.e.teamSite||n===o.e.group?t.groupColor:void 0,i=r?r+";web#"+t.webTemplate:null;e=t.themedCssFolderUrl||i||null}return e};e.prototype._loadTheme=function(e){if(!!this._getThemeCacheToken()){this._themeDataSource||(this._themeDataSource=this._getThemeDataSource());return this._themeDataSource.then(function(t){return t?t.loadTheme(e):i.n.resolve()})}return i.n.resolve()};return e})(),l=n(435),c=n(389),h=n(1723),p=n(1818),d=n(75),v=n(910).r?"#0078d4":"#03787c",m=(function(){function e(e){this._pageContext=e;this._dataRequestor=new c.e({qosName:"WebThemeDataSource"},{pageContext:e})}e.prototype.getCacheToken=function(){var e="",t=this._pageContext;if(t){var n=Number(t.webTemplate),r=n!==o.t.mySite&&n!==o.t.mySiteHost?t.groupColor:v;e=t.themedCssFolderUrl||r}return e};e.prototype.loadTheme=function(e){if(!e&&this._dataPromise)return this._dataPromise;if(!this.getCacheToken())return this._dataPromise=i.n.resolve();this._dataPromise=this._pageContext.themedCssFolderUrl?this.loadServerTheme():this.loadGeneratedTheme();return this._dataPromise};e.prototype.needsRequestDigest=function(e){return!1};e.prototype.loadGeneratedTheme=function(){var e=this._pageContext.groupColor||v,t=u.e.fromHtmlColor(e);if(t){var n={backgroundImageUri:null,cacheToken:e,isDefault:!1,isInverted:!1,palette:h.e.generateFabricColors(t),version:"1"};return i.n.resolve(n)}return i.n.resolve()};e.prototype.loadServerTheme=function(){var e=this,t=Object(l.n)(this._pageContext),n=this._pageContext.currentUICultureName,r=this._pageContext.themedCssFolderUrl,i=!d.e.isActivated("D18277F9-2D5C-488B-98F2-90403DE467E7","02/26/2020","Specify theme folder override")&&this.getCacheToken()===r&&r||void 0,s=p.e.makeWebThemeRestUrl(t,n,i),o=this._dataRequestor.getData({url:s,parseResponse:function(t){e._data=p.e.processWebThemeRestResponse(t);return e._data},qosName:"WebThemeDataSource.LoadData",method:"GET"});o.done(null,function(){e._dataPromise=null});return o};return e})();n.d(t,"e",function(){return g});function g(e){var t=e||window._spPageContextInfo,n={webThemeProvider:function(){return new f({pageContext:t,getThemeDataSource:function(){return i.n.resolve(new m(t))}})}};return Object(r.e)(n,t)}},"1735":function(e,t,n){"use strict";n.d(t,"e",function(){return o});var r=n(134),i=n(281),s=n(129),o=(function(){function e(){}e.getBatchOperationUrl=function(e,t){return new i.t({webAbsoluteUrl:!e&&t?new s.e(t).authority:e}).build().segment("$batch").toString()};e.processErrorResponse=function(e,t){var n={id:t};if((e=e.error?e.error:e)&&e.code){var r=e.code?e.code.split(","):e.error.code.split(","),i=Number(r[0]),s=e.message.value;n.error={code:i,message:s}}return{items:[n]}};e.getBatchResponseText=function(e){var t,n,r,i=[];e.split("\n").length>0&&(t=e.split("\n")[0]);if(t){n=(e=e.replace(t.trim()+"--","")).split(t);for(var s=1;s<n.length;s++)(r=n[s].split("\n\r")).length>2&&i.push(r[2])}return i};e.processBatchResponse=function(e,t,n){var r,i,s,o,u=[],a=!1;e.split("\n").length>0&&(r=e.split("\n")[0]);if(r){i=(e=e.replace(r.trim()+"--","")).split(r);for(var f=1;f<i.length;f++)if((s=i[f].split("\n\r")).length>2){try{o=JSON.parse(s[2])}catch(e){o=s[2]}var l=t&&t[f-1],c=l?{key:l.key,id:l.id,newId:n?n+"/"+l.name:null}:{};if((o=o.error?o.error:o)&&o.code){var h=o.code?o.code.split(","):o.error.code.split(","),p=Number(h[0]),d=o.message.value;c.error={code:p,message:d};a=!0}u.push(c)}}return{items:u,hasError:a}};e.getBatchContent=function(e,t,n,i){for(var s=[],o=0;o<t.length;o++){for(var u=t[o],a=r.e.generate(),f=[],l=0;l<u.length;l++){var c=u[l];f.push("--changeset_"+a);f.push("Content-Type: application/http");f.push("Content-Transfer-Encoding: binary");f.push("");f.push(n+" "+c+" HTTP/1.1");f.push(i);f.push("")}f.push("--changeset_"+a+"--");var h=f.join("\r\n");s.push("--batch_"+e);s.push('Content-Type: multipart/mixed; boundary="changeset_'+a+'"');s.push("Content-Length: "+h.length);s.push("Content-Transfer-Encoding: binary");s.push("");s.push(h);s.push("")}s.push("--batch_"+e+"--");return s.join("\r\n")};e.getBatchContentExtended=function(e,t,n,i,s,o,u){var a=r.e.generate(),f=[];s&&s.length!==t.length&&(s=null);for(var l=0;l<t.length;l++){var c=t[l];f.push("--changeset_"+a);f.push("Content-Type: application/http");f.push("Content-Transfer-Encoding: binary");f.push("");u?f.push(u[l]+" "+c+" HTTP/1.1"):f.push(n+" "+c+" HTTP/1.1");f.push(i);o&&f.push(o);if(s){f.push("");f.push(s[l])}f.push("")}f.push("--changeset_"+a+"--");var h=f.join("\r\n");(f=[]).push("--batch_"+e);f.push('Content-Type: multipart/mixed; boundary="changeset_'+a+'"');f.push("Content-Length: "+h.length);f.push("Content-Transfer-Encoding: binary");f.push("");f.push(h);f.push("");f.push("--batch_"+e+"--");return f.join("\r\n")};e.defaultBatchRequestPostData="Content-Type: application/json;odata=verbose";e.defaultBatchAcceptData="accept: application/json;odata=verbose";return e})();t.t=o},"1740":function(e,t,n){"use strict";n.d(t,"e",function(){return f});var r=n(0),i=n(94),s=n(75),o=n(1987),u=n(101),a=n(1641),f=(function(){function e(e,t){this._getDataPromises={};var n=e.id,i=e.dataSourceName,s=e.cacheType,a=void 0===s?1:s,f=(t.pageContext||{}).aadUserId;this._id=n;this._userId=f;var l=i||n,c=u.e.withData(function(e){return e.name&&l&&!e.name.startsWith(l)?Object(r.__assign)(Object(r.__assign)({},e),{name:l+"."+e.name}):e});this._cache=new o.e({cacheType:a,telemetry:{qos:c}})}e.prototype.getDataUtilizingCache=function(e){var t=this,n=e,r=n.cacheRequestKey,o=n.cachingStrategy,u=void 0===o?0:o,f=n.cacheTimeoutTime,c=void 0===f?a.n:f,h=n.getData,p=n.returnStatistics,d=void 0!==p&&p,v={key:r,user:this._userId},m=function(){l()||t._getDataPromises[r]||(t._getDataPromises[r]=h().then(function(e){delete t._getDataPromises[r];return e}));return(l()?h():t._getDataPromises[r]).then(function(e){t._cache.update(v,e);return d?{data:e,cacheStats:{lastModified:NaN,lastRead:Date.now(),reads:1}}:e})};return s.e.isActivated("19cec8a5-4f79-4d4c-ae7e-f272ba265abb")||2!==u?i.n.resolve(this._cache.read(v)).then(function(e){var n=e.data,r=e.cacheStats;if(null==n)return m();var i=d?{data:n,cacheStats:r}:n,s=t._isCacheExpired(r.lastModified,c);switch(u){case 2:return i;case 0:s&&m();return i;case 1:return s?m():i;case 3:default:return m()}}).catch(function(){return m()}):i.n.resolve(this._cache.read(v)).then(function(e){var t=e.data,n=e.cacheStats;return null==t?null:d?{data:t,cacheStats:n}:t}).catch(function(){return null})};e.prototype.getRequestKey=function(e,t,n){var r=[];r.push(e);r.push(t);n&&r.push(n.toString());return r.join(",")};Object.defineProperty(e.prototype,"cacheId",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"cacheVersionId",{get:function(){return this._id+"-version"},enumerable:!0,configurable:!0});e.prototype.flushCache=function(e){var t={key:e,user:this._userId};delete this._cache[e];this._cache.remove(t)};e.prototype._isCacheExpired=function(e,t){return e<=(new Date).valueOf()-t};return e})();function l(){return s.e.isActivated("0b1fbce0-bb51-41da-a09b-8d1686398bb7")}},"1750":function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.Html5file=0]="Html5file";e[e.Folder=1]="Folder"})(r||(r={}));t.t=r},"1775":function(e,t,n){"use strict";n.r(t);n.d(t,"getItemName",function(){return f});n.d(t,"updateListContext",function(){return l});n.d(t,"updateListContextGroupInfo",function(){return c});var r=n(0),i=n(1480),s=n(75),o=n(391),u=n(241),a=n(29);function f(e,t,n){return n&&!n.isDocLib&&t!==i.t.Folder&&(e.Title||e["URL.desc"])||e.FileLeafRef}function l(e,t){if(Number(e.ListTemplateType)){t.listTemplateType=Number(e.ListTemplateType);t.isDocLib=Object(a.i)(t.listTemplateType)}"boolean"==typeof e.ContentTypesEnabled&&(t.contentTypesEnabled=e.ContentTypesEnabled);if(e.ListSchema){t.listId=e.listName;t.rawListSchema=e.ListSchema;t.viewTitle=e.viewTitle;t.openInClient="0"===t.rawListSchema.DefaultItemOpen}e.ListTitle&&(t.listTitle=e.ListTitle);e.listUrlDir&&(t.listUrl=decodeURIComponent(e.listUrlDir));e.EnableAttachments&&(t.enableAttachments="true"===e.EnableAttachments);e.Flags2&&(t.flags2=e.Flags2);var n=e.BasePermissions;n&&(t.permissions={manageLists:n.ManageLists,managePersonalViews:n.ManagePersonalViews,openItems:n.OpenItems});"boolean"!=typeof e.ExcludeFromOfflineClient&&"boolean"!=typeof e.WebExcludeFromOfflineClient||(t.excludeFromOfflineClient=!(!e.ExcludeFromOfflineClient&&!e.WebExcludeFromOfflineClient));"boolean"==typeof e.TenantTagPolicyEnabled&&(t.tenantTagPolicyEnabled=e.TenantTagPolicyEnabled);"boolean"==typeof e.verEnabled&&(t.enableVersions=e.verEnabled);"boolean"==typeof e.checkPowerAppState&&(t.checkPowerAppState=e.checkPowerAppState);"boolean"==typeof e.EnableMinorVersions&&(t.enableMinorVersions=e.EnableMinorVersions);"boolean"==typeof e.NewWOPIDocumentEnabled&&(t.newWOPIDocumentEnabled=e.NewWOPIDocumentEnabled);"number"==typeof e.NewWOPIDocumentTypes&&(t.newWOPIDocumentTypes=e.NewWOPIDocumentTypes);"boolean"==typeof e.isForceCheckout&&(t.isForceCheckout=e.isForceCheckout);"boolean"==typeof e.isModerated&&(t.isModerated=e.isModerated);"boolean"==typeof e.EnableRequestSignOff&&(t.enableRequestSignOff=e.EnableRequestSignOff);"boolean"==typeof e.AllowCreateFolder&&(t.allowCreateFolder=e.AllowCreateFolder);s.e.isActivated("F5795B0F-8820-4A74-9281-EC1C68E4929C","2/9/2021","Implement list level comment setting")||"boolean"!=typeof e.DisableCommenting||(t.disableCommenting=e.DisableCommenting);"boolean"==typeof e.AllowGridMode?t.allowGridMode=e.AllowGridMode:"boolean"!=typeof t.allowGridMode&&(t.allowCreateFolder=!0);e.displayFormUrl&&(t.displayFormUrl=e.displayFormUrl);e.editFormUrl&&(t.editFormUrl=e.editFormUrl);e.newFormUrl&&(t.newFormUrl=e.newFormUrl);e.metadataNavFeatureEnabled&&(t.metadataNavFeatureEnabled=e.metadataNavFeatureEnabled);e.AvailableContentTypes&&(t.availableContentTypes=e.AvailableContentTypes);if(e.ViewMetadata){var i=void 0;i=s.e.isActivated("F5D38A68-8774-425A-BC0B-1650EAA9C41D","9/21/2018","avoid mutate the original serverView object in the spdata")?e.ViewMetadata:Object(r.__assign)({},e.ViewMetadata);if(e.VisualizationInfo)try{i.VisualizationInfo=JSON.parse(e.VisualizationInfo)}catch(e){}i.CustomFormatter=e.ListSchema&&e.ListSchema.CustomFormatter;t.viewResult=new o.e(i)}t.isPlaceholder=!1}function c(e){var t=void 0;if(e.groupByOverride)t=[e.groupByOverride];else if(e.rawListSchema&&e.rawListSchema.group1){(t=[]).push(e.rawListSchema.group1);e.rawListSchema.group2&&t.push(e.rawListSchema.group2)}var n=-1,r=e.rawListSchema&&"TRUE"===e.rawListSchema.Collapse;if(t&&t.length>0){n=0;if(e.filterParams&&!r){var i=Boolean(Object(u.getFilterFieldByName)(e.filterParams,t[0])),s=!(!i||!t[1])&&Boolean(Object(u.getFilterFieldByName)(e.filterParams,t[1]));(i&&1===t.length||s&&2===t.length)&&(n=-1)}}e.groupLevel=n;e.groupBy=n>-1?t:void 0;e.isGrouped=Boolean(e.groupBy)}},"1777":function(e,t,n){"use strict";n.d(t,"e",function(){return r});n.d(t,"t",function(){return i});n.d(t,"n",function(){return s});var r={neutralDark:"#201f1e",neutralPrimary:"#323130",neutralPrimaryAlt:"#3b3a39",neutralSecondary:"#605e5c",neutralSecondaryAlt:"#8a8886",neutralTertiary:"#a19f9d",neutralTertiaryAlt:"#c8c6c4",neutralQuaternary:"#d2d0ce",neutralQuaternaryAlt:"#e1dfdd",neutralLight:"#edebe9",neutralLighter:"#f3f2f1",neutralLighterAlt:"#faf9f8"},i={elevation4:"0 0 5px 0 rgba(0,0,0,.4)",elevation8:"0 0 5px 0 rgba(0,0,0,.4)",elevation16:"0 0 5px 0 rgba(0,0,0,.4)",elevation64:"0 0 5px 0 rgba(0,0,0,.4)",roundedCorner2:"0px",roundedCorner4:"0px",roundedCorner6:"0px"},s={tiny:{fontSize:10,fontWeight:600},xSmall:{fontSize:11,fontWeight:400},small:{fontSize:12,fontWeight:400},smallPlus:{fontSize:13,fontWeight:400},medium:{fontSize:14,fontWeight:400},mediumPlus:{fontSize:15,fontWeight:400},large:{fontSize:17,fontWeight:300},xLarge:{fontSize:21,fontWeight:100},xLargePlus:{fontSize:21,fontWeight:100},xxLarge:{fontSize:28,fontWeight:100},xxLargePlus:{fontSize:28,fontWeight:100},superLarge:{fontSize:42,fontWeight:100},mega:{fontSize:72,fontWeight:100}}},"1792":function(e,t,n){"use strict";n.d(t,"t",function(){return l});n.d(t,"e",function(){return c});var r=n(0),i=n(246),s=n(394),o=n(171),u=n(141),a=n(1777),f=n(910);function l(e,t,n){var r;i.e.applyBatchedUpdates(function(){r=Object(s.n)(c(e,t))});return r}function c(e,t){t&&o.e.initSPExpFeatures(t.ExpFeatures);u.n.evaluateCanOverride();if(!f.r){e=h({palette:{themePrimary:"#03787c",themeLighterAlt:"#f0f9fa",themeLighter:"#c5e9ea",themeLight:"#98d6d8",themeTertiary:"#49aeb1",themeSecondary:"#13898d",themeDarkAlt:"#026d70",themeDark:"#025c5f",themeDarker:"#014446"}},e)}f.n&&!u.n.isFeatureEnabled(f.e)&&(e=h({effects:a.t},e));f.n&&!u.n.isFeatureEnabled(f.e)&&(e=h({fonts:a.n},e));var n=e.palette;n&&(n.black||n.neutralPrimary||n.white||n.neutralQuaternary)&&!(n.black&&n.white&&n.neutralPrimary&&n.neutralQuaternary&&0===n.black.indexOf("#000")&&0===n.white.toLowerCase().indexOf("#fff")&&0===n.neutralPrimary.indexOf("#333")&&0===n.neutralQuaternary.toLowerCase().indexOf("#d0d0d0"))||(e.palette=Object(r.__assign)(Object(r.__assign)({},e.palette),a.e));return e}function h(e,t){return e=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},e),t),{effects:Object(r.__assign)(Object(r.__assign)({},e.effects),t.effects),fonts:Object(r.__assign)(Object(r.__assign)({},e.fonts),t.fonts),palette:Object(r.__assign)(Object(r.__assign)({},e.palette),t.palette)})}},"1793":function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r,i;function s(e,t){if(!r||i!==e){r=(function(e,t){var n,r=t||window._spPageContextInfo;r&&(n=e.webThemeProvider(r));return n})(e,t);i=e}return r}},"1816":function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return i});var r,i,s={applyPanel:"filtersPane-applyInPanel",pinnedToFiltersPaneChanged:"filtersPane-pinnedToFiltersPaneChanged",showInFiltersPaneChanged:"filtersPane-showInFiltersPaneChangedChanged",sectionInfosChanged:"filtersPane-sectionInfosChanged"};(function(e){e[e.user=0]="user";e[e.date=1]="date";e[e.fileType=2]="fileType";e[e.choice=3]="choice";e[e.hierarchy=4]="hierarchy"})(r||(r={}));(function(e){e[e.none=0]="none";e[e.last3Months=1]="last3Months";e[e.last30Days=2]="last30Days";e[e.last7Days=3]="last7Days";e[e.yesterday=4]="yesterday";e[e.today=5]="today";e[e.tomorrow=6]="tomorrow";e[e.next7Days=7]="next7Days";e[e.next30Days=8]="next30Days";e[e.next3Months=9]="next3Months";e[e.nextYear=10]="nextYear"})(i||(i={}))},"1819":function(e,t,n){"use strict";n.d(t,"e",function(){return N});var r=n(0),i=n(326),s=n(196),o=n(107),u=n(2072),a=n(1715),f=n(147),l=n(919),c=n(151),h=n(141),p=n(75),d=n(1722),v=n(910),m=n(94),g=n(900),y=n(173),b=n(101),w=n(48),E=n(934),S={ODB:556,ODC:null,Fallback:!1},x={ODB:1302,ODC:null,Fallback:!1},T={ODB:1836,ODC:null,Fallback:!1},N=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,{engagementEvent:y.e,qosEvents:{"SuiteNavProvider.GetO365Shell":new b.e({name:"SuiteNavProvider.GetO365Shell"})}},n)||this;r._dataSource=n.dataSource;r._cssLoaded=!1;r._isSuiteNavBootstrapperLoadingFlowEnabled=h.n.isFeatureEnabled(x);return r}t.prototype.clearCachedPromise=function(){this._modelPromise=void 0};t.prototype.loadData=function(e){return this._loadModel(e).then(function(e){return e.data})};t.prototype.getO365Shell=function(){if(this._isSuiteNavBootstrapperLoadingFlowEnabled)return e.prototype.getO365Shell.call(this);if(!this._capabilities.supportsRealSuiteNav)throw new Error("getO365Shell is only supported if supportsRealSuiteNav capability is true.");var t=new i.e,n=new b.e({name:"SuiteNavProvider.GetO365Shell"});this._getSuiteNavShell(t);t.getPromise().then(function(){n.end({resultType:w.e.Success})},function(e){n.end(Object(E.n)({error:e}))});return t.getPromise()};t.prototype.getMailUrl=function(){return this._loadModel().then(function(e){var t=e&&e.data&&e.data.WorkloadLinks;if(t)for(var n=0,r=t;n<r.length;n++){var i=r[n];if(i&&i.Id===l.e.MAIL)return i.Url}})};t.prototype.updateWorkloadSettingsLinks=function(e){var t,n=this;return this.getO365Shell().then(function(r){return(t=r)&&t.Settings?n.loadData(e):void 0}).then(function(e){e&&e.CurrentWorkloadSettingsSubLinks&&e.CurrentWorkloadSettingsSubLinks.length>0&&t.Settings.SetWorkloadSettingsLinks(e.CurrentWorkloadSettingsSubLinks)}).catch(function(e){y.e.logData({name:"SuiteNavProvider.UpdateWorkloadSettingsLinksError"})})};t.prototype.trySetDataAfterInitialRender=function(e,t){var n=this;if(!p.e.isActivated("90416B39-D822-4C92-829E-276AA74014C8","01/21/2021","Support consumer SuiteNav")){var i=this._dataSource.getSuiteNavContext();if(i&&i.isConsumer){this._logEngagementData({name:"SuiteNavProvider.SetDataNotNeededInConsumer"});return m.n.wrap(!0)}}y.e.logData({name:"SuiteNavProvider.SetDataAfterInitialRender"});var s=t.actionContext,o=t.bundleLoader;return this.loadData().then(function(t){if(!t){y.e.logData({name:"SuiteNavProvider.NoSuiteNavData"});return!1}if(!e){y.e.logData({name:"SuiteNavProvider.NoO365Shell"});return!1}var i=h.n.isFeatureEnabled(T)&&!!e.NFD,u=i&&n._shouldAddFeedbackButton(e);if(u){var a=JSON.parse(t.ClientData);if(a.OCVFeedbackMAXEnabled){a.OCVFeedbackMAXEnabled=!1;t.ClientData=JSON.stringify(a)}else i=u=!1}try{e.SetData(t)}catch(e){y.e.logData({name:"SuiteNavProvider.SetDataFail"});b.e.instrumentPromise({name:"SuiteNav.RefreshCacheAfterInvalidShellData"},function(){return n.loadData(!0)});return!1}t.ActionsMap&&e.Navigation.OnLinkClick(function(e){var n=t.ActionsMap[e.Id];n&&(e.Cancel=!n(Object(r.__assign)(Object(r.__assign)({},e),s||{})))});e.OnHasMember("OnDataChanged",function(){e.OnDataChanged(function(){return b.e.instrumentPromise({name:"SuiteNav.RefreshCacheForShellDataChanged"},function(){return n.loadData(!0)}).done()})});if(i){e.NFD.OnFeedbackMetadataRequested(function(e,t){return e=n._dataSource.setFeedbackMetadata(e,t)});u&&n._addFeedbackButton(e)}o&&o.pageRenderingIsComplete();return!0},function(e){y.e.logData({name:"SuiteNavProvider.LoadDataError"});return!1})};t.prototype._getSuiteNavShell=function(e,t){var n=this;this._loadModel().then(function(r){if(!n._cssLoaded&&r.cssUrl){g.e.loadStylesheet(r.cssUrl);n._dataSource.onCssLoad&&n._dataSource.onCssLoad(r);n._cssLoaded=!0}y.e.logData({name:"SuiteNavProvider.GetO365ShellByS2S"});n._requestShellCore(r.jsUrl,t,C).then(function(t){e.complete(t)},function(t){n._modelPromise=void 0;if((t=Object(E.n)({error:t}))&&"LoadScriptError"===t.resultCode&&n._isDataFromCache){y.e.logData({name:"SuiteNavProvider.O365ShellCacheFailed"});n._clearCache();n._getSuiteNavShell(e)}else if(n._hasRetriedShell)e.error(t);else{n._hasRetriedShell=!0;n._cssLoaded=!1;y.e.logData({name:"SuiteNavProvider.O365ShellRetry"});n._getSuiteNavShell(e,!0)}})})};t.prototype._loadModel=function(e){var t=this;if(!e&&this._modelPromise)return this._modelPromise;var n,r,s=new i.e,o=this._capabilities.supportsCaching,u=this._dataSource,a=w.e.Failure,f=b.e.instrumentPromise({name:"SuiteNavProvider.LoadData"},function(){return new m.n(function(r,i){var s;!e&&o&&t._isCacheValid()&&(s=t._cache.getValue(t._cacheDataKey));if(s&&s.data){y.e.logData({name:"SuiteNavProvider.DataFromCache"});u.updateDataForCurrentPage&&(s.data=u.updateDataForCurrentPage(s.data));if(o&&t._isCacheOutdated()){y.e.logData({name:"SuiteNavProvider.RefreshCache"});u.loadData().then(function(e){t._updateCache(e)})}t._isDataFromCache=!0;r(s)}else{t._isDataFromCache=!1;e&&y.e.logData({name:"SuiteNavProvider.ForceUpdateData"});y.e.logData({name:"SuiteNavProvider.DataFromServer"});u.loadData().done(function(e){if(e)if(e.data){o&&!(function(e){var t=e&&e.data&&e.data.WorkloadLinks;return!!t&&t.some(function(e){return e&&!e.Url})})(e)&&t._updateCache(e);r(e)}else{n="NoModelData";i("Model with no data returned")}else{n="NoModel";i("No model returned")}},function(e){if(m.n.isCanceled(i)){n="Canceled";a=w.e.ExpectedFailure}else n="ServerLoadFailure";i(e)})}})},null,function(e){if(m.n.isCanceled(e)){a=w.e.ExpectedFailure;n="Canceled"}return{resultType:a,resultCode:n||"Other",error:e}});(r=Object(d.e)())?this._modelPromise=m.n.all({suiteNavModel:f,theme:r.loadThemeSlotsMap()}).then(function(e){var t=e.suiteNavModel,n=e.theme,r=t&&t.data,i=t&&t.hasCobranding,s=r&&r.UseSPOBehaviors,o=h.n.isFeatureEnabled(S),u=n&&n.suiteBarBackground;!(u&&r&&s)||i&&o||(r.ThemeColors=[u,n.primaryText,u,n.suiteBarText,n.suiteBarDisabledText,n.topBarBackground,n.topBarText,n.topBarHoverText,n.primaryBackground,n.themeLighterAlt,n.dialogBorder]);return t}):this._modelPromise=f;this._modelPromise.then(function(e){return s.complete(e)},function(e){return s.error(e)});return s.getPromise()};t.prototype._shouldAddFeedbackButton=function(e){var t=!1;if(h.n.isFeatureEnabled({ODB:v.r?-1246:1246,ODC:null,Fallback:!1})){var n=this._dataSource.getWebTemplateType?this._dataSource.getWebTemplateType():f.t.invalid;t=n!==f.t.mySiteHost&&n!==f.t.mySite&&n!==f.t.tenantAdmin||/\/_layouts\/15\/Lists.aspx$/i.test(window.location.pathname)}return t};t.prototype._addFeedbackButton=function(e){var t;null===(t=e.Extensibility)||void 0===t||t.AddOrUpdateCustomHeaderButton({affordanceMenuItemText:u.e.FeedbackAriaLabel,ariaLabel:u.e.FeedbackAriaLabel,iconFontFamily:"FabricMDL2Icons",iconFontName:"",id:"GiveFeedbackButton",onShow:function(){var t;if(e.FlexPane){e.FlexPane.OpenFlexPaneForProvider("Feedback");c.e.raise(document.body,"resize",void 0,!0)}null===(t=e.Extensibility)||void 0===t||t.UpdateButtonState("GiveFeedbackButton",!0)},onHide:function(){var t;null===(t=e.FlexPane)||void 0===t||t.CloseFlexPaneForProvider("Feedback");c.e.raise(document.body,"resize",void 0,!0)}})};t.prototype._clearCache=function(){this._cache.remove(this._cacheDataKey);this._cache.remove(this._cacheThemeDataKey);this._cache.remove(this._cacheDateKey);this._cache.remove(this._cacheVersionKey);this._cache.remove(this._cacheSessionKey,o.e.session)};t.prototype._updateCache=function(e,t){this._cache.setValue(this._cacheDataKey,e);this._cache.setValue(this._cacheDateKey,new Date);this._cache.setValue(this._cacheVersionKey,this._cacheVersion);this._cache.setValue(this._cacheSessionKey,!0,o.e.session)};t.prototype._isCacheOutdated=function(){var e=this._cache.getValue(this._cacheSessionKey,o.e.session),t=Date.parse(this._cache.getValue(this._cacheDateKey));return s.e.hasStorageType(o.e.session)&&!e||Date.now()-t>=60*this._cacheRenew*60*1e3};return t})(E.e);function C(){var e=window._o365su;if(e&&e.b)for(var t=0,n=["ThrowOnNull","ThrowOnUndefined","ThrowOnNullOrUndefined","ThrowOnNullOrEmpty","ThrowOnNullOrEmptyArray"];t<n.length;t++){var r=n[t];k(e.b,r)}}function k(e,t){var n=e[t];"function"==typeof n&&(e[t]=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];try{return n.apply(this,e)}catch(e){a.e.logData({message:e&&e.message||"",stack:e&&e.stack||"",type:t})}})}},"1846":function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(0),i=n(1611),s=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,Object(r.__assign)(Object(r.__assign)({},t),{isExpected:o(t.errorType)}))||this;n.message=t.message;n.errorType=t.errorType||i.e.other;n.maxSizeInBytes=t.maxSizeInBytes;n.allowRename=t.allowRename||!1;n.allowMerge=t.allowMerge||!1;n.supportsVersioning=t.supportsVersioning||!1;n.extraData=t.extraData;n.libraryName=t.libraryName;n.isFolder=t.isFolder;n.fixItUrl=t.fixItUrl;return n}return t})(n(69).e);function o(e){switch(e){case i.e.conflict:case i.e.similarNameExists:case i.e.emptyFileOrFolder:case i.e.emptyFileOrFolderForDocLib:case i.e.fileSize:case i.e.folderUploadNotSupported:case i.e.insufficientVaultQuota:case i.e.invalidName:case i.e.lockMismatch:case i.e.malwareDetected:case i.e.overQuota:case i.e.overQuotaSharedFolder:case i.e.pathTooLong:case i.e.targetFolderMissing:case i.e.throttled:case i.e.unlockRequired:case i.e.versionMismatch:return!0;case i.e.accessDenied:case i.e.itemNotFound:case i.e.disconnected:case i.e.authFailure:case i.e.general:return!1;case i.e.none:case i.e.other:return}}},"1861":function(e,t,n){"use strict";var r,i=n(241);(function(e){e.getFilterData=function(e,t,r,s){var o=[];e=e.split("<br>")[0];var u=document.createElement("DIV");u.innerHTML=e;var a=u.querySelector("#diidFilter"+t);if(null!=a)for(var f=a.childNodes.length,l=a.childNodes,c=1;c<f;c++){var h=Object(i.getText)(l[c]),p=l[c].value.toString(),d={display:null!=s&&s?p:h,value:p};if(r){var v=n(p);if(v.filterType){d.value=v.value;d.calculatedFieldOriginFilterValue=p;d.calculatedFieldFilterType=v.filterType;o.push(d)}}else o.push(d)}for(var m={},g=0,y=o;g<y.length;g++){(E=y[g]).display in m?m[E.display]++:m[E.display]=1}for(var b=0,w=o;b<w.length;b++){var E;m[(E=w[b]).display]>1&&(E.display=E.value)}return o};var t=["Text","Text","Text","Text","Text","Number","Text","DateTime","Text","Text","Error","Boolean"];function n(e){var n=e.indexOf("_"),r=e,i=void 0;if(n>0){r=e.substring(n+1);var s=Number(e.substring(0,n));!isNaN(s)&&s<t.length&&(i=t[s])}return{value:r,filterType:i}}e.getCalculatedFieldFilterValueAndType=n})(r||(r={}));t.e=r},"1888":function(e,t,n){"use strict";var r=n(438),i=n(75),s=n(171),o=(function(){function e(e){this._itemUrlHelper=e.itemUrlHelper;this._sharingContextInformation=e.sharingContextInformation}e.prototype.getApiRoot=function(e,t,n){if(this._sharingContextInformation){var i=this._sharingContextInformation,s=i.isFolder,o=i.isListSharing,u=i.itemUrl,a=i.listId,f=i.listItemId,l=i.listUrl,c=i.resourceId,h=i.serverRelativeItemUrl,p=i.uniqueId,d=i.webAbsoluteUrl;if(!this.isListSharingKillswitchActive()&&o)return e.build().webByUrl({webUrl:d}).method("Lists",a);if(p){if(a)return e.build().webByUrl({webUrl:d}).segment("lists").method("getbyid",a).method("GetItemByUniqueId",p);var v=s?"GetFolderById":"GetFileById",m={guid:p};return e.build().webByUrl({webUrl:d}).method(v,m).segment("ListItemAllFields")}return l?e.build().webByUrl({listUrl:l}).method("GetListItem",h):u?e.build().webByUrl({webUrl:d}).method("GetFileByUrl",this._encodingFixEnabled()?u:r.t(u)).segment("ListItemAllFields"):a&&f?e.build().webByUrl({webUrl:d}).method("Lists",a).method("GetItemById",f):e.build().webByUrl({webUrl:d}).method("GetListItemByResourceId",c)}var g;g=t.properties.path?this._itemUrlHelper.getUrlParts({path:t.properties.path}):this._itemUrlHelper.getItemUrlParts(t.key);var y=e.build().webByItemUrl(g).method("Lists",n);this.isListSharingKillswitchActive()?y=t.properties.ID?y.method("GetItemById",t.properties.ID):y.method("GetItemByUniqueId",t.properties.uniqueId):t.isRootFolder||(y=t.properties.ID?y.method("GetItemById",t.properties.ID):y.method("GetItemByUniqueId",t.properties.uniqueId));return y};e.prototype.getFileUrl=function(e){return this._itemUrlHelper.getItemUrlParts(e.key).fullItemUrl};e.prototype.canUseSecurable=function(e){var t=e.properties;return!!t&&(this.isListSharingKillswitchActive()?!!t.ID||!!t.uniqueId:e.isRootFolder?!!e.list&&!!e.list.id:!!t.ID||!!t.uniqueId)};e.getUniqueSharingPrincipals=function(e){if(e){var t=new Set;return e.filter(function(e){if(t.has(e.loginName))return!1;t.add(e.loginName);return!0})}};e.prototype.isListSharingKillswitchActive=function(){return i.e.isActivated("0d6f4387-b53c-48b9-aab6-66369291541d","03/27/2020","List sharing changes in odsp-datasources")};e.prototype._encodingFixEnabled=function(){return s.e.isFeatureEnabled({ODB:1331})};return e})();t.e=o},"1928":function(e,t,n){"use strict";n.d(t,"t",function(){return s});var r;(function(e){e[e.unknown=1]="unknown";e[e.odb=2]="odb";e[e.sharePoint=3]="sharePoint";e[e.ngsc=4]="ngsc";e[e.word=5]="word";e[e.powerpoint=6]="powerpoint";e[e.excel=7]="excel";e[e.onenoteWeb=8]="onenoteWeb";e[e.wac=9]="wac";e[e.visio=10]="visio";e[e.officecom=11]="officecom";e[e.listPart=12]="listPart";e[e.outlookWeb=13]="outlookWeb";e[e.odIos=14]="odIos";e[e.odAndroid=15]="odAndroid";e[e.teams=16]="teams";e[e.sample=17]="sample";e[e.odc=18]="odc";e[e.wordAndroid=19]="wordAndroid";e[e.excelAndroid=20]="excelAndroid";e[e.powerpointAndroid=21]="powerpointAndroid";e[e.wordIos=22]="wordIos";e[e.excelIos=23]="excelIos";e[e.powerpointIos=24]="powerpointIos";e[e.onenote=25]="onenote";e[e.teamsIos=26]="teamsIos";e[e.teamsAndroid=27]="teamsAndroid";e[e.onenoteIos=28]="onenoteIos";e[e.visioIos=29]="visioIos";e[e.onenoteAndroid=30]="onenoteAndroid";e[e.visioAndroid=31]="visioAndroid";e[e.outlookWindows=32]="outlookWindows";e[e.outlookMac=33]="outlookMac";e[e.onenoteUWP=34]="onenoteUWP";e[e.officemobileIos=35]="officemobileIos";e[e.officemobileAndroid=36]="officemobileAndroid";e[e.odcWac=37]="odcWac";e[e.outlookGroupsWeb=38]="outlookGroupsWeb";e[e.fluid=39]="fluid";e[e.modernFileExplorer=40]="modernFileExplorer";e[e.listsHome=41]="listsHome";e[e.listsIos=42]="listsIos";e[e.edgeEnterpriseNtp=43]="edgeEnterpriseNtp";e[e.officeFeed=44]="officeFeed";e[e.searchUx=45]="searchUx"})(r||(r={}));var i=void 0;function s(e){if(void 0===i){i={};for(var t in r){var n=parseInt(t);if(!isNaN(n)){var s=r[n].toLowerCase();i[s]=n}}}var o=e?e.toLowerCase():"";return i[o]||r.unknown}t.e=r},"1963":function(e,t,n){"use strict";n.d(t,"r",function(){return o});n.d(t,"t",function(){return u});n.d(t,"n",function(){return a});n.d(t,"e",function(){return f});var r=n(141),i=n(75),s={ODB:751};function o(){return r.n.isFeatureEnabled(s)}function u(e){if(i.e.isActivated("BE4B8FC5-0DC1-4A4B-A35F-7C7C1E3573BF","7/25/2019","Use Flow hostname from farmSettings"))return o()?"https://tip1.flow.microsoft.com":"https://flow.microsoft.com";if(o())return"https://tip1.flow.microsoft.com";var t=e&&e.farmSettings&&e.farmSettings.ExternalService_flowhostname;return t?"https://"+t:"https://flow.microsoft.com"}function a(e,t){return u(t)+"/manage/environments/"+e.environmentId+"/flows/shared/"+e.id+"/details"}function f(e,t){return u(t)+"/manage/environments/"+e+"/approvals/received"}},"1979":function(e,t,n){"use strict";n.d(t,"n",function(){return o});n.d(t,"t",function(){return a});n.d(t,"e",function(){return c});var r=n(27),i=n(359),s=n(80);function o(e){var t="string"==typeof e?Object(i.t)(e):e;return{filters:l(t.where),sorts:u(t.orderBy),groupBy:a(t.groupBy),fieldNames:Object(i.s)(t.viewFields),rowLimit:f(t.rowLimit),associatedContentTypeId:Object(i.i)(t.associatedContentTypeId)}}function u(e){if(e){var t=Array.prototype.slice.call(e.childNodes).map(function(e){return h(e)}).filter(function(e){return!!e});return t.length?t:void 0}}function a(e){if(e){var t=Array.prototype.slice.call(e.childNodes).map(function(e){return h(e)}).filter(function(e){return!!e});if(t.length){var n={isCollapsed:p(e,r.e.collapse,!0),group1:t[0]};t[1]&&(n.group2=t[1]);return n}}}function f(e){if(e&&e.textContent)return{rowLimit:Number(e.textContent),isPerPage:p(e,r.e.paged,!1)}}function l(e){if(e&&e.childElementCount){var t=c(e.firstElementChild);return t&&t.length?t:void 0}}function c(e){if(e){var t;switch(e.tagName){case r.n.and:t=(function(e){if(!e||!e.childElementCount)return;var t=e.firstElementChild,n=c(t);if(!t.nextElementSibling)return n;var r=c(t.nextElementSibling);if(!n&&!r)return;return(n||[]).concat(r||[])})(e);break;case r.n.or:t=(function(e){var t=(function e(t){if(!t.childElementCount)return;var n;switch(t&&t.tagName){case r.n.or:var i=t.firstElementChild,s=e(i);if(s&&i.nextElementSibling){var o=e(i.nextElementSibling);n=o?s.concat(o):void 0}else n=s;break;case r.n.eq:n=d(t);break;case r.n.isNull:n=v(t)}if(n)return Array.isArray(n)?n:[n];return})(e);if(t&&t.length&&!t.some(function(e){return!e})){if(t.every(function(e){return e.fieldName===t[0].fieldName&&e.lookupId===t[0].lookupId})){var n=!1,i=t.reduce(function(e,t){if(!n)if(e.type&&t.type&&e.type!==t.type){n=!0;e.type=void 0}else e.type=e.type||t.type;e.values.push(t.values[0]);return e});i.operator=r.n.eq;i.id=e&&s.t(e,r.e.id);return i}}return null})(e);break;case r.n.isNull:case r.n.isNotNull:case r.n.membership:t=v(e);break;case r.n.beginsWith:case r.n.contains:case r.n.eq:case r.n.greaterEq:case r.n.greater:case r.n.includes:case r.n.lessEq:case r.n.less:case r.n.notEq:case r.n.notIncludes:t=d(e);break;case r.n.inTag:t=(function(e){var t=m(e),n=Array.prototype.filter.call(e.childNodes,function(e){return e.tagName===r.n.values})[0];if(!t||!n)return;var i=!1,s=Array.prototype.map.call(n.childNodes,function(e){var n=g(e);if(n&&n.type&&!i){var r=n.type,s=t.type;i=!(!s||!r||s===r);t.type=s||r}return n&&n.value});if((s=s.filter(function(e){return!!e})).length){t.values=s;i&&(t.type=void 0)}return s.length?t:void 0})(e)}return t?Array.isArray(t)?t.length?t:void 0:[t]:void 0}}function h(e){if(e&&e.tagName===r.n.fieldRef){var t=s.t(e,r.e.name);if(t)return{fieldName:t,isAscending:p(e,r.e.ascending,!0)}}}function p(e,t,n){switch((s.t(e,t)||"").toLowerCase()){case"true":return!0;case"false":return!1;default:return n}}function d(e){var t=m(e),n=Array.prototype.filter.call(e.childNodes,function(e){return e.tagName===r.n.value})[0];if(t&&n){var i=g(n);if(i){t.type=i.type;t.values=[i.value];return t}}}function v(e){var t=m(e);if(t)if(e.tagName===r.n.isNull)t.values=[""];else if(e.tagName===r.n.membership){var n=s.t(e,r.e.type);n?t.values=[n]:t=void 0}return t}function m(e){var t=Array.prototype.filter.call(e.childNodes,function(e){return e.tagName===r.n.fieldRef})[0],n=t&&s.t(t,r.e.name),i=e&&s.t(e,r.e.id);if(n)return{fieldName:n,id:i,type:void 0,lookupId:p(t,r.e.lookupId),operator:e.tagName,values:void 0}}function g(e){var t=e&&e.childElementCount&&e.firstElementChild.tagName!==r.n.today&&e.firstElementChild.tagName!==r.n.me;if(e&&e.tagName===r.n.value&&!t){var n,i={value:e.textContent,type:s.t(e,r.e.type)};if(e.childElementCount)if(e.firstElementChild.tagName===r.n.today){var o=e.firstElementChild,u=s.t(o,r.e.offset)||s.t(o,r.e.offsetDays),a=parseInt(u,10)||0;i.value=s.s(a);i.type=i.type||"DateTime"}else if(e.firstElementChild.tagName===r.n.me){i.value=s.r();i.type=i.type||"Integer"}i.value&&"DateTime"===i.type&&!0!==p(e,r.e.includeTimeValue)&&(n=i.value.match(r.t.datetimeNoTimeRegex))&&(i.value=n[1]);return i}}},"2013":function(e,t,n){"use strict";n.r(t);n.d(t,"getFilter",function(){return a});n.d(t,"updateFilter",function(){return f});n.d(t,"removeFilter",function(){return l});n.d(t,"getAllSmartFilters",function(){return c});n.d(t,"removeSmartFilters",function(){return h});n.d(t,"getEffectiveFilterParams",function(){return p});var r=n(176),i=n(1979),s=n(563),o=n(80),u=n(241);function a(e,t){var n=d(e,t);if(n){var r=i.e(n);if(r&&1===r.length&&r[0]){var s=r[0];s.id=t;return s}}}function f(e,t){if(!t.id)throw new Error("Must provide a filter with an id to use updateFilter");var n=s.e(t);if(!n)throw new Error("Filter could not be serialized");var i=d(e,t.id);if(i){var u=void 0;try{u=o.c(n).documentElement}catch(e){throw new Error("Generated filter was not valid XML!")}i.parentNode.replaceChild(u,i);e.setIsDirty(!0,r.e.filters)}else e.addFilters([n])}function l(e,t){var n=d(e,t);if(n){var i=n.parentNode;if("Where"===i.tagName)e.clearFilters();else{i.removeChild(n);"Or"!==i.tagName&&"And"!==i.tagName||i.parentNode.replaceChild(i.firstElementChild,i);e.setIsDirty(!0,r.e.filters)}}}function c(e){var t=e.getDomParts();if(t&&t.where){var n=t.where.querySelectorAll("[id]"),r=[];if(n)for(var s=0;s<n.length;s++){var o=i.e(n[s]);o&&r.push.apply(r,o)}return r}}function h(e){var t=c(e);if(t)for(var n=0,r=t;n<r.length;n++){l(e,r[n].id)}}function p(e,t){var n=e,r=c(t);r&&r.length>0&&r.forEach(function(e){n=Object(u.updateFilterInfoInQueryString)(n,{filterField:e.fieldName,filterValues:e.values,filterType:e.type,useLookupId:e.lookupId})});return n}function d(e,t){var n=e.getDomParts();if(n&&n.where){var r=n.where.querySelectorAll('[id="'+t+'"]');if(r.length>1)throw new Error("More than one filter found with id "+t);return r[0]}}},"2019":function(e,t,n){"use strict";n.d(t,"e",function(){return l});var r,i=n(0),s=n(435),o=n(1562),u=n(94),a=n(65);(function(e){e[e.lightBlue=0]="lightBlue";e[e.blue=1]="blue";e[e.darkBlue=2]="darkBlue";e[e.teal=3]="teal";e[e.lightGreen=4]="lightGreen";e[e.green=5]="green";e[e.darkGreen=6]="darkGreen";e[e.lightPink=7]="lightPink";e[e.pink=8]="pink";e[e.magenta=9]="magenta";e[e.purple=10]="purple";e[e.black=11]="black";e[e.orange=12]="orange";e[e.red=13]="red";e[e.darkRed=14]="darkRed"})(r||(r={}));var f=["#0078d7","#088272","#107c10","#881798","#b4009e","#e81123","#da3b01","#006f94","#005e50","#004e8c","#a80000","#4e257f"],l=(function(e){Object(i.__extends)(t,e);function t(t){return e.call(this,{dataSourceName:"SiteHeaderLogoAcronym",id:"acronymAndColors"},{pageContext:t})||this}t.decodeAcronymColor=function(e){return f.indexOf(e)+1};t.prototype.getAcronymData=function(e){return this.getAcronyms([e]).then(function(e){return e[0]},function(){return{acronym:void 0,color:void 0,text:void 0}})};t.prototype.getAcronyms=function(e,t){var n=this;void 0===t&&(t={});if(this._pageContext.webServerRelativeUrl){var r=t.qosName,i=void 0===r?"GetSiteHeaderLogoAcronym":r;return this.getDataUtilizingPersistentCache({getUrl:function(){var t=e.map(function(e){return"{Text: "+a.e.encodeURIComponent('"'+e+'"')+"}"}).join(",");return Object(s.n)(n._pageContext)+"/_api/sphome/GetAcronymsAndColors?labels=["+t+"]"},parseResponse:function(e){return JSON.parse(e).d.GetAcronymsAndColors.results.map(function(e){return{acronym:e.Acronym,color:e.Color,text:e.Text}})},method:"GET",qosName:i})}return u.n.reject(new Error("No web URL specified for request."))};return t})(o.e);t.t=l},"2115":function(e,t,n){"use strict";var r;(function(e){e[e.specificPeople=0]="specificPeople";e[e.organization=1]="organization";e[e.anyone=2]="anyone";e[e.existing=3]="existing";e[e.specificPeopleFlex=4]="specificPeopleFlex";e[e.customLabeledSpecificPeople=5]="customLabeledSpecificPeople"})(r||(r={}));t.e=r},"2149":function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n(0),i=n(1562),s=n(435),o=n(94),u=n(73),a=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,{dataSourceName:"SiteDataSource",id:"SiteDataSource("+(t?t.siteId:"")+")"},{pageContext:t})||this;r.getOAuthToken=n;return r}t.prototype.getReadOnlyState=function(){var e=this,t=this.getFullSiteReadOnlyState();return-2===t?this.getDataUtilizingPersistentCache({getUrl:function(){return Object(s.n)(e._pageContext)+"/_api/Site/ReadOnly"},parseResponse:function(e){var t=JSON.parse(e);return t&&t.d&&t.d.ReadOnly},qosName:"SiteReadOnly",method:"GET",noRedirect:!0}):o.n.resolve(-1!==t)};t.prototype.getFullSiteReadOnlyState=function(){return void 0===this._pageContext.readOnlyState?-2:null===this._pageContext.readOnlyState?-1:this._pageContext.readOnlyState};t.prototype.getStatusBarInfo=function(){var e=this;return this.getDataUtilizingPersistentCache({getUrl:function(){return Object(s.n)(e._pageContext)+"/_api/Site?$select=StatusBarLink,StatusBarText"},parseResponse:function(e){var t=JSON.parse(e);if(!t||!t.d)return{StatusBarText:void 0,StatusBarLinkText:void 0,StatusBarLinkTarget:void 0};var n=t.d.StatusBarLink,r=void 0,i=void 0;if(n){var s=n.split("|");r=s[0];var o=1===s.length?s[0]:s[1];if(0===o.lastIndexOf("http",0)){var a=new u.t(o);i=encodeURI(a.toString())}}return{StatusBarText:t.d.StatusBarText,StatusBarLinkText:r,StatusBarLinkTarget:i}},qosName:"SiteStatusBar",method:"GET",noRedirect:!0})};t.prototype.setClassificationProperty=function(e){var t=Object(s.n)(this._pageContext)+"/_api/Site",n=JSON.stringify({__metadata:{type:"SP.Site"},Classification:e});return this.dataRequestor.getData({url:t,qosName:"SetClassificationProperty",additionalPostData:n,method:"PATCH"})};t.prototype.setClassificationPropertyAndId=function(e,t){var n=Object(s.n)(this._pageContext)+"/_api/Site",r=JSON.stringify({__metadata:{type:"SP.Site"},Classification:e,SensitivityLabelId:t});return this.dataRequestor.getData({url:n,qosName:"SetClassificationProperty",additionalPostData:r,method:"PATCH"})};t.prototype.getCanSyncHubSitePermissionsProperty=function(e){var t=this;return this.getDataUtilizingPersistentCache({getUrl:function(){return Object(s.n)(t._pageContext)+"/_api/Site/CanSyncHubSitePermissions"},parseResponse:function(e){var t=JSON.parse(e);return t&&t.d&&t.d.CanSyncHubSitePermissions},qosName:"GetCanSyncHubSitePermissionsProperty",method:"GET",cachingStrategy:e?3:0,noRedirect:!0})};t.prototype.setCanSyncHubSitePermissionsProperty=function(e){var t=Object(s.n)(this._pageContext)+"/_api/Site",n=JSON.stringify({__metadata:{type:"SP.Site"},CanSyncHubSitePermissions:e});return this.dataRequestor.getData({url:t,qosName:"SetCanSyncHubSitePermissionsProperty",additionalPostData:n,method:"PATCH",noRedirect:!0})};t.prototype.isSiteFeatureEnabled=function(e,t){var n=this,r=t||Object(s.n)(this._pageContext),i=r+"/_api/site/Features/GetById('"+e.toString()+"')";return this.getOAuthToken(r).then(function(e){return n.dataRequestor.getData({url:i,qosName:"GetSPSiteFeatureEnabled",method:"GET",authToken:null!=e?e:void 0,parseResponse:function(e){try{var t=JSON.parse(e);if(t&&t.d&&t.d.DefinitionId)return!0}catch(e){return!1}return!1}})})};return t})(i.t);t.t=a},"2192":function(e,t,n){"use strict";var r;(function(e){e[e.share=1]="share";e[e.copy=2]="copy";e[e.atMention=3]="atMention";e[e.linkSettings=4]="linkSettings";e[e.manageAccess=5]="manageAccess";e[e.notify=6]="notify";e[e.addPeople=7]="addPeople"})(r||(r={}));t.e=r},"2219":function(e,t,n){"use strict";var r,i,s,o=n(94),u=n(212),a=n(486),f=n(173),l=n(171),c=n(134),h=n(48),p=n(101),d=n(1526),v=n(1963),m={ODB:1565};(function(e){e.ApprovalCenter="approvalCenter";e.Flows="flows";e.FlowCreation="flowCreation";e.FlowsRuntime="flowsRuntime";e.Templates="templates"})(r||(r={}));(function(e){e.CreateFlowFromTemplate="createFlowFromTemplate";e.TriggerFlow="triggerFlow";e.TriggerFlowByTemplate="triggerFlowByTemplate"})(i||(i={}));(function(e){e.GetAccessToken="GET_ACCESS_TOKEN";e.WidgetClose="WIDGET_CLOSE";e.WidgetReady="WIDGET_READY";e.WidgetRendered="WIDGET_RENDERED";e.RunFlowCompleted="RUN_FLOW_COMPLETED";e.RunFlowCancelButtonClicked="RUN_FLOW_CANCEL_BUTTON_CLICKED";e.RunFlowDoneButtonClicked="RUN_FLOW_DONE_BUTTON_CLICKED";e.RunFlowStarted="RUN_FLOW_STARTED";e.FlowCreationFailed="FLOW_CREATION_FAILED";e.FlowCreationSucceeded="FLOW_CREATION_SUCCEEDED";e.Error="ERROR";e.ApprovalStatusChanged="RECEIVED_APPROVAL_STATUS_CHANGED";e.GetStrings="GET_STRINGS"})(s||(s={}));var g=n(1581),y=n(75),b="FlowWidgetProvider.",w=(function(){function e(e,t){void 0===e&&(e={});this._params=e;this._oAuthTokenProvider=t.oAuthTokenProvider||new d.e({},{oAuthTokenDataSource:new g.e(t.pageContext)});this._async=new u.e;this._widget=null;this._widgetErrorTimeout=null;this._pageContext=t.pageContext}e.prototype.dispose=function(){this._widgetReadyQos&&this._widgetReadyQos.end({resultType:h.e.ExpectedFailure,extraData:{message:"Widget disposed"}});this._renderWidgetQos&&this._renderWidgetQos.end({resultType:h.e.ExpectedFailure,extraData:{message:"Widget disposed"}});this._notifyWidgetQos&&this._notifyWidgetQos.end({resultType:h.e.ExpectedFailure,extraData:{message:"Widget disposed"}});if(this._widgetErrorTimeout){this._async.clearTimeout(this._widgetErrorTimeout);this._widgetErrorTimeout=null}if(this._widget){this._widget.dispose();this._widget=null}};e.prototype.launchFlowWidget=function(t,n){var r=this;f.e.logData({name:b+"PanelOpened",extraData:{flowId:n.flow.id}});e._loadSdk(this._pageContext).then(function(e){t.id||(t.id="od-Flow-iframeContainer-"+c.e.generate());var i={container:t.id,campaign:n.campaign,environmentId:n.flow.environmentId,enableOnBehalfOfTokens:!0,enableRegionalPortal:!0,widgetStyleSettings:n.widgetStyleSettings,approvalCenterSettings:n.approvalCenterSettings,templatesSettings:{useServerSideProvisioning:!0,defaultParams:n.widgetDefaultParams,allowCustomFlowName:n.allowCustomFlowName},enableWidgetV2:!0};r._widgetReadyQos=new p.e({name:b+"WidgetReady"});r._renderWidgetQos=new p.e({name:b+"RenderWidget"});r._widgetErrorTimeout=r._setErrorTimeout("WIDGET_READY");try{var s=e.renderWidget(n.widgetType,i);r._registerListeners(s);r._widget=s;r._currentFlowParams=n}catch(e){r._onWidgetError(e)}})};e.preloadSdk=function(t,n){f.e.logData({name:b+"PreloadSdk"});return e._loadSdk(n,t).then(function(){return o.n.resolve()})};e.prototype._registerListeners=function(e){var t=this;e.listen("GET_ACCESS_TOKEN",function(e,n){t._onGetAccessToken(e,n)});e.listen("WIDGET_READY",function(){t._onWidgetReady(e)});e.listen("WIDGET_RENDERED",function(){t._onWidgetRendered()});e.listen("RUN_FLOW_STARTED",function(){t._onTriggerFlowStarted()});e.listen("RUN_FLOW_COMPLETED",function(e){t._onTriggerFlowSucceeded(e)});e.listen("RUN_FLOW_DONE_BUTTON_CLICKED",function(){t._onTriggerFlowDoneClicked()});e.listen("RUN_FLOW_CANCEL_BUTTON_CLICKED",function(){t._onTriggerFlowCancelClicked()});e.listen("WIDGET_CLOSE",function(){t._onWidgetClose()});e.listen("FLOW_CREATION_SUCCEEDED",function(e){t._onFlowCreationSucceeded(e)});e.listen("FLOW_CREATION_FAILED",function(){t._onFlowCreationFailed()});e.listen("RECEIVED_APPROVAL_STATUS_CHANGED",function(e){t._onApprovalStatusChanged(e)});e.listen("GET_STRINGS",function(e,n){t._onGetStrings(e,n)})};e.prototype._notifyWidget=function(e,t){var n=this;this._notifyWidgetQos=new p.e({name:b+"NotifyWidget"});e.notify(t.actionName,t.actionData).then(function(){n._notifyWidgetQos.end({resultType:h.e.Success,extraData:{flowId:t.flow.id}})}).catch(function(e){var r=h.e.Failure,i=null;if(e){var s=e.code;"runFlowWidgetCancelled"!==s&&"flowWidgetClosed"!==s||(r=h.e.Success);i=s}else i="Error unknown: no error returned in the notifyWidget promise catch clause.";n._notifyWidgetQos.end({resultType:r,extraData:{flowId:t.flow.id,message:i}})})};e.prototype._onGetAccessToken=function(e,t){this._getToken().then(function(e){t(null,{token:e})})};e.prototype._onWidgetReady=function(e){this._widgetReadyQos.end({resultType:h.e.Success});this._async.clearTimeout(this._widgetErrorTimeout);this._widgetErrorTimeout=this._setErrorTimeout("WIDGET_RENDERED");this._notifyWidget(e,this._currentFlowParams)};e.prototype._onWidgetRendered=function(){this._async.clearTimeout(this._widgetErrorTimeout);this._widgetErrorTimeout=null;this._renderWidgetQos.end({resultType:h.e.Success});this._params.onWidgetRendered&&this._params.onWidgetRendered()};e.prototype._onTriggerFlowStarted=function(){f.e.logData({name:b+"RunFlowClicked",extraData:{flowId:this._currentFlowParams.flow.id}});this._params.onTriggerFlowStarted&&this._params.onTriggerFlowStarted(this._currentFlowParams)};e.prototype._onTriggerFlowSucceeded=function(e){l.e.isFeatureEnabled(m)&&f.e.logData({name:"ManualFlowTriggered",isIntentional:!0});if(this._params.onTriggerFlowSucceeded){var t=e.data;this._params.onTriggerFlowSucceeded(this._currentFlowParams,t)}};e.prototype._onTriggerFlowDoneClicked=function(){this._params.onTriggerFlowDoneClicked&&this._params.onTriggerFlowDoneClicked(this._currentFlowParams)};e.prototype._onTriggerFlowCancelClicked=function(){this._params.onTriggerFlowCancelClicked&&this._params.onTriggerFlowCancelClicked(this._currentFlowParams)};e.prototype._onWidgetClose=function(){this._params.onWidgetClose&&this._params.onWidgetClose(this._currentFlowParams)};e.prototype._onFlowCreationSucceeded=function(e){if(this._params.onFlowCreationSucceeded){var t=e.data;this._params.onFlowCreationSucceeded(this._currentFlowParams,t)}};e.prototype._onFlowCreationFailed=function(){this._params.onFlowCreationFailed&&this._params.onFlowCreationFailed(this._currentFlowParams)};e.prototype._onApprovalStatusChanged=function(e){this._params.onApprovalStatusChanged&&this._params.onApprovalStatusChanged(e)};e.prototype._onGetStrings=function(e,t){this._currentFlowParams.additionalEvents&&this._currentFlowParams.additionalEvents.indexOf("GET_STRINGS")>-1&&this._params.onGetStrings?this._params.onGetStrings(t):t(null,{})};e.prototype._onTokenError=function(e){this._params.onTokenError&&this._params.onTokenError(e)};e.prototype._onWidgetError=function(e){this._renderWidgetQos&&this._renderWidgetQos.end({resultType:h.e.Failure,extraData:{message:e.message}})};e.prototype._setErrorTimeout=function(e){var t=this;return this._async.setTimeout(function(){t._onWidgetError(new Error("Timeout: Widget timed out waiting for: "+e))},15e3)};e._loadSdk=function(t,r){if(e._loadSdkPromise)return e._loadSdkPromise;e._loadSdkPromise=new o.n(function(e){0;n.e("47").then(n.t.bind(null,3557,7)).then(function(n){var i=new MsFlowSdk({hostName:Object(v.t)(t),locale:a.e.language,hostId:r});e(i)})});return e._loadSdkPromise};e.prototype._getToken=function(){var e=this;return new o.n(function(t){var n=new p.e({name:b+"GetToken"}),r="https://service.flow.microsoft.com/";if(!y.e.isActivated("EE645DA8-7C00-446D-9E39-7A11F52BF789","7/25/2019","Use Flow hostname from farmSettings")){var i=e._pageContext&&e._pageContext.farmSettings&&e._pageContext.farmSettings.ExternalService_flowservicehostname;i&&(r="https://"+i+"/")}e._oAuthTokenProvider.getToken(r).then(function(e){t(e);n.end({resultType:h.e.Success})},function(r){e._onTokenError(r);n.end({resultType:h.e.Failure,extraData:{serverErrorCode:r._serverErrorCode,message:r.message}});t(null)})})};return e})();t.e=w},"2239":function(e,t,n){"use strict";n.d(t,"e",function(){return w});n.d(t,"r",function(){return E});n.d(t,"t",function(){return S});n.d(t,"n",function(){return N});n.d(t,"i",function(){return C});var r=n(0),i=n(2042),s=n(180),o=n(1332),u=n(1481),a=n(2240),f=n(1928),l=n(2115),c=n(2192),h=n(435),p=n(1480),d=n(1888),v=n(147),m=n(905),g=n(171),y=n(75),b=n(958),w="role:1073741827",E="role:1073741826",S="role:1073741829",x={ODB:1657},T=!y.e.isActivated("f8f5a253-cc95-4903-8f09-41053f644db1","10/13/2020","Deactivate Trackable Anyone Link, disable anyoneLinkAbility"),N=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===n&&(n={pageContext:t.pageContext});var r=e.call(this,{dataSourceName:"SharingDataSource"},n)||this;r._getParentListId=t.getParentListId;r._itemUrlHelper=t.itemUrlHelper||new s.e({},{pageContext:t.pageContext});r._apiUrlHelper=t.apiUrlHelper||new o.e({},{pageContext:t.pageContext,itemUrlHelper:r._itemUrlHelper});r._sharingContextInformation=t.sharingContextInformation||void 0;r._sharingDataSourceHelper=new d.e({itemUrlHelper:r._itemUrlHelper,sharingContextInformation:r._sharingContextInformation,isItemUrlEncoded:t.isItemUrlEncoded});var i=Object(h.n)(r._pageContext);r._shareUrl=i+"/_api/SP.Web.ShareObject";return r}t.parsePeople=function(e){return e.map(function(e){var n={role:t.parseSharingRole(e.CurrentRole),statusCode:Number(!e.Status),errorMessage:e.Message||null};return{name:e.DisplayName,email:e.Email,userId:e.UserId,sharingInfo:n}})};t.parseSharingRole=function(e){switch(e){case 0:return 5;case 1:return 1;case 2:return 2;case 6:return 6;default:return 1}};t.prototype.getSharingInformation=function(e,t,n,r,i,s){var o,u=this,a=(r=r||this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e,this._getParentListId(e))).segment("GetSharingInformation"),f="pickerSettings";t&&(f+=",permissionsInformation");n&&(f+=",sharingLinkTemplates");i&&(f+=",addressBarLinkSettings");o=a.oDataParameter("$Expand",f).toString();return this.getData(function(){return o},function(t){var n=JSON.parse(t);return u._parseGetSharingInformationResponse(n,e)},"GetSharingInformation",null,"POST",null,null,null,!0,void 0,void 0,this._getExtraData(),s)};t.prototype.emailWithoutPermissioning=function(e,n,r,i){var s=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,n,this._getParentListId(n)).segment("ForwardObjectLink").toString();return this.getData(function(){return s},function(e){var r=JSON.parse(e).d,i=[];r.UniquelyPermissionedUsers&&r.UniquelyPermissionedUsers.results&&(i=r.UniquelyPermissionedUsers.results);var s=[];r.InvitedUsers&&r.InvitedUsers.results&&(s=r.InvitedUsers.results);var o={};o.statusCode=r.StatusCode;o.errorMessage=r.ErrorMessage;o.people=t.parsePeople(i);o.invitedUsers=t.parsePeople(s);o.itemId=n&&n.id;s.length>0&&(o.invitationLink=s[0].InvitationLink);o.invalidEmails=[];if(r.UsersWithInvalidEmails&&r.UsersWithInvalidEmails.results)for(var u=0,a=r.UsersWithInvalidEmails.results;u<a.length;u++){var f=a[u];o.invalidEmails.push(f.User)}return o},"ForwardObjectLink",function(){for(var t=[],n=0,s=e;n<s.length;n++){var o=s[n];t.push(o.rawPersonData)}var u={peoplePickerInput:JSON.stringify(t),emailBody:r,emailSubject:i};return JSON.stringify(u)})};t.prototype.checkPermissions=function(e,t){var n=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("CheckPermissions").toString();return this.getData(function(){return n},function(e){var t=JSON.parse(e);if(t.d){return t.d.CheckPermissions.results}return null},"CheckPermissions",function(){var t={recipients:e};return JSON.stringify(t)})};t.prototype.share=function(e,n){var r,i=this,s=!!this._sharingContextInformation||this._sharingDataSourceHelper.canUseSecurable(n.items[0]);if(9===n.linkType||6===n.linkType||5===n.linkType)return this._shareLink(e,n);if(s){var o=n.items[0],u=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,o,this._getParentListId(o));r=u.segment("ShareObject").toString()}else r=this._shareUrl;return this.getData(function(){return r},function(e){var r=JSON.parse(e).d,i=[];r.UniquelyPermissionedUsers&&r.UniquelyPermissionedUsers.results&&(i=r.UniquelyPermissionedUsers.results);var s=[];r.InvitedUsers&&r.InvitedUsers.results&&(s=r.InvitedUsers.results);var o={};o.statusCode=r.StatusCode;o.errorMessage=r.ErrorMessage;o.people=t.parsePeople(i);o.invitedUsers=t.parsePeople(s);o.itemId=n.items[0]&&n.items[0].id;s.length>0&&(o.invitationLink=s[0].InvitationLink);o.invalidEmails=[];if(r.UsersWithInvalidEmails&&r.UsersWithInvalidEmails.results)for(var u=0,a=r.UsersWithInvalidEmails.results;u<a.length;u++){var f=a[u];o.invalidEmails.push(f.User)}return o},"Share",function(){for(var t=[],r=0;r<e.length;r++){var o=e[r];t.push(o.rawPersonData)}n.roleValue===2..toString()?n.roleValue=w:n.roleValue===1..toString()&&(n.roleValue=E);var u={peoplePickerInput:JSON.stringify(t),roleValue:n.roleValue,sendEmail:n.sendEmail,emailBody:n.message,emailSubject:n.subject,includeAnonymousLinkInEmail:!n.requireSignIn,propagateAcl:n.propagateSharing,useSimplifiedRoles:!0};s||(u.url=i._sharingDataSourceHelper.getFileUrl(n.items[0]));return JSON.stringify(u)})};t.prototype.updatePermissions2=function(e,t,n){var r=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("UpdateDocumentSharingInfo").toString();return this.getData(function(){return r},function(e){var t=JSON.parse(e).d;return t?{role:t.UpdateDocumentSharingInfo.results[0].CurrentRole}:null},"UpdatePermissions2",function(){var t;switch(n){case a.e.none:case a.e.view:case a.e.review:case a.e.edit:case a.e.owner:t=n;break;default:t=a.e.view}var r={userRoleAssignments:[{UserId:e.loginName,Role:t}],validateExistingPermissions:!1,additiveMode:!1,sendServerManagedNotification:!1,customMessage:null,includeAnonymousLinksInNotification:!1,propagateAcl:!0};return JSON.stringify(r)})};t.prototype.updatePermissionsMultiple=function(e,t,n,r,i){var s=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("UpdateDocumentSharingInfo").toString();return this.getData(function(){return s},function(e){var t=JSON.parse(e).d;return t?{role:t.UpdateDocumentSharingInfo.results[0].CurrentRole,success:t.UpdateDocumentSharingInfo.results.map(function(e){return e.Status}).reduce(function(e,t){return e&&t},!0)}:null},"UpdatePermissionsMultiple",function(){var t;switch(n){case a.e.none:t=0;break;case a.e.view:t=1;break;case a.e.review:t=6;break;case a.e.edit:t=2;break;default:t=1}var s={userRoleAssignments:e.map(function(e){return{UserId:e.userId,Role:t}}),validateExistingPermissions:!1,additiveMode:!1,sendServerManagedNotification:r,customMessage:i,includeAnonymousLinksInNotification:!1,propagateAcl:!0};return JSON.stringify(s)})};t.prototype.parseRawSharingInformation=function(e){return this._parseGetSharingInformationResponse(e,void 0)};t.prototype.unshareLink=function(e){var t=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e.item,this._getParentListId(e.item)).segment("UnshareLink").toString();return this.getData(function(){return t},function(e){return!!JSON.parse(e).d},"UnshareLink",function(){var t={linkKind:e.kind,shareId:e.shareId};return JSON.stringify(t)})};t.prototype.shareLink=function(e){var t=e.settings,n=e.items[0],r=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e.items[0],this._getParentListId(n)).segment("ShareLink").toString();return this.getData(function(){return r},function(e){var t=JSON.parse(e);return t.d?C(t):t.error?{error:5,errorMessage:t.error.message}:void 0},"ShareLink",function(){var n=null;t.expiration&&(n=Object(i.e)(t.expiration.toString()));var r=null;if(e.recipients&&e.recipients.length>0){r=[];for(var s=0,o=e.recipients;s<o.length;s++){var u=o[s];u.rawPersonData&&r.push(u.rawPersonData)}}var a=null;if(t.inviteesToRemove&&t.inviteesToRemove.length>0){a=[];for(var f=0,l=t.inviteesToRemove;f<l.length;f++){var c=l[f];a.push({id:c.id,loginName:c.loginName,name:c.primaryText,isExternal:c.isExternal,principalType:c.type,email:c.email})}}var h={request:{createLink:!!t.createLink,settings:{allowAnonymousAccess:t.allowAnonymousAccess,trackLinkUsers:t.trackLinkUsers,linkKind:t.sharingLinkKind,expiration:n,role:t.role,restrictShareMembership:t.restrictShareMembership,updatePassword:t.updatePassword,password:t.password,shareId:t.shareId,description:t.description,scope:t.scope}}};a&&(h.request.settings.inviteesToRemove={results:a});if(r&&r.length>0){h.request.peoplePickerInput=JSON.stringify(r);var p=e.emailData,d=e.emailSubject;void 0!==p&&void 0===d&&(h.request.emailData={body:e.emailData,subject:""});void 0===p&&void 0!==d&&(h.request.emailData={body:"",subject:e.emailSubject});void 0!==p&&void 0!==d&&(h.request.emailData={body:e.emailData,subject:e.emailSubject})}var v=e.settings.shareId;if(v){h.request.settings.shareId=v;h.request.emailData={body:""}}return JSON.stringify(h)},"POST",null,null,null,!0,void 0,void 0,this._getExtraData()).catch(function(e){var t="";try{t=JSON.stringify(e)}catch(e){}return{error:5,debugErrorMessage:t}})};t.prototype.setAddressBarLinkCapability=function(e,t){var n=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e,this._getParentListId(e)).segment("SetAddressBarLinkCapability").toString();return this.getData(function(){return n},function(e){return!!JSON.parse(e).d},"SetAddressBarLinkCapability",function(){var e={enable:t};return JSON.stringify(e)})};t.prototype.shareLinkExpress=function(e,t,n){var r=this._apiUrlHelper.build().webByUrl({webUrl:this._pageContext.webAbsoluteUrl}).method("Lists",e).method("GetItemById",t).segment("ShareLinkExpress").toString();return this.getData(function(){return r},function(e){var t=JSON.parse(e);return t.d?k(t.d.ShareLinkExpress.sharingLinkInfo):t.error?{error:5,errorMessage:t.error.message}:void 0},"ShareLinkExpress",function(){var e={expressOption:n};return JSON.stringify(e)},"POST",null,null,null,!0,void 0,void 0,this._getExtraData()).catch(function(e){var t="";try{t=JSON.stringify(e)}catch(e){}return{error:5,debugErrorMessage:t}})};t.prototype.getClientId=function(){var e=Number(this._pageContext.webTemplate);if(Object(b.e)(this._pageContext))return f.e.sharePoint;switch(e){case v.t.teamSite:case v.t.group:case v.t.subgroup:case v.t.sitePagePublishing:return f.e.sharePoint;case v.t.mySite:return f.e.odb;default:return y.e.isActivated("49c1f4de-c1fb-47ed-8d4b-695083cb10ef","11/08/2019","Default clientId to SharePoint if unknown for other web templates")?f.e.unknown:f.e.sharePoint}};t.prototype._shareLink=function(e,t){var n=this,r=t.items[0],s=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,r,this._getParentListId(r)).segment("ShareLink").toString();return this.getData(function(){return s},function(n){return{statusCode:0,errorMessage:"",people:e,itemId:t.items[0].id}},"ShareLink",function(){for(var r=[],s=0,o=e;s<o.length;s++){var u=o[s];r.push(u.rawPersonData)}var a=null;t.expiration&&(a=Object(i.e)(t.expiration));var f={request:{peoplePickerInput:JSON.stringify(r),emailData:{body:t.message,subject:t.subject},linkKind:n._getSharingLinkKind(t.linkType,t.roleValue),createLink:!0,expiration:a}};return JSON.stringify(f)})};t.prototype._getSharingLinkKind=function(e,t){var n=1;6===e?n=5:5===e?n=4:9===e&&(n=t===2..toString()?3:2);return n};t.prototype._parseGetSharingInformationResponse=function(e,t){if(e.error)return{error:5,anonymousLinkExpirationRestrictionDays:void 0,anyoneLinkTrackUsers:void 0,canAddExternalPrincipal:void 0,canAddInternalPrincipal:void 0,canRequestAccessForGrantAccess:void 0,canManagePermissions:void 0,defaultSharingLink:void 0,defaultShareLinkToExistingAccess:void 0,hasInheritedLinks:void 0,isShared:void 0,item:void 0,fileExtension:void 0,sharedObjectType:void 0,sharingLinks:void 0,sharingPrincipals:void 0,peoplePickerSettings:void 0,userDisplayName:void 0,blockPeoplePickerAndSharing:void 0,userRole:void 0,defaultShareLinkPermission:void 0,sharingAbilities:void 0,defaultLinkKind:void 0,directLink:void 0,hasPermissionsInformation:void 0,sharingLinkTemplates:void 0,webTemplateId:void 0,itemUniqueId:void 0};var n=e.d,r=!!n.permissionsInformation,i=!!n.sharingLinkTemplates,s=g.e.isFeatureEnabled(x)&&r,o=!!n.addressBarLinkSettings,u=r?this._parseSharingLinks(n.permissionsInformation.links.results,n.directUrl):[],a=i?this._parseSharingLinkTemplates(n.sharingLinkTemplates.templates.results):[],f=o?n.addressBarLinkSettings:null,c=[];if(y.e.isActivated("4681ee55-dadc-4d9b-a53c-30012907318a","5/5/2020","Mark site admins amongst sharing principals")){var h=r?n.permissionsInformation.siteAdmins.results.concat(n.permissionsInformation.principals.results):[];c=this._parseSharingPrincipals(h)}else if(r){var d=n.permissionsInformation.siteAdmins.results,v=n.permissionsInformation.principals.results,m=this._parseSharingPrincipals(d);m.forEach(function(e){return e.isSiteAdmin=!0});var b=this._parseSharingPrincipals(v);c=m.concat(b)}var w=this._getDefaultSharingLink(n.defaultLinkKind,u,n.sharingAbilities),E={name:this._sharingContextInformation?this._sharingContextInformation.itemName:void 0,childCount:this._sharingContextInformation?this._sharingContextInformation.itemCount:void 0,hasDlpPolicy:this._sharingContextInformation?this._sharingContextInformation.hasDlpPolicy:void 0,extension:this._sharingContextInformation&&this._sharingContextInformation.itemExtension?this._sharingContextInformation.itemExtension:n.fileExtension,appmap:this._sharingContextInformation?this._sharingContextInformation.itemAppmap:void 0,itemType:this._sharingContextInformation?this._sharingContextInformation.itemType:void 0};if(t){var S=t.properties,T=S.ItemChildCount?parseInt(S.ItemChildCount,10):0,N=S.FolderChildCount?parseInt(S.FolderChildCount,10):0,C=t.type===p.t.OneNote?0:T+N,k=this._isPolicyTipFlagSet(t.policyTip,4);E={name:t.name,childCount:C,hasDlpPolicy:k,extension:t.extension,appmap:t.appMap,itemType:t.type}}var L=n.canRequestAccessForGrantAccess||n.canAddInternalPrincipal||u.length>1;return{anonymousLinkExpirationRestrictionDays:0===n.anonymousLinkExpirationRestrictionDays?-1:n.anonymousLinkExpirationRestrictionDays,anyoneLinkTrackUsers:n.anyoneLinkTrackUsers,canAddExternalPrincipal:n.canAddExternalPrincipal,canAddInternalPrincipal:n.canAddInternalPrincipal,defaultShareLinkToExistingAccess:n.defaultShareLinkToExistingAccess,canManagePermissions:L,defaultSharingLink:w,fileExtension:n.fileExtension,sharedObjectType:n.sharedObjectType,hasInheritedLinks:!!s&&n.permissionsInformation.hasInheritedLinks,isShared:this._computeIsShared(u,c),item:E,sharingLinks:u,sharingPrincipals:c,peoplePickerSettings:n.pickerSettings,userDisplayName:this._pageContext.userDisplayName,blockPeoplePickerAndSharing:n.blockPeoplePickerAndSharing,requiresAccessApproval:!n.canAddInternalPrincipal&&n.canRequestAccessForGrantAccess,canRequestAccessForGrantAccess:n.canRequestAccessForGrantAccess,userRole:n.currentRole,defaultShareLinkPermission:n.defaultShareLinkPermission,sharingAbilities:n.sharingAbilities,defaultLinkKind:n.defaultLinkKind,directLink:{allowsAnonymousAccess:!1,audience:l.e.existing,expiration:null,description:null,isActive:!0,isEdit:!0,principals:[],invitees:[],shareId:"",sharingLinkKind:1,url:n.directUrl,updatePassword:!1,password:"",passwordLastModifiedBy:null},hasPermissionsInformation:!!n.permissionsInformation,sharingLinkTemplates:a,addressBarLinkSettings:f,webTemplateId:n.webTemplateId,itemUniqueId:n.itemUniqueId,customizedExternalSharingServiceUrl:n.customizedExternalSharingServiceUrl||"",siteIBSegmentIDs:n.siteIBSegmentIDs?n.siteIBSegmentIDs.results:null,enforceIBSegmentFiltering:!!n.enforceIBSegmentFiltering,enforceSPOSearch:!!n.enforceSPOSearch}};t.prototype._computeIsShared=function(e,t){for(var n=!1,r=0,i=e;r<i.length;r++){var s=i[r];s.isActive&&1!==s.sharingLinkKind&&(n=!0)}n||(n=t.length>0);return n};t.prototype._parseSharingLinks=function(e,t){var n=this,r=(e=e.filter(function(e){return!e.isInherited})).map(function(e){var t,r=e.linkDetails;t=T&&void 0!==r.Scope&&-1!==r.Scope?A(r.LinkKind,r.Scope):L(r.LinkKind,r.AllowsAnonymousAccess,r.RestrictedShareMembership);return{allowsAnonymousAccess:r.AllowsAnonymousAccess,hasPassword:r.RequiresPassword,blockDownload:r.BlocksDownload,description:r.Description,audience:t,expiration:r.Expiration?new Date(r.Expiration):null,isActive:r.IsActive,isEdit:O(r.LinkKind)||r.IsEditLink,isReview:r.IsReviewLink,principals:n._parseSharingPrincipals(e.linkMembers.results,r.LinkKind),invitees:n._parseLinkInvitees(r),shareId:r.ShareId,sharingLinkKind:r.LinkKind,url:r.Url,updatePassword:r.UpdatePassword,password:r.Password,passwordLastModifiedBy:n._parseSharingPrincipal(r.PasswordLastModifiedBy),isCreateOnlyLink:r.IsCreateOnlyLink,isAddressBarLink:r.IsAddressBarLink,isUnhealthy:r.IsUnhealthy,status:r.SharingLinkStatus,created:r.Created,trackLinkUsers:r.TrackLinkUsers}});(r=r.sort(function(e,t){return n._getLinkRanking(t)-n._getLinkRanking(e)})).push({allowsAnonymousAccess:!1,audience:l.e.specificPeople,expiration:null,description:null,isActive:!0,isEdit:!0,principals:[],invitees:[],shareId:"",sharingLinkKind:1,url:t,updatePassword:!1,password:"",passwordLastModifiedBy:null});return r};t.prototype._getLinkRanking=function(e){var t=0;switch(e.audience){case l.e.anyone:t+=30;break;case l.e.organization:t+=20;break;case l.e.specificPeopleFlex:t+=10}e.isEdit?t+=3:e.isReview?t+=2:e.isEdit||e.isReview||e.blockDownload||(t+=1);return t};t.prototype._getSharingLinkTemplateRanking=function(e){var t=0;if(e&&e.linkDetails&&e.linkDetails.shareId){switch(e.scope){case 0:t+=30;break;case 1:t+=20;break;case 2:t+=10}switch(e.role){case a.e.edit:t+=3;break;case a.e.review:t+=2;break;case a.e.view:t+=1}}return t};t.prototype._parseSharingLinkTemplates=function(e){var t=this,n=e.map(function(e){var n,r=e.linkDetails;if(null!==r){var i=void 0;i=T&&void 0!==r.Scope&&-1!==r.Scope?A(r.LinkKind,r.Scope):L(r.LinkKind,r.AllowsAnonymousAccess,r.RestrictedShareMembership);n={allowsAnonymousAccess:r.AllowsAnonymousAccess,hasPassword:r.RequiresPassword,blockDownload:r.BlocksDownload,audience:i,expiration:r.Expiration?new Date(r.Expiration):null,description:r.Description,isActive:r.IsActive,isEdit:O(r.LinkKind)||r.IsEditLink,isReview:r.IsReviewLink,principals:void 0,invitees:t._parseLinkInvitees(r),shareId:r.ShareId,sharingLinkKind:r.LinkKind,url:r.Url,updatePassword:r.UpdatePassword,password:r.Password,passwordLastModifiedBy:t._parseSharingPrincipal(r.PasswordLastModifiedBy)}}return{linkDetails:n,passwordProtected:e.passwordProtected,role:e.role,scope:e.scope,shareKind:e.shareKind}});return n=n.sort(function(e,n){return t._getSharingLinkTemplateRanking(n)-t._getSharingLinkTemplateRanking(e)})};t.prototype._parseLinkInvitees=function(e){var t=e.Invitations;if(!t)return[];for(var n=[],r=0,i=t.results;r<i.length;r++){var s=i[r];s&&s.invitee&&n.push(s.invitee)}return n.map(function(e){return{id:e.id,email:e.email,primaryText:e.name,isExternal:e.isExternal,loginName:e.loginName,role:null,secondaryText:e.jobTitle,type:e.principalType,imageUrl:Object(m.getUserPhotoUrl)(t.email)}})};t.prototype._parseSharingPrincipals=function(e,t){var n=e.map(function(e){var n=e.principal;n||(n=e);var r={id:n.id,isExternal:n.isExternal,loginName:n.loginName,primaryText:n.name,role:e.role,secondaryText:n.jobTitle,type:n.principalType,imageUrl:Object(m.getUserPhotoUrl)(n.email),email:n.email};t&&(r.sharingLinkKind=t);return r});return d.e.getUniqueSharingPrincipals(n)};t.prototype._getExtraData=function(){var e;this._sharingContextInformation&&(e={clientId:this._sharingContextInformation.clientId,mode:c.e[this._sharingContextInformation.mode]});return e};t.prototype._parseSharingPrincipal=function(e){if(e){var t=e.principal;t||(t=e);return{id:t.id,isExternal:t.isExternal,loginName:t.loginName,primaryText:t.name,role:e.role,secondaryText:t.jobTitle,type:t.principalType,imageUrl:Object(m.getUserPhotoUrl)(t.email),email:t.email}}return null};t.prototype._getDefaultSharingLink=function(e,t,n){n.peopleSharingLinkAbilities&&(n.peopleSharingLinkAbilities.canManageEditLink.enabled||n.peopleSharingLinkAbilities.canManageReadLink.enabled)&&1===e&&(e=6);var r=e;if(T&&n.anyoneLinkAbilities){5!==r||n.anyoneLinkAbilities.canManageEditLink.enabled||(r=4);4!==r||n.anyoneLinkAbilities.canManageReadLink.enabled||(r=3)}else{5!==r||n.anonymousLinkAbilities.canManageEditLink.enabled||(r=4);4!==r||n.anonymousLinkAbilities.canManageReadLink.enabled||(r=3)}if(n.organizationLinkAbilities){3!==r||n.organizationLinkAbilities.canManageEditLink.enabled||(r=2);2!==r||n.organizationLinkAbilities.canManageReadLink.enabled||(r=1)}var i=void 0;5===e||4===e?i=l.e.anyone:3===e||2===e?i=l.e.organization:1===e?i=l.e.specificPeople:6===e&&(i=l.e.specificPeopleFlex);return{allowsAnonymousAccess:void 0,audience:i,expiration:void 0,description:void 0,isActive:!0,isEdit:void 0,principals:void 0,shareId:void 0,sharingLinkKind:r,url:void 0,invitees:void 0,updatePassword:!1,password:"",passwordLastModifiedBy:void 0}};t.prototype._isPolicyTipFlagSet=function(e,t){return e&&(e&t)===t};return t})(u.t);function C(e){if(e.d){return k(e.d.ShareLink.sharingLinkInfo)}}function k(e){var t;t=T&&void 0!==e.Scope&&-1!==e.Scope?A(e.LinkKind,e.Scope):L(e.LinkKind,e.AllowsAnonymousAccess,e.RestrictedShareMembership);var n=e.Expiration?new Date(e.Expiration):void 0;return{link:{allowsAnonymousAccess:e.AllowsAnonymousAccess,audience:t,expiration:n,description:e.Description,isActive:e.IsActive,isEdit:O(e.LinkKind)||e.IsEditLink,principals:null,invitees:null,hasPassword:e.RequiresPassword,shareId:e.ShareId,sharingLinkKind:e.LinkKind,url:e.Url,updatePassword:e.UpdatePassword,password:e.Password,passwordLastModifiedBy:e.PasswordLastModifiedBy,shareTokenString:e.ShareTokenString,isAddressBarLink:e.IsAddressBarLink,isUnhealthy:e.IsUnhealthy,status:e.SharingLinkStatus,created:e.Created}}}function L(e,t,n){return 5===e||4===e?l.e.anyone:3===e||2===e?l.e.organization:1===e?l.e.specificPeople:6===e?t?l.e.anyone:!1===n?l.e.organization:l.e.specificPeopleFlex:void 0}function A(e,t){return 5===e||4===e?l.e.anyone:3===e||2===e?l.e.organization:1===e?l.e.specificPeople:6===e?0==t?l.e.anyone:1===t?l.e.organization:l.e.specificPeopleFlex:void 0}function O(e){return 5===e||3===e||4!==e&&2!==e&&null}},"2240":function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.none=0]="none";e[e.view=1]="view";e[e.edit=2]="edit";e[e.owner=3]="owner";e[e.review=6]="review";e[e.restrictedview=7]="restrictedview";e[e.submit=8]="submit"})(r||(r={}))},"2330":function(e,t,n){"use strict";var r,i=n(0),s=n(134),o=n(212),u=n(326),a=n(94),f=n(75),l=n(653),c=n(101),h=n(48),p=n(200),d=n(1973),v=n(1611),m=n(69),g=n(1846),y=n(223),b=n(316),w=(function(e){Object(i.__extends)(t,e);function t(n){var r=e.call(this,n)||this;r.name="FileHasherError";r.__proto__=t.prototype;return r}return t})(Error),E="UNKNOWN_UPLOAD_ERROR",S="UPLOAD_TIMEOUT_ERROR",x="UPLOAD_TOO_SLOW_ERROR";(function(e){e[e.singleChunk=0]="singleChunk";e[e.start=1]="start";e[e.continue=2]="continue";e[e.finish=3]="finish";e[e.status=4]="status";e[e.cancel=5]="cancel"})(r||(r={}));var T=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,Object(i.__assign)(Object(i.__assign)({},t),{extraData:Object(i.__assign)(Object(i.__assign)({},t.extraData||{}),"number"==typeof t.statusCode?{status:t.statusCode}:{})}))||this;n.errorType=t.errorType;n.displayString=t.displayString;try{n.serverError=JSON.stringify(t.serverError)}catch(e){n.serverError=""}return n}return t})(m.e);function N(e){if(e&&e.code){return e.code.split(",")[0]||e.code}return e&&e.number?""+e.number:E}function C(e,t){if(!e)return new T({errorType:v.e.general,code:"Unknown",statusCode:0,message:"Unknown upload error",serverError:e});var n,i,s=!1,o=N(e);e instanceof y.e&&(e=e.errorData);if("string"==typeof e)n=e;else{var u=e.message;if("string"==typeof u)n=u;else if(u&&u.value){n=u.value;s=!0}}i=o===b.r?v.e.disconnected:"-2130575257"===o?v.e.conflict:"-2130245249"===o?v.e.similarNameExists:o===S?v.e.general:"-2147024891"===o?v.e.accessDenied:404!==e.status||t!==r.start&&t!==r.singleChunk?s?v.e.other:v.e.general:v.e.targetFolderMissing;return new T({errorType:i,code:o,statusCode:e.status,displayString:s?n:"",message:n||"Unhandled client error",correlationId:e.correlationId,serverError:e})}n.d(t,"e",function(){return O});var k="ServerRelativeUrl,UniqueId,Name,VroomItemID,VroomDriveID,ServerRedirectedUrl",L=!f.e.isActivated("B1726BAE-6860-4FE3-937B-2A8768F26044","01/08/2021","Include the full server response for errors without status codes"),A=!f.e.isActivated("54761027-a6a8-42c2-a8c3-a4821f4955c4","02/19/2021","Enable Rename on upload collision errors and large file uploads leverage StartUploadFile instead of StartUpload"),O=(function(){function e(e){var t=e.hasher,n=e.throttler,r=e.dataRequestor,i=e.appName,u=e.webApiUrl,a=e.authToken,f=e.canStream,l=e.fileUpload,h=e.itemExpansion,p=e.destinationUrl,d=e.qosEvent,v=void 0===d?c.e:d,m=e.nameConflictBehavior,g=void 0===m?0:m,y=e.onStart,b=e.onAbort,w=e.onProgress;this._hasher=t;this._dataRequestor=r;this._throttler=n;this._chunkNumber=0;this._uploadedBytes=0;this._qosEvent=v;this._id=s.e.generate();this._authToken=a;this._canStream=f;this._webApiUrl=u;this._fileUpload=l;this._async=new o.e(this);this._itemExpansion=h;this._destinationUrl=p;this._nameConflictBehavior=g;this._chunkSize=Math.min(l.size,262144e3);this._trackingHeaders={Application:i,Scenario:"UploadFile",ScenarioType:"AUO"};this._onStart=y;this._onAbort=b;this._onProgress=w}e.prototype.upload=function(){var e=this,t=this._throttler.throttle(function(){var t=e._id,n=e._fileUpload.size,r=e._canStream&&n>25165824,s={fileUploadId:t,size:n},o=new e._qosEvent({name:"Upload.h5",extraData:s}),u=r?"SharePointUploader.stream":"SharePointUploader.create",f=new e._qosEvent({name:u,extraData:s}),c=new d.e({scenario:"SharePointUpload",extraData:s});e._fileName=e._fileUpload.name;e._onStart&&e._onStart();return e.start(r).then(function(e){o.end({resultType:h.e.Success});f.end({resultType:h.e.Success});c.end({resultType:h.e.Success});return e},function(t){if(a.n.isCanceled(t)){o.end({resultType:h.e.ExpectedFailure,resultCode:"Aborted"});f.end({resultType:h.e.ExpectedFailure,resultCode:"Aborted"});c.end({resultType:h.e.ExpectedFailure,errorCode:"Aborted"});e._onAbort&&e._onAbort();return a.n.reject(t)}var n=(function(e){return e instanceof T?e:new T(e instanceof w?{errorType:v.e.other,code:"FileHasher",statusCode:0,innerError:e}:{errorType:v.e.general,code:"Unknown",statusCode:0,innerError:e})})(t),r=(function(e){return new g.e({message:e.displayString,errorType:e.errorType,innerError:e,supportsVersioning:!0})})(n),s=(function(e){switch(e.errorType){case v.e.disconnected:case v.e.conflict:case v.e.similarNameExists:case v.e.targetFolderMissing:return!0}switch(e.code){case"-2147023080":case"-2130575245":case b.r:case b.n:case b.i:case S:case"-2130245249":return!0}return!1})(n)?h.e.ExpectedFailure:h.e.Failure;o.end(Object(l.e)(Object(p.e)(r),{resultType:s,resultCode:v.e[r.errorType]}));var u=L&&!n.extraData.status&&n.serverError,d=Object(l.e)(Object(p.e)(n),{resultType:s,extraData:Object(i.__assign)(Object(i.__assign)({},u?{serverError:u}:{}),{uploadedBytes:e._uploadedBytes})});f.end(d);var m=d.extraData,y=d.resultCode;c.end({resultType:s,extraData:m,errorCode:y});return a.n.reject(r)})});this._uploadPromise=t;return t};e.prototype.abort=function(){var e=this,t=this._uploadPromise;this._uploadPromise=void 0;if(!this._hasCompleted&&t){t.cancel();t.then(function(){},function(){}).done(function(){e._hasher&&e._hasher.dispose();return e.cancelUpload()})}};e.prototype.restart=function(e){var t=e.nameConflictBehavior,n=void 0===t?this._nameConflictBehavior:t;this._nameConflictBehavior=n;var r=this._uploadPromise;this._uploadPromise=void 0;r&&r.cancel();this._hasher&&this._hasher.reset();return this.upload()};e.prototype.dispose=function(){this._async.dispose();this._hasher&&this._hasher.dispose()};e.prototype.start=function(e){var t=this;this._uploadedBytes=0;var n=this._fileUpload.size;return(e?this.streamFile():this.uploadFile()).then(function(e){t.updateProgress(n);return e})};e.prototype.updateProgress=function(e){if(this._uploadedBytes!==e){this._uploadedBytes=e;this._onProgress&&this._onProgress(e)}};e.prototype.getUploadUrl=function(e){var t=this._webApiUrl;t=(t=t.methodWithAliases("GetFolderByServerRelativePath",{DecodedUrl:this._destinationUrl})).segment("Files");var n={};n.DecodedUrl=this._fileName;1===this._nameConflictBehavior||3===this._nameConflictBehavior?n.overwrite=!0:2===this._nameConflictBehavior&&(n.EnsureUniqueFileName=!0);n.AutoCheckoutOnInvalidData=!0;e&&(n.XorHash=e);t=t.methodWithAliases("AddUsingPath",n).oDataParameter("$Select",k);this._itemExpansion&&(t=t.oDataParameter("$Expand",this._itemExpansion));return t.toString()};e.prototype.uploadFile=function(e){var t=this;void 0===e&&(e=3);var n=this._fileUpload.slice(0,this._fileUpload.size);return(this._hasher&&!this._hasher.hasFullHash()?this._hasher.computeHash(n,0,n.size):a.n.resolve()).then(function(){var i=t._hasher?t._hasher.getFullHash(n.size):void 0,s=t._hasher?"UploadFileWithChecksum":"UploadFile";return t.uploadChunk({trackSpeed:!1,url:t.getUploadUrl(i),qosName:s,data:n,offset:0,length:n.size}).then(function(e){return t.parseItemResponse(e)}).catch(function(n){if(a.n.isCanceled(n))return a.n.wrapError(n);if(n&&n.retryAfter&&e>0){var i=1e3*n.retryAfter;return t._throttler.addThrottleTimer(i).then(function(){t._uploadedBytes=0;return t.uploadFile(e-1)})}return a.n.wrapError(C(n,r.singleChunk))})})};e.prototype.getStreamingUrl=function(e,t,n,s){var o,u=this._webApiUrl,a=this._fileName,f={uploadId:{guid:this._requestId}};if(n===r.start){o=A?"StartUploadFile":"StartUpload";u=(u=u.methodWithAliases("GetFolderByServerRelativePath",{DecodedUrl:this._destinationUrl})).segment("Files");u=1===this._nameConflictBehavior||3===this._nameConflictBehavior?u.methodWithAliases("GetByPathOrAddStub",{DecodedUrl:a}):2===this._nameConflictBehavior?u.methodWithAliases("AddStubUsingPath",Object(i.__assign)({DecodedUrl:a},A?{EnsureUniqueFileName:!0}:{})):u.methodWithAliases("AddStubUsingPath",{DecodedUrl:a})}else{if(n===r.finish){o=this._hasher?"FinishUploadWithChecksum":"FinishUpload";u=u.oDataParameter("$Select",k);this._itemExpansion&&(u=u.oDataParameter("$Expand",this._itemExpansion))}else o="ContinueUpload";u=u.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:this._destinationUrl+"/"+a});f.fileOffset=e;s&&n===r.finish&&(f.checksum=s)}return(u=u.methodWithAliases(o,f)).toString()};e.prototype.streamFile=function(e,t){var n=this;void 0===e&&(e=0);void 0===t&&(t=3);this._requestId||(this._requestId=s.e.generate());var i=this._fileUpload.size,o=this._chunkNumber>0?Math.min(this._chunkSize+e,i):0,f=this._fileUpload.slice(e,o),l=0===this._chunkNumber?r.start:i<=o?r.finish:r.continue,c=l===r.start,h=l===r.finish,p="SendFileRequest"+(c?".Start":h?this._hasher?".FinishWithChecksum":".Finish":".Continue"),d=this._hasher&&l!==r.start&&!this._hasher.hasFullHash()&&this._hasher?this._hasher.computeHash(f,e,o):a.n.resolve();return(h?d:a.n.resolve()).then(function(){var s=void 0;n._hasher&&h&&(s=n._hasher.getFullHash(i));return n.uploadChunk({trackSpeed:!0,url:n.getStreamingUrl(e,o,l,s),qosName:p,data:f,offset:e,length:f.size}).then(function(e){n.updateProgress(o);var s=n.parseItemResponse(e);l===r.start&&2==n._nameConflictBehavior&&s.Name&&(n._fileName=s.Name);if(o<i){n._chunkNumber++;return d.then(function(){return n.streamFile(o,t)})}return s},function(i){if(a.n.isCanceled(i)){l!==r.start&&n.cancelUpload();return a.n.reject(i)}if((o=N(s=i))===x||o===S||s&&0===s.status){if(n._chunkSize<=1048576){n.cancelUpload();return a.n.reject(C(i,l))}n._chunkSize=Math.floor(n._chunkSize/2);return n.streamFile(e,t)}var s,o;if(t>0&&(function(e,t){if(429===e.status)return!1;if(404===e.status&&(t===r.start||t===r.singleChunk))return!1;switch(N(e)){case b.i:case"-1":case"-2130575257":case"-2130245249":case"-2130575142":case"-2130209002":case"-2130209003":case"-2147023080":case"-2130575245":case"-2147024891":return!1;default:return!0}})(i,l)){var f,c=new u.e(function(){f&&n._async.clearTimeout(f)});f=n._async.setTimeout(function(){return c.complete()},1e3);return c.getPromise().then(function(){return n.getUploadStatus().then(function(e){return n.streamFile(e,t-1)},function(){return n.streamFile(e,t-1)})})}l!==r.start&&n.cancelUpload();return a.n.reject(C(i,l))})},function(e){l!==r.start&&n.cancelUpload();return a.n.reject(e)})};e.prototype.getUploadStatus=function(){var e=this._webApiUrl.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:this._destinationUrl+"/"+this._fileName}).methodWithAliases("GetUploadStatus",{uploadId:{guid:this._requestId}}).toString();return this._dataRequestor.getData({url:e,method:"GET",noRedirect:!0,authToken:this._authToken,qosName:"GetUploadStatus",additionalHeaders:this._trackingHeaders,qosExtraData:{fileUploadId:this._id},telemetryHandler:function(e){var t=e.eventData,n=e.response;if(t.resultType===h.e.Success){if(!n||!n.d||!n.d.ExpectedContentRange)return{eventData:Object(i.__assign)(Object(i.__assign)({},t),{resultCode:"NoContentRange",resultType:h.e.Failure})};var r=parseInt(n.d.ExpectedContentRange.split("-")[0],10);if(isNaN(r))return{eventData:Object(i.__assign)(Object(i.__assign)({},t),{resultCode:"NaNContentRange",resultType:h.e.Failure,error:n.d.ExpectedContentRange})}}return{eventData:t}}}).then(function(e){if(e.d&&e.d.ExpectedContentRange){var t=parseInt(e.d.ExpectedContentRange.split("-")[0],10);return isNaN(t)?a.n.reject(""):t}return a.n.reject("")})};e.prototype.cancelUpload=function(){if(!this._requestId)return a.n.resolve();var e=this._webApiUrl.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:this._destinationUrl+"/"+this._fileName}).methodWithAliases("CancelUpload",{uploadId:{guid:this._requestId}}).toString();this._requestId="";this._chunkNumber=0;return this._dataRequestor.getData({url:e,noRedirect:!0,authToken:this._authToken,qosName:"CancelUploadSession",additionalHeaders:this._trackingHeaders,qosExtraData:{fileUploadId:this._id}}).then(function(){})};e.prototype.uploadChunk=function(e){var t,n,r,i,s=this,o=e.url,a=e.qosName,f=e.data,l=e.offset,c=e.length,h=!1,p=new u.e(function(){h=!0;t.cancel()}),d=function(e){var t=s._chunkNumber>0&&l+c>=s._fileUpload.size?3e5:1e4,r=Math.min(Math.max(.08*e,t),2147483647);n&&s._async.clearTimeout(n);e&&(n=s._async.setTimeout(function(){p.error({code:""+S,message:""})},r))},v=Date.now(),m=Date.now(),g=0,y=0,b=0,w=this._async.debounce(function(e){e>s._uploadedBytes&&s.updateProgress(e)},100,{leading:!1});t=this._dataRequestor.getData({url:o,qosName:a,noRedirect:!0,authToken:this._authToken,additionalHeaders:this._trackingHeaders,qosExtraData:{fileUploadId:this._id},parseResponse:function(e){return e},contentType:"application/octet-stream",additionalPostData:f,onUploadProgress:function(e){if(e.lengthComputable){var t=Date.now();y+=(e.loaded-g)/(t-m);b++;r=e.loaded/(t-v);m=t;g=e.loaded;s._onProgress&&w(l+e.loaded);d(c-e.loaded)}}});d(c);e.trackSpeed&&(i=this._async.setInterval(function(){if(b){Date.now()-v+(c-g)/((y+r)/(b+1))>15e4&&g<c&&p.error({code:""+x,message:""})}},1e4));var E=function(){n&&s._async.clearTimeout(n);i&&s._async.clearInterval(i)},T=p.getPromise();t.done(function(e){p.complete(e)},function(e){h||p.error(e)});T.done(function(){return E()},function(){h||t.cancel();E()});return T};e.prototype.parseItemResponse=function(e){try{return JSON.parse(e).d}catch(e){}};return e})()},"2573":function(e,t,n){"use strict";n.d(t,"e",function(){return c});var r=n(0),i=n(389),s=n(94),o=n(435),u=n(1735),a=n(134),f=n(1562),l=n(75),c=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,{dataSourceName:"UserExpirationDataSource",id:"UserExpirationDataSource"},{pageContext:t.pageContext})||this;n._dataRequestor=new i.t({qosName:"UserExpirationDataSource",pageContext:t.pageContext});var r=Object(o.n)(t.pageContext);n._getExpiringUsersUrl=r+"/_api/web/SiteUserInfoList/GetItems";n._setUserExpirationUrl=r+"/_api/web/SiteUsers/GetById(@a)";n._expireUserUrl=r+"/_api/web/SiteUsers/GetById(@a)/Expire";n._externalUserExpirationPolicyUrl=r+"/_api/Site/ExternalUserExpirationInDays";return n}t.prototype.setUserExpiration=function(e,t){var n=this;if(!e||e.length<1)return s.n.reject([!1]);if(e.length>1){var r=a.e.generate(),i="multipart/mixed; boundary=batch_"+r,o=[],f=[],l=[];e.forEach(function(e){o.push(n._setUserExpirationUrl+"?@a="+e.id);f.push(JSON.stringify({__metadata:{type:"SP.User"},Expiration:t?t.toISOString():""}));l.push("PATCH")});var c=this._dataRequestor.getData({url:u.t.getBatchOperationUrl(this._pageContext.webAbsoluteUrl),parseResponse:function(e){return e},qosName:"SetUserExpirations",additionalPostData:u.t.getBatchContentExtended(r,o,"PATCH",u.t.defaultBatchRequestPostData,f,u.t.defaultBatchAcceptData,l),method:"POST",contentType:i,noRedirect:!0,needsRequestDigest:!0});this.flushCache();return c.then(function(e){var t=u.t.processBatchResponse(e);return t.hasError?s.n.reject(t):t}).then(function(e){return e.items.map(function(){return!0})},function(e){return e.items.map(function(e){return!e.error})})}var h=this._setUserExpirationUrl+"?@a="+e[0].id,p={__metadata:{type:"SP.User"},Expiration:t?t.toISOString():""};this.flushCache();return this._dataRequestor.getData({url:h,parseResponse:function(e){return[!e]},qosName:"SetUserExpiration",additionalPostData:JSON.stringify(p),method:"POST",additionalHeaders:{"X-HTTP-Method":"PATCH"},noRedirect:!0,needsRequestDigest:!0})};t.prototype.expireUser=function(e){var t=this;if(!e||e.length<1)return s.n.reject([!1]);if(e.length>1){var n=a.e.generate(),r="multipart/mixed; boundary=batch_"+n,i=[],o=[];e.forEach(function(e){i.push(t._expireUserUrl+"?@a="+e.id);o.push("POST")});var f=this._dataRequestor.getData({url:u.t.getBatchOperationUrl(this._pageContext.webAbsoluteUrl),parseResponse:function(e){return e},qosName:"BatchExpireUser",additionalPostData:u.t.getBatchContentExtended(n,i,"POST",u.t.defaultBatchRequestPostData,[],u.t.defaultBatchAcceptData,o),method:"POST",contentType:r});this.flushCache();return f.then(function(e){var t=u.t.processBatchResponse(e);return t.hasError?s.n.reject(t):t}).then(function(e){return e.items.map(function(){return!0})},function(e){return e.items.map(function(e){return!e.error})})}var l=this._expireUserUrl+"?@a="+e[0].id;this.flushCache();return this._dataRequestor.getData({url:l,parseResponse:function(e){if(e){var t=JSON.parse(e);if(t&&t.d)return[!0]}return[!1]},qosName:"ExpireUser",method:"POST"})};t.prototype.getUsersWithExpirationsWithCache=function(e,t,n,r,i,s){var o=[];n&&o.push("$top="+n);r&&o.push("$skip="+r);e&&o.push("$orderby="+e+" "+(t?"asc":"desc"));i&&o.push("$filter="+i);o.push("$select=Title,ID,Name,UserExpiration,IsSiteAdmin,EMail");var u=this._getExpiringUsersUrl;o.length>0&&(u+="?"+o.join("&"));return this.getDataUtilizingPersistentCache({url:u,parseResponse:function(e){var t=JSON.parse(e);return t&&t.d&&t.d.results?t.d.results.map(function(e){return{id:e.ID,loginName:e.Name,email:e.EMail,expiration:new Date(e.UserExpiration),title:e.Title,isSiteAdmin:e.IsSiteAdmin}}):e},qosName:"GetUsersWithExpirations",additionalPostData:JSON.stringify({query:{__metadata:{type:"SP.CamlQuery"},ViewXml:"<View><Query><Where><IsNotNull><FieldRef Name='UserExpiration'/></IsNotNull></Where></Query></View>"}}),method:"POST",cachingStrategy:s})};t.prototype.getUsersWithExpirations=function(e,t,n,r,i){var s=this;return this.getUsersWithExpirationsWithCache(e,t,n,r,i,1).then(function(o){return!l.e.isActivated("D4D5FBC4-9310-4DD9-A7B4-7702B0473A8D","4/01/2021","Bypass cache to match pageContext expiringUser count")&&0===r&&o&&o.length>0&&s.hasSiteUsersExpiringSoon(o)!=s._pageContext.HasSiteUsersExpiringSoon?s.getUsersWithExpirationsWithCache(e,t,n,r,i,3):o})};t.prototype.hasSiteUsersExpiringSoon=function(e){var t=new Date;t.setDate(t.getDate()+21);return e.some(function(e){return e.expiration&&e.expiration<t})};t.prototype.getExternalUserExpirationPolicy=function(){return this._dataRequestor.getData({url:this._externalUserExpirationPolicyUrl,parseResponse:function(e){if(e){var t=JSON.parse(e);if(t&&t.d&&t.d.ExternalUserExpirationInDays)return t.d.ExternalUserExpirationInDays}return 0},qosName:"GetExternalUserExpirationPolicy",method:"GET",needsRequestDigest:!0})};return t})(f.t);t.t=c},"2626":function(e,t,n){"use strict";var r=n(284),i=n(23);function s(e,t,n){var r=e.replace("&action=edit",""),i=n?"forms.officeppe.com":"forms.office.com",s="Action=Create&Host=OneDrive&XlWorkbookId="+encodeURIComponent(r)+"&Title="+encodeURIComponent(t);return"https://"+i+"/Pages/DesignPage.aspx?Action=Create&Fragment="+encodeURIComponent(s)}n.d(t,"e",function(){return o});n.d(t,"t",function(){return u});function o(e,t,n){var r=void 0;"string"==typeof e?0===(e=e.trim()).length?r=t.emptyNameError:/["\*:<>\?\/\\\|]/.test(e)&&(r=i.format(n?t.invalidNameError2:t.invalidNameError,e)):r=t.emptyNameError;return r}function u(e,t,n,i){var o="";null!==e&&""!==e&&(o=t===r.e.ExcelSurvey?e.replace("action=edit","action=formedit"):t===r.e.ExcelForm?s(e,n,i):e.replace("action=edit","action=editnew"));return o}},"2728":function(e,t,n){"use strict";var r,i,s=n(0);(function(e){e[e.ContextMenu=0]="ContextMenu";e[e.RibbonDocuments=1]="RibbonDocuments";e[e.RibbonList=2]="RibbonList"})(r||(r={}));(function(e){e[e.None=0]="None";e[e.List=1]="List";e[e.ContentType=2]="ContentType";e[e.ProgId=3]="ProgId";e[e.FileType=4]="FileType"})(i||(i={}));var o="ClientSideExtension.ListViewCommandSet",u="ClientSideExtension.ListViewCommandSet.ContextMenu",a="ClientSideExtension.ListViewCommandSet.CommandBar",f=n(60),l=n(27),c=n(2759),h=n(134),p=n(23),d=n(65);n.d(t,"t",function(){return v});n.d(t,"e",function(){return m});n.d(t,"n",function(){return g});function v(e,t){var n=[],r=[],f=[];if("undefined"==typeof DOMParser)throw new Error("Cannot parse custom actions on this platform");for(var c=new DOMParser,d=function(e){var d=e.Location,v=e.RegistrationType;if(d&&0===d.lastIndexOf(o,0)){if(!v||v!==i.List)return"continue";var m=d===o,g=d===u||m,S=d===a||m,N={text:e.Title,isEnabled:function(){return T({registrationId:e.RegistrationId,registrationType:e.RegistrationType,requireSiteAdministrator:e.RequireSiteAdministrator,rights:e.Rights},t)},allowMultiSelect:!0,clientSideComponentId:e.ClientSideComponentId,clientSideComponentProperties:e.ClientSideComponentProperties};g&&f.push(N);S&&(t.isDocumentLibrary?n.push(Object(s.__assign)({},N)):r.push(Object(s.__assign)({},N)))}else{if(!y(e.UrlAction))return"continue";if(e.CommandUIExtension&&p.doesStringStartWith(e.Location,"CommandUI.Ribbon")&&e.UrlAction){var C=b(e,t,!0),k=b(e,t,!1),L=void 0;try{L=c.parseFromString(e.CommandUIExtension,l.t.doctype)}catch(e){}if(!L)return"continue";var A=L.getElementsByTagName("Tab");A&&0!==A.length||(A=L.getElementsByTagName("Group"));if(A&&A.length>0){var O=w(A,!0),M=w(A,!1),_={};if(O||M)for(var D=0,P=L.getElementsByTagName("CommandUIHandlers");D<P.length;D++)for(var H=P[D].firstElementChild;H;){_[H.getAttribute("Command")]=H.getAttribute("CommandAction");H=H.nextElementSibling}if(O){var B=E(O,_,e,C);n.push(B)}if(M){B=E(M,_,e,k);r.push(B)}}else{var j=L.getElementsByTagName("Button"),F=x(j,!0,e,C);F&&n.push(F);var I=x(j,!1,e,k);I&&r.push(I)}}else if("EditControlBlock"===e.Location&&e.Title){var q={text:e.Title,isEnabled:b(e,t),allowMultiSelect:!!e.CommandUIExtension&&!e.EnabledScript,action:e.UrlAction,clientSideComponentId:h.e.Empty,clientSideComponentProperties:""};f.push(q)}}},v=0,m=e;v<m.length;v++){d(m[v])}return{"Ribbon.Documents":n,"Ribbon.List":r,ContextMenu:f}}function m(e){return"children"in e}function g(e,t,n){var r=n.webAbsoluteUrl+"/",i=n.layoutsUrl+"/",s=""+r+i,o=n.siteAbsoluteUrl+"/",u=""+o+i,a="",f=n.listId,l=n.listUrl;0===e.toLowerCase().lastIndexOf("javascript:launchapp(",0)&&(f=f.replace(/{/g,"%7B").replace(/-/g,"%2D").replace(/}/g,"%7D"));a=e.replace(/{SiteUrl}/g,r).replace(/~site\//g,r).replace(/~layouts\//g,i).replace(/~siteLayouts\//g,s).replace(/~siteCollection\//g,o).replace(/~siteCollectionLayouts\//g,u).replace(/{ListId}/g,f).replace(/{SelectedListId}/g,f).replace(/{ListUrlDir}/g,l).replace(/{Source}/g,d.e.encodeURIComponent(window.location.href)).replace(/{ModernUX}/g,"true");if(t.length>0){var c=t.map(function(e){return e.id}).join(","),h=t[0].id,p=t[0].url;a=a.replace(/{ItemUrl}/g,d.e.encodeURIComponent(p)).replace(/{ItemId}/g,h).replace(/{SelectedItemId}/g,c)}else a=a.replace(/{ItemUrl}/g,null).replace(/{ItemId}/g,null).replace(/{SelectedItemId}/g,null);return a}function y(e){return!e||("javascript:"!==e.substring(0,11).toLowerCase()||Object(c.t)(e,!1))}function b(e,t,n){var r=void 0===n||n===t.isDocumentLibrary;if(e.CommandUIExtension&&e.EnabledScript)return r||!0;var i=T({registrationId:e.RegistrationId,registrationType:e.RegistrationType,requireSiteAdministrator:e.RequireSiteAdministrator,rights:{High:Number(e.Rights.High),Low:Number(e.Rights.Low)}},t);return!!i&&("function"==typeof i?"function"==typeof r?function(e){return i(e)&&r}:i:r)}function w(e,t){for(var n=0,r=e.length;n<r;n++){var i=e[n],s=i.getAttribute("Id");if(!s)return i;if((t||!p.doesStringStartWith(s,"Ribbon.Documents"))&&!(t&&p.doesStringStartWith(s,"Ribbon.List")||p.doesStringStartWith(s,"Ribbon.Calendar")))return i}return null}function E(e,t,n,r){for(var i=[],s=e.getElementsByTagName("Button"),o=0,u=s.length;o<u;o++){var a=s[o],f=a.getAttribute("Command"),l=f&&t[f]||n.UrlAction;if(y(l)){var c={text:a.getAttribute("LabelText"),iconUrl:S(a),isEnabled:r,allowMultiSelect:!n.EnabledScript,action:l,clientSideComponentId:h.e.Empty,clientSideComponentProperties:""};i.push(c)}}return{text:e.getAttribute("Title"),tooltip:e.getAttribute("Description"),children:i}}function S(e){return e.getAttribute("Image32by32")||e.getAttribute("Image16by16")}function x(e,t,n,r){if("boolean"!=typeof r||r){var i;e&&e.length>0&&(i=w(e,t));if(i){var s=i.getAttribute("LabelText")||n.Title;if(s){var o={text:s,allowMultiSelect:!n.EnabledScript,action:n.UrlAction,isEnabled:r,clientSideComponentId:h.e.Empty,clientSideComponentProperties:""},u=S(e[0]);u&&(o.iconUrl=u);return o}}}}function T(e,t){var n=(function(e,t){return e.requireSiteAdministrator?t.currentUserIsSiteAdmin:function(t){return f.e.hasItemPermission(t,e.rights)}})(e,t),r=(function(e,t){var n=e.registrationType,r=e.registrationId;if(!r)return n===i.List;switch(n){case i.List:return parseInt(r,10)===t.listTemplate||r===t.listId;case i.FileType:var s="."+r;return function(e){return p.equalsCaseInsensitive(e.extension,s)};case i.ContentType:return function(e){var t="contentTypeId"in e&&e.contentTypeId||"properties"in e&&e.properties.ContentTypeId;return t&&p.doesStringStartWith(t,r)};case i.ProgId:return function(e){return("progId"in e&&e.progId||"properties"in e&&e.properties.ProgId)===r}}return!1})(e,t);return!(!n||!r)&&function(e){return!!e&&(!("function"==typeof n&&!n({permissions:e.permissions}))&&!("function"==typeof r&&!r(e)))}}},"2759":function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(94),i=n(65);function s(e,t){if(t)return!0;if("javascript:LaunchApp("===e.substring(0,21)&&");"===e.substring(e.length-2)){var n=u(e);try{JSON.parse(n);return!0}catch(e){return!1}}return!1}function o(e,t){var n=u(e);try{var s=JSON.parse(n);(function(e){var t=e.pageContext,n=e.appInstanceId,r=e.appOAuthId,s=e.launchUrl,o=e.isTenantApp,u=i.e.escapeUrlForCallback(t.webAbsoluteUrl),a=i.e.escapeUrlForCallback(t.layoutsUrl),f=u+"/"+a+"/appredirect.aspx";if(r&&s)f+="?client_id="+i.e.encodeURIComponent(r)+"&redirect_uri="+i.e.encodeURIComponent(s);else{if(!n)throw"appOAuthId, launchUrl, appInstanceId are null";f+="?instance_id="+i.e.encodeURIComponent(n)}o&&(f+="&tsapp=1");window.location.href=f})({pageContext:t,appInstanceId:s[0],appOAuthId:s[1],launchUrl:s[2],isTenantApp:s[4]});return r.n.wrap()}catch(e){return r.n.wrapError(e)}}function u(e){return e.replace("javascript:LaunchApp(","[").replace(");","]").replace(/'/g,'"').replace(/(width|height|title):/g,'"$1":')}},"2959":function(e,t,n){"use strict";n.d(t,"e",function(){return p});var r=n(0),i=n(647),s=n(304),o=n(1481),u=n(94),a=n(48),f=n(173),l=n(134),c=n(171),h={ODB:1201},p=(function(e){Object(r.__extends)(t,e);function t(t){return e.call(this,{dataSourceName:"ListItemDataSource"},{pageContext:t.pageContext})||this}t.prototype.getItem=function(t,n,r,i){var s=this;t.postDataContext.isOnePage=!!t.newTargetListUrl||!!t.isOnePageNavigation;var o=t.remoteItem&&c.e.isFeatureEnabled(h)?this._getRemoteItemPostData():this.getAdditionalPostData(t.postDataContext,n,t.pageSize);return e.prototype.getData.call(this,function(){return s.getUrl(n,t)},function(e,t){return s._parseResponse(e,r.qosEvent,t)},r.qosName,function(){return o},"POST",this._getListRequestHeaders(t,n),void 0,void 0,void 0,void 0,function(e){var t=s._telemetryHandler(e);i&&i(t.eventData);return t},void 0,t.authToken).then(function(e){return e},function(e){s._errorHandler(r.qosName,e);return u.n.reject(e)})};t.prototype.getUrl=function(e,t){var n,r=t&&t.postDataContext;n=c.e.isFeatureEnabled(h)?{webUrl:this._pageContext.webAbsoluteUrl,listId:t.remoteItem?t.remoteItem.ListId:e.listId,urlParts:t.remoteItem?{}:e.urlParts,searchTerm:e.searchTerm,rootFolder:t.remoteItem?void 0:e.folderPath,isOnePageNavigation:t.isOnePageNavigation,remoteWebUrl:t.remoteItem?t.remoteItem.SiteUrl:t.remoteWebUrl,uniqueId:t.remoteItem&&t.remoteItem.UniqueId}:{webUrl:this._pageContext.webAbsoluteUrl,listId:e.listId,urlParts:e.urlParts||{},searchTerm:e.searchTerm,rootFolder:e.folderPath,isOnePageNavigation:t.isOnePageNavigation};if(this._isSpecifiedItemRequest(e))n.viewId=e.viewIdForRequest;else{(!e.viewXmlForRequest||r&&r.isOnePage)&&e.viewIdForRequest!==l.e.Empty&&(n.view=e.viewIdForRequest);!n.view&&e.viewPathForRequest&&(n.viewPath=e.viewPathForRequest);t&&t.ignoreFilterParams||(n.filterParams=e.filterParams);if(e.sortField){n.sortField=e.sortField;n.sortDir="false"===e.isAscending?"Desc":"Asc"}r&&r.groupReplace?n.requestToken=this._isExpandingGroup(n)?void 0:e.requestToken:n.requestToken=e.group?void 0:e.requestToken;!this._isExpandingGroup(e)||r&&r.groupReplace||(n.groupString=e.group.groupString);r&&r.webId&&(n.webId=r.webId)}return i.t(n)};t.prototype.getAdditionalPostData=function(e,t,n){return s.e(e,t,n)};t.prototype._getRemoteItemPostData=function(){return JSON.stringify({parameters:{RenderOptions:7}})};t.prototype._getListRequestHeaders=function(e,t){var n=i.r(t,e.postDataContext);n["X-ServiceWorker-Strategy"]=e.skipServiceWorkerCache?"SkipCache":"CacheFirst";return n};t.prototype._isSpecifiedItemRequest=function(e){return e.itemIds&&e.itemIds.length>0};t.prototype._isExpandingGroup=function(e){return e.group&&"__next__"!==e.group.groupingId};t.prototype._parseResponse=function(e,t,n){var r=n.getServiceWorkerDataSourceHeader();try{if(void 0!==e)return this._getListItemResponse(e,r)}catch(n){if("{}"!==e.substring(0,2)){t.end({resultType:a.e.Failure,resultCode:"BadJSON"});throw n}return this._getListItemResponse(e.substring(2),r)}};t.prototype._getListItemResponse=function(e,t){var n;n=JSON.parse(e);"ServiceWorker-FromCache"===t&&(n.isFromServiceWorkerCache=!0);return n};t.prototype._telemetryHandler=function(e){var t=e.errorData,n=Object(r.__assign)({},e.eventData);if(t){var i=void 0,s=t.code?t.code:"";if(s.indexOf("2147024860")>-1)s="ListViewTreshold";else if(s.indexOf("2147024749")>-1)s="LookupColumnTreshold";else if(s.indexOf("2147024809")>-1&&s.indexOf("requestUrl")>-1)s="RequestURLFailure";else if(s.indexOf("2147024809")>-1&&s.indexOf("range")>-1)s="RangeError";else if(s.indexOf("2147024809")>-1&&s.indexOf("view")>-1)s="InvalidView";else if(s.indexOf("2130575340")>-1&&s.indexOf("field")>-1)s="FieldTypesNotInstalledProperly";else if(s.indexOf("2146232832")>-1){s="DefaultDoclibNotFound";if(500===t.status){i=!1;n.resultType=a.e.ExpectedFailure}}else if(s.indexOf("2147024895")>-1){s="PrefetchWebMismatch";if(500===t.status){i=!1;n.resultType=a.e.ExpectedFailure}}else s=n.resultCode;n.resultCode=s;return{canRetry:i,eventData:n}}return{eventData:n}};t.prototype._errorHandler=function(e,t){var n=t&&t.code?t.code:"";n.indexOf("2147024860")>-1?f.e.logData({name:e+".ListViewTreshold"}):n.indexOf("2147024749")>-1&&f.e.logData({name:e+".LookupColumnTreshold"})};return t})(o.t)},"2961":function(e,t,n){"use strict";n.d(t,"e",function(){return r});n.d(t,"t",function(){return s});var r,i=n(905);(function(e){e.Small="S";e.Medium="M";e.Large="L"})(r||(r={}));function s(e){var t;switch(e.size){case r.Large:t=3;break;case r.Medium:t=2;break;default:t=1}return Object(i.getUserPhotoUrl)(e.userLoginName,t)}},"2978":function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(e){var t=e.serverRelativeItemUrl,n=e.dataRequestor,r=e.webApiUrl,i=e.duration,s=void 0===i?1:i,o=e.authToken,u=r;u=(u=u.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:t})).method("GetPreAuthorizedAccessUrl",s);return n.getData({url:u.toString(),method:"GET",authToken:o,qosName:"ItemDataSource.getDownloadUrl"}).then(function(e){return e.d.GetPreAuthorizedAccessUrl})}},"3114":function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n(212),i=n(326),s=n(94),o=n(1571),u={enqueue:function(e){return e()}},a=(function(){function e(e){void 0===e&&(e={});this.async=new r.e;this.uploaderCount=0;this.throttledSignals=[];var t=e.maxParallelUploads,n=void 0===t?3:t,i=e.maxUploadsPerSecond,s=void 0===i?8:i;this.uploadQueue=n===1/0?u:new o.e(n);this.maxUploads=s}e.prototype.throttle=function(e){var t=this;return this.uploadQueue.enqueue(function(){if(!t.isReady&&t.uploaderCount>=1e3){t.uploaderCount=0;t.isReady=!0}if(t.batchStartTime&&t.uploaderCount>=t.maxUploads)return t.throttleUploader(e);t.isReady&&!t.batchStartTime&&(t.batchStartTime=Date.now());return t.startUploader(e)})};e.prototype.addThrottleTimer=function(e){this.isReady=!0;this.setTimeout(e);return this.addUploaderCallback(function(){return s.n.resolve()})};e.prototype.startUploader=function(e){this.uploaderCount+=1;return e()};e.prototype.addUploaderCallback=function(e){var t=this,n=new i.e;this.throttledSignals.push(n);return n.getPromise().then(function(){return t.startUploader(e)})};e.prototype.throttleUploader=function(e){if(this.timeout)return this.addUploaderCallback(e);var t=1e3-(Date.now()-this.batchStartTime);if(t>0){this.setTimeout(t);return this.addUploaderCallback(e)}this.uploaderCount=0;this.batchStartTime=Date.now();return this.startUploader(e)};e.prototype.setTimeout=function(e){var t=this;if(this.timeout){this.async.clearTimeout(this.timeout);this.timeout=void 0}this.timeout=this.async.setTimeout(function(){t.timeout=void 0;t.uploaderCount=0;t.batchStartTime=Date.now();for(var e=0,n=t.throttledSignals;e<n.length;e++){n[e].complete()}t.throttledSignals=[]},e)};return e})()},"3154":function(e,t,n){"use strict";var r=n(94),i=n(212),s=n(486),o=n(173),u=n(134),a=n(48),f=n(101),l=n(1963),c=n(75),h="FlowWidgetProviderOld.",p={runFlowWidgetCancelled:a.e.Success,flowWidgetClosed:a.e.Success},d=(function(){function e(e,t){void 0===e&&(e={});this._widgetData=t.widgetData;this._oAuthTokenProvider=t.oAuthTokenProvider;this.containerId="od-Flow-iframeContainer-"+u.e.generate();this._listeners=new Array;this._async=new i.e;this._isWidgetReady=!1}e.prototype.addListener=function(e){if(e){this._listeners.indexOf(e)<0&&this._listeners.push(e)}};e.prototype.removeListener=function(e){if(e){var t=this._listeners.indexOf(e);t>=0&&this._listeners.splice(t,1)}};e.prototype.launchFlowWidget=function(e){var t=this;this._currentLaunchFlowData=e;o.e.logData({name:h+"PanelOpened",extraData:{flowId:e.flow.id}});c.e.isActivated("6A24FAB5-B66C-4A87-831E-CF8E543D167D","11/08/2018","FlowWidgetProvider managing listeners")||this.addListener(e.listener);return this._widgetData.getPromise().then(function(n){t._onLaunchWidget();return t._getWidget(e).then(function(n){t._widget=n;t._notifyWidget(e)},function(n){t._onWidgetError(n,e)})})};e.prototype.preloadSdk=function(e,t){if(c.e.isActivated("8B5248EE-6FF7-4C9F-B888-1485D51BC017","12/01/2018","FlowWidgetProvider preload sdk"))return r.n.resolve();o.e.logData({name:h+"PreloadSdk"});return this._loadSdk(e).then(function(){return r.n.resolve()})};e.prototype.onDismiss=function(){this._notifyWidgetQos&&this._notifyWidgetQos.end({resultType:a.e.Success,extraData:{message:"onDismiss"}});c.e.isActivated("3067C8F6-A92C-4264-9DBF-1ED2F221AC22","9/20/2018","Flow Widget dismiss calls _onWidgetClose")?c.e.isActivated("5346FE2A-9601-4AA8-BD09-632520D561B3","9/04/2018","Flow Widget dismiss calls closeWidget")?this._onRunFlowCanceled(this._currentLaunchFlowData):this.closeWidget():this._onWidgetClose(this._currentLaunchFlowData)};e.prototype.closeWidget=function(){c.e.isActivated("3067C8F6-A92C-4264-9DBF-1ED2F221AC22","9/20/2018","Flow Widget dismiss calls _onWidgetClose")?this._listeners.forEach(function(e){e.onCloseWidget&&e.onCloseWidget()}):this._onWidgetClose(this._currentLaunchFlowData)};e.prototype._getWidget=function(e){var t=this;if(!c.e.isActivated("48255E70-701C-48EB-8198-97B44A7DB68E","02/13/2019","Disable flow widget caching upon request")&&Boolean(e.noCache)||!this._createWidgetPromise||"triggerFlowByTemplate"===e.actionName||e.widgetType!==(this._widget&&this._widget.getWidgetType())){if(this._widget){this._widget.dispose();this._widget=null;this._isWidgetReady=!1}o.e.logData({name:h+"CreateNewFlowWidget"});this._widgetReadyQos=new f.e({name:h+"WidgetReady"});this._createWidgetPromise=this._createWidget(e)}else o.e.logData({name:h+"ReuseCachedFlowWidget"});return this._widget?r.n.wrap(this._widget):this._createWidgetPromise.then(function(e){return e},function(e){t._createWidgetPromise=null;return r.n.wrapError(e)})};e.prototype._createWidget=function(e){var t=this;return new r.n(function(n,r){t._widgetData.getPromise().then(function(i){t._renderWidget(i,e).then(function(e){n(e)},function(e){r(e)})})})};e.prototype._registerListeners=function(e){var t=this;if(this._widget){var n,r=this._activateTimeout("WIDGET_READY",e);this._widget.listen("GET_ACCESS_TOKEN",function(e,n){t._getToken().then(function(e){n(null,{token:e})})});this._widget.listen("WIDGET_READY",function(){t._widgetReadyQos&&t._widgetReadyQos.end({resultType:a.e.Success});t._isWidgetReady=!0;t._notifyWidget(e);t._async.clearTimeout(r);n=t._activateTimeout("WIDGET_RENDERED",e)});this._widget.listen("WIDGET_RENDERED",function(){t._onWidgetRendered();t._async.clearTimeout(n)});this._widget.listen("RUN_FLOW_COMPLETED",function(n){t._onRunFlowCompleted(e,n)});this._widget.listen("RUN_FLOW_CANCEL_BUTTON_CLICKED",function(){t._onRunFlowCanceled(e)});this._widget.listen("RUN_FLOW_DONE_BUTTON_CLICKED",function(){t._onRunFlowDoneClicked(e)});this._widget.listen("WIDGET_CLOSE",function(){t._onWidgetClose(e)});this._widget.listen("FLOW_CREATION_SUCCEEDED",function(n){t._onFlowCreationSucceeded(e,n)});this._widget.listen("FLOW_CREATION_FAILED",function(){t._onFlowCreationFailed(e)});this._widget.listen("RECEIVED_APPROVAL_STATUS_CHANGED",function(e){t._onApprovalStatusChanged(e)});!c.e.isActivated("a62f4d5a-349b-449b-bf44-c5b464d66328","7/09/2018","getStrings callback")&&e.additionalEvents&&e.additionalEvents.indexOf("GET_STRINGS")>-1&&this._widget.listen("GET_STRINGS",function(e,n){t._onGetStrings(n)})}};e.prototype._activateTimeout=function(e,t){var n=this;return this._async.setTimeout(function(){n._onWidgetError(new Error("Timeout: Widget timed out waiting for: "+e),t)},15e3)};e.prototype._notifyWidget=function(e){var t=this,n=!!this._widget;c.e.isActivated("7F471D6A-BFA2-4F72-BE2C-6601BA0A50E6","3/8/2018","Check isWidgetReady in notifyWidget")||(n=!!this._widget&&this._isWidgetReady);if(n){this._widget.listen("RUN_FLOW_STARTED",function(){t._onRunFlowStarted(e);o.e.logData({name:h+"RunFlowClicked",extraData:{flowId:e.flow.id}})});this._notifyWidgetQos=new f.e({name:h+"NotifyWidget"});this._widget.notify(e.actionName,e.actionData).then(function(){t._notifyWidgetQos.end({resultType:a.e.Success,extraData:{flowId:e.flow.id}})}).catch(function(n){if(n){var r=n.code,i=void 0!==p[r]?p[r]:a.e.Failure;t._notifyWidgetQos.end({resultType:i,extraData:{flowId:e.flow.id,message:r}})}else t._notifyWidgetQos.end({resultType:a.e.Failure,extraData:{flowId:e.flow.id,message:"Error unknown: no error returned in the notifyWidget promise catch clause."}})})}};e.prototype._onRunFlowStarted=function(e){this._listeners.forEach(function(t){t.onRunFlowStarted&&t.onRunFlowStarted(e)})};e.prototype._onWidgetRendered=function(){this._renderWidgetQos&&this._renderWidgetQos.end({resultType:a.e.Success});this._listeners.forEach(function(e){e.onWidgetRendered&&e.onWidgetRendered()})};e.prototype._onRunFlowCompleted=function(e,t){this._listeners.forEach(function(n){n.onRunFlowCompleted&&n.onRunFlowCompleted(e,t)})};e.prototype._onRunFlowCanceled=function(e){this._logWidgetCloseData("CancelClicked",e);this._listeners.forEach(function(t){t.onRunFlowCanceled&&t.onRunFlowCanceled(e)})};e.prototype._onRunFlowDoneClicked=function(e){this._logWidgetCloseData("DoneClicked",e);this._listeners.forEach(function(t){t.onRunFlowDoneClicked&&t.onRunFlowDoneClicked(e)})};e.prototype._onWidgetClose=function(e){this._logWidgetCloseData("WidgetClose",e);this._listeners.forEach(function(e){e.onCloseWidget&&e.onCloseWidget()});c.e.isActivated("6A24FAB5-B66C-4A87-831E-CF8E543D167D","11/08/2018","FlowWidgetProvider managing listeners")||e&&this.removeListener(e.listener)};e.prototype._logWidgetCloseData=function(e,t){var n=t&&t.flow?{flowId:t.flow.id,templateName:t.flow.templateName}:{};o.e.logData({name:""+h+e,extraData:n})};e.prototype._onFlowCreationSucceeded=function(e,t){var n=t?t.data:void 0;this._listeners.forEach(function(t){t.onFlowCreationSucceeded&&t.onFlowCreationSucceeded(e,n)})};e.prototype._onFlowCreationFailed=function(e){this._listeners.forEach(function(t){t.onFlowCreationFailed&&t.onFlowCreationFailed(e)})};e.prototype._onApprovalStatusChanged=function(e){this._listeners.forEach(function(t){t.onApprovalStatusChanged&&t.onApprovalStatusChanged(e)})};e.prototype._onWidgetError=function(e,t){this._renderWidgetQos&&this._renderWidgetQos.end({resultType:a.e.Failure,extraData:{message:e.message}});this._listeners.forEach(function(t){t.onWidgetError&&t.onWidgetError(e)})};e.prototype._onTokenError=function(e){this._listeners.forEach(function(t){t.onTokenError&&t.onTokenError(e)})};e.prototype._onLaunchWidget=function(){this._renderWidgetQos=new f.e({name:h+"RenderWidget"});this._listeners.forEach(function(e){e.onLaunchWidget&&e.onLaunchWidget()})};e.prototype._onGetStrings=function(e){this._listeners.forEach(function(t){t.onGetStrings&&t.onGetStrings(e)})};e.prototype._renderWidget=function(e,t){var n=this,i=this._loadSdk(t.hostId),s=e.iframePromise,o=this._getToken();return r.n.all([i,s,o]).then(function(i){var s=i[1];i[2];if(!n._widget){var o={container:s.id,campaign:t.campaign,environmentId:t.flow.environmentId,enableOnBehalfOfTokens:!0,enableRegionalPortal:!0,widgetStyleSettings:e.widgetStyleSettings,approvalCenterSettings:t.approvalCenterSettings,enableWidgetV2:!0};o.templatesSettings={useServerSideProvisioning:!0,defaultParams:t.widgetDefaultParams?t.widgetDefaultParams:void 0,allowCustomFlowName:t.allowCustomFlowName};try{n._widget=n._sdk.renderWidget(t.widgetType,o);n._registerListeners(t)}catch(e){return r.n.wrapError(e)}}return n._widget})};e.prototype._loadSdk=function(e){var t=this;if(this._sdkPromise)return this._sdkPromise;this._sdkPromise=new r.n(function(r){if(t._sdk)r();else{0;n.e("47").then(n.t.bind(null,3557,7)).then(function(n){t._sdk=new MsFlowSdk({hostName:Object(l.t)(void 0),locale:s.e.language,hostId:e});r()})}});return this._sdkPromise};e.prototype._getToken=function(){var e=this;return new r.n(function(t){var n=new f.e({name:h+"GetToken"});e._oAuthTokenProvider.getToken("https://service.flow.microsoft.com/").then(function(e){t(e);n.end({resultType:a.e.Success})},function(r){e._onTokenError(r);n.end({resultType:a.e.Failure,extraData:{serverErrorCode:r._serverErrorCode,message:r.message}});t(null)})})};return e})();t.e=d},"3386":function(e,t,n){"use strict";var r=n(0),i=n(94),s=n(212),o=n(1571),u=n(326),a=n(134),f=n(65),l=n(1480),c=n(648),h=n(75),p=n(1611),d=n(1846),v=n(151),m=n(262),g=(function(){function e(){var e=this.scope=new m.e;this._events=e.attach(new v.t(this))}e.prototype.start=function(){};e.prototype.abort=function(){};e.prototype.dispose=function(){this.scope.dispose()};e.prototype.updateState=function(e){if(e!==this.state){this.state=e;this._events.raise("upload_state_change",e)}};return e})();n.d(t,"e",function(){return w});var y=new o.e(3),b=!h.e.isActivated("72E63389-0C1B-4876-8C80-5F244AD63320","10/15/2020","Restrict retries on streaming uploads"),w=(function(e){Object(r.__extends)(t,e);function t(t){var n=this,r=t.fileUpload;(n=e.call(this)||this)._fileUpload=r;n._authToken=t.authToken;n._uploadId=null;n._chunkNumber=0;n._streamingChunkNumber=0;n._currentChunkSize=8388608;n._currentStreamingChunkSize=262144e3;n._onProgress=t.onProgress;n._dataRequestor=t.dataRequestor;n._async=n.scope.attach(new s.e(n));n.totalBytes=r.size;n.uploadedBytes=0;n.fileName=r.name;n.iconName=t.iconName;n.state=0;n.error=null;n.nameConflictBehavior=0;n.allowRename=!1;n.supportsVersioning=!0;n._expandAllItemFields=t.expandAllItemFields;n._uniqueId=t.uniqueId;n._parentItemKey=t.parentItemKey;n._targetItemKey=t.targetItemKey;n._serverRelativeItemUrl=t.serverRelativeItemUrl;n._webApiUrl=t.webApiUrl;return n}t.prototype.start=function(){var e=this;this.updateState(0);var t=y.enqueue(function(){e.error=void 0;e.updateState(1);return e._upload().then(function(){e.updateState(2)},function(t){var n;n=t instanceof d.e?t:new d.e({message:t&&t.message||"",errorType:p.e.general});e.error=n;e.updateState(4);return i.n.reject(t)})});this._uploadPromise=t;return t};t.prototype.abort=function(){var e=this;if(2!==this.state){this.error=null;this.updateState(3);var t=this._uploadPromise;this._uploadPromise=void 0;if(t){t.cancel();t.then(function(){},function(){}).done(function(){return e._cancelChunkUpload()})}}};t.prototype.restart=function(){var e,t=this,n=this._uploadPromise;this._uploadPromise=void 0;if(n){n.cancel();e=n.catch(function(){return t._cancelChunkUpload().catch(function(){})})}else e=i.n.resolve();e.done(function(){t.start()})};t.prototype._upload=function(){var e,t=this;this.uploadedBytes=0;var n=this._fileUpload.size;if(n<=25165824)e=this._sendSingleRequestUpload();else{this._maxUploadRequestDuration=15e4;e=this._sendStreamingUpload()}return e.then(function(e){t.uploadedBytes=n;t.item=e})};t.prototype._createUploadError=function(e){var t,n,r,i;if("string"==typeof e)r=String(e);else{t=this._getErrorCode(e);n=e.status;r="string"==typeof e.message?String(e.message):e.message.value}switch(t){case-2130575257:i=p.e.conflict;break;case-1:i=p.e.disconnected;break;case-2130575245:i=p.e.invalidName;break;case-2130246326:i=p.e.versionMismatch;break;case-2147023080:case-2130575282:i=p.e.overQuota;break;default:switch(n){case 401:i=p.e.authFailure;break;case 404:i=p.e.targetFolderMissing;break;case 403:case 429:i=p.e.accessDenied;break;case 409:i=p.e.conflict;break;case 412:i=p.e.versionMismatch;break;case 415:i=p.e.emptyFileOrFolder;break;case 423:i=p.e.lockMismatch;break;case 507:i=p.e.overQuota;break;default:r?i||(i=p.e.other):i=p.e.general}}return new d.e({message:r,errorType:i,allowRename:this.allowRename,supportsVersioning:this.supportsVersioning})};t.prototype._getErrorCode=function(e){var t=e.code;return(void 0===t?"":t).split(",").map(function(e){return Number(e)})[0]};t.prototype._getUploadFileUrl=function(){var e=this._uniqueId,t=this._serverRelativeItemUrl,n=this._webApiUrl;n=e?n.method("GetFolderById",e):E(n,{serverRelativeItemUrl:t,isFolder:!0});var r=this._fileUpload.name,i=1===this.nameConflictBehavior;n=n.segment("Files").methodWithAliases("AddUsingPath",{DecodedUrl:r,overwrite:i,AutoCheckoutOnInvalidData:!0});var s="ListItemAllFields";this._expandAllItemFields&&(s+="/ContentType/Fields");s&&(n=n.oDataParameter("$Expand",s));return n.toString()};t.prototype._isConflictFile=function(){var e=this;if(1===this.nameConflictBehavior)return i.n.resolve(!1);var t=this._serverRelativeItemUrl,n=this._webApiUrl;n=(n=E(n,{serverRelativeItemUrl:t,isFolder:!0})).segment("Files").oDataParameter("$filter","Name eq '"+f.e.encodeRestUriStringToken(this._fileUpload.name)+"'");return this._dataRequestor.getData({noRedirect:!0,url:n.toString(),qosName:"SingleFileUploader.GetFile",authToken:this._authToken,parseResponse:function(t){var n=JSON.parse(t);return!!(n&&n.d&&n.d.results&&n.d.results.length>0)&&!(n.d.results[0].Exists&&e._streamingChunkNumber>0)}}).then(function(e){return e},function(e){return!!i.n.isCanceled(e)&&i.n.reject(e)})};t.prototype._processUploadCompleteResponse=function(e){return this._getItemFromResponse(e)};t.prototype._getItemFromResponse=function(e){var t;try{var n=JSON.parse(e).d,r=this._targetItemKey,i=void 0;n.ListItemAllFields&&n.ListItemAllFields.Id&&(i=String(n.ListItemAllFields.Id));var s=!1;if(n.ListItemAllFields&&n.ListItemAllFields.ContentType&&n.ListItemAllFields.ContentType.Fields&&n.ListItemAllFields.ContentType.Fields.results){var o=n.ListItemAllFields.ContentType.Fields.results.filter(function(e){return e.Required});if(o.length>0)for(var u=0,f=o;u<f.length;u++){var h=f[u];if(!n.ListItemAllFields[h.InternalName]){s=!0;break}}}var p=void 0;n.UniqueId&&(p=a.e.normalizeLower(n.UniqueId));var d=n.Name,v=c.t(d);t={key:r,parentKey:this._parentItemKey,type:l.t.File,id:n.ServerRelativeUrl,name:d,displayName:d,extension:v,properties:{ID:i,uniqueId:p},itemFromServer:n,hasMissingMetadata:s}}catch(e){}return t};t.prototype._generateChunkPostUrl=function(e,t){var n,i=this._fileUpload,s=this._uniqueId,o=i.size<=t,u=this._serverRelativeItemUrl,a=this._webApiUrl,f={uploadId:{guid:this._uploadId}};if(0===this._chunkNumber&&0===this._streamingChunkNumber){n="StartUpload";a=(a=s?a.method("GetFolderById",s):E(a,{serverRelativeItemUrl:u,isFolder:!0})).segment("Files");a=1===this.nameConflictBehavior?a.methodWithAliases("GetByPathOrAddStub",{DecodedUrl:i.name}):a.methodWithAliases("AddStubUsingPath",{DecodedUrl:i.name})}else{n=o?"FinishUpload":"ContinueUpload";a=E(a,{serverRelativeItemUrl:u+"/"+i.name,isFolder:!1});f=Object(r.__assign)(Object(r.__assign)({},f),{fileOffset:e})}return(a=a.methodWithAliases(n,f)).toString()};t.prototype._getUploadStatus=function(){var e=this._fileUpload,t=this._uploadId,n=this._serverRelativeItemUrl,r=this._webApiUrl;r=r.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:n+"/"+e.name}).methodWithAliases("GetUploadStatus",{uploadId:{guid:t}});return this._dataRequestor.getData({noRedirect:!0,url:r.toString(),authToken:this._authToken,qosName:"SingleFileUploader.GetUploadStatus",method:"GET"}).then(function(e){if(e.d&&e.d.ExpectedContentRange){return parseInt(e.d.ExpectedContentRange.split("-")[0],10)}return i.n.reject(new Error("No expected range from server response."))})};t.prototype._uploadFragment=function(e,t){var n=this;void 0===e&&(e=0);void 0===t&&(t=3);var r=this._fileUpload.size,s=Math.min(this._currentChunkSize+e,r);this._uploadId||(this._uploadId=a.e.generate());var o=Date.now();return this._sendFileData({url:this._generateChunkPostUrl(e,s),qosName:"SingleFileUploader.SendFileRequest",data:this._fileUpload.slice(e,s),offset:e,length:s-e}).then(function(e){n.uploadedBytes=s;if(s<r){n._chunkNumber++;Date.now()-o<6e4&&(n._currentChunkSize=Math.min(Math.floor(n._currentChunkSize*Math.pow(2,1/4)),62914560));return n._uploadFragment(s)}return n._processUploadCompleteResponse(e)},function(r){if(i.n.isCanceled(r))return i.n.reject(r);if(-2===n._getErrorCode(r)){if(n._currentChunkSize>262144){n._currentChunkSize=Math.max(Math.floor(n._currentChunkSize/2),262144);var s=void 0;0===n._chunkNumber&&(s=n._cancelChunkUpload());return i.n.resolve(s).then(function(){return n._uploadFragment(e)})}}else if(t>0&&n._canRetry(r)){var o,a=new u.e(function(){o&&n._async.clearTimeout(o)});o=n._async.setTimeout(function(){return a.complete()},1e3);return a.getPromise().then(function(){return n._uploadFragment(e,t-1)})}return i.n.reject(n._createUploadError(r))})};t.prototype._sendSingleRequestUpload=function(){var e=this;return this._isConflictFile().then(function(t){if(t){var n=new d.e({message:"",errorType:p.e.conflict});return i.n.reject(n)}return e._fileUpload.slice(0,e._fileUpload.size)}).then(function(t){return e._sendFileData({url:e._getUploadFileUrl(),qosName:"SingleFileUploader.UploadFile",data:t,offset:0,length:t.size}).then(function(t){return e._processUploadCompleteResponse(t)}).then(function(e){return e},function(t){if(i.n.isCanceled(t))return i.n.reject(t);if(-2===e._getErrorCode(t)){e.nameConflictBehavior=1;return e._uploadFragment()}return i.n.reject(e._createUploadError(t))})})};t.prototype._sendStreamingUpload=function(e,t){var n=this;void 0===e&&(e=0);void 0===t&&(t=3);this._uploadId||(this._uploadId=a.e.generate());var r=this._fileUpload.size,s=this._streamingChunkNumber>0?Math.min(this._currentStreamingChunkSize+e,r):0;return this._isConflictFile().then(function(t){if(t){var r=new d.e({message:"",errorType:p.e.conflict});return i.n.reject(r)}return n._fileUpload.slice(e,s)}).then(function(o){return n._sendFileData({url:n._generateChunkPostUrl(e,s),qosName:"SingleFileUploader.SendFileRequest",data:o,offset:e,length:o.size}).then(function(e){n.uploadedBytes=s;if(s<r){n._streamingChunkNumber++;return n._sendStreamingUpload(s,t)}return n._processUploadCompleteResponse(e)},function(r){if(i.n.isCanceled(r))return i.n.reject(r);if(-2===n._getErrorCode(r)){if(n._currentStreamingChunkSize<=1048576)return i.n.reject(n._createUploadError(r));n._currentStreamingChunkSize=n._currentStreamingChunkSize/2;return n._sendStreamingUpload(e,t)}return n._getUploadStatus().then(function(e){return n._sendStreamingUpload(e,b?t-1:3)},function(e){if(t>0&&n._canRetry(r)){var s,o=new u.e(function(){s&&n._async.clearTimeout(s)});s=n._async.setTimeout(function(){return o.complete()},1e3);return o.getPromise().then(function(){return n._sendStreamingUpload(0,t-1)})}return i.n.reject(n._createUploadError(r))})})})};t.prototype._canRetry=function(e){var t;switch(this._getErrorCode(e)){case-2130575257:case-2130575142:t=!1;break;default:t=!0}return t};t.prototype._cancelChunkUpload=function(){var e=this._uploadId;this._uploadId=void 0;this._chunkNumber=0;if(e){var t=this._fileUpload,n=this._serverRelativeItemUrl,r=this._webApiUrl;r=(r=E(r,{serverRelativeItemUrl:n+"/"+t.name,isFolder:!1})).methodWithAliases("CancelUpload",{uploadId:{guid:e}});return this._dataRequestor.getData({noRedirect:!0,url:r.toString(),authToken:this._authToken,qosName:"SingleFileUploader.CancelUploadSession"}).then(function(){})}return i.n.resolve()};t.prototype._sendFileData=function(e){var t,n,r,i=this,s=e.url,o=e.qosName,a=e.data,f=e.offset,l=e.length,c=new u.e(function(){t.cancel()}),h=function(e){var t=i._chunkNumber>0&&f+l>=i._fileUpload.size?3e5:1e4,r=Math.max(.08*e,t);n&&i._async.clearTimeout(n);e&&(n=i._async.setTimeout(function(){c.error({code:"-1",message:""})},r))},p=Date.now(),d=Date.now(),v=0,m=0,g=0,y=this._async.debounce(function(e){if(e>i.uploadedBytes){i.uploadedBytes=e;i._onProgress&&i._onProgress(e)}},100,{leading:!1});t=this._dataRequestor.getData({url:s,noRedirect:!0,authToken:this._authToken,qosName:o,parseResponse:function(e){return e},contentType:"application/octet-stream",additionalPostData:a,onUploadProgress:function(e){if(e.lengthComputable){var t=Date.now();m+=(e.loaded-v)/(t-d);g++;r=e.loaded/(t-p);d=t;v=e.loaded;y(f+e.loaded);h(l-e.loaded)}}});h(l);var b=this._async.setInterval(function(){if(g){Date.now()-p+(l-v)/((m+r)/(g+1))>i._maxUploadRequestDuration&&v<l&&c.error({code:"-2",message:""})}},1e4);t.done(function(e){c.complete(e)},function(e){c.error(e)});c.getPromise().done(function(){n&&i._async.clearTimeout(n);b&&i._async.clearInterval(b)},function(){t.cancel();n&&i._async.clearTimeout(n);b&&i._async.clearInterval(b)});return c.getPromise()};return t})(g);function E(e,t){var n=t.serverRelativeItemUrl,r=t.isFolder;return e=e.methodWithAliases(r?"GetFolderByServerRelativePath":"GetFileByServerRelativePath",{DecodedUrl:n})}},"3436":function(e,t,n){"use strict";n.d(t,"e",function(){return v});var r=n(0),i=n(435),s=n(60),o=n(3683),u=n(65),a=n(141),f=n(910),l=n(75),c=n(1112),h=n(1481),p=n(29),d=n(147),v=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,{dataSourceName:"SuiteNavDataSource"},n)||this;r._suiteNavContext=t.suiteNavContext;r._suiteNavDataUpdater=t.suiteNavDataUpdater;r._suiteNavDataSourceBasic=t.suiteNavDataSourceBasic?t.suiteNavDataSourceBasic:new c.e(t,n);return r}t.prototype.getCapabilities=function(){return this._suiteNavDataSourceBasic.getCapabilities()};t.prototype.getReactShellBootstrapperUrl=function(){return this._suiteNavDataSourceBasic.getReactShellBootstrapperUrl()};t.prototype.getInitialRenderNavBarData=function(){return this._suiteNavDataSourceBasic.getInitialRenderNavBarData()};t.prototype.getCacheToken=function(){return this._suiteNavDataSourceBasic.getCacheToken()};t.prototype.getUserIdentifier=function(){return this._suiteNavDataSourceBasic.getUserIdentifier()};t.prototype.getWebTemplateType=function(){var e;return Number((null===(e=this._pageContext)||void 0===e?void 0:e.webTemplate)||d.t.invalid)};t.prototype.setFeedbackMetadata=function(e,t){var r=this._suiteNavContext.feedbackOptions;if(r&&r.appId){e=e||{contentLanguage:void 0,source:"OneShell",options:{telemetryGroup:{}}};var i=a.n.isFeatureEnabled({ODB:f.r?-1246:1246,ODC:null,Fallback:!1}),s=e.options;s.appId=r.appId;s.disableIncludeScreenshot=!i;s.userVoiceEnabled=r.userVoiceEnabled;s.userVoiceLink=r.userVoiceLink;if(!l.e.isActivated("A12253B9-7F27-4C11-BFC9-3E7688B5CE1E","9/14/20","Ensure appData in feedback options")){s.applicationGroup||(s.applicationGroup={});s.applicationGroup.appData||(s.applicationGroup.appData="{}")}var o=s.telemetryGroup;o.audienceGroup=this._getAudienceGroup();o.featureArea=this._getFeatureArea();o.processSessionId=this._pageContext.CorrelationId;i&&t&&n.e("459").then(n.t.bind(null,3733,7)).then(function(e){(e.default||e)(document.body).then(function(e){t(e.toDataURL("image/jpeg"))})})}return e};t.prototype.loadData=function(e){var t=this;if(!e&&this._dataPromise)return this._dataPromise;var n,r=u.e.escapeUrlForCallback(this._pageContext.currentUICultureName),s=Object(i.n)(this._pageContext),o=s?u.e.escapeUrlForCallback(s):"",a=o+"/_layouts/15/online/handlers/SpoSuiteLinks.ashx?Locale="+r+"&v=2&msajax=1&cv=2",f=o+"/_api/Microsoft.SharePoint.Portal.SuiteNavData.GetSuiteNavData?v=2&Locale="+r,l=function(e){return t.getData(function(){return e},function(e){return JSON.parse(e)},"LoadData",null,"POST",null,null,1).then(function(n){var r=e===a?n:JSON.parse(n.d.GetSuiteNavData),i={suiteNavData:r.NavBarData,suiteNavContext:t._suiteNavContext,pageContext:t._pageContext},s=t._suiteNavDataUpdater?t._suiteNavDataUpdater.updateSuiteNavData(i):r.NavBarData,o=!(!s.HasTenantBranding||!r.TenantPrimaryColorShades&&!s.TenantLogoUrl);s.AppBrandTheme=Object(c.n)(t._suiteNavContext);return{data:s,jsUrl:r.JsUrl,cssUrl:r.CssUrl,hasCobranding:o,userIdentifier:t.getUserIdentifier(),cacheToken:t.getCacheToken()}})};n=this._pageContext.isSPO?l(a).catch(function(){return l(f)}):l(f);this._dataPromise=n;n.catch(function(){t._dataPromise=null});return n};t.prototype.getSuiteNavContext=function(){return this._suiteNavContext};t.prototype.onCssLoad=function(e){if(e.data&&e.data.ClientData)try{var t=JSON.parse(e.data.ClientData);t&&t.IsFallbackShell&&Object(o.e)()}catch(e){}};t.prototype.updateDataForCurrentPage=function(e){var t={suiteNavData:e,suiteNavContext:this._suiteNavContext,pageContext:this._pageContext};return this._suiteNavDataUpdater.updateSuiteNavData(t)};t.prototype._getAudienceGroup=function(){var e,t=this._pageContext;"prodbubble"===t.env&&"MSIT_SPDF_1_Content"===t.farmLabel?e="Dogfood":"prodbubble"===t.env?e="Microsoft":"prod"!==t.env&&"dprod"!==t.env||(e="Production");return e};t.prototype._getFeatureArea=function(){var e=this._pageContext;return e.listBaseTemplate===p.t.genericList?"List":e.listBaseTemplate===p.t.documentLibrary?"Libraries":e.listBaseTemplate===p.t.webPageLibrary?"Modern Pages and News Authoring (Floodgate)":"Site"};t.siteSettingsPermissions=[s.e.enumeratePermissions,s.e.manageWeb,s.e.manageSubwebs,s.e.addAndCustomizePages,s.e.applyThemeAndBorder,s.e.manageAlerts,s.e.manageLists,s.e.viewUsageData];return t})(h.e)},"3680":function(e,t,n){"use strict";n.d(t,"e",function(){return l});var r,i=n(0),s=n(94),o=n(75),u=n(1562),a=n(180),f=n(1332);(function(e){e.odbFirstRun="sharePointOneDriveBusinessFirstRun";e.filtersPaneFirstRun="sharePointFiltersPaneFirstRun";e.teamsTeachingBubble="sharePointTeamsTeachingBubble";e.librariesFirstRun="sharePointLibrariesFirstRun";e.listsFirstRun="sharePointListsFirstRun";e.modernDocSetsFirstRun="sharePointModernDocSetsFirstRun"})(r||(r={}));var l=(function(e){Object(i.__extends)(t,e);function t(t,n){var r=e.call(this,{dataSourceName:"UserInfo",id:"UserInfo"},n)||this,i=r._pageContext,s=n.itemUrlHelper||new a.e({},{pageContext:i});r.apiUrlHelper=n.apiUrlHelper||new f.e({},{pageContext:i,itemUrlHelper:s});r._additionalHeaders={"X-ClientType":"SharePointFirstRunUserFlag"};return r}t.prototype.getUserFlagValue=function(e){var t=this;if(o.e.isActivated("AC6676C2-EA2E-4FFE-AAEA-E36483FB5552","03/29/2020","Disable Firstrun check"))return s.n.resolve(!0);if(!this._pageContext.userLoginName&&!this._pageContext.aadUserId)return s.n.resolve(!0);if(this._pageContext.isAnonymousGuestUser||this._pageContext.isEmailAuthenticationGuestUser||this._pageContext.isExternalGuestUser)return s.n.resolve(!0);var n={url:this._getApiUrl()+"&$select="+e,qosName:"GetUserFlag",method:"GET",cacheRequestKey:e};return this.getDataUtilizingLegacyCache(Object(i.__assign)({onlyCache:!0,useStale:!0},n)).then(function(r){return r||t.getDataUtilizingLegacyCache(Object(i.__assign)(Object(i.__assign)({},n),{additionalHeaders:Object(i.__assign)({},t._additionalHeaders),parseResponse:function(t){var n=JSON.parse(t);if(n&&n.d&&void 0!==n.d[e])return!!n.d[e];throw new Error("Response did not contain flag: "+e)}}))}).catch(function(){return null})};t.prototype.setUserFlagValue=function(e,t){var n;return this.getDataUtilizingLegacyCache({url:this._getApiUrl(),qosName:"SetUserFlag",additionalPostData:JSON.stringify((n={},n[e]=t,n)),method:"POST",additionalHeaders:Object(i.__assign)({"X-HTTP-Method":"PATCH",Accept:"application/json; odata=minimalmetadata"},this._additionalHeaders),contentType:"application/json; odata=minimalmetadata",cacheRequestKey:e,bypassCache:!0,parseResponse:function(){return t}})};t.prototype._getApiUrl=function(){return this.apiUrlHelper.build().segment("SP.Directory.DirectorySession").methodWithAliases("User",this._pageContext.aadUserId?{id:this._pageContext.aadUserId}:{principalName:this._pageContext.userLoginName}).toString()};return t})(u.e)},"3684":function(e,t,n){"use strict";var r=n(1775);n.d(t,"e",function(){return r})},"3696":function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(2239),i=(function(){function e(e){this._dataSource=e.sharingDataSource||new r.n({getParentListId:e.getParentListId,pageContext:e.pageContext});this._itemProvider=e.itemProvider}e.prototype.getSharingInformation=function(e,t,n,r,i){return this._dataSource.getSharingInformation(e,t,n,r,i)};e.prototype.shareLink=function(e){var t=this;return this._dataSource.shareLink(e).then(function(n){t._invalidateItem(e.items[0]);return n})};e.prototype.unshareLink=function(e){var t=this;return this._dataSource.unshareLink(e).then(function(n){t._invalidateItem(e.item);return n})};e.prototype.updatePermissions2=function(e,t,n){var r=this;return this._dataSource.updatePermissions2(e,t,n).then(function(e){r._invalidateItem(t);return e})};e.prototype.updatePermissionsMultiple=function(e,t,n,r,i){var s=this;return this._dataSource.updatePermissionsMultiple(e,t,n,r,i).then(function(e){s._invalidateItem(t);return e})};e.prototype.getClientId=function(){return this._dataSource.getClientId()};e.prototype.parseRawSharingInformation=function(e){return this._dataSource.parseRawSharingInformation(e)};e.prototype.emailWithoutPermissioning=function(e,t,n,r){return this._dataSource.emailWithoutPermissioning(e,t,n,r).then(function(e){return e})};e.prototype.checkPermissions=function(e,t){return this._dataSource.checkPermissions(e,t)};e.prototype.share=function(e,t,n){return this._dataSource.share(e,t).then(function(e){return e})};e.prototype.setAddressBarLinkCapability=function(e,t){return this._dataSource.setAddressBarLinkCapability(e,t)};e.prototype._invalidateItem=function(e){this._itemProvider&&e&&e.parent&&e.parent.key&&this._itemProvider.invalidateItem(e.parent.key)};return e})()}}]);