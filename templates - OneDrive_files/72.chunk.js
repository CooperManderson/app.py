(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["72"],{"1480":function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.File=0]="File";e[e.Folder=1]="Folder";e[e.Media=2]="Media";e[e.OneNote=3]="OneNote";e[e.Unknown=4]="Unknown";e[e.Error=5]="Error";e[e.App=6]="App";e[e.Subsite=7]="Subsite";e[e.Shortcut=8]="Shortcut"})(r||(r={}));t.t=r},"1840":function(e,t,n){"use strict";var r=n(0),i=n(94),s=n(1470),o=n(387),u=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._getModule=t.getModule;n._path=t.path;n._getExecutorParams=t.getExecutorParams;n._bundleLoader=n.resources.consume(o.e);n._bundleLoader.queueLoad(n._path,n._getModule).done();return n}t.prototype.execute=function(e,t){var n=this;return this._path?this._loadExecutorType().then(function(r){return"function"!=typeof r?i.n.wrapError(new Error("Cannot create action from "+r+": "+n._path)):i.n.as(n._getExecutorParams()).then(function(s){var o=new(n.resources.injected(r))(s);return i.n.as(o.execute(e,t))})}):i.n.wrapError(new Error("Cannot create action from nothing: "+this._path))};t.prototype._loadExecutorType=function(){var e=this._bundleLoader.loadNow(this._path,this._getModule);this._loadExecutorType=function(){return e};return e};return t})(s.n);t.e=u},"1856":function(e,t,n){"use strict";var r=n(0),i=n(1840),s=(function(e){Object(r.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._loader=new(n.managed(i.e))({path:n.getExecutorPath(),getModule:n.getModuleFactory(),getExecutorParams:function(){return n.selectionHelper.resolveSelection().then(function(e){return n.getExecutorParameters({selection:e})})}});return n}t.prototype.onExecute=function(e,t){return this._loader.execute(e,t)};return t})(n(1949).e);t.e=s},"1949":function(e,t,n){"use strict";var r=n(0),i=n(1484),s=n(1590),o=n(1491),u=(function(e){Object(r.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.itemCommandHelper=new(n.managed(s.e));n.selectionHelper=new(n.child(o.e))(Object(r.__assign)(Object(r.__assign)({},n.getSelectionOptions()),{overrideItem:t.item}));return n}t.prototype.getSelectionOptions=function(){return{}};return t})(i.e);t.e=u},"2147":function(e,t,n){"use strict";n.d(t,"n",function(){return i});n.d(t,"e",function(){return s});n.d(t,"t",function(){return o});var r=n(1660),i=new r.e("upload"),s=new r.e("download"),o=new r.e("sync")},"2796":function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(913),i=n(1480),s=n(171),o=n(29);function u(e,t,n){if(e.type===i.t.OneNote)return!1;if(e.list||e.subsite)return!1;return!(!s.e.isFeatureEnabled({ODB:831,ODC:"UseDownloadMicroservice"})||n||!e.urls[r.e.downloadAsZip]||!e.urls[r.e.itemUrl]||0===e.childCount||e.type!==i.t.Folder)||!e.isRootFolder&&(!!t&&((!t||!t.list||t.list.templateType!==o.n.webPageLibrary)&&(e.type===i.t.File||e.type===i.t.Media||e.type===i.t.Unknown)))}},"3498":function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(94),s=n(1856),o=n(797),u=n(796),a=n(1495),f=n(231),l=n(913),c=n(327),h=n(2796),p=n(1590),d=n(2147),v=n(1760),m=n(60),g=(function(e){Object(r.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="Download";n._urlDataSource=n.resources.consume(c.me);n._currentItem=n.resources.consume(o.s);n._itemParentHelper=n.resources.consume(a.e);n._itemCommandHelper=n.resources.consume(p.t);return n}t.prototype.getExecutorPath=function(){return"./DownloadExecutor"};t.prototype.getModuleFactory=function(){return function(){return i.n.resolve(n.e("73").then(n.bind(null,3611)))}};t.prototype.getSelectionOptions=function(){var e=Object(u.isFeatureEnabled)(u.DownloadAsZip);return{allowMultiSelect:e,canFallback:e}};t.prototype.getExecutorParameters=function(){return{selectionHelper:this.selectionHelper,currentItem:this._currentItem.peek(),actionName:this.name}};t.prototype.onIsAvailable=function(){var e=this,t=this._currentItem();if(!t)return!1;var n=this._urlDataSource.getKeyParams(t.key),r=this._urlDataSource.getQueryType(n);if(this._urlDataSource.isRecycleBin(r))return!1;var i=this.selectionHelper.selection(),s=i&&i.length>1;if(s&&(!Object(u.isFeatureEnabled)(u.DownloadAsZip)||i[0]&&i[0]&&i[0].peek()&&!i[0].peek().urls[l.t.itemUrl]||!i[0].peek().urls[l.t.downloadAsZip]))return!1;var o=i.filter(function(t){return t&&e._canDownloadItem(t)}),a=o.length,c=o.filter(function(e){return e&&e.peek().urls[l.t.itemUrl]&&e.peek().urls[l.t.itemUrl]});return!(s&&c&&a>c.length)&&(a>1||a&&(!!this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(o[0].peek(),"list"))||o[0].peek().type===f.e.Folder))};t.prototype._canDownloadItem=function(e){var t=e();if(3===t.itemStatus||4===t.itemStatus)return!1;if(!m.e.hasItemPermission(t,m.e.openItems))return!1;var n=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(t,"list"));return this._itemCommandHelper.isCommandSupported(t,d.e)&&h.e(Object(v.n)(t),Object(v.n)(n),!1)};return t})(s.e);t.default=g}}]);