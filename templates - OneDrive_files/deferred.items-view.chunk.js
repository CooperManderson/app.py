(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["deferred.items-view"],Array(1286).concat([function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(5),i=n(410),s=new r.e("spSharedByMePage",{itemSet:Object(r.o)(i.t),after:Object(r.s)()})}],Array(77),[function(e,t,n){"use strict";n.r(t);n.d(t,"spItemUploadItemsOperationHandler",function(){return y});var r=n(0),i=n(44),s=n(104),o=n(2969),u=n(11),a=n(111),f=n(1976),l=n(2),c=n(71),h=n(8),p=n(159),d=n(3453),v=n(129),m=n(146),g=n(1),y=Object(u.i)({mergeForSameItemKey:!1,maxParallelOperationCount:3,timeout:864e5})(function(e){var t=this,n=e.itemKey,u=e.options.sourceEntries,y=i.e.deserialize(n),b=y.webAbsoluteUrl,w=y.listFullUrl,E=Object.keys(u)[0],S=u[E].progressItemKey;return function(i){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,u,x,T,N,C,k,L,A,O;return Object(r.__generator)(this,function(M){switch(M.label){case 0:t=i(Object(a.e)({sourceFile:f.t},E)).sourceFile;u=i(Object(m.e)({listItemUploader:g.qe})).listItemUploader,x=void 0===u?o.e:u;return[4,i(x(e))];case 1:T=M.sent().itemKey;N=new p.e;S&&t&&N.resolveItems({items:(L={},L[S]=Object(r.__assign)(Object(r.__assign)({},c.s.pack({itemKey:T})),Object(l.n)({progressSize:c.m},{progressSize:{current:t.size}})),L)});N.invalidateItems({items:(A={},A[n]=[h.t],A)});if(y.listFullUrl){C=new v.e(y.listFullUrl+"/Forms").path;if(y.rootFolder&&(y.rootFolder+"/").slice(0,C.length+1)===C+"/"){k=s.e.serialize({webAbsoluteUrl:b,listFullUrl:w});i(Object(d.e)({items:(O={},O[k]={childItemKey:T},O)}))}}i(N.execute());return[2]}})})}})},function(e,t,n){"use strict";n.r(t);n.d(t,"spItemCreateFolderOperationHandler",function(){return x});n.d(t,"getCreateFolderUrl",function(){return T});var r=n(0),i=n(129),s=n(44),o=n(104),u=n(1),a=n(121),f=n(223),l=n(324),c=n(111),h=n(158),p=n(1198),d=n(11),v=n(71),m=n(8),g=n(6),y=n(786),b=n(233),w=n(37),E=n(146),S=n(3441),x=Object(d.i)({mergeForSameItemKey:!1,maxParallelOperationCount:8})(function(e){var t=this,n=e.itemKey,d=e.options.folders;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,y,b,E,x,C,k,L,A,O,M,_,D,P,H,B,j;return Object(r.__generator)(this,function(F){switch(F.label){case 0:t=Object.keys(d)[0];y=d[t],b=y.progressItemKey,E=y.conflictResolution;x=s.e.deserialize(n);C=x.rootFolder||new i.e(x.listFullUrl).path;k=o.e.serialize({webAbsoluteUrl:x.webAbsoluteUrl,listFullUrl:x.listFullUrl});L=e(Object(c.e)({list:u.Be},k));A=Object(S.mapConflictResolutionToNameConflictBehavior)(E);O=T({webAbsoluteUrl:x.webAbsoluteUrl,listFullUrl:x.listFullUrl,parentFolderPath:C,isDocLib:!!L&&!!L.list&&L.list.isDocumentLibrary,folderName:t,nameConflictBehavior:A});return[4,e(Object(a.t)({webAbsoluteUrl:x.webAbsoluteUrl,listFullUrl:x.listFullUrl,url:O,method:"POST",qosName:"createFolder",parseResponse:function(e){var t;try{return null===(t=JSON.parse(e))||void 0===t?void 0:t.d}catch(e){}},telemetryHandler:function(e){var t=e.errorData,n=e.eventData;if(t){var i=t.code,s=i&&(i.indexOf("-2130575257")>-1||i.indexOf("-2130575245")>-1||i.indexOf("-2130247139")>-1)?w.t.expectedFailure:w.t.failure;return{eventData:Object(r.__assign)(Object(r.__assign)({},n),{resultType:s})}}return{eventData:n}}})).catch(function(t){if(t instanceof f.e&&t.message&&C){var n=C;"/"===n[0]&&(n=n.substr(1));"/"!==n[n.length-1]&&(n+="/");t.message=t.message.replace(n,"")}throw new l.e({innerError:t,facets:e(N(t))})})];case 1:M=F.sent();if(b){_=null===(j=M)||void 0===j?void 0:j.Name;D=C+"/"+_;P=s.e.serialize({webAbsoluteUrl:x.webAbsoluteUrl,listFullUrl:x.listFullUrl,rootFolder:D});e(Object(h.e)({items:(H={},H[b]=Object(r.__assign)(Object(r.__assign)({},v.s.pack({itemKey:P})),_&&t!==_?g.l.pack(_):{}),H[P]=Object(r.__assign)(Object(r.__assign)({},u.le.pack(D)),g.A.pack({itemKey:n})),H)}))}e(Object(p.e)({items:(B={},B[n]=[m.t],B)}));return[2]}})})}});function T(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,i=e.parentFolderPath,s=e.isDocLib,o=void 0===s||s,u=e.folderName,a=e.nameConflictBehavior,f=Object(y.r)({webAbsoluteUrl:t,listOrItemFullUrl:n}),l=u?u.trim():"";return(f=o?(f=f.segment("folders")).methodWithAliases("AddUsingPath",Object(r.__assign)({DecodedUrl:i+"/"+l,overwrite:!1},2===a?{EnsureUniqueFileName:!0}:{})).oDataParameter("$Expand","ListItemAllFields/PermMask"):f.methodWithAliases("GetFolderByServerRelativePath",{DecodedUrl:i}).methodWithAliases("AddSubFolderUsingPath",{DecodedUrl:l||"Folder"+(Math.floor(100*Math.random())+1)})).toString()}function N(e){return function(t){if(e instanceof f.e){switch((function(e){var t=e.errorData.code;return(void 0===t?"":t).split(",").map(function(e){return Number(e)})[0]})(e)){case Number("-2130575257"):var n=t(Object(E.e)({enableRenameOnUploadConflict:u.J})).enableRenameOnUploadConflict;if(n)return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},b.v.pack({})),b.t.pack(!!n)),b.n.pack(!1)),b.i.pack({supportsRename:!!n}));break;case-2147023080:case-2130575282:return b.g.pack({})}}}}},function(e,t,n){"use strict";n.r(t);n.d(t,"spItemCreateDocumentOperationHandler",function(){return o});var r=n(0),i=n(11),s=n(2976);n.d(t,"getCreateDocumentUrl",function(){return s.e});n.d(t,"getRedirectUrlFromResponse",function(){return s.t});var o=Object(i.i)({mergeForSameItemKey:!1,maxParallelOperationCount:4})(function(e){var t=this;return function(i){return Object(r.__awaiter)(t,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("30")]).then(n.bind(null,3737))];case 1:return[4,(0,t.sent().createDocumentsCore)(i,e)];case 2:t.sent();return[2]}})})}})}],Array(19),[function(e,t,n){"use strict";n.r(t);n.d(t,"getNeedsAttentionView",function(){return p});var r=n(0),i=n(391),s=n(563),o=n(29),u=n(308),a=n(111),f=n(1),l=n(104),c=n(171),h=n(841);function p(e,t,n){var p=l.e.serialize({webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl}),d=n(Object(a.e)({list:f.Be},p)),v=d&&d.list&&d.list.templateType&&Object(o.s)(d.list.templateType),m=v?"LinkTitle":"LinkFilename",g={},y=[];if(e)for(var b=0,w=e;b<w.length;b++){var E=w[b];if(E.contentTypeId&&E.requiredFields&&E.requiredLookups){for(var S={fieldName:"ContentTypeId",operator:"Eq",values:[E.contentTypeId]},x=s.e(S),T=[],N=E.requiredFields.split(","),C=E.requiredLookups.split(","),k=0;k<N.length;k++){var L=N[k],A="True"===C[k];void 0===g[L]&&(g[L]=A);var O={fieldName:L,lookupId:!!A||void 0,operator:"Eq",values:[""]};T.push(O)}var M=s.t(T,"Or");if(M){var _=s.t([x,M],"And");y.push(_)}}}0===y.length&&y.push(s.e({fieldName:"FileLeafRef",operator:"Eq",values:[""]}));var D=Object.keys(g),P=D.map(function(e){return g[e]}),H=Object(r.__spreadArrays)(["DocIcon",m,"Editor","Modified"],D,["FileDirRef"]),B=Object(r.__spreadArrays)([void 0,void 0,void 0,void 0],P,[void 0]),j=!!d&&!!d.list&&!!d.list.templateType&&d.list.templateType===o.n.webPageLibrary,F=new i.e("<View Scope='Recursive'/>");j&&c.e.isFeatureEnabled({ODB:1743})?F.title=u.e.PagesThatNeedAttention:F.title=v?u.e.ItemsThatNeedAttention:u.e.FilesThatNeedAttention;F.isReadOnly=!0;F.id=h.e;F.replaceFields(H,B);F.updateSort({fieldName:"ID",isAscending:!0});F.updateRowLimit({rowLimit:30,isPerPage:!0});var I=s.t(y,"Or");F.addFilters([I]);return F}},function(e,t,n){"use strict";n.r(t);n.d(t,"getListRootFolder",function(){return o});var r=n(0),i=n(121),s=n(786);function o(e){var t=this,n=e.webAbsoluteUrl,o=e.listFullUrl,u=e.qosName;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=Object(s.e)({webAbsoluteUrl:n,listFullUrl:o}).segment("RootFolder");return[4,e(Object(i.r)({url:t.toString(),method:"GET",webAbsoluteUrl:n,listFullUrl:o,qosName:"rootFolder."+u,noRedirect:!0}))];case 1:return[2,r.sent()]}})})}}},function(e,t,n){"use strict";n.r(t);n.d(t,"fileHandlerGetItemsOperationHandler",function(){return w});n.d(t,"filehandlerPerExtensionGetItemsOperationHandler",function(){return E});n.d(t,"fetchFileHandlerData",function(){return S});var r=n(0),i=n(11),s=n(1362),o=n(89),u=n(3466),a=n(799),f=n(1623),l=n(1847),c=n(220),h=n(157),p=n(59),d=n(146),v=n(331),m=n(48),g=n(653),y=n(200),b=n(756),w=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=c.t.deserialize(n),s=i.endpoint;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,u;return Object(r.__generator)(this,function(r){t=e(Object(v.e)({name:"getFileHandlersOperation"}));u={endpoint:s};return[2,e(S(i)).then(function(r){if(r){Object(b.e)({driveAppsKey:i,data:r});e(Object(b.n)(r,n));u.fileHandlerRequestEndpoint=r.signature.endpoint;u.accessTokenObtained=!0;e(t({resultType:m.e.Success,extraData:u}))}else e(t({resultType:m.e.Failure,resultCode:"NoFileHandlerData",extraData:u}))}).catch(function(n){o.e.logError(n);e(t({resultType:m.e.Failure,extraData:u}));throw n})]})})}}),E=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=c.e.deserialize(n).endpoint;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(n){switch(n.label){case 0:t=c.t.serialize({endpoint:i});return[4,e(Object(s.e)(function(e){return e.demandItemFacet(h.t,t)}))];case 1:n.sent();return[2]}})})}});function S(e){var t=e.endpoint,n=e.driveId;return function(e){var r,i={endpoint:t,driveId:n},s=e(Object(v.e)({name:"fetchFileHandlerData",extraData:i})),o=e(Object(d.e)({getUserOneDriveEndpoint:p.l,useOneDriveEndpoint:p.C})),c=o.getUserOneDriveEndpoint,h=o.useOneDriveEndpoint,b=Object(a.n)({endpoint:t,driveId:n}),w=new u.e({},{dataRequestor:e(f.e).dataRequestor}),E=Promise.resolve(t);c&&h&&(E=e(c({endpoint:t})));return E.then(function(t){r=t;b=Object(a.n)({endpoint:r});i.fileHandlerRequestEndpoint=r;return e(Object(l.t)(r,b,{qosExtraData:{requestor:"GetFileHandlerData",endPoint:r,driveUrl:b}}))}).then(function(t){i.accessTokenObtained=!!t;return w.getFileHandlerData({accessToken:t,endpoint:r,includePromotedApp:!0,driveId:n}).then(function(t){if(t){var o={data:t,lastModified:Date.now(),signature:{endpoint:r,includePromotedApp:!0,driveId:n}};e(s({resultType:m.e.Success,extraData:i}));return o}e(s({resultType:m.e.Failure,resultCode:"NoDataFromFileHandlerService",extraData:i}))}).catch(function(t){e(s(Object(g.e)({resultType:m.e.Failure,extraData:i},Object(y.e)(t))));throw t})}).catch(function(t){e(s(Object(g.e)({resultType:m.e.Failure,resultCode:"getSessionTokenError",extraData:i},Object(y.e)(t))));throw t})}}},,function(e,t,n){"use strict";n.r(t);n.d(t,"ItemAutoRefresh",function(){return a});n.d(t,"CurrentItemAutoRefresh",function(){return f});var r=n("react-lib"),i=n(25),s=n(34),o=n(3471);function u(e){var t=e.subscribe;r.useLayoutEffect(function(){return t()},[t]);return null}var a=Object(s.t)(function(e,t){var n=t.itemKey,i=e.demandItemFacet(o.e,n),s=o.e.evaluate(i)(e,{itemKey:n,itemSubscriber:null}),a=s.isAvailable,f=s.itemSubscriber,l=s.subscribe;return a?f||(l?r.createElement(u,{subscribe:l}):null):null}),f=Object(i.n)()(a)},,,,,,,,function(e,t,n){"use strict";n.r(t);var r=n(0),i=n("react-lib"),s=n(1458),o=n(3129),u=n(2450),a=n(2506),f=n(23),l=n(275),c=n(3702),h=n(492),p=n(16),d=n(52),v=new p.e("dragLayerPreviewControl",{dragLayerPreviewRenderer:Object(d.e)()}),m=n(199),g=n(28),y=n(26);function b(e){var t=e.draggedItem,n=e.dropEffect,r=t.dragSourceKey,s=t.itemKeys,o=void 0===s?[]:s,u=o[0]||r,a=o.length>0?o.length:r?1:0;if(a<1)return null;var p=Object(f.format)(Object(f.getLocalizedCountValue)("copy"===n?c.e.dragCopyItemsPreviewText:c.e.dragMoveItemsPreviewText,"copy"===n?c.e.dragCopyItemsPreviewTextIntervals:c.e.dragMoveItemsPreviewTextIntervals,a)||"",a),d=1===a?i.createElement(h.t,{itemKey:u,size:20,className:"dragPreviewIcon_7aee6371"}):i.createElement(h.e,{type:l.e.genericFile,size:20,className:"dragPreviewIcon_7aee6371"});return p?i.createElement("div",{className:"dragPreviewRoot_7aee6371"},d||null,i.createElement("span",{className:"dragPreviewText_7aee6371"},p)):null}var w=i.memo(function(e){var t=e.draggedItem,n=e.dropEffect,r=i.useCallback(function(e){var r=e.itemCache;if(!t)return null;var s=Object(g.e)(r,{enableDragDropCopy:y.u}).enableDragDropCopy,o=void 0!==s&&s,u=t.dragSourceKey,a=t.itemKeys,f=a||[u],l=r.demandItemFacet(v,u),c=v.evaluate(l)(r,{itemKeys:f,dragLayerPreviewRenderer:b}).dragLayerPreviewRenderer;return i.createElement(c,{draggedItem:t,dropEffect:o?n:"none"})},[t,n]);return i.createElement(m.e,null,r)}),E=n(3703),S=n(482),x=n(92),T=n(127);n.d(t,"DropTargetHook",function(){return N});n.d(t,"DragSourceHook",function(){return C});n.d(t,"DragDropHook",function(){return O});var N=function(e){return i.createElement(o.e,null,i.createElement(u.e,Object(r.__assign)({},e)))};var C=function(e){var t=e.dragSourceKey,n=e.type,s=i.useState(),u=s[0],f=s[1],l=Object(T.e)(function(t){var n;e.hookCallback(t);f(null===(n=t.collectedProps)||void 0===n?void 0:n.isDragging)});return i.createElement(o.e,null,i.createElement(a.t,Object(r.__assign)({},e,{hookCallback:l})),e.showDefaultDragPreview||!u?null:i.createElement(a.e,{dragSourceKey:t,type:n},function(e){return i.createElement(A,{draggedItem:e.draggedItem,dropEffect:e.dropEffect})}))};function k(e){var t=e.resolve,n=Object(r.__rest)(e,["resolve"]);i.useEffect(function(){return function(){t()}},[]);return i.createElement(w,Object(r.__assign)({},n))}function L(e){var t,n,r=e.draggedItem,s=e.resolve;return i.createElement(o.e,null,i.createElement(a.e,{dragSourceKey:null===(t=r)||void 0===t?void 0:t.dragSourceKey,type:null===(n=r)||void 0===n?void 0:n.type,as:M,getItemStyles:_},function(e){return i.createElement(k,{draggedItem:e.draggedItem,dropEffect:e.dropEffect,resolve:s})}))}function A(e){var t=Object(S.i)({scope:"global"});i.useEffect(function(){if(e.draggedItem&&t){var n=new x.e,r=n.reject,s=n.resolve,o=n.promise,u=i.createElement(L,{draggedItem:e.draggedItem,reject:r,resolve:s});t.enqueue({content:u,promise:o,scope:"global"})}},[e.draggedItem]);return null}var O=i.memo(function(e){var t=e.dragDropKey,n=e.dragType,s=i.useState(),u=s[0],f=s[1],l=Object(T.e)(function(t){var n;e.hookCallback(t);f(null===(n=t.collectedDragProps)||void 0===n?void 0:n.isDragging)});return i.createElement(o.e,null,i.createElement(E.e,Object(r.__assign)({},e,{hookCallback:l})),e.showDefaultDragPreview||!u?null:i.createElement(a.e,{dragSourceKey:t,type:n},function(e){return i.createElement(A,{draggedItem:e.draggedItem,dropEffect:e.dropEffect})}))}),M=i.forwardRef(function(e,t){return i.createElement(s.e,null,i.createElement("div",{className:e.className,ref:t},e.children))});function _(e,t,n,r,i){if(!(e&&t&&n&&r))return{display:"none"};var s={top:0,left:0};if(null!==i){var o=i.getBoundingClientRect();if(o){s.top=o.top;s.left=o.left}}var u=t||{x:0,y:0},a=u.x,f=u.y,l="translate("+a+"px, "+(f-=s.top)+"px)";return{transform:l,WebkitTransform:l}}}],Array(224),[function(e,t,n){"use strict";n.d(t,"e",function(){return m});n.d(t,"t",function(){return g});n.d(t,"n",function(){return y});n.d(t,"r",function(){return b});n.d(t,"i",function(){return w});n.d(t,"s",function(){return E});var r=n(0),i=n(167),s=n(1560),o=n(1847),u=n(312),a=n(401),f=n(390),l=n(146),c=n(963),h=n(59),p=n(94),d=n(1945),v=n(441),m=Object(i.e)(function(e){var t=e(a.e),n=e(Object(l.e)({graphDataRequestorConfiguration:c.e,graphTokenProvider:d.e})),r=n.graphDataRequestorConfiguration,i=n.graphTokenProvider,o=r&&r.alwaysSendContentType,h=r&&r.cookieOrigin;return{dataRequestor:new s.e({alwaysSendContentType:o},{cookieOrigin:h,apiEvent:f.e.withManager(t),sessionManagementProvider:i,isOffline:function(){return new p.n(function(t,n){try{var r=e(Object(u.n)()),i=void 0!==window.navigator.onLine&&!window.navigator.onLine;t(r||i)}catch(e){n(e)}})}}),hasTokenProvider:!!i&&!!i.getSessionToken,cookieOrigin:h}});function g(e,t){return"&orderby=folder,"+e+" "+(t?"asc":"desc")}function y(e){var t=this,n=e.url,i=e.method,s=void 0===i?"GET":i,u=e.body,a=e.qosName,f=e.endpoint,c=e.headers,p=void 0===c?{}:c,d=e.timeout,g=e.expectedErrors,y=e.driveUrl,b=e.parseResponse,w=e.allowCookies,E=e.useMultiPartIfSupported,S=e.apiVersion;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,c,x,T,N,C,k,L,A,O,M,_;return Object(r.__generator)(this,function(D){switch(D.label){case 0:t=e(m),i=t.dataRequestor,c=t.hasTokenProvider,x=t.cookieOrigin;T=void 0!==typeof u?JSON.stringify(u):void 0;N=new v.e(n).authority;C=x&&N&&x===N;return c||w&&C?[3,2]:[4,e(Object(o.t)(f,y))];case 1:k=D.sent();D.label=2;case 2:L=e(Object(l.e)({clientName:h.t,enableUseMultiPart:h.f,isClaimsPerSiteEnabled:h.d})),A=L.clientName,O=L.isClaimsPerSiteEnabled,M=L.enableUseMultiPart;_=void 0===M||M(f);return[4,i.send({path:n,endpoint:f,driveUrl:y,requestType:s,apiName:a,accessToken:k,useAuthorizationHeaders:!0,postData:T,headers:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},p),A?{"X-ClientService-ClientTag":A}:{}),O?{"x-ms-cc":"t"}:{}),useMultiPart:_?E:void 0,expectedErrors:g,allowCookies:w,timeout:d,parseResponse:b,apiVersion:S})];case 3:return[2,D.sent()]}})})}}function b(e){var t=this,n=e.url,i=e.method,s=void 0===i?"GET":i,o=e.body,a=e.qosName,f=e.timeout,l=e.endpoint,c=e.headers,h=e.expectedErrors,p=e.driveUrl,d=e.useMultiPartIfSupported,v=e.parseResponse,m=e.allowCookies;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,g,b,w,E,S,x;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=void 0!==typeof o?JSON.stringify(o):"";i=(function(e,t,n){var r=void 0!==n?n:"";return e+"__"+t+"__"+r})(n,s,t);g=e(Object(u.n)());b=void 0!==window.navigator.onLine&&!window.navigator.onLine;w=g||b;return[4,e(Object(u.t)(i))];case 1:E=r.sent();if(w&&E)return[2,E];S=y({url:n,method:s,body:o,qosName:a,endpoint:l,headers:c,expectedErrors:h,timeout:f,driveUrl:p,useMultiPartIfSupported:d,parseResponse:v,allowCookies:m});if(!E)return[3,2];e(S).then(function(t){e(Object(u.r)(i,t))});return[2,E];case 2:return[4,e(S)];case 3:x=r.sent();return[4,e(Object(u.r)(i,x))];case 4:r.sent();return[2,x]}})})}}function w(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(r){return[2,!!(t=n(Object(l.e)({isODCEndpoint:h.v})).isODCEndpoint)&&t(e)]})})}}function E(e,t){return function(n){var r=n(Object(l.e)({supportsRandomAccess:h.x})).supportsRandomAccess;return!!r&&r(e,t)}}}],Array(223),[function(e,t,n){"use strict";n.d(t,"e",function(){return l});n.d(t,"t",function(){return c});var r=n(0),i=n(964),s=n(146),o=n(331),u=n(48),a=n(69),f=n(1945);function l(e,t,n,l){var c=this;return function(h){return Object(r.__awaiter)(c,void 0,void 0,function(){var c,p,d,v,m,g,y,b,w,E,S,x,T,N=this;return Object(r.__generator)(this,function(C){switch(C.label){case 0:c=(l||{}).qosExtraData;p=h(Object(s.e)({graphDataSourceConfiguration:i.e,graphTokenProviderConfiguration:f.e})),d=p.graphDataSourceConfiguration,v=p.graphTokenProviderConfiguration;m=d&&d.ensureAuthToken;g=n&&d&&d.ensureAuthTokenWithAction;y=v&&v.getSessionToken;if(!(w=y?function(){return Object(r.__awaiter)(N,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,y({endpoint:t,driveUrl:n,path:n||t})];case 1:return[2,e.sent().accessToken]}})})}:g?function(){return Object(r.__awaiter)(N,void 0,void 0,function(){return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,h(g(e,t,n))];case 1:return[2,r.sent()]}})})}:m?function(){return Object(r.__awaiter)(N,void 0,void 0,function(){return Object(r.__generator)(this,function(n){switch(n.label){case 0:return[4,m(e,t)];case 1:return[2,n.sent()]}})})}:void 0))return[3,4];E=h(Object(o.e)({name:"graphDataSource.getAuthToken",extraData:c}));C.label=1;case 1:C.trys.push([1,3,,4]);return[4,w()];case 2:b=C.sent();h(E({resultType:u.e.Success,extraData:Object(r.__assign)(Object(r.__assign)({},c),{authTokenObtained:!!b})}));return[3,4];case 3:S=C.sent();x=u.e.Failure;T=void 0;if(S instanceof a.e){S.isExpected&&(x=u.e.ExpectedFailure);T=S.code}else T=S instanceof Error?S.name+"("+S.message+")":"UnknownAuthError";h(E({resultType:x,resultCode:T,error:S&&JSON.stringify(S),extraData:c}));throw S;case 4:return[2,b]}})})}}function c(e,t,n){var i=this;return function(s){return Object(r.__awaiter)(i,void 0,void 0,function(){var i,o;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,s(l(["Files.ReadWrite.All"],e,t,n))];case 1:(i=r.sent())&&(o={accessToken:i});return[2,o]}})})}}},function(e,t,n){"use strict";n.d(t,"e",function(){return c});var r=n("react-lib"),i=n(1720),s=n(1519),o=n(1575),u=n(1616),a=n(1335),f=n(1892),l=n(2292),c=function(e){var t=e.onConfirm,n=e.onCancel,c=e.defaultToYes,h=void 0!==c&&c,p=e.yesText,d=void 0===p?l.e.yes:p,v=e.noText,m=void 0===v?l.e.no:v,g=h?u.e:a.e,y=h?a.e:u.e;return r.createElement(f.e,null,r.createElement(i.e,{dialogContentProps:{type:s.e.close,subText:e.prompt?e.prompt:""},onDismiss:n,hidden:!1,title:e.title,maxWidth:e.maxWidth},r.createElement(o.e,null,r.createElement(g,{"data-automationid":"confirmbutton",onClick:t},d),r.createElement(y,{"data-automationid":"cancelbutton",onClick:n,componentRef:function(e){e&&e.focus()}},m))))}}],Array(41),[function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n(0),i=n("react-lib"),s=n(2),o=n(99),u=n(961),a={key:new s.e("openInOfficeOnline").id,automationId:"openInOfficeOnlineCommand",action:i.createElement(u.t,null),facets:Object(r.__assign)({},o.t.pack(!0))}},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n(0),i=n("react-lib"),s=n(2),o=n(99),u=n(956),a={key:new s.e("openInOfficeClient").id,automationId:"openInOfficeClientCommand",action:i.createElement(u.n,null),facets:Object(r.__assign)({},o.t.pack(!0))}},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n("react-lib"),i=n(947),s=n(132),o=n(91),u=0;function a(e){var t=e.isDefault,n=void 0!==t&&t,o=r.useState(""+ ++u)[0],a=r.useContext(i.e),l=r.useRef(),c=l.current||n&&a.keyboardManager||(l.current=new i.t({isDefault:!1,id:o,parent:a.keyboardManager})),h=f(c),p=h.isActive,d=h.isChildActive;r.useEffect(function(){return function(){if(!n){c.setIsActive(!1);c.dispose()}}},[]);var v=r.useMemo(function(){return{keyboardManager:c}},[c]);return r.createElement("div",{"data-keyboard-zone-id":o},r.createElement(i.e.Provider,{value:v},Object(s.t)(e.children,{isActive:p,isChildActive:d})))}function f(e){var t=r.useState(function(){return e.getIsActive()}),n=t[0],i=t[1],s=r.useState(function(){return e.hasActiveChildren()}),u=s[0],a=s[1];r.useEffect(function(){var t=new o.e(null);t.on(e,"change",function(){i(e.getIsActive());a(e.hasActiveChildren())});return function(){t.dispose()}},[]);return{isActive:n,isChildActive:u}}}],Array(52),[function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("graphTokenProvider")}],Array(30),[function(e,t,n){"use strict";n.d(t,"e",function(){return i});n.d(t,"t",function(){return s});var r=n(2),i=new r.e("entryBatch"),s=new r.e("sourceFile")},,function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(115),s=new r.e("refreshItemsInSet"),o=Object(i.i)({operationTypeFacet:s})}],Array(69),[function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(0),i=n("react-lib"),s=n(554),o=n(447),u=function(e){var t=e.extension,n=e.className,u=e.isOneNote,a=e.size,f=e.brand,l=Object(o.n)({size:a,extension:u?"one":t,brand:f});return l?i.createElement(s.e,Object(r.__assign)({className:n},l)):null}},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(115),s=new r.e("saveViewCore"),o=Object(i.i)({operationTypeFacet:s})}],Array(66),[function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(115),s=new r.e("retryProgressItemsOperation"),o=Object(i.i)({operationTypeFacet:s})}],Array(22),[function(e,t,n){"use strict";var r=n(0),i=n("react-lib"),s=n(34),o=n(25),u=n(32),a=n(1720),f=n(1575),l=n(1616),c=n(2332),h=n(1028),p=n(2448),d=n(111),v=n(6),m=n(77),g=n(146),y=n(59),b=n(799),w=n(2668),E=n(1623),S=n(1847);function x(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u,a;return Object(r.__generator)(this,function(f){switch(f.label){case 0:t=e.appId,i=e.itemKeys,s=e.getPreAuthUrl,o=e.driveUrl;if(!s)return[2,i.map(function(e){var t=n(Object(d.e)({driveItemKey:m.e},e)).driveItemKey,i=n(Object(g.e)({graphEndpoint:y.c})).graphEndpoint;return t?Object(b.t)(Object(r.__assign)(Object(r.__assign)({},t),{endpoint:i||t.endpoint})):""})];u=i.map(function(e){return n(Object(d.e)({fullUrl:v.i},e)).fullUrl||""});return[4,n(Object(S.t)(o,o))];case 1:a=f.sent();return[2,new w.e({},{dataRequestor:n(E.e).dataRequestor}).getPreAuthUrls({appId:t,items:u,accessToken:a,driveUrl:o})]}})})}}var T=n(131),N=n(3128),C=n(21),k=n(75);n.d(t,"e",function(){return A});n.d(t,"t",function(){return O});var L=Object(s.t)(function(e,t){var n,s=t.itemKeys,o=t.action,d=t.isAvailable,v=t.itemKey,g=o.handler,y=g.appId,w=g.isPromoted,E=v,S="",L="";L=k.e.isActivated("f69e50a3-c176-4a8c-8c48-6adf2b86607b","1/23/2021","Use itemKey instead of parentItemKey.")?E||(1===s.length?s[0]:""):1===s.length?s[0]:E||"";var A=e.demandItem({controlHandler:p.e,driveItemKey:m.e},L),O=A.controlHandler,M=A.driveItemKey;(S=M&&Object(b.n)(M)||"").indexOf("/v2.1")>-1&&(S=S.replace("/v2.1","/v2.0"));var _=p.e.evaluate(O)(e,{itemKey:L}).sharedPostData;n=_;var D=e.dispatch;if(!(d&&o.url&&n&&S))return null;var P=e.demandItemFacet(p.n,v),H=p.n.evaluate(P)(e,{itemKey:v}).onInvokeCallback,B=function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var e,t,i;return Object(r.__generator)(this,function(u){switch(u.label){case 0:e=H?void 0:window.open("","_blank");return[4,D(x({appId:y,itemKeys:s,getPreAuthUrl:!w,driveUrl:S})).catch(function(){})];case 1:t=u.sent();i=Object(r.__assign)(Object(r.__assign)({},n),{appId:y,items:JSON.stringify(t||[])});if(H)H({url:o.url,postdata:i});else if(t&&t.length>0&&e&&e.document){e.opener=null;Object(h.e)({url:o.url,postdata:i,document:e.document})}else e&&e.close();return[2]}})})},j=w?Object(C.o)(function(e){var t=e.resolve,n=e.reject,s=function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){n(new T.e);return[2]})})};return i.createElement(a.e,{dialogContentProps:{title:N.e.consentDialogTitle,onDismiss:s},hidden:!1},i.createElement("p",null,N.e.consentDialogMessage),i.createElement(f.e,null,i.createElement(l.e,{onClick:function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:t();return[4,B()];case 1:e.sent();return[2]}})})}},N.e.consentDialogContinueButton),i.createElement(c.e,{onClick:s},N.e.consentDialogCancelButton)))}):B;return i.createElement(u.e,Object(r.__assign)({isAvailable:d,onExecute:j},t))}),A=Object(o.e)()(L);function O(e,t,n){var r=e.file,i=e.folder,s=e.file&&e.file.extensions||void 0;if(!0===n)return!!i;if(r&&t){var o=k.e.isActivated("b0dc9ce2-048d-43d2-ac18-f07fc73030c2","1/23/2021","Check if the extension includes a period")||"."===t.charAt(0)?t:"."+t;return!s||-1!==s.indexOf(o.toLowerCase())||-1!==s.indexOf("*")||-1!==s.indexOf(".*")}return!1}},,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return o});var r=n(5),i=n(77),s=n(1117),o=new r.e("driveItemSet",{driveItemKey:Object(r.o)(i.e),sortBy:Object(r.s)(),isAscending:Object(r.n)(),extFilters:Object(r.t)(Object(r.s)()),filters:Object(r.t)(Object(r.o)(s.e)),groupBy:Object(r.s)()})}],Array(24),[function(e,t,n){"use strict";var r=n(0),i=n("react-lib"),s=n(2178),o=n(2),u=n(99),a=n(643),f=n(25),l=n(32),c=n(656),h=n(34),p=n(1),d=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return this.props.canOpenInOffice?i.createElement(l.e,null):i.createElement(c.t,null)};return t})(i.PureComponent);var v=Object(h.e)(function(e,t){var n=t.itemKey;return{canOpenInOffice:!!e.demandItem({appMap:p.tt},n).appMap}})(d),m=Object(f.s)()(Object(f.r)()(v)),g=n(1891),y=n(1890);n.d(t,"t",function(){return b});n.d(t,"e",function(){return w});var b={key:a.e.key,automationId:a.e.automationId,name:a.e.name,subMenuProps:{items:[y.e,g.e],contextualMenuItemAs:s.t},facets:Object(r.__assign)({},u.t.pack(!0))},w={key:new o.e("fallbackOpen").id,automationId:"fallbackOpen",name:a.e.name,action:i.createElement(m,null),facets:Object(r.__assign)({},u.t.pack(!0))}},function(e,t,n){"use strict";var r=n(0),i=n("react-lib"),s=n(554),o=n(1356),u=n(1),a=n(2153),f=n(25),l=n(34),c=n(6),h=n(1891),p=n(1890),d=n(2),v=n(2048),m=n(56),g=n(90);n.d(t,"t",function(){return w});n.d(t,"e",function(){return E});var y=new d.e("fileHandlerOpenCommand").id,b={ODB:625,ODC:"CommandBarBrandIcons",Fallback:!1},w=Object(f.s)()(Object(f.r)()(Object(l.e)(function(e,t){var n=t.itemKey,r=t.item,i=e.demandItem({appMap:u.tt},n).appMap,s=r.name;r.key===h.e.key?s=s||(i?Object(a.o)(i,!0):a.e.Open):r.key===p.e.key&&(s=s||(i?Object(a.s)(i,!0):a.e.OpenInBrowser));return{name:s}})(function(e){return i.createElement("div",{className:"contextualMenuItemLinkContent_8920b193"},i.createElement("span",{dir:"auto",className:"contextualMenuItemTextLabel_8920b193"},e.name))}))),E=Object(f.s)()(Object(f.r)()(Object(l.e)(function(e,t){var n=t.itemKey,i=t.menuProps,s=e.demandItem({appMap:u.tt,fileName:c.h},n),o=s.appMap,f=s.fileName,l={};if(i&&i.items){var d=i.items[0];d&&-1!==d.key.indexOf(y)&&d.iconProps&&(l=d.iconProps)}var v=!!f&&!!f.extension&&".pdf"===f.extension.toLowerCase(),w={iconName:o?Object(a.t)(o):v?"PDF":"OpenFile"},E=Object(g.e)(e,n),x=Object(m.e)(e,{feature:b,pageContext:E}),T=void 0;i&&i.items&&(T=i.items.map(function(e){return e.key===h.e.key?Object(r.__assign)(Object(r.__assign)({},e),{iconProps:w,name:e.name||o&&Object(a.o)(o,!0)||a.e.Open,onRenderIcon:o?S.bind(void 0,o,!0,x):void 0}):e.key===p.e.key?Object(r.__assign)(Object(r.__assign)({},e),{iconProps:w,name:e.name||o&&Object(a.s)(o,!0)||(v?a.e.OpenInBrowser:a.e.Open),onRenderIcon:o?S.bind(void 0,o,!0,x):void 0}):e}));return{iconProps:l||w,onRenderIcon:o?S.bind(void 0,o,!1,x):void 0,text:a.e.Open,menuProps:T?Object(r.__assign)(Object(r.__assign)({},i),{items:T}):i}})(o.e)));function S(e,t,n){var r=e&&Object(a.n)(e),o=e&&Object(a.r)(e);return o&&n?i.createElement(v.e,{size:16,extension:"",brand:o.toLowerCase(),className:t?"menuItemBrandIcon_8920b193":"brandIcon_8920b193"}):r?i.createElement("span",{className:t?"menuItemIconContainer_8920b193":"iconContainer_8920b193"},i.createElement(s.e,{iconName:r.logoFill16,className:"logoFillIcon_8920b193"}),i.createElement(s.e,{iconName:r.logo16,className:"logoIcon_8920b193"})):null}}],Array(17),[function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.Publish=0]="Publish";e[e.Republish=1]="Republish";e[e.PostNews=2]="PostNews";e[e.UpdateNews=3]="UpdateNews";e[e.SubmitForApproval=4]="SubmitForApproval";e[e.CancelApproval=5]="CancelApproval";e[e.SchedulePublish=6]="SchedulePublish"})(r||(r={}))}],Array(49),[function(e,t,n){"use strict";n.d(t,"e",function(){return l});var r=n(0),i=n("react-lib"),s=n(99),o=n(643),u=n(2178),a=n(1890),f=n(1891),l={key:o.e.key,automationId:o.e.automationId,subMenuProps:{items:[a.e,f.e]},onRender:function(e){return i.createElement(u.e,Object(r.__assign)({},e,{menuProps:e.subMenuProps}))},facets:Object(r.__assign)({},s.t.pack(!0))}}],Array(22),[function(e,t,n){"use strict";var r=n(0),i=n("react-lib"),s=n(2),o=n(578),u=n(105),a=n(2667),f=n(34),l=n(32),c=n(25),h=n(47),p=n(990),d=n(300),v=n(2139),m=n(6),g=n(111),y=n(332),b=n(2981),w=n(158),E=new d.e("newDocument"),S=Object(y.t)()(v.e),x=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._onItemOpened=function(){n.setState({fileCreated:!1,isItemOpened:!0})};n.state={newDocumentKey:E.serializeNext()};return n}t.prototype.render=function(){var e=this,t=this.state,n=t.newDocumentKey,s=t.fileCreated,o=t.isItemOpened,u=this.props,a=u.itemCacheDispatch,f=u.itemKey,c=u.parentFolderDriveItemUrl,h=u.action,d=Object(r.__rest)(u,["itemCacheDispatch","itemKey","parentFolderDriveItemUrl","action"]),v=h.availableOn,y=v&&v.file&&v.file.extensions&&v.file.extensions[0]&&v.file.extensions[0].replace(".",""),b=!!y&&!!h.handler,E=void 0;if(b&&y){var x=!h.handler.isPromoted;x&&!c||(E=function(){return Object(r.__awaiter)(e,void 0,void 0,function(){var e;return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,a(Object(p.e)({items:(e={},e[f]={newDocumentKey:n,extension:y},e)}))];case 1:t.sent();x&&c&&a((i={newDocumentKey:n,parentFolderDriveItemUrl:c},function(e){var t,n=i.newDocumentKey,s=i.parentFolderDriveItemUrl,o=e(Object(g.e)({fileName:m.l},n));if(!o||!o.fileName)throw"FileHandler create action: fail to get file name of the new document";var u=s+":/"+o.fileName+":";e(Object(w.e)({items:(t={},t[n]=Object(r.__assign)({},m.j.pack(u)),t)}))}));this.setState({fileCreated:!0,isItemOpened:!1});return[2]}var i})})})}return s?o?null:i.createElement(S,Object(r.__assign)({},d,{onComplete:this._onItemOpened,isAvailable:!0,itemKeys:[n],action:h})):i.createElement(l.e,Object(r.__assign)({},d,{isAvailable:b,onExecute:E}))};return t})(i.Component),T=Object(c.i)()(Object(f.e)(function(e,t){var n=t.itemKey,i=t.action,s=e.demandItemFacet(b.e,n),o=b.e.evaluate(s)(e,{itemKey:n}).driveItemFullUrl,u=i.handler,a=u.appId,f=u.isPromoted?"PromotedFileHandlerCreate":"FileHandlerCreate",l={appId:a};return Object(r.__assign)(Object(r.__assign)({},Object(h.t)(e,{itemKey:n,engagement:{name:f,isIntentional:!0,extraData:l}})),{parentFolderDriveItemUrl:o||""})})(x));var N=Object(c.s)()(Object(f.e)(function(e,t){var n=t.itemKeys,i=t.action,s=i.availableOn,o=s.allowMultiSelect,u=void 0!==o&&o,a=n.length,f=u&&a>0||1===a;f&&(f=n.every(function(t){var n=e.demandItem({fileName:m.h,isFolder:m.d},t),r=n&&n.fileName,i=r&&r.extension||"",o=n&&n.isFolder||!1;return Object(v.t)(s,i,Boolean(o))}));var l=i.handler,c=l.appId,p=l.isPromoted?"PromotedFileHandlerCustom":"FileHandlerCustom",d={appId:c};return Object(r.__assign)({isAvailable:f},Object(h.t)(e,{itemKey:n[0],engagement:{name:p,isIntentional:!0,extraData:d}}))})(v.e)),C=n(3458),k=n(23),L=n(8),A=n(96),O=n(157),M=n(1090),_=n(2448);n.d(t,"e",function(){return F});n.d(t,"t",function(){return I});var D=new s.e("fileHandlerOpenCommand").id,P=new s.e("fileHandlerCreateCommand").id,H=new s.e("fileHandlerCustomCommand").id,B=new s.e("fileHandlerAppCommand").id,j=new s.e("fileHandlerActionsCommand").id,F=function(e,t){var n=t.itemKey,r=t.collapseCustomCommands,i=e.demandItem({actions:O.t,version:O.a},n),s=i.actions,o=i.version;if(o&&4===o&&s){var u=function(t){var n=s&&s[t],r=e.demandItemFacet(L.e,n);return r&&r.itemKeys||[]};return{new:R(e,{actionKeys:u("create"),type:"create"})||[],open:R(e,{actionKeys:u("open"),type:"open"})||[],custom:R(e,{actionKeys:u("custom"),type:"custom",collapseCustomCommands:r})||[]}}},I=function(e,t,n){var r=n?t:e,i=n?e:t,s=r,o={};r.forEach(function(e){o[e.key]=!0});i.forEach(function(e){o[e.key]||s.push(e)});return s};function q(e,t){var n,r,s,f,l,c=t.itemKey,h=t.type,p=t.CustomAction,d=void 0,v=void 0;if("app"===h){d=c;if(!(_=c&&e.demandItem({displayName:m.l,appIcon:O.n},c)))return;s=B+"-"+c;f="itemsScopefileHandlerAppCommand";n=_.displayName;_.appIcon&&_.appIcon.url&&(r={iconType:o.e.Image,className:"fileHandlerCommandIcon_713927b4",imageProps:{src:_.appIcon&&_.appIcon.url||"",title:_.displayName||"",imageFit:u.t.contain,className:"fileHandlerCommandIcon_713927b4"}})}else{var g=e.demandItem({displayName:m.l,handlerKey:O.o,availableOn:O.e,icon:O.i,isPromoted:O.s},c),y=g.displayName,b=g.handlerKey,w=g.availableOn,E=g.icon;v=g.isPromoted;var S=b&&e.demandItemFacet(O.n,b),x="open"===h&&S||E;x&&x.url&&(r={iconType:o.e.Image,className:"fileHandlerCommandIcon_713927b4",imageProps:{src:x&&x.url,title:x&&x.displayName,imageFit:u.t.contain,className:"fileHandlerCommandIcon_713927b4"}});var L=Object(M.e)(e,{itemKey:c});n=y;switch(h){case"open":if(!n&&b){var _;n=(_=c&&e.demandItem({displayName:m.l},b))&&_.displayName&&k.format(C.e.openWithCommand,_.displayName)}s=D;f="itemsScopefileHandlerOpenCommand";l=p?i.createElement(p,{action:L}):i.createElement(a.e,{action:L});break;case"create":n||(n=E&&E.displayName||w&&w.file&&w.file.extensions&&k.format(C.e.createFileWithExtension,w.file.extensions[0])||"");s=P;f="itemsScopefileHandlerCreateCommand";l=i.createElement(A.e,null,i.createElement(T,{action:L}));break;case"custom":s=H;f="itemsScopefileHandlerCustomCommand";y&&(f=y.toLowerCase().replace(/\s+(.)/g,function(e,t){return t.toUpperCase()})+"Command");l=p?i.createElement(p,{action:L}):i.createElement(N,{action:L})}s+="-"+c;d=b}if(s&&n)return{key:s,automationId:f,name:n,iconProps:r,action:l,handlerKey:d,isPromoted:v,fileHandlerType:h}}function R(e,t){var n=t.actionKeys,i=t.type,s=t.collapseCustomCommands,o=void 0===s||s,u=[];if("open"===i){var f=e.demandItemFacet(_.r,n[0]),l=_.r.evaluate(f)(e,{openActionAs:a.e}).openActionAs;n.forEach(function(t){var n=q(e,{itemKey:t,type:i,CustomAction:l});n&&u.push(n)})}else if("create"===i)n.forEach(function(t){var n=q(e,{itemKey:t,type:i});n&&u.push(n)});else if("custom"===i){f=e.demandItemFacet(_.t,n[0]);var c=_.t.evaluate(f)(e,{customActionAs:N}).customActionAs,h=(function(e,t){var n=t.actionKeys,i=t.collapseCustomCommands,s=t.CustomAction,o=void 0,u=[],a={},f=function(t){return q(e,{itemKey:t,type:"custom",CustomAction:s})},l=function(t,n){var r=q(e,{itemKey:t,type:"app"});r&&n&&n.length>0&&(r.subMenuProps={items:n});return r};if(i){for(var c=0,h=n;c<h.length;c++){var p=h[c],d=f(p);if(d){var v=d.handlerKey||"";if(o){if(!o.subMenuProps){var m=Object(r.__assign)({},o),g=Object.keys(a)[0];if(E=l(g)){o=E;if(v===g){E.subMenuProps={items:[m,d]};continue}}}var y=Object.keys(a).length;if(void 0!==a[v]){var b=o.subMenuProps;if(1===y)b&&b.items.push(d);else{var w=a[v];if(b){var E;(E=b.items[w]).subMenuProps&&E.subMenuProps.items.push(d)}}}else{var S=l(v,[d]);if(!S)continue;if(1===y){var x=Object(r.__assign)({},o);o={key:""+j,automationId:"itemsScopefileHandlerActionsCommand",name:C.e.fileHandlerRootActionsMenu,iconProps:{iconName:"SetAction",ariaLabel:C.e.fileHandlerRootActionsMenuAriaLabel,className:"fileHandlerCommandIcon_713927b4"},subMenuProps:{items:[x,S]}};a[v]=1}else{o.subMenuProps&&o.subMenuProps.items.push(S);a[v]=y}}}else{o=d;a[v]=0}}}o&&(u=[o])}else for(var T=0,N=function(e){var t=f(e);if(!t)return"continue";var n=t.handlerKey||"",i=l(n,[t]),s=!1;if(i){Object.keys(a).forEach(function(e){if(n===e){s=!0;var i=u[a[e]];i.subMenuProps&&(i.subMenuProps={items:Object(r.__spreadArrays)(i.subMenuProps.items,[t])})}});if(!s){a[n]=T;T++;u.push(i)}}else{a[n]=T;T++;u.push(t)}},k=0,L=n;k<L.length;k++){p=L[k];N(p)}return u})(e,{actionKeys:n,collapseCustomCommands:o,CustomAction:c});h&&u.push.apply(u,h)}return u}}],Array(61),[function(e,t,n){"use strict";var r=n(0),i=n(109),s=n(6),o=n(8),u=n(77),a=n(2152),f=n(2753),l=new(n(2).e)("driveItemResponse"),c=n(507),h=n(953),p=n(494),d=n(149),v=n(46),m=n(1008),g=n(2754),y=n(681),b=n(2660),w=n(1507),E=n(2973),S=n(3119),x=n(3118),T=n(172),N=n(3445),C=n(666);n.d(t,"e",function(){return k});n.d(t,"t",function(){return L});function k(e){var t,n=e.driveItemKey,k=e.driveItem,A=e.endpoint,O=e.parentFolderItemKey,M=e.shouldReturnShareFacets,_=void 0===M||M,D=k.file,P=k.fileSystemInfo,H=k.name,B=k.parentReference,j=k.remoteItem,F=k.root,I=k.size,q=k.thumbnails,R=k.image,U=k.video,z=k.eTag,W=k.specialFolder,X=k.lastModifiedDateTime,V=void 0===X?P&&P.lastModifiedDateTime||j&&j.lastModifiedDateTime:X,$=k.createdDateTime||P&&P.createdDateTime||j&&j.createdDateTime,J=B&&B.driveId,K=B&&B.driveType||j&&j.parentReference&&j.parentReference.driveType,Q="personal"===K,G=P&&P.lastAccessedDateTime||j&&j.fileSystemInfo&&j.fileSystemInfo.lastAccessedDateTime,Y=k.package||j&&j.package,Z=q||j&&j.thumbnails,ee=R||j&&j.image,te=U||j&&j.video,ne=k.shared||j&&j.shared,re={itemId:k.id,driveId:J,endpoint:A},ie=P&&P.systemPath,se=n||j&&j.parentReference&&{itemId:j.id,driveId:j.parentReference.driveId,endpoint:A}||re,oe=u.e.serialize(se),ue=k.webDavUrl||j&&j.webDavUrl;t="business"!==K&&"documentLibrary"!==K&&"personal"!==K||!F?H||j&&j.name||"":p.e.files;var ae=k.folder||j&&j.folder,fe=I||j&&j.size,le=ae&&ae.childCount,ce=L(t,!!ae),he=ce.extension||k.package&&k.package.type,pe=he&&(function(e){var t=e.replace(".",""),n=Object.keys(w.e);for(var r in n)if(w.e.hasOwnProperty(n[r])){var i=n[r];if(w.e[i].indexOf(t)>-1)return i}})(he),de=k.sharepointIds||j&&j.sharepointIds,ve=k.localItem,me=k.webUrl||j&&j.webUrl;return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},u.e.pack(se)),s.l.pack(t)),void 0!==fe?s.p.pack(fe):{}),P||k.folder||D||j&&j.folder?Object(r.__assign)({},s.d.pack(ae?{}:void 0)):{}),me?s.L.pack(me):{}),y.n.pack(ie)),ue?s.i.pack(decodeURIComponent(ue)):{}),s.a.pack(V?new Date(V).getTime():void 0)),s.o.pack($?new Date($).getTime():void 0)),G?Object(r.__assign)({},s.s.pack(new Date(G).getTime())):{}),i.i.pack(Y&&"oneNote"===Y.type?{}:void 0)),Z?Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},f.e.pack(Z)),x.e.pack(!0)),N.e.pack(Object(C.i)(ce.extension))):{}),Object(T.e)().forFacet(d.v).thenInvalidate(oe,f.e).pack()),l.pack(k)),z?s.c.pack(z):{}),ee&&ee.width&&ee.height?d.a.pack({width:ee.width,height:ee.height}):{}),ee&&!te?d.p.pack({}):{}),te?d.g.pack({}):{}),o.t.pack({itemKey:a.e.serialize({driveItemKey:se,sortBy:"",isAscending:!0})})),s.n.pack({itemKey:c.e.serialize({driveItemKey:se})})),s.A.pack(O?{itemKey:O}:void 0)),!Q&&ue?Object(r.__assign)({},s.O.pack((function(e){var t=e.split("/");return t.length>2?decodeURIComponent(t[t.length-2]):void 0})(ue))):{}),m.e.pack(K)),Q?Object(r.__assign)({},g.e.pack(k.vault)):{}),s.h.pack(ce)),_?Object(r.__assign)(Object(r.__assign)({},s.E.pack(!!ne)),h.e.pack(ne)):{}),ve?y.e.pack(ve):{}),"number"==typeof le?v.e.pack(le):{}),y.t.pack(D&&D.mimeType)),pe?b.e.pack(pe):{}),de?E.e.pack(de):{}),W?S.e.pack(W.name):{})}function L(e,t){var n=e.lastIndexOf(".");return t||n<0?{name:e,extension:""}:{name:e.substring(0,n),extension:e.substring(n)}}}],Array(31),[function(e,t,n){"use strict";n.d(t,"e",function(){return O});var r=n(0),i=n(11),s=n(115),o=n(159),u=n(129),a=n(93),f=n(669),l=n(994),c=n(75),h=n(1125),p=n(104),d=n(158),v=n(274),m=n(438),g=n(44),y=n(51),b=n(379),w=n(1),E=n(6),S=n(8),x=n(287),T=n(251),N=n(304),C=n(111),k=n(360),L=n(334),A=n(292),O=Object(i.t)(function(){return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){e(Object(d.t)({keyFacet:h.e,facets:[g.e,E.l,E.h,w.fn,E.d,w.le,S.t,w.We,k.e,k.t,w.st,E.i]}));e(Object(s.s)(h.e,v.e)(Object(i.i)({maxParallelOperationCount:8})(M)));return[2]})})}});function M(e){var t=this,n=e.itemKey,i=h.e.deserialize(n);return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s,d,v,E,k,O,M,_,D,P,H,B,j,F,I,q,R,U,z;return Object(r.__generator)(this,function(W){switch(W.label){case 0:t=new o.e;s=!1;d=new u.e(i.itemFullUrl);v=e((function(e,t,n){return function(r){var i,s,o=e.itemFullUrl,a=new u.e(o);s=c.e.isActivated("ca2adcfe-ec7f-4e6b-a8ca-7023c151d026","1/8/2020","Adding more fields to GetListDataAsStream")?["File_x0020_Type","FileRef","FileLeafRef"]:["File_x0020_Type","FileRef","FileLeafRef","_ip_UnifiedCompliancePolicyUIAction","_ComplianceFlags","CheckoutUser","CheckedOutUserId","Created_x0020_Date.ifnew"];i=[a.path];var f=r(Object(C.e)({contentTypeId:w.p},h.e.serialize(e)));if(t&&t.length>0&&f&&f.contentTypeId)for(var l=0,p=t;l<p.length;l++){var d=p[l];if(d.contentTypeId===f.contentTypeId&&d.Fields)for(var v=0,m=d.Fields.split(",");v<m.length;v++){var g=m[v];"Modified_x0020_By"===g?s.push("Editor"):"Created_x0020_By"===g?s.push("Author"):s.push(g)}}var y=Object(N.r)({itemRefs:i,recurseInFolders:!0,pageSize:1,fieldNames:s});return{webAbsoluteUrl:"",listFullUrl:o,currentPageContext:void 0,qosName:n,viewXml:y,rootFolder:void 0,postDataContext:{needUpdatePageContext:!0,needsSchema:!0}}}})(i,void 0,"getSPItemByFullUrl"));return[4,e(Object(x.e)({getItemContext:v}))];case 1:E=W.sent();k=E.WebUrl||m.i(decodeURIComponent(E.HttpRoot||""))||d.authority;O=""+new u.e(k).authority+(E.ListUrl||decodeURIComponent(E.listUrlDir||""));M={webAbsoluteUrl:k,listFullUrl:O,rootFolder:""};_=e(Object(T.t)({serverData:E,itemSetKey:M,currentPageContext:v.currentPageContext,contentTypes:void 0,isItemSetRequest:s})),D=_.itemResolver,P=_.childKeys,H=_.pageContext;B=P[0];j=y.e.serialize(M);B&&t.mapKeys({mappings:(U={},U[B]=h.e.serialize(i),U)});if(H){F=b.e.serialize({webAbsoluteUrl:k,listFullUrl:O});e(Object(C.e)({pageContext:w.Qt},F)).pageContext||e(Object(f.e)({itemKey:F,options:{pageContext:H}}))}t.merge(D);if(g.e.matches(B)){I=g.e.deserialize(B);(q=Object(L.t)(I))&&t.merge(e(Object(L.e)({parentKey:q,serverData:E,pageContext:H})).itemResolver)}R=p.e.serialize({webAbsoluteUrl:k,listFullUrl:O});t.resolveItems({items:(z={},z[g.e.serialize(M)]=Object(r.__assign)({},S.t.pack({itemKey:j})),z[n]=Object(r.__assign)({},a.r.pack(g.e)),z[R]=Object(r.__assign)({},Object(l.e)(E,H)),z)});e(t.execute());e(Object(A.e)({itemSetKey:j,serverData:E,isItemSetRequest:s}));return[2]}})})}}},function(e,t,n){"use strict";n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});var r=n(186);function i(e){switch(e){case r.e.Word:return".docx";case r.e.Excel:case r.e.ExcelSurvey:case r.e.ExcelForm:return".xlsx";case r.e.PowerPoint:return".pptx";case r.e.OneNote:return"";case r.e.Text:return".txt";case r.e.Visio:return".vsdx";case r.e.Bohemia:return".b";case r.e.Prague:return".prague"}}function s(e,t){var n="";switch(e){case r.e.Word:n=t.CreateWord;break;case r.e.Excel:n=t.CreateExcel;break;case r.e.PowerPoint:n=t.CreatePowerPoint;break;case r.e.OneNote:n=t.CreateOneNote;break;case r.e.ExcelSurvey:n=t.CreateExcelSurvey;break;case r.e.Text:n=t.CreateText;break;case r.e.ExcelForm:n=t.CreateFormForExcel;break;case r.e.Visio:n=t.CreateVisio;break;case r.e.Bohemia:n=t.CreateBohemia;break;case r.e.Prague:n=t.CreatePrague}return n}},function(e,t,n){"use strict";n.d(t,"e",function(){return d});n.d(t,"t",function(){return v});n.d(t,"i",function(){return m});n.d(t,"r",function(){return g});n.d(t,"n",function(){return y});var r,i=n(1),s=n(6),o=n(60),u=n(965),a=n(2196),f=n(44),l=n(104),c=n(2545),h=n(1064),p=n(992);(function(e){e[e.publish=0]="publish";e[e.schedule=1]="schedule"})(r||(r={}));function d(e,t){var n,r,a;if(!t)return!1;var h=e.demandItem({firstItemKey:f.e,permissions:i.st,checkoutInfo:s.y,needsPublishing:i.Qe},t),d=h.firstItemKey,v=h.permissions,m=h.checkoutInfo,y=h.needsPublishing;if(!d)return!1;var b=e.demandItemFacet(i.Be,l.e.serialize({webAbsoluteUrl:d.webAbsoluteUrl,listFullUrl:d.listFullUrl}));return Boolean(y&&o.e.hasItemPermission({permissions:v},o.e.editListItems)&&(null===(n=b)||void 0===n?void 0:n.enableMinorVersions)&&(null===(r=b)||void 0===r?void 0:r.isDocumentLibrary)&&!(null===(a=m)||void 0===a?void 0:a.byOther)&&!p.e(e,t)&&!(function(e,t){var n=t.itemKey,r=t.listFacets,s=e.demandItem({moderationStatusType:i.Ve},n).moderationStatusType;if(r&&r.isModerated)return"number"==typeof s&&s!==u.e.draft&&s!==u.e.denied&&s!==u.e.pending;var o=g(e,n);return 0===o.minor&&0!==o.major})(e,{itemKey:t,listFacets:b})&&!c.t(e,{itemKey:t,includeOneNote:!0}))}function v(e){return e?""+512*(Math.floor(Number(e)/512)+1):""}function m(e){return!!e&&0===e.indexOf("0x0101009D1CB255DA76424F860D91F20E6C4118")}function g(e,t){var n=e.demandItem({uiVersion:i.un},t).uiVersion;return Object(h.t)(n)}function y(e,t){var n,r=e.demandItem({firstItemKey:f.e,moderationStatusType:i.Ve},t),s=r.firstItemKey,o=r.moderationStatusType;return s?(null===(n=e.demandItemFacet(i.Be,l.e.serialize({webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl})))||void 0===n?void 0:n.isModerated)?o===u.e.pending?a.e.CancelApproval:a.e.SubmitForApproval:p.t(e,t)?a.e.SchedulePublish:0===g(e,t).major?a.e.Publish:a.e.Republish:a.e.Publish}},function(e,t,n){"use strict";n.d(t,"e",function(){return o});n.d(t,"t",function(){return a});var r=n(2),i=n(98),s=n(5),o=new r.e("updateItem"),u=new s.e("updateListItem",{itemDisplayName:Object(s.s)()}),a=new i.e("updateListItemProgress",function(e,t){return u.serialize({})})}],Array(67),[function(e,t,n){"use strict";var r=n("react-lib"),i=n(199),s=n(21),o=n(899),u=n(490),a=n(6),f=n(117),l=n(446),c=n(571);n.d(t,"e",function(){return h});var h=function(e){var t=e.itemKey,n=e.action;return r.createElement(i.e,null,function(i){var h,p=i.itemCache;if(e.children)h=e.children;else{var d=p.demandItemFacet(a.l,t);h=d}var v=Object(f.e)(p),m=(n||!(function(e,t){var n=Object(l.e)(e,{itemKey:t.itemKey1}),r=Object(l.e)(e,{itemKey:t.itemKey2});return Object(c.e)(e,{itemKey:n})===Object(c.e)(e,{itemKey:r})})(p,{itemKey1:t,itemKey2:v}))&&t?r.createElement(u.e,{itemKey:t}):null;return r.createElement(s.n,{action:m},function(e){var t=e.isAvailable,n=e.execute,i=t?function(){n().catch(function(){})}:void 0;return i?r.createElement(o.e,{onClick:i},h):r.createElement("span",null,h)})})}},,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});var r=n(5),i=new r.e("uploadProgress",{sourceEntryKey:Object(r.s)()});function s(e){return i.serialize({sourceEntryKey:e})}},,function(e,t,n){"use strict";n.d(t,"e",function(){return i});n.d(t,"t",function(){return s});n.d(t,"r",function(){return o});n.d(t,"n",function(){return u});var r=n(16),i=new r.e("fileHandlerActionControl"),s=new r.e("fileHandlerCustomActionControl"),o=new r.e("fileHandlerOpenActionControl"),u=new r.e("fileHandlerInvokeActionControl")},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n("react-lib"),i=n(1720),s=n(1575),o=n(1616),u=n(1677),a=function(e){var t=e.title,n=e.prompt,a=e.cancelText,f=e.onCancel;return r.createElement(i.e,{onDismiss:f,hidden:!1,title:t,maxWidth:e.maxWidth},r.createElement(u.e,null,n),r.createElement(s.e,null,r.createElement(o.e,{onClick:f,componentRef:function(e){e&&e.focus()}},a)))}}],Array(95),[function(e,t,n){"use strict";n.d(t,"t",function(){return u});n.d(t,"e",function(){return a});var r=n(1),i=n(6),s=n(60),o=n(109);function u(e,t){var n=t.itemKey,r=t.includeOneNote,s=e.demandItem({folder:i.d,oneNote:o.i},n),u=s.folder,a=s.oneNote;return r?!!u||!!a:!!u&&!a}function a(e,t){var n=t.itemKey,o=t.listFacets,u=!!o&&!!o.isModerated;if(u){var a=e.demandItem({permissions:r.st,checkoutInfo:i.y},n),f=a.permissions,l=a.checkoutInfo;u=!!(!l||!l.byOther&&!l.byYou)&&!!f&&s.e.hasItemPermission({permissions:f},s.e.editListItems)&&s.e.hasItemPermission({permissions:f},s.e.approveItems)}return u}},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n(0),i=n(44),s=n(1),o=n(1362),u=n(116);function a(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,a,f;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=n(Object(u.e)(function(t){return t.demandItemFacet(i.e,e)}));return[4,n(Object(o.e)(function(t){return t.demandItem({listItemId:s.Ie},e)}))];case 1:a=r.sent().listItemId;if(!t)throw new Error("Cannot get spItemKeyFacet for itemKey: "+e);if(!(f=a||t.itemId))throw new Error("Cannot find itemId for itemKey: "+e);return[2,{key:t,itemId:f}]}})})}}},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(115),s=new r.e("bulkUpdateListItems"),o=Object(i.i)({operationTypeFacet:s})},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(115),s=new r.e("modifyView"),o=Object(i.i)({operationTypeFacet:s})},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(16).e)("itemPropertiesFormControl")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(451).e)("calendarMonth")},function(e,t,n){"use strict";n.d(t,"e",function(){return d});var r=n(0),i=n(115),s=n(11),o=n(116),u=n(159),a=n(2),f=n(120),l=n(40),c=n(71),h=n(98),p=n(8);function d(e,t){return Object(s.n)()(function(e){var n=this;return function(s){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,d,v,m,g,y,b,w,E,S,x;return Object(r.__generator)(this,function(T){switch(T.label){case 0:n=s(Object(o.e)(function(n){var i={operationTypeFacet:t,items:{}},s=new u.e;function o(e){var u,d=n.demandItemFacet(c.g,e),v=d&&d.itemKey,m=n.demandItemFacet(t,e),g=Object(h.i)(n,{itemKey:e}).phase;if(v&&m&&"failed"===g){i.items[v]=Object(r.__assign)(Object(r.__assign)({},m),{progressItemKey:e});s.resolveItems({items:(u={},u[e]=Object(r.__assign)({},Object(a.n)({error:f.e},{error:new l.u})),u)})}var y=n.demandItemFacet(p.e,e);if(y)for(var b=0,w=y.itemKeys;b<w.length;b++){o(w[b])}}for(var d=0,v=Object.keys(e.items);d<v.length;d++){o(v[d])}return{itemResolver:s,operationPayload:i}}));s(n.itemResolver.execute());d=s(Object(i.o)(n.operationPayload)),v=d.completed,m=d.items;for(g=0,y=Object.keys(m);g<y.length;g++){b=y[g];w=m[b],E=w.started,S=w.completed;(x=n.operationPayload.items[b].progressItemKey)&&s(Object(h.f)({progressItemKey:x,started:E,completed:S}))}return[4,v];case 1:T.sent();return[2]}})})}})}},function(e,t,n){"use strict";n.d(t,"t",function(){return y});n.d(t,"e",function(){return E});var r=n(10),i=n(44),s=n(104),o=n(817),u=n(1),a=n(29),f=n(28),l=n(129),c=n(77),h=n(799),p=n(6),d=n(136),v=n(56),m=n(90),g=n(75),y=Object(r.t)()(function(){return function(e){return w}}),b={ODB:1928};function w(e,t){var n=t.itemKey,r=t.desiredSize,f=e.demandItemFacet(i.e,n);if(!f)return{};var l=(function(e,t){var n=t.itemKey,r=t.spItem,i=t.desiredSize,s=E(e,{itemKey:n,spItem:r});if(s){var o=Math.ceil(i.width),u=Math.ceil(i.height);return{url:s(o,u),width:0,height:0}}})(e,{itemKey:n,spItem:f,desiredSize:r})||(function(e,t){var n=t.itemKey,r=t.desiredSize,i=e.demandItemFacet(o.t,n),s=i&&i(r.width,r.height);if(s)return{url:s,width:0,height:0}})(e,{itemKey:n,desiredSize:r})||(function(e,t){var n=t.spItem,r=t.itemKey,i=s.e.serialize(n),f=e.demandItemFacet(u.Be,i);if(!f)return;var l=f.templateType===a.n.publishingAsset;if(f.isPromotedLinks||l){var c=e.demandItemFacet(u.bt,r),h=void 0;f.isPromotedLinks?h=c&&c.BackgroundImageLocation:l&&c&&c.AlternateThumbnailUrl&&(h=e.demandItemFacet(o.e,r));if(h)return{url:h,width:0,height:0}}})(e,{spItem:f,itemKey:n});return l?{thumbnail:l}:{}}function E(e,t){var n=t.itemKey,r=t.spItem,i=Object(f.e)(e,{enableSharePointDirectThumbnails:u.G,spCookieDomainConfiguration:u.kt}),s=i.enableSharePointDirectThumbnails,o=void 0===s||s,a=i.spCookieDomainConfiguration,y=Object(m.e)(e,n);if(o&&Object(v.e)(e,{pageContext:y,feature:b})&&y&&!Object(g.t)(y).isActivated("C5892D55-79FA-4399-8941-95AD020ABB93","3/30/2020","Support direct SharePoint thumbnails")){var w=r.webAbsoluteUrl,E=r.listFullUrl,S=new l.e(w||E).authority;if(a&&a===S){var x=S+"/_api/v2.1",T=e.demandItemFacet(c.e,n),N=e.demandItemFacet(p.c,n)||"";if(T){var C=T.driveId,k=T.itemId,L=Object(h.t)({endpoint:x,driveId:C,itemId:k});return function(e,t){return L+"/thumbnails/0/c"+e+"x"+(t=t||e)+"/content?"+Object(d.e)({prefer:"noredirect,closestavailablesize",cb:N})}}}}}}],Array(104),[function(e,t,n){"use strict";n.d(t,"t",function(){return p});n.d(t,"e",function(){return d});var r=n(0),i=n(94),s=n(233),o=n(1611),u=n(131),a=n(1846),f=n(959),l=n(1),c=n(2658),h=n(146);function p(e){throw new f.e({facets:Object(r.__assign)({},s.a.pack({maxFileSize:e}))})}function d(e){return function(t){if(i.n.isCanceled(e))return new u.e;if(e instanceof a.e)return new f.e({facets:t((p=e,function(e){if(p.errorType===o.e.conflict||p.errorType===o.e.similarNameExists){var t=e(Object(h.e)({enableRenameOnUploadConflict:l.J})).enableRenameOnUploadConflict;switch(p.errorType){case o.e.conflict:return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},s.v.pack({})),s.t.pack(!!t)),s.n.pack(!0)),s.i.pack({supportsRename:!!t}));case o.e.similarNameExists:return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},s.b.pack({})),s.t.pack(!0)),s.n.pack(!1))}}switch(p.errorType){case o.e.accessDenied:return Object(r.__assign)({},s.e.pack({}));case o.e.disconnected:return Object(r.__assign)({},s.m.pack({}));case o.e.emptyFileOrFolder:case o.e.emptyFileOrFolderForDocLib:return Object(r.__assign)({},s.s.pack({}));case o.e.folderUploadNotSupported:return Object(r.__assign)({},s.f.pack({}));case o.e.invalidName:return Object(r.__assign)({},s.c.pack({}));case o.e.lockMismatch:return Object(r.__assign)({},s.p.pack({}));case o.e.malwareDetected:return Object(r.__assign)({},s.d.pack({}));case o.e.overQuota:return Object(r.__assign)({},s.g.pack({}));case o.e.targetFolderMissing:return Object(r.__assign)({},s.w.pack({}));case o.e.throttled:return Object(r.__assign)({},s.E.pack({}));case o.e.versionMismatch:return Object(r.__assign)({},s.S.pack({}))}return Object(r.__assign)({},s.y.pack({}))})),innerError:e});if(Object(c.t)(e)){var n=t(Object(h.e)({enableRenameOnUploadConflict:l.J})).enableRenameOnUploadConflict;return new f.e({facets:Object(r.__assign)(Object(r.__assign)({},"-2130575257"===e.code?Object(r.__assign)({},s.i.pack({supportsRename:!!n})):Object(r.__assign)({},s.y.pack({}))),l._t.pack(e)),message:Object(c.e)(e)})}var p;return e}}},function(e,t,n){"use strict";n.d(t,"t",function(){return r});n.d(t,"e",function(){return i});function r(e){return!!e&&("status"in e||!(!e.message||"object"!=typeof e.message))}function i(e){return e&&e.message&&("object"==typeof e.message?e.message.value:e.message.toString())||""}},function(e,t,n){"use strict";n.d(t,"e",function(){return s});n.d(t,"t",function(){return o});var r=n(2),i=n(98),s=new r.e("assignItemToGroup"),o=new i.e("assignToGroup")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("officeApp")},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(5),i=new r.e("userByEmail",{email:Object(r.s)(),endpoint:Object(r.s)()})},function(e,t,n){"use strict";n.d(t,"e",function(){return l});n.d(t,"t",function(){return c});n.d(t,"n",function(){return h});n.d(t,"r",function(){return p});n.d(t,"i",function(){return d});n.d(t,"s",function(){return m});var r=n(0),i=n(953),s=n(3117),o=n(3116),u=n(77),a=n(124),f=n(109),l=(new a.e("addToOneDrive",function(e,t){return v(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:s.e}))}),new a.e("canCreateFolder",function(e,t){return v(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:s.t}))})),c=(new a.e("canCreateLink",function(e,t){return v(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:s.n}))}),new a.e("canDelete",function(e,t){return v(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:s.r}))})),h=new a.e("canDownload",function(e,t){return!e.demandItemFacet(f.i,t.itemKey)&&v(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:s.i}))}),p=(new a.e("canInvite",function(e,t){return v(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:s.s}))}),new a.e("canMove",function(e,t){return v(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:s.o}))}),new a.e("canUseOfficeLens",function(e,t){return v(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:s.u}))}),new a.e("canRename",function(e,t){return v(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:s.a}))})),d=new a.e("canUpload",function(e,t){return v(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:s.f}))});function v(e,t){var n=t.itemKey,r=t.commandFacet,i=e.demandItemFacet(u.e,n);if(!i)return!1;var s=i.endpoint,a=i.driveId,f=e.demandItemFacet(r,o.e.serialize({endpoint:s,driveId:a}));return!!f&&!!f.roles&&m(e,{itemKey:n,oneOfRequiredRoles:f.roles})}function m(e,t){var n=t.itemKey;return(function(e,t){var n=t.oneOfRequiredRoles,r=t.effectiveRoles;for(var i in r)if(i in n)return!0;return!1})(0,{oneOfRequiredRoles:t.oneOfRequiredRoles,effectiveRoles:(function(e,t){if((function(e,t){var n=e.demandItemFacet(i.e,t);return!n||!n.effectiveRoles||!n.owner})(e,t))return["read","write","owner"];var n=e.demandItemFacet(i.e,t);if(n&&n.effectiveRoles)return n.effectiveRoles;return[]})(e,n)})}},,function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(98),s=new r.e("updatePublishState"),o=new i.e("publish")},function(e,t,n){"use strict";n.d(t,"t",function(){return o});n.d(t,"e",function(){return u});var r,i=n(2),s=n(115);(function(e){e[e.previewColumnFormatter=0]="previewColumnFormatter";e[e.saveColumnFormatter=1]="saveColumnFormatter";e[e.previewViewFormatter=2]="previewViewFormatter";e[e.saveViewFormatter=3]="saveViewFormatter"})(r||(r={}));var o=new i.e("updateFormatter"),u=Object(s.i)({operationTypeFacet:o})},function(e,t,n){"use strict";n.d(t,"e",function(){return k});var r=n(0),i=n("react-lib"),s=n(34),o=n(32),u=n(54),a=n(25),f=n(131),l=n(51),c=n(104),h=n(1),p=n(47),d=n(2547),v=n(2545),m=n(60),g=n(965),y=n(28),b=n(29),w=n(656),E=n(6),S=n(21),x=n(155),T=Object(x.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("25")]).then(n.bind(null,3404))];case 1:return[2,e.sent().ApproveRejectDialog]}})})}),N=Object(s.t)(function(e,t){var n=t.onContinue,s=t.onCancel,o=t.resolve,u=t.reject,a=Object(r.__rest)(t,["onContinue","onCancel","resolve","reject"]);return i.createElement(T,Object(r.__assign)({},a,{onContinue:function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return n?[4,n(e)]:[3,2];case 1:t.sent();t.label=2;case 2:o();return[2]}})})},onCancel:function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return s?[4,s()]:[3,2];case 1:e.sent();e.label=2;case 2:u(new f.e);return[2]}})})}}))}),C=Object(s.t)(function(e,t){var n=t.itemKeys,s=Object(u.e)(e);if(!s)return null;var a=e.demandItem({setKey:l.e},s).setKey;if(!a||!n||!n.length)return null;if(!Object(y.e)(e,{enbableApproveRejectConfiguration:h.x}).enbableApproveRejectConfiguration)return null;var f=!0,x=e.demandItemFacet(h.Be,c.e.serialize({webAbsoluteUrl:a.webAbsoluteUrl,listFullUrl:a.listFullUrl}));if(x&&x.templateType===b.n.webPageLibrary&&n.length>1)return null;for(var T,C,k=!0,L=!0,A=!1,O={},M=0,_=n;M<_.length;M++){var D=_[M];if(!v.e(e,{itemKey:D,listFacets:x}))return null;var P=e.demandItem({permissions:h.st,moderationStatusType:h.Ve,moderationComments:h.Xe},D),H=P.permissions,B=P.moderationStatusType,j=P.moderationComments;if(x&&!x.isDocumentLibrary&&!m.t.hasItemPermission({permissions:H},m.t.layoutsPage))return null;if(void 0!==B){var F=O[g.e[B]];O[g.e[B]]=F?F+1:1}void 0===T?T=j:T!==j&&(k=!1);void 0===C?C=B:C!==B&&(L=!1);B===g.e.draft&&(A=!0);if(!(f=v.t(e,{itemKey:D,includeOneNote:!0})||B===g.e.pending||!!x&&!x.enableMinorVersions))return null}if(x&&x.templateType===b.n.webPageLibrary){if(f){return(D=t.itemKeys?t.itemKeys[0]:void 0)?i.createElement(w.e,{itemKey:t.itemKeys?t.itemKeys[0]:"",engagement:{name:"ApproveReject",isIntentional:!0}}):null}return null}var I,q=L&&C===g.e.draft&&!!x&&!!x.enableMinorVersions,R=A,U=e.dispatch,z=function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,i;return Object(r.__generator)(this,function(r){t=[{FieldName:"_ModerationStatus",FieldValue:e.status.toString()}];void 0!==e.comment&&t.push({FieldName:"_ModerationComments",FieldValue:e.comment});return[2,U(Object(d.e)({items:(i={},i[s]={itemKeys:n,formValues:t,qosName:"BulkApproveReject"},i)}))]})})},W=n.length,X=W>1?"BulkApproveReject":"ApproveReject";1===W&&(I=e.demandItemFacet(E.l,n[0]));var V=Object(S.o)(function(e){return i.createElement(N,Object(r.__assign)({},e,{onContinue:z,hideApproveRejectOptions:q,showDraftOption:R,initialComment:k?T:void 0,initialStatus:L?C:void 0,itemCount:n.length,itemName:I,initialStatusMapForBulkEdit:O}))});return i.createElement(o.e,Object(r.__assign)({isAvailable:f,onExecute:V},Object(p.t)(e,{itemKey:n[0],engagement:{name:X,isIntentional:!0}})))}),k=Object(a.s)()(C)},function(e,t,n){"use strict";n.d(t,"t",function(){return f});n.d(t,"e",function(){return l});var r=n(0),i=n(34),s=n(2139),o=n(25),u=n(6),a=n(47),f=Object(i.e)(function(e,t){var n=t.itemKey,i=t.action,o=!1;if(n){var f=e.demandItem({fileName:u.h,isFolder:u.d},n),l=f&&f.fileName,c=l&&l.extension||"",h=f&&f.isFolder||!1;o=Object(s.t)(i.availableOn,c,Boolean(h))}var p=i.handler,d=p.appId,v=p.isPromoted?"PromotedFileHandlerOpen":"FileHandlerOpen",m={appId:d};return Object(r.__assign)({isAvailable:o,itemKeys:n?[n]:[]},Object(a.t)(e,{itemKey:n,engagement:{name:v,isIntentional:!0,extraData:m}}))})(s.e),l=Object(o.s)()(Object(o.r)()(f))},,function(e,t,n){"use strict";n.d(t,"e",function(){return c});var r=n(0),i=n(34),s=n(32),o=n(104),u=n(1126),a=n(1),f=n(2548),l=n(47),c=Object(i.e)(function(e,t){var n=t.currentDerivedView,i=t.listViewSetKey,s=!1,u=i&&o.e.serialize(i);if(i&&n){var f=e.demandItemFacet(a.Be,u);s=!(!(f&&f.permissions&&f.permissions.manageLists&&n&&n.id)||n.isPersonal||n.isDefault)}return Object(r.__assign)({isAvailable:s},Object(l.t)(e,{itemKey:u,engagement:{name:"SetDefaultView",isIntentional:!0}}))},function(e,t){var n=t.currentDerivedView,i=t.listViewSetKey;return{onExecute:n?function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,s;return Object(r.__generator)(this,function(r){e(Object(f.e)({items:(t={},t[u.e.serialize(i)]={views:(s={},s[n.id]={isDefault:!0},s)},t)}));return[2]})})}:void 0}})(s.e)},,,,,,,function(e,t,n){"use strict";n.d(t,"n",function(){return i});n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=new r.e("shortcutExistedAlready"),s=new r.e("nestedDescendantShortcutExists"),o=new r.e("nestedAscendantShortcutExists")},,function(e,t,n){"use strict";n.d(t,"t",function(){return r});n.d(t,"n",function(){return i});n.d(t,"r",function(){return s});n.d(t,"i",function(){return o});n.d(t,"s",function(){return u});n.d(t,"e",function(){return a});var r="socialBarList_4e4d3e0f",i="socialBarPanel_4e4d3e0f",s="socialBarPanelContent_4e4d3e0f",o="socialBarPanelPersona_4e4d3e0f",u="socialBarPanelPersonaDescription_4e4d3e0f",a="analyticsStatsLink_4e4d3e0f"}],Array(48),[function(e,t,n){"use strict";var r=n(162),i=n("react-lib"),s=n(1097),o=n(6),u=n(21),a=n(490),f=n(129),l=n(113);var c=n(235),h=n(53),p=n(699),d=n(700),v=n(695),m=n(696),g=n(693);n.d(t,"e",function(){return y});var y=Object(p.e)({key:c.r,name:r.e.Name,fieldName:"",isCollapsible:!1,minWidth:445,maxWidth:445,sortProps:h.r},[d.e,g.e,function(e,t){var n=t.itemKey,r=t.renderer,c=e.demandItemFacet(o.A,n),h=c&&e.demandItemFacet(o.L,c.itemKey)||"",p=h?(function(e){for(var t=[],n=new f.e(e),r=0,i=n.segments.slice(1);r<i.length;r++){var s=i[r];try{t.push(decodeURIComponent(s))}catch(e){t.push(s)}}return t})(h):[],d=c&&h?Object(l.r)(e,i.createElement(a.e,{itemKey:c.itemKey})):null;return{renderer:function(e,t,n){var o=r?r(e,t,n):null;return i.createElement(i.Fragment,null,o?i.createElement(i.Fragment,{key:"content"},o):null,d?i.createElement(u.n,{key:"path",action:d},function(e){var t=e.execute,n=e.isAvailable?function(e){t({event:e}).catch(function(){});e.preventDefault();e.stopPropagation()}:void 0;return i.createElement(s.e,{displayPathSegments:p,parentLink:h,onClick:n})}):null)}}},v.e,m.e])}],Array(25),[function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("graphThumbnailSet")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("vault")},function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(5),i=n(77),s=new r.e("searchItemSet",{driveItemKey:Object(r.o)(i.e),searchTerm:Object(r.s)()})},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(5),i=new r.e("thumbnailToken",{endpoint:Object(r.s)(),driveId:Object(r.s)({shouldNormalizeToEmpty:!0})})},function(e,t,n){"use strict";n.d(t,"e",function(){return u});n.d(t,"t",function(){return a});var r,i=n(23),s=n(3454);(function(e){e[e.InvalidStart=0]="InvalidStart";e[e.InvalidEnd=1]="InvalidEnd";e[e.InvalidCharacters=2]="InvalidCharacters";e[e.Empty=3]="Empty"})(r||(r={}));function o(e){return function(t){return(function(e,t){switch(e){case r.InvalidCharacters:return i.format(s.e.invalidNameError,t.invalidCharacters);case r.InvalidStart:return i.format(s.e.invalidNameStartError,t.cannotStartWith);case r.InvalidEnd:return i.format(s.e.invalidNameEndError,t.cannotEndWith);case r.Empty:return s.e.emptyNameError;case void 0:return}})((function(e,t){var n=e.trim();return 0===n.length?r.Empty:t.invalidCharactersRegex.test(n)?r.InvalidCharacters:t.cannotStartWithRegex&&t.cannotStartWithRegex.test(n)?r.InvalidStart:t.cannotEndWithRegex&&t.cannotEndWithRegex.test(n)?r.InvalidEnd:void 0})(t,e),e)}}var u=o({invalidCharactersRegex:/["\*:<>\?\/\\\|]/,invalidCharacters:'" * : < > ? / \\ |'}),a=o({invalidCharactersRegex:/["\*:<>\?\/\\\|#%]/,invalidCharacters:'" * : < > ? / \\ # %|'})},function(e,t,n){"use strict";n.d(t,"t",function(){return u});n.d(t,"e",function(){return a});var r=n(121),i=n(786),s=n(29),o=n(391);function u(e){return function(t){return t(Object(r.r)({webAbsoluteUrl:e.webAbsoluteUrl,listFullUrl:e.listFullUrl,method:"GET",url:c(e),qosName:"getViewData",additionalHeaders:e.preferredLanguage?{"Accept-Language":e.preferredLanguage}:{},parseResponse:function(t){return JSON.parse(t).d.results.map(function(t){var n=f(t,!1,e.listTemplate);t&&n&&!t.ViewData&&(t.ViewData=n.viewData);return{serverView:t,view:n}})},noRedirect:!0}))}}function a(e){return function(t){return t(Object(r.r)({webAbsoluteUrl:e.webAbsoluteUrl,listFullUrl:e.listFullUrl,method:"GET",url:c(e),qosName:"getViewDataById",parseResponse:function(e){var t=JSON.parse(e).d;return{serverView:t,view:f(t,!0)}},noRedirect:!0}))}}function f(e,t,n){if(e.ViewType&&e.Id){var r=o.e.isAppView(e),i=e.Hidden&&!r,u=n===s.t.pictureLibrary&&"2"===e.BaseViewId&&window.location.pathname.toLowerCase()!==e.ServerRelativeUrl.toLowerCase();if(t||!i&&!u){var a=new o.e(e);if(a.viewType)return a}}}var l=["BaseViewId","DefaultView","EditorModified","Hidden","Id","ListViewXml","PersonalView","RowLimit","Scope","ServerRelativeUrl","TabularView","Title","ViewType","VisualizationInfo","CustomFormatter"].join(",");function c(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,r=e.viewId,s=Object(i.e)({webAbsoluteUrl:t,listFullUrl:n});return(s=r?s.method("Views",r):s.segment("Views")).oDataParameter("$select",l).toString()}},,function(e,t,n){"use strict";n.d(t,"e",function(){return i});n.d(t,"n",function(){return s});n.d(t,"t",function(){return o});var r=n(2),i=new r.e("enabledForMultipleItems"),s=new r.e("isEnabledFunction"),o=new r.e("iconUrl")},function(e,t,n){"use strict";n.d(t,"t",function(){return c});n.d(t,"e",function(){return h});n.d(t,"r",function(){return p});n.d(t,"n",function(){return v});n.d(t,"i",function(){return m});var r=n("react-lib"),i=n(2985),s=n(2984),o=n(2),u=n(308),a=n(2763),f=n(2762),l=new o.e("moreCommands").id,c={key:new o.e("CheckOutItem").id,automationId:"checkOutItemCommand",name:s.e.CheckOut,iconProps:{iconName:"ArrowDownRight8"},action:r.createElement(i.e,{checkInOutType:"checkOut"})},h={key:new o.e("CheckInItem").id,automationId:"checkInItemCommand",name:s.e.CheckIn,iconProps:{iconName:"ArrowDownRight8"},action:r.createElement(i.e,{checkInOutType:"checkIn"})},p={key:new o.e("UndoCheckOutItem").id,automationId:"undoCheckoutItemCommand",name:s.e.UndoCheckOut,iconProps:{iconName:"ArrowDownRight8"},action:r.createElement(i.e,{checkInOutType:"undoCheckOut"})},d={key:new o.e("ViewDocumentProperties").id,name:u.e.ViewProperties,action:r.createElement(f.e,{interactiveSave:!0})},v={key:l,automationId:"moreCommands",name:"",iconProps:{iconName:"More"},subMenuProps:{items:[d,c,h,p]}};function m(e){var t=e.listFacets,n=Object(a.e)({listFacets:t}),r=!!t&&!t.isDocumentLibrary;return{key:l,automationId:"moreCommands",name:"",iconProps:{iconName:"More"},subMenuProps:{items:r?[n]:[d,c,h,p,n]}}}},function(e,t,n){"use strict";n.d(t,"e",function(){return b});var r=n(0),i=n("react-lib"),s=n(60),o=n(155),u=n(2549),a=n(34),f=n(21),l=n(184),c=n(1),h=n(47),p=n(32),d=n(44),v=n(104),m=n(29),g=n(28),y=Object(o.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("11")]).then(n.bind(null,3535))];case 1:return[2,e.sent().EditItemWizard]}})})}),b=Object(a.t)(function(e,t){var n=Object(l.e)(e),o=1===n.length?n[0]:void 0,a=Object(g.e)(e,{enableEditItemCommand:c.C}).enableEditItemCommand,b=e.demandItemFacet(u.e,o),w=u.e.evaluate(b)(e,{itemKey:o}).getPropertiesForm,E=e.demandItemFacet(c.st,o),S=e.demandItemFacet(d.e,o),x=S&&e.demandItemFacet(c.Be,v.e.serialize(S)),T=x&&x.templateType===m.t.mySiteDocumentLibrary,N=a&&!!w&&!!E&&!T&&s.t.hasItemPermission({permissions:E},s.t.editListItems),C=o&&w?Object(f.o)(function(e){return i.createElement(y,Object(r.__assign)({},e,{itemKey:o,interactiveSave:t.interactiveSave,getPropertiesForm:w}))}):void 0;return i.createElement(p.e,Object(r.__assign)({isAvailable:N,onExecute:C},Object(h.t)(e,{itemKey:o,engagement:{name:"EditItem",isIntentional:!0}})))})},function(e,t,n){"use strict";n.d(t,"e",function(){return f});var r=n("react-lib"),i=n(2),s=n(308),o=n(2666),u=n(29),a=new i.e("ApproveReject").id;function f(e){var t=e.listFacets,n=t&&t.templateType===u.n.webPageLibrary&&t.isModerated?s.e.ReviewApprovals:s.e.ApproveReject;return{key:a,automationId:"approveRejectCommand",iconProps:{iconName:"DocumentApproval"},name:n,action:r.createElement(o.e,null)}}},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(16).e)("saveViewActionControl")},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(51),i=n(164);function s(e,t){var n=t.itemSetKey,s=e.demandItemFacet(r.e,n);return s&&s.viewKey&&i.e.serialize(s.viewKey)}},,,,,,,,,function(e,t,n){"use strict";n.d(t,"t",function(){return g});n.d(t,"e",function(){return y});var r=n(0),i=n("react-lib"),s=n(25),o=n(32),u=n(21),a=n(34),f=n(117),l=n(43),c=n(155),h=n(47),p=n(674),d=Object(l.e)()(Object(c.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred.resx-deferred"),n.e("467")]).then(n.bind(null,3602))];case 1:return[2,e.sent().LaunchMoveCopyPickerWizard]}})})})),v=Object(a.t)(function(e,t){var n=t.itemKeys,s=t.isMove,a=void 0!==s&&s;if(0===n.length)return null;var l=Object(f.e)(e);if(!l)return null;var c=e.demandItemFacet(p.e,n[0]),v=p.e.evaluate(c)(e,{entryItemKey:l,sourceItemKeys:n,isMove:a,isAvailable:!1,moveCopyPickerWizard:d}),m=v.isAvailable,g=v.moveCopyPickerWizard;if(!m||!g)return null;var y=Object(u.o)(function(e){return i.createElement(g,Object(r.__assign)({isMove:a,entryItemKey:l,sourceItemKeys:n},e))},{scope:"global"});return i.createElement(o.e,Object(r.__assign)({onExecute:y},Object(h.t)(e,{itemKey:n[0],engagement:{name:a?"MoveTo":"CopyTo"}})))}),m=Object(s.s)()(v),g=Object(a.e)(function(){return{isMove:!0}})(m),y=Object(a.e)(function(){return{isMove:!1}})(m)}],Array(126),[function(e,t,n){"use strict";var r=n(0),i=n(44),s=n(51),o=n(104),u=n(1126),a=n(164),f=n(1),l=n(2912),c=n(498),h=n(2246),p=n("react-lib"),d=n(211),v=n(1143),m=n(841),g=n(6),y=n(134),b=n(155),w=n(29),E=n(308),S=n(23),x=n(569),T=n(56),N=n(504),C=n(2550),k=n(2988),L=n(25),A=n(28),O=n(182),M=n(102),_=n(264),D=n(35),P=n(496),H=new M.e;function B(e,t){var n=Object(A.e)(e,{enableQuickEdit:f.$}).enableQuickEdit,r=Object(D.e)(e).itemsScopeItemKey,i=r&&Object(_.e)(e,{itemsScopeItemKey:r}),s=i&&i.id===P.e.id;return!!(n&&!!s&&!H.isIE)}var j=Object(L.n)()(Object(O.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e("16").then(n.bind(null,4025))];case 1:return[2,e.sent().SwitchGridLayoutActionExecutor]}})})},B,function(e,t){var n=t.itemKey,r=t.viewType,i=e.demandItem({deserizalizedKey:s.e},n).deserizalizedKey,o=i&&i.viewKey&&a.e.serialize(i.viewKey),u=o&&e.demandItemFacet(f.pn,o);return B(e)&&u===r})),F=n(462),I=n(34),q=n(379),R=n(47),U=n(32),z=n(136);var W=Object(I.t)(function(e,t){var n,i,u,a,l,c,h=t.viewKey,d=t.itemSetKey,v=void 0,m=d&&e.demandItemFacet(s.e,d),g=e.demandItemFacet(f.v,h);if(m&&g){var b=o.e.serialize({webAbsoluteUrl:m.webAbsoluteUrl,listFullUrl:m.listFullUrl}),w=e.demandItemFacet(f.Be,b),E=e.demandItemFacet(f.Qt,q.e.serialize({webAbsoluteUrl:m.webAbsoluteUrl,listFullUrl:m.listFullUrl}));E&&w&&w.id&&g&&"POWER"!==g.viewType&&w.permissions&&g.canUserEdit(w.permissions)&&(v=(n={webAbsoluteUrl:m.webAbsoluteUrl,layoutsUrl:E.layoutsUrl,viewId:g.id,listId:w.id,sourceUrl:g.serverRelativeUrl||""},i=n.webAbsoluteUrl,u=n.layoutsUrl,a=n.viewId,l=n.listId,c=n.sourceUrl,i+"/"+u+"/ViewEdit.aspx?"+Object(z.e)({View:y.e.normalizeUpper(a,!0),List:y.e.normalizeUpper(l,!0),Source:c})))}var S=!!v;return p.createElement(U.e,Object(r.__assign)({isAvailable:S,onExecute:function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){window.open(v);return[2]})})}},Object(R.t)(e,{itemKey:d,engagement:{name:"CustomizeView",isIntentional:!0}})))});var X=Object(O.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e("22").then(n.bind(null,2790))];case 1:return[2,e.sent().SwitchViewExecutor]}})})},function(e,t){return!0},function(e,t){var n=t.currentDerivedView,r=t.viewId;return n?r===n.id:""===r}),V=n(54),$=n(2764),J=n(21),K=n(644),Q=Object(b.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred.resx-deferred"),n.e("440")]).then(n.bind(null,3859))];case 1:return[2,e.sent().ViewCreator]}})})}),G=Object(I.t)(function(e,t){var n=t.currentViewKey,i=Object(V.e)(e),u=Object(D.e)(e).itemsScopeItemKey,a=!1,l=e.demandItemFacet(s.e,i),c=e.demandItemFacet(f.v,n),h=e.demandItemFacet($.e,i),d=$.e.evaluate(h)(e,{viewKey:n}).onViewSaved;if(l&&c){var v=o.e.serialize({webAbsoluteUrl:l.webAbsoluteUrl,listFullUrl:l.listFullUrl}),m=e.demandItemFacet(f.Be,v);a=!!(m&&c&&"POWER"!==c.viewType&&m.permissions&&(m.permissions.managePersonalViews||m.permissions.manageLists))}if(!c||!i||!u)return null;var g=Object(J.o)(function(e){return p.createElement(K.e,{itemsScopeItemKey:u},p.createElement(Q,Object(r.__assign)({},e,t,{itemSetKey:i,viewTitle:c.title,isPublicView:!c.isPersonal,onViewSaved:d})))},{scope:"global"});return p.createElement(U.e,Object(r.__assign)({isAvailable:a,onExecute:g},Object(R.t)(e,{itemKey:i,engagement:{name:"SaveView",isIntentional:!0}})))}),Y=n(2669),Z=n(2),ee=Object(Z.t)("createView"),te=Object(Z.t)("switchView"),ne=Object(Z.t)("needsAttentionView"),re=Object(Z.t)("setDefaultView"),ie=Object(Z.t)("customizeView"),se=Object(Z.t)("switchToFixedGridLayoutCommand"),oe=Object(Z.t)("switchToDynamicGridLayoutCommand"),ue=Object(Z.t)("calendarMonth"),ae=Object(Z.t)("kanban"),fe=Object(Z.t)("saveView"),le=Object(Z.t)("syncIssues"),ce=n(99),he=n(285),pe=n(2289),de=n(139),ve=n(8),me=n(2987),ge=[{ODB:1776},{ODB:1772},{ODB:60020}],ye={ODB:1484},be={iconName:void 0,styles:{root:{display:"none!important"}}},we=Object(b.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred.resx-deferred"),n.e("440")]).then(n.bind(null,4024))];case 1:return[2,e.sent().CreateViewAction]}})})}),Ee={key:se,automationId:"switchToFixedGridLayoutCommand",name:E.e.fixedHeight,action:p.createElement(j,{viewType:"GRIDFIXED"}),iconProps:{iconName:"ViewList"}},Se={key:oe,automationId:"switchToDynamicGridLayoutCommand",name:E.e.dynamicHeight,action:p.createElement(j,{viewType:"GRID"}),iconProps:{iconName:"DynamicList"}};function xe(e,t){var n,i,s=t.viewKeys,l=t.webAbsoluteUrl,c=t.listViewSetKey,h=t.itemSetKey,b=t.currentViewKey,L=o.e.serialize({webAbsoluteUrl:c.webAbsoluteUrl,listFullUrl:c.listFullUrl}),A=Object(T.e)(e,{feature:ye})&&ge.some(function(t){return Object(T.e)(e,{feature:t})}),O=e.demandItemFacet(f.Be,L),M=!!O&&!!O.templateType&&Object(w.s)(O.templateType),_=!!O&&!!O.templateType&&O.templateType===w.n.webPageLibrary,D=!1,P=E.e.Views,H=e.demandItem({showViewModifiedIndicator:f.St,currentDerivedView:f.v,currentViewBasicInfo:f.cn},b),B=H.showViewModifiedIndicator,j=H.currentDerivedView,I=H.currentViewBasicInfo;O&&j&&"POWER"!==j.viewType&&O.permissions&&j.canUserEdit(O.permissions)&&(D=!0);j&&j.title?P=j.title:I&&I.Title&&(P=I.Title);D&&(B||j&&j.isDirty())&&(P=S.format(E.e.ViewModifiedIndicator,P));var q=s.map(function(t){var n=e.demandItemFacet(f.wt,t),r=e.demandItemFacet(f.cn,t);return n&&!n.Hidden?Te(n,l,h,j):r?Te(r,l,h,j):void 0}).filter(function(e){return!!e}),R=(function(e,t){var n=e.demandItemFacet(f.Ke,t);return!(!n||!e.demandItemFacet(g.C,n))})(e,h),U=(function(e,t){var n,i,s=t.isPagesLib,o=t.isList,u=t.itemsNeedAttention,a=t.currentDerivedView,f=t.itemSetKey,l=m.e;if(s&&Object(T.e)(e,{feature:{ODB:1743}})){n=E.e.PagesThatNeedAttention;i="PagesThatNeedAttention"}else{n=o?E.e.ItemsThatNeedAttention:E.e.FilesThatNeedAttention;i=o?"ItemsThatNeedAttention":"FilesThatNeedAttention"}return{key:ne,automationId:"needsAttentionViewCommand",name:n,iconProps:u?{iconName:"error",styles:{root:"needsAttentionIcon_817fe717"}}:be,action:p.createElement(X,{viewId:l,currentDerivedView:a,itemSetKey:f}),facets:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},ce.i.pack(!0)),me.r.pack(!0)),me.n.pack(!0)),engagement:{name:i}}})(e,{isList:M,isPagesLib:_,itemsNeedAttention:R,itemSetKey:h,currentDerivedView:j}),z=(function(e,t,n){var r=o.e.serialize({webAbsoluteUrl:t,listFullUrl:n}),i=e.demandItemFacet(f.d,r),s=[];i&&i.length&&i.forEach(function(t){var n=e.demandItemFacet(f.Jt,t),r=n&&n.requiredFields&&n.requiredFields.split(",");r&&r.length>0&&(s=s.concat(r))});return s.length>0})(e,l,c.listFullUrl),V=M&&Object(T.e)(e,{feature:pe.t})&&!!e.demandItemFacet(f.Mt,de.e),$=v.n.serialize({webAbsoluteUrl:l,listFullUrl:c.listFullUrl}),J=V&&!!(null===(i=null===(n=e.demandItemFacet(ve.e,$))||void 0===n?void 0:n.itemKeys)||void 0===i?void 0:i.length),K=E.e.listSyncIssuesViewMenuItem,Q=J?{key:le,automationId:"itemsWithSyncIssuesViewCommand",name:K,iconProps:J?{iconName:"error",styles:{root:"needsAttentionIcon_817fe717"}}:be,action:$?p.createElement(he.e,{itemKey:$}):void 0,facets:Object(r.__assign)(Object(r.__assign)({},me.n.pack(!0)),me.r.pack(!0))}:void 0,Z=j?(function(e){var t=e.isCreateNewViewEnabled,n=e.currentDerivedView,i=e.listViewSetKey,s=e.itemSetKey,o=e.allowEditCurrentView,f=a.e.serialize({viewId:n.id}),l=u.e.serialize(i),c=o||t&&"MODERNCALENDAR"===n.viewType;return Object(r.__spreadArrays)(t?[{key:ee,automationId:"createViewCommand",name:E.e.CreateNewView,iconProps:be,action:p.createElement(we,{listViewSetKey:l,currentViewKey:f,isEditing:!1}),facets:Object(r.__assign)(Object(r.__assign)({},me.n.pack(!0)),me.e.pack(!0))}]:[],[{key:fe,automationId:"saveCommand",name:E.e.SaveViewAs,iconProps:be,action:p.createElement(G,{listViewSetKey:l,currentViewKey:f}),facets:Object(r.__assign)(Object(r.__assign)({},me.n.pack(!0)),me.t.pack(!0))},{key:re,automationId:"setDefaultViewCommand",name:E.e.SetDefaultView,iconProps:be,action:p.createElement(Y.e,{currentDerivedView:n,listViewSetKey:i}),facets:Object(r.__assign)(Object(r.__assign)({},me.n.pack(!0)),me.t.pack(!0))}],c?[{key:ie,automationId:"customizeViewCommand",name:E.e.CustomizeView,iconProps:be,action:"MODERNCALENDAR"===n.viewType?p.createElement(we,{listViewSetKey:l,currentViewKey:f,isEditing:!0}):p.createElement(W,{viewKey:f,itemSetKey:s}),facets:Object(r.__assign)(Object(r.__assign)({},me.n.pack(!0)),me.t.pack(!0))}]:[])})({listViewSetKey:c,isCreateNewViewEnabled:A,currentDerivedView:j,itemSetKey:h,allowEditCurrentView:D}):[],te=e.demandItemFacet(f.pn,b),se="MODERNCALENDAR"===te?[{key:ue,isPermanent:!1,automationId:"calendarMonthCommand",name:E.e.calendarMonthTitle,title:E.e.calendarMonthDesc,action:p.createElement(N.e,{layoutType:C.e}),iconProps:{iconName:"calendar"}}]:[],oe="KANBAN"===te?[{key:ae,isPermanent:!1,automationId:"kanbanCommand",name:E.e.kanbanLayoutTitle,title:E.e.kanbanLayoutDesc,action:p.createElement(N.e,{layoutType:k.e}),iconProps:{iconName:"TripleColumn"}}]:[],xe=[];if(x.e.subMenuProps){var Ne=e.demandItemFacet(f.hn,b),Ce=Ne&&Ne.viewFormatter,ke=Ce&&Ce.isTileDesignerTemplateApplied(),Le=Ce&&Ce.getTileProps(),Ae=!!(Le&&Le.formatter&&Le.formatter);if(M&&(ke||Object(T.e)(e,{feature:{ODB:1396}})&&!Ae))for(var Oe=0,Me=x.e.subMenuProps.items;Oe<Me.length;Oe++){var _e=Me[Oe];_e.key!==F.r?xe.push(_e):xe.push(Object(r.__assign)(Object(r.__assign)({},_e),{name:E.e.GalleryLayout,title:E.e.GalleryLayoutCommandTooltip,automationId:"galleryLayoutCommand"}))}else xe=x.e.subMenuProps.items}var De=[];z&&De.push(U);J&&Q&&De.push(Q);De.length>0&&De.push({name:"-",key:"divider_1",itemType:d.e.Divider});var Pe=Object(r.__spreadArrays)(xe,se,oe,[{name:"-",key:"divider_1",itemType:d.e.Divider}],De,[Ee,Se,{name:"-",key:"divider_1",itemType:d.e.Divider}],q,[{name:"-",key:"divider_1",itemType:d.e.Divider}],Z,[{name:"-",key:"divider_1",itemType:d.e.Divider}]),He={name:P,key:x.e.key,automationId:x.e.automationId,iconProps:x.e.iconProps,title:E.e.SwitchViewsCommandTitle,ariaLabel:S.format(E.e.SwitchViewsCommandAriaLabel,P),postProcess:function(e){var t=e.subMenuProps&&e.subMenuProps.items,n=t&&t.filter(function(e){return e.checked})[0];return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},e),t&&1===t.length?{subMenuProps:void 0,disabled:!0}:{}),n?{iconProps:Object(r.__assign)(Object(r.__assign)({},n.iconProps),R||J?{styles:{root:"needsAttentionIconOverlay_817fe717"}}:{})}:{})},subMenuProps:{items:Pe},facets:Object(r.__assign)({},ce.i.pack(!0))},Be=j?y.e.normalizeLower(j.id,!1):"";He.cacheKey=x.e.key+"_viewId_"+Be;return He}function Te(e,t,n,i){var s=y.e.normalizeLower(e.Id,!1);return{key:te+"-"+s,automationId:"switchViewCommand_"+s,name:e.Title,iconProps:be,action:p.createElement(X,{viewId:s,currentDerivedView:i,itemSetKey:n}),facets:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},ce.i.pack(!0)),me.n.pack(!0)),me.r.pack(!0))}}var Ne=n(3076),Ce=n(3077),ke=n(199),Le=n(2365),Ae=n(2196),Oe=new Z.e("Publish").id,Me=new Z.e("Schedule").id,_e=new Map([[Ae.e.Publish,E.e.Publish],[Ae.e.CancelApproval,E.e.CancelApproval],[Ae.e.SubmitForApproval,E.e.SubmitForApproval],[Ae.e.SchedulePublish,E.e.Schedule],[Ae.e.Republish,E.e.Republish]]),De=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.defaultRender,n=e.itemKeys,i=Object(r.__rest)(e,["defaultRender","itemKeys"]),s=n[0];return p.createElement(ke.e,null,function(e){var n=e.itemCache,o=Object(Le.n)(n,s),u=_e.get(o)||E.e.Publish;return t?p.createElement(t,Object(r.__assign)({},i,{text:u})):null})};return t})(p.PureComponent),Pe={key:Oe,automationId:"PublishCommand",iconProps:{iconName:"ReadingMode"},name:E.e.Publish,action:p.createElement(Ce.t,{publishType:0,source:"Command"}),commandBarButtonAs:Object(L.s)()(De)},He={key:Me,automationId:"ScheduleCommand",iconProps:{iconName:"DateTime2"},name:E.e.Schedule,action:p.createElement(Ce.t,{publishType:1,source:"Command"}),commandBarButtonAs:Object(L.s)()(De)},Be=n(2761),je=n(1095),Fe=n(1012);var Ie=Object(L.n)()(Object(O.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e("15").then(n.bind(null,4229))];case 1:return[2,e.sent().ExitQuickEditActionExecutor]}})})},function(e,t){var n=Object(A.e)(e,{enableQuickEdit:f.$}).enableQuickEdit,r=!!n;if(n){r=Object(_.e)(e)===P.e}return r})),qe={key:new Z.e("exitQuickEdit").id,automationId:"exitQuickEditCommand",name:E.e.ExitGridView,action:p.createElement(Ie,null),iconProps:{iconName:"ViewList"}};var Re=n(10),Ue=n(495),ze=n(3069),We=n(562),Xe=n(663),Ve=n(314),$e=n(1616),Je=n(1720),Ke=n(1519),Qe=n(1575),Ge=n(1892),Ye=n(127),Ze=[{keys:"Ctrl + a",desc:Ve.e.selectAllDesc},{keys:"Ctrl + d",desc:Ve.e.deselectAllDesc},{keys:"esc",desc:Ve.e.escDesc},{keys:"space",desc:Ve.e.spaceDesc},{keys:"enter",desc:Ve.e.enterDesc}],et=[{keys:"F2",desc:Ve.e.renameDesc},{keys:"Delete",desc:Ve.e.deleteDesc},{keys:"s",desc:Ve.e.showShareDesc},{keys:"alt + up",desc:Ve.e.altUpDesc},{keys:"?",desc:Ve.e.showKeymapDesc},{keys:"g",desc:Ve.e.showActionDetailsDesc},{keys:"i",desc:Ve.e.toggleInfoDesc}];function tt(e){var t=e.resolve,n=Object(Ye.e)(function(){t()}),r=[Ze,et],i=-1,s=-1;return p.createElement(Ge.e,null,p.createElement(Je.e,{onDismiss:n,hidden:!1,dialogContentProps:{type:Ke.e.close,title:Ve.e.KeyboardMapTitle},styles:rt},r.map(function(e){return p.createElement("div",{className:"keyboardMapGroup_0538ad13",key:"keyMap"+ ++i},p.createElement("ul",{className:"keyboardMapTable_0538ad13",key:""+i},e.map(function(e){return p.createElement("li",{className:"keyboardMapRow_0538ad13",key:""+ ++s},p.createElement("span",{className:"keyboardMapKey_0538ad13",key:i+"."+s+".0.0"},e.keys),p.createElement("span",{className:"keyboardMapVal_0538ad13",key:i+"."+s+".1.1"},e.desc))})))}),p.createElement(Qe.e,null,p.createElement($e.e,{onClick:n},Ve.e.okButtonText))))}var nt=Object(I.t)(function(e){var t=Object(J.o)(tt);return p.createElement(U.e,{onExecute:t})});function rt(){return{main:{maxWidth:"700px !important"}}}var it={key:new Z.e("ShowKeymapShortcut").id,automationId:"ShowKeymapShortcut",shortcutProps:{keySequences:["Shift/"],content:Ve.e.showKeymapDesc},action:p.createElement(nt,null)},st=Object(I.t)(function(e,t){var n=t.itemKey,r=e.demandItemFacet(g.A,n),i=r&&r.itemKey;return p.createElement(he.e,{itemKey:i})}),ot=Object(L.i)()(st),ut={key:new Z.e("NavigateUpShortcut").id,automationId:"NavigateUpShortcut",shortcutProps:{keySequences:["AltUp"],content:Ve.e.altUpDesc},action:p.createElement(ot,null),facets:Object(r.__assign)({},ce.i.pack(!0))},at=n(2269),ft=n(1030),lt=n(3064),ct=n(2989),ht=n(3089),pt=n(90),dt=n(2763),vt=n(75),mt=n(683),gt=n(59),yt=n(3070),bt=n(676);n.d(t,"e",function(){return xt});n.d(t,"t",function(){return Tt});n.d(t,"r",function(){return Nt});n.d(t,"n",function(){return Ct});var wt={ODB:1544},Et=[Be.t,Be.e,Be.r],St=[it,ut],xt="658D384B-C862-48CC-986B-F1CD32B00BFE",Tt=Object(Re.t)()(Lt),Nt=Object(Re.t)()(Lt),Ct=function(e,t){var n=Object(r.__rest)(h.e,[]);if(e&&e.open&&e.open.length>0){n.subMenuProps=n.subMenuProps||{};n.subMenuProps.items=Object(at.t)(n.subMenuProps&&n.subMenuProps.items||[],e.open,t);!vt.e.isActivated("BC85A80B-0AA5-41F5-98B6-C875D1773EE5","12/9/2019","Log engagement for open menu for promoted file handler")&&e.open.some(function(e){return e.isPromoted||!1})&&(n.engagement={name:"OpenCommand",isIntentional:!0,extraData:{hasPromotedFileHandler:!0}})}return n};function kt(e,t){var n,p,d=t.itemKey,v=t.itemSetKey,m=t.commands,g=t.overflowCommands,b=t.farCommands,E=t.shortcutCommands,S=e.demandItemFacet(i.e,d),N=e.demandItemFacet(s.e,v),C=g?Object(r.__spreadArrays)(g):[],k=!0,L=!1,O=void 0,M=void 0,H=void 0,B=m?Object(r.__spreadArrays)(m):[],j=b,F=[],I="",q=S&&o.e.serialize(S),R=e.demandItemFacet(o.e,q);N&&N.viewKey&&(I=N.viewKey.viewId);var U,z,W,X=[],V=!1;if(S&&R){V=Object(ft.t)(e,d,S);var $=e.demandItemFacet(f.Be,q);k=!!$&&!!$.isDocumentLibrary;U=Object(pt.e)(e,d);k?F=E?Object(r.__spreadArrays)(E,St):Object(r.__spreadArrays)(St):B=Object(l.e)(U);if(!(L=!!$&&$.templateType===w.t.mySiteDocumentLibrary)){k&&C.push.apply(C,Et);C&&C.push(Object(dt.e)({listFacets:$}));var J={webAbsoluteUrl:R.webAbsoluteUrl,listFullUrl:R.listFullUrl},K=u.e.serialize(J),Q=e.demandItemFacet(ve.e,K);if(Q&&Q.itemKeys&&b){!I&&U&&U.viewId&&(I=y.e.normalizeLower(U.viewId,!1));p=e.demandItemFacet(f.Ye,q);j=(z=b,W=xe(e,{viewKeys:Q.itemKeys,webAbsoluteUrl:S.webAbsoluteUrl,listViewSetKey:J,itemSetKey:v,currentViewKey:a.e.serialize({viewId:I})}),z.map(function(e){return e.key===x.e.key?W:e}))}}$&&R&&(X=(n=Object(ht.e)(e,{key:S,listFacets:$,listKey:R,pageContext:U})).contentTypes,O=n.contentTypeCommands);M=Object(ze.t)(e,S);U&&$&&(H=Object(ct.e)(e,{isODB:L,key:S,listFacets:$,pageContext:U}).fileHandlerCommands)}var G=Object(A.e)(e,{enableQuickEdit:f.$,enableUniversalPrint:gt.u}),Y=G.enableQuickEdit,Z=G.enableUniversalPrint,ee=!!U&&!!Y;if(ee){var te=Object(D.e)(e).itemsScopeItemKey;if(Object(_.e)(e,{itemsScopeItemKey:te})===P.e)return{commands:[qe],overflowCommands:[],farCommands:[],shortcutCommands:[]}}var ne=(function(e,t){for(var n=t.quickEditEnabled,r=t.defaultCommands,i=t.isDocumentLibrary,s=t.isODB,o=t.contentTypeCommands,u=t.customActionCommands,a=t.fileHandlerCommands,f=t.newDocumentTemplates,l=t.contentTypes,p=t.isCreateFolderAvailable,d=t.listKey,v=t.pageContext,m=t.printEnabled,g=[],y=!vt.e.isActivated(xt,"7/5/2019","Show file handler commands before OOB commands"),b={},w=0,E=r;w<E.length;w++){var S=E[w];b[S.key]=S}for(var x=0,N=r;x<N.length;x++){if((S=N[x]).key===Ue.e.key){var C=Object(lt.e)(e,{contentTypes:l,newCommandMenu:S,fileHandlerCommands:a,isCreateFolderAvailable:p,newDocumentTemplates:f,contentTypeCommands:o,listKey:d}).visibleNewCommands;g.push(C)}else if(S.key===mt.e.key&&n&&!b[Fe.t.key])g.push(S,Fe.t);else if(S.key===h.e.key){var k=Ct(a,y);g.push(k)}else if(S.key===We.t.key&&i&&!b[je.e.key])g.push(S,je.e);else if(S.key===Xe.e.key&&i){g.push(S);s||b[c.e.key]||g.push(c.e);g.push(Ne.t,Ne.e)}else if(S.key===We.n.key){!i&&Object(T.e)(e,{feature:wt,pageContext:v})?g.push(We.e):g.push(S);g.push(Pe,He)}else S.key===bt.e.key&&m?g.push(bt.e,yt.e):g.push(S)}u&&u.length>0&&g.push.apply(g,u);a&&a.custom&&a.custom.length>0&&(g=Object(at.t)(g,a.custom));return{overrideDefaultCommands:g}})(e,{defaultCommands:B,isDocumentLibrary:k,isODB:L,contentTypeCommands:O,customActionCommands:M,fileHandlerCommands:H,newDocumentTemplates:p,contentTypes:X,isCreateFolderAvailable:V,quickEditEnabled:ee,listKey:S,pageContext:U,printEnabled:!!Z});return{commands:B=ne.overrideDefaultCommands,overflowCommands:C,farCommands:j,shortcutCommands:F}}function Lt(){return function(e){return function(e,t){return kt(e,t)}}}},,,,,,,,function(e,t,n){"use strict";var r=n("react-lib"),i=n(308),s=n(663),o=n(562),u=n(50),a=n(0),f=n(25),l=n(34),c=n(32),h=n(44),p=n(379),d=n(104),v=n(1),m=n(29),g=n(1021),y=n(441),b=n(60),w=n(47),E=n(28),S=function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){return[2]})})},x=Object(f.s)()(Object(f.r)()(Object(l.e)(function(e,t){var n=t.itemKey,r=t.isEditForm,i=!1,s=S;if(Object(E.e)(e,{enableEditOrViewItemCommandConfiguration:v.k}).enableEditOrViewItemCommandConfiguration){var o=e.demandItem({key:h.e,itemId:v.Ie,contentTypeId:v.p,permissions:v.st},n),u=o.key,f=o.itemId,l=o.contentTypeId,c=o.permissions;if(u&&f&&(!r||c&&b.t.hasItemPermission({permissions:c},b.t.editListItems))){var x=u&&e.demandItemFacet(v.Qt,p.e.serialize({webAbsoluteUrl:u.webAbsoluteUrl,listFullUrl:u.listFullUrl}));if(x&&!x.isAnonymousGuestUser){var T=e.demandItem({list:v.Be,listFormUrls:v.je},d.e.serialize({webAbsoluteUrl:u.webAbsoluteUrl,listFullUrl:u.listFullUrl})),N=T.list,C=T.listFormUrls,k=C?r?C.editFormUrl:C.displayFormUrl:void 0;if(N&&C&&N.templateType&&N.templateType!==m.n.mySiteDocumentLibrary&&k){var L=Object(g.e)(k,u.rootFolder||new y.e(u.listFullUrl).path,f,l);i=!0;s=function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(a.__generator)(this,function(t){(e=window.open(L,"_blank"))&&e.focus();return[2]})})}}}}}return Object(a.__assign)({isAvailable:i,onExecute:s},Object(w.t)(e,{itemKey:n,engagement:{name:r?"OpenItemEditForm":"OpenItemDisplayForm",isIntentional:!0}}))})(c.e))),T=n(2762),N=n(498),C=n(495),k=n(655),L=n(3459),A=n(2),O=n(340),M=n(96),_=n(2986),D={key:new A.e("createListItem").id,automationId:"createListItemCommand",name:L.e.listItem,action:r.createElement(M.e,null,r.createElement(_.e,null)),iconProps:Object(O.e)({size:16,type:4})},P={key:C.e.key,automationId:C.e.automationId,name:C.e.name,iconProps:C.e.iconProps,subMenuProps:{items:[k.e,D]}},H=n(1012),B=Object(A.t)("EditItem"),j=Object(A.t)("ViewItem");n.d(t,"t",function(){return F});n.d(t,"e",function(){return q});var F={key:j,name:u.e.Open,action:r.createElement(x,null)},I={key:B,name:i.e.Edit,action:r.createElement(T.e,null),iconProps:{iconName:"Edit"}};function q(e){return[P,H.t,I,o.n,o.t,s.e,N.e]}},,,,,,,,,,,,,function(e,t,n){"use strict";var r=n(0),i=n("react-lib"),s=n(1469),o=n(1720),u=n(1519),a=n(1462),f=n(354);n.d(t,"e",function(){return l});var l=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._onClose=function(){n.setState({isOpen:!1})};n._iframeOnLoad=function(){var e=n.props.heightOffset;if(n._iframeElement&&n._iframeElement.contentDocument){var t=n._iframeElement.contentDocument.body.clientHeight;t<=0&&e&&(t=document.body.clientHeight*e);n._iframeElement.style.height=t+"px"}n.setState({isIFrameLoaded:!0});n.props.onLoad&&n._iframeElement&&n.props.onLoad(n._iframeElement)};n.state={isOpen:!0,isIFrameLoaded:!1};return n}t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.setState({isIFrameLoaded:!1})};t.prototype.render=function(){var e=this,t=this.props,n=t.url,l=(t.heightOffset,Object(r.__rest)(t,["url","heightOffset"])),c=this.state.isIFrameLoaded;return i.createElement(o.e,Object(r.__assign)({className:"IFrameDialog_e592d114",hidden:!this.state.isOpen,type:u.e.close},l),i.createElement(s.e,null,!c&&i.createElement(a.e,{size:f.e.large}),i.createElement("iframe",{ref:function(t){return e._setupIFrameElementFunctions(t)},src:n,style:{display:c?"block":"none"},onLoad:this._iframeOnLoad})))};t.prototype._setupIFrameElementFunctions=function(e){if(e){var t=e;t.cancelPopUp=this._onClose;t.commitPopup=this._onClose}this._iframeElement=e};return t})(i.Component)},,,,,function(e,t,n){"use strict";var r=n("react-lib"),i=n(0),s=n(2116),o=n(114),u=n(32),a=n(98),f=n(25),l=n(34),c=Object(l.t)(function(e,t){var n=t.itemKeys.filter(function(t){return"failed"===Object(a.i)(e,{itemKey:t}).phase}),f=e.dispatch;return r.createElement(u.e,{onExecute:function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){f(Object(s.e)({items:Object(o.e)(n,function(){return{}})}));return[2]})})},isAvailable:n.length>0})}),h=Object(f.s)()(c),p=n(2),d=n(249);n.d(t,"e",function(){return v});var v={key:new p.e("retryProgressCommand").id,name:d.e.progressRetryActionText,action:r.createElement(h,null)}},,,function(e,t,n){"use strict";var r=n(0),i=n("react-lib"),s=n(899),o=n(1948),u=n(21),a=n(25),f=n(32),l=n(155),c=n(47),h=n(34),p=Object(l.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("45")]).then(n.bind(null,4059))];case 1:return[2,e.sent().default]}})})}),d=Object(h.t)(function(e,t){var n=t.itemKey,s=Object(u.o)(function(e){return i.createElement(p,Object(r.__assign)({},e,{itemKey:n}))},{scope:"global"});return i.createElement(f.e,Object(r.__assign)({onExecute:s},Object(c.t)(e,{itemKey:n,engagement:{name:"SocialBar",isIntentional:!0}})))}),v=(Object(a.i)()(d),n(2678));n.d(t,"e",function(){return m});var m=(function(e){Object(r.__extends)(t,e);function t(t){return e.call(this,t)||this}t.prototype.render=function(){var e=this.props,t=e.likeLabel,n=e.itemKey,r=i.createElement(o.e,{activityDescription:t,isCompact:!0});return i.createElement(u.n,{action:i.createElement(d,{itemKey:n})},function(e){var t=e.isAvailable,n=e.execute,o=t?function(){n().catch(function(){})}:void 0;return i.createElement(s.e,{disabled:!1,className:v.e,onClick:o},r)})};return t})(i.Component)}],Array(35),[function(e,t,n){"use strict";n.d(t,"e",function(){return w});var r=n(0),i=n(44),s=n(104),o=n(3386),u=n(121),a=n(1),f=n(203),l=n(111),c=n(1976),h=n(158),p=n(2),d=n(71),v=n(786),m=n(116),g=n(6),y=n(29),b=n(2657);function w(e){var t=this,n=e.itemKey,w=e.options.sourceEntries,E=i.e.deserialize(n),S=E.webAbsoluteUrl,x=E.listFullUrl,T=Object.keys(w)[0],N=w[T],C=N.progressItemKey,k=N.conflictResolution;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,w,N,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K;return Object(r.__generator)(this,function(Q){switch(Q.label){case 0:t=e(Object(u.n)({webAbsoluteUrl:S,listFullUrl:x})),w=t.dataRequestor,N=t.hasDigest;if(!t.hasTokenProvider)return[3,1];A=void 0;return[3,3];case 1:return[4,e(Object(u.e)({url:S||x,disallowCookies:!N}))];case 2:A=Q.sent();Q.label=3;case 3:L=A;O=e(Object(l.e)({sourceFile:c.t},T)).sourceFile;M=e(Object(l.e)({folderPath:a.le},n)).folderPath,_=void 0===M?E.rootFolder:M;if(!O)throw new Error("No source file for upload.");if(!_)throw new Error("No path information for target folder.");D=Object(v.r)({webAbsoluteUrl:S,listOrItemFullUrl:x});P=new f.e(void 0);H=P.debounce(function(t){var n;C&&e(Object(h.e)({items:(n={},n[C]=Object(p.n)({progressSize:d.m},{progressSize:{current:t}}),n)}))},300,{leading:!1});B=e(Object(m.e)(function(e){return e.demandItemFacet(a.Be,s.e.serialize({webAbsoluteUrl:S,listFullUrl:x}))}));j=B&&B.contentTypesEnabled&&B.templateType!==y.t.mySiteDocumentLibrary;(F=new o.e({authToken:L,dataRequestor:w,parentItemKey:"",targetItemKey:"",fileUpload:O,iconName:"",serverRelativeItemUrl:_,webApiUrl:D,onProgress:H,expandAllItemFields:j})).nameConflictBehavior="replace"===k?1:0;C&&e(Object(h.e)({items:(J={},J[C]=Object(r.__assign)({},d.m.pack({total:O.size,current:0})),J)}));I=F.start();q=e(Object(m.e)(function(e){return e.demandItemFacet(d.i,C)}));R=q?q.token.subscribe(function(){F.abort()}):void 0;Q.label=4;case 4:Q.trys.push([4,6,7,8]);return[4,I];case 5:Q.sent();return[3,8];case 6:U=Q.sent();F.abort();throw Object(b.e)(U);case 7:R&&R();F.dispose();return[7];case 8:z=F.item;W=z.properties;X=W&&W.ID||z.id;V=W&&W.uniqueId;$=i.e.serialize({webAbsoluteUrl:S,listFullUrl:x,itemId:X});e(Object(h.e)({items:(K={},K[$]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},g.l.pack(z.displayName)),z.id?a.le.pack(z.id):{}),V?a.fn.pack(V):{}),g.A.pack({itemKey:n})),K)}));return[2,{itemKey:$}]}})})}}},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("sharepointIds")},function(e,t,n){"use strict";n.d(t,"n",function(){return r});n.d(t,"e",function(){return i});n.d(t,"t",function(){return s});var r="root",i="/drive/root:",s=30},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("thumbnailAccessToken")},function(e,t,n){"use strict";n.d(t,"t",function(){return u});n.d(t,"e",function(){return a});var r=n(2626),i=n(186),s=n(2364),o=n(786);function u(e){var t=e.responseText,n=e.documentType,i=e.fileName,s="",o="";if(null!=t){var u=JSON.parse(t);if(null!==u&&null!==u.d&&null!==u.d.CreateDocumentAndGetEditLink){o=u.d.CreateDocumentAndGetEditLink;s=Object(r.t)(o,n,i||"",!1)}else try{o=(new DOMParser).parseFromString(t,"text/xml").getElementsByTagName("d:CreateDocumentAndGetEditLink")[0].textContent||"";s=Object(r.t)(o,n,i||"",!1)}catch(e){}}return{originalEditLink:o,redirectUrl:s}}function a(e){var t=i.e.Visio,n=e.webAbsoluteUrl,r=e.listFullUrl,u=e.parentFolderPath,a=e.templateUrl,f=e.docName,l=e.docType;if(null!==l&&l>=i.e.Word&&l<=t&&l!==i.e.Text){if(l!==i.e.OneNote||f){if(f){f+=Object(s.t)(l)}}else f="Notebook"+Math.floor(100*Math.random())+1;f||(f="");l===i.e.ExcelForm&&(l=i.e.ExcelSurvey);return Object(o.e)({webAbsoluteUrl:n,listFullUrl:r}).methodWithAliases("CreateDocumentAndGetEditLink",{fileName:f,folderPath:u,documentTemplateType:l,templateUrl:a||""}).toString()}throw new Error("document type is not valid, here are the valid type: 1 - Word, 2 - Excel,\n    3 - PowerPoint, 4 - OneNote, 5 - Excel Survey, 7 - ExcelForm, 8 - Visio")}},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(98),s=new r.e("updateCheckoutState"),o=new i.e("checkout");Object(i.s)({operationTypeFacet:s,progressKeyFacet:o})},,function(e,t,n){"use strict";n.d(t,"e",function(){return u});n.d(t,"t",function(){return a});n.d(t,"n",function(){return f});var r=n(2),i=n(115),s=n(98),o=n(5),u=new r.e("editPinnedItem"),a=new o.e("editPinnedItemProgressItem",{itemKey:Object(o.s)(),editType:Object(o.i)()}),f=new s.e("editPinnedItemProgress",function(e,t){var n=Object.keys(t.itemEditTypeMap)[0],r=t.itemEditTypeMap[n].editType;return a.serialize({itemKey:n,editType:r})});Object(i.i)({operationTypeFacet:u})},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(115),s=new r.e("createFreshView"),o=Object(i.i)({operationTypeFacet:s})},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(16).e)("getDriveItemFullUrlControl")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(e){for(var t=e,n="",r=0,i=void 0,s=0,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";t.charAt(0|s)||(o="=",s%1);n+=o.charAt(63&r>>8-s%1*8)){if((i=t.charCodeAt(s+=3/4))>255)throw new Error("Unable to obtain default share URL: btoa failed");r=r<<8|i}return n}},function(e,t,n){"use strict";n.d(t,"n",function(){return s});n.d(t,"e",function(){return o});n.d(t,"t",function(){return u});var r=n(2),i=n(98),s=new r.e("removeItemsFromSharedList"),o=new i.e("removeItemsFromSharedList"),u=Object(i.s)({operationTypeFacet:s,progressKeyFacet:o})},,function(e,t,n){"use strict";n.d(t,"e",function(){return E});var r=n(0),i=n("react-lib"),s=n(1),o=n(60),u=n(6),a=n(109),f=n(34),l=n(44),c=n(379),h=n(104),p=n(29),d=n(155),v=n(21),m=n(184),g=n(47),y=n(54),b=n(32),w=Object(d.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("deferred.resx-deferred"),n.e("8")]).then(n.bind(null,3644))];case 1:return[2,e.sent().CheckOutItemWizard]}})})}),E=Object(f.t)(function(e,t){var n=t.checkInOutType,f=Object(y.e)(e),d=Object(m.e)(e);if(!d.length)return null;var E=e.demandItem({firstItemKey:l.e},d[0]).firstItemKey;if(!E)return null;var S=E&&e.demandItemFacet(s.Qt,c.e.serialize({webAbsoluteUrl:E.webAbsoluteUrl,listFullUrl:E.listFullUrl}));if(S&&(S.isAnonymousGuestUser||S.isEmailAuthenticationGuestUser))return null;for(var x=e.demandItemFacet(s.Be,h.e.serialize({webAbsoluteUrl:E.webAbsoluteUrl,listFullUrl:E.listFullUrl})),T=!!x&&x.templateType===p.t.mySiteDocumentLibrary,N=!!x&&!!x.enableMinorVersions,C=!1,k=0,L=d;k<L.length;k++){var A=L[k],O=e.demandItemFacet(u.d,A),M=e.demandItemFacet(a.i,A);if(A&&!O&&!M){var _=e.demandItem({isCheckedOut:u.y,isBFile:s.Se},A),D=_.isCheckedOut,P=_.isBFile,H=e.demandItemFacet(s.st,A),B=o.e.hasItemPermission({permissions:H},o.e.editListItems),j=o.e.hasItemPermission({permissions:H},o.e.cancelCheckout);"checkOut"===n?C=!P&&!T&&!(D&&(D.byYou||D.byOther))&&B:"checkIn"!==n&&"undoCheckOut"!==n||!D||(C=B&&(!!D.byYou||j&&!!D.byOther))}if(!C)break}var F=d?Object(v.o)(function(e){return i.createElement(w,Object(r.__assign)({},e,{itemSetKey:f,itemKeys:d,checkInOutType:n,enableMinorVersions:N}))}):void 0;return i.createElement(b.e,Object(r.__assign)({isAvailable:C,onExecute:F},Object(g.t)(e,{itemKey:d[0],engagement:{name:n,isIntentional:!0,extraData:{isBulk:d.length>1}}})))})},function(e,t,n){"use strict";n.d(t,"e",function(){return l});var r=n(0),i=n(1),s=n(60),o=n(182),u=n(25);function a(e,t){var n=t.itemKey,r=e.demandItemFacet(i.st,n);return s.e.hasItemPermission({permissions:r},s.e.insertListItems)}var f=function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e("10").then(n.bind(null,3536))];case 1:return[2,e.sent().CreateListItemExecutor]}})})},l=Object(u.i)()(Object(o.e)(f,a));Object(u.e)()(Object(o.e)(f,a))},function(e,t,n){"use strict";n.d(t,"n",function(){return i});n.d(t,"r",function(){return s});n.d(t,"t",function(){return o});n.d(t,"e",function(){return u});var r=n(2),i=new r.e("isViewCommand"),s=new r.e("isSwitchViewCommand"),o=new r.e("isEditViewCommand"),u=new r.e("isCreateViewCommand")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(451).e)("kanban")},function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(29),i=n(129),s=n(220),o=n(2269);function u(e,t){var n,u=t.pageContext,a=t.listFacets,f=t.isODB,l=t.key;if(u&&(a&&a.templateType===r.t.documentLibrary||f)){var c=new i.e(l.webAbsoluteUrl||l.listFullUrl).authority+"/_api/v2.0",h=s.t.serialize({endpoint:c});n=Object(o.e)(e,{itemKey:h})}return{fileHandlerCommands:n}}},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("editNewMenu").id},function(e,t,n){"use strict";n.d(t,"e",function(){return p});n.d(t,"t",function(){return d});var r=n(0),i=n("react-lib"),s=n(1135),o=n(860),u=n(1),a=n(1507),f=n(158),l=n(11),c=n(342),h=n(186),p=Object(l.i)()(function(e){var t=this,n=e.itemKey,a=s.e.deserialize(n);return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(s){e(Object(f.e)({items:(t={},t[n]=Object(r.__assign)({},u.t.pack(function(){return i.createElement(c.e,{documentType:d(a.templateUrl),templateItemKey:o.e.serialize({listKey:a.listKey,templateUrl:a.templateUrl})})})),t)}));return[2]})})}});function d(e){var t=h.e.Word;if(e){var n=e.lastIndexOf(".");if(n){var r=e.substr(n+1).toLowerCase();switch(a.t[r]){case a.i:t=h.e.OneNote;break;case a.s:t=h.e.PowerPoint;break;case a.n:t=h.e.Excel;break;case a.o:t=h.e.Visio}}}return t}},,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("universalPrintSharedPrinterListItem")}],Array(70),[function(e,t,n){"use strict";var r,i=n(0),s=n(655),o=n(227),u="NewFolder",a="NewDOC",f="NewXSL",l="NewPPT",c="NewONE",h="NewXSLSurvey",p="NewXSLForm",d="NewVSDX",v=((r={})[s.e.key]=u,r[o.o.key]=a,r[o.e.key]=f,r[o.i.key]=l,r[o.r.key]=c,r[o.t.key]=h,r[o.n.key]=p,r[o.s.key]=d,r);var m=n(75),g=n(495),y=n("react-lib"),b=n(96),w=n(2),E=n(308),S=n(686),x=n(187),T=n(520),N=n(117),C=n(40),k=n(44),L=n(104),A=n(794),O=n(448),M=n(1),_=n(29),D=n(60),P=n(441),H=n(34),B=m.e.isActivated("EADE19B8-AD86-4CA2-9B13-E049A2AD37AA","07/28/2020","Use currentItemKey to check permissions"),j=Object(x.t)(function(){return{type:"file"}})(S.e),F=Object(H.e)(function(){return{fileSelector:j}})(T.e),I=Object(A.n)({uploadItemsAction:O.e},{uploadItemsAction:function(e,t){var n=Object(N.e)(e),r=e.demandItemFacet(k.e,n);if(!r)return{isAvailable:!1};var s=r.listFullUrl;if(!s)return{isAvailable:!1};var o=new P.e(s+"/Forms").path,u=k.e.serialize(Object(i.__assign)(Object(i.__assign)({},r),{rootFolder:""})),a=k.e.serialize(Object(i.__assign)(Object(i.__assign)({},r),{rootFolder:o})),f=B?u:n,l=e.demandItemFacet(M.st,f),c=D.t.hasItemPermission({permissions:l},D.t.manageLists);return{targetItemKey:a,isAvailable:c&&R(e,r)}}}),q=Object(H.t)(function(e,t){var n=t.engagement,r=Object(N.e)(e);return r?y.createElement(I,null,y.createElement(F,{itemKey:r,engagement:Object(C.d)({name:"UploadTemplate",isIntentional:!0},n)})):null});function R(e,t){var n=t&&e.demandItemFacet(M.Be,L.e.serialize({webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl}));return!!n&&!!n.isDocumentLibrary&&n.templateType!==_.t.webPageLibrary&&!!n.newWOPIDocumentEnabled}new w.e("UploadTemplate").id,E.e.UploadTemplate,y.createElement(b.e,null,y.createElement(q,{engagement:{name:"UploadTemplate"}}));var U={key:new w.e("AddTemplate").id,automationId:"AddTemplate",name:E.e.AddTemplate,iconProps:{iconName:"Add"},action:y.createElement(b.e,null,y.createElement(q,{engagement:{name:"AddTemplate"}}))},z=n(2990);var W=n(211),X=n(342),V=n(340),$=n(648),J=n(1509),K=n(2991),Q=n(860),G=function(e){var t=e.template,n=e.listKey;if(!t.url)throw new Error("Cannot create a command for a template without a URL.");var r,i,s=t.url,o=Q.e.serialize({listKey:n,templateUrl:s});return{key:new w.e("createDocumentFromTemplate").id,automationId:"createDocumentFromTemplate",name:t.title,action:y.createElement(b.e,null,y.createElement(X.e,{documentType:Object(K.t)(s),templateItemKey:o})),iconProps:Object(V.e)({extension:(r=s,i=Object($.t)(r,!0),Object(J.t)(i)),size:16})}};var Y=n(2269);n.d(t,"e",function(){return Z});function Z(e,t){var n=t.contentTypes,r=t.newCommandMenu,y=t.fileHandlerCommands,b=t.isCreateFolderAvailable,w=t.newDocumentTemplates,E=t.contentTypeCommands,S=t.listKey,x={},T={},N=(function(){var e;return(e={})[u]=s.e,e[a]=o.o,e[f]=o.e,e[l]=o.i,e[c]=o.r,e[h]=o.t,e[p]=o.n,e[d]=o.s,e})(),C={},k=[],L=[];if(!m.e.isActivated("7FE1672F-3DCA-41A7-8CAF-C5B376315694","11/19/2018","Build New menu with newDocumentTemplates")&&w&&w.length){if(E)for(var A=0,O=E;A<O.length;A++){(D=O[A]).name&&(x[D.name]=D)}if(n)for(var M=0,_=n;M<_.length;M++){var D;x[(D=_[M]).displayName]&&D.contentTypeId&&(T[D.contentTypeId]=x[D.displayName])}var P=r.subMenuProps&&r.subMenuProps.items;if(P)for(var H=0,B=P;H<B.length;H++){(R=B[H]).name&&(N[R.name]=R);R.automationId&&(N[R.automationId]=R)}for(var j=void 0,F=0,I=w;F<I.length;F++){var q=I[F];q.isContentType&&q.contentTypeId&&(C[q.contentTypeId]=!0);var R=void 0;q.isUpload&&S?R=G({template:q,listKey:S}):q.isContentType&&q.contentTypeId&&T[q.contentTypeId]?R=T[q.contentTypeId]:N[q.title]?R=N[q.title]:q.templateId&&N[q.templateId]&&(R=N[q.templateId]);if(R){var X=q.templateId||v[R.key];X===u&&(j=!0);L.push(Object(i.__assign)(Object(i.__assign)({},q),{templateId:X,command:R}));if(q.visible){k.push(R);N[q.title]&&N[q.title].key===s.e.key&&k.push({name:"-",key:"divider_1",itemType:W.e.Divider})}}}!j&&b&&s.e.name&&L.unshift({command:s.e,templateId:v[s.e.key],title:s.e.name,visible:!1});for(var V in T)if(T.hasOwnProperty(V)&&!C[V]){var $=T[V];$.name&&L.push({command:$,contentTypeId:V,isContentType:!0,templateId:V,title:$.name,visible:!0});k.push($)}}else{L=(function(e,t){var n=t.isCreateFolderAvailable,r=t.contentTypeCommands,i=void 0===r?[]:r,o=t.contentTypes,u=[];n&&s.e.name&&u.push({command:s.e,templateId:v[s.e.key],title:s.e.name,visible:!0});var a=!(!i||!i.length),f={};if(o)for(var l=0,c=o;l<c.length;l++){var h=c[l];h.contentTypeId&&(f[h.displayName]=h.contentTypeId)}if(a)for(var p=0,d=i;p<d.length;p++){if((E=d[p]).name){var m=f[E.name];u.push({command:E,contentTypeId:m,isContentType:!0,templateId:m,title:E.name||"",visible:!0})}}var y=g.e.subMenuProps&&g.e.subMenuProps.items;if(y)for(var b=0,w=y;b<w.length;b++){var E;(E=w[b]).name&&-1===[s.e.key,"divider_1","divider_2",U.key,z.e].indexOf(E.key)&&u.push({command:E,templateId:v[E.key],title:E.name,visible:!a})}return u})(0,{isCreateFolderAvailable:b,contentTypeCommands:E,contentTypes:n});E&&E.length?k.push.apply(k,Object(i.__spreadArrays)([s.e,{name:"-",key:"divider_1",itemType:W.e.Divider}],E)):k=r.subMenuProps?Object(i.__spreadArrays)(r.subMenuProps.items):[]}y&&y.new&&(k=Object(Y.t)(k,y.new));return{visibleNewCommands:Object(i.__assign)(Object(i.__assign)({},g.e),{subMenuProps:{items:k}}),allCommands:L}}},,,,,function(e,t,n){"use strict";var r=n("react-lib"),i=n(2),s=n(6),o=n(8),u=n(222),a=n(1139),f=n(104),l=n(1138),c=n(1),h=n(2760),p=n(0),d=n(32),v=n(25),m=n(34),g=n(44),y=n(379),b=n(2728),w=n(2759),E=n(47),S=function(e){return Object(p.__awaiter)(void 0,void 0,void 0,function(){return Object(p.__generator)(this,function(e){return[2]})})},x=Object(v.e)()(Object(v.s)()(Object(m.e)(function(e,t){var n,r,i,s=t.itemKey,o=t.itemKeys,u=t.enabledForMultipleItems,a=void 0===u?t.enabledForMultipleItems||!1:u,f=t.isEnabledFunc,l=t.url,h=!!a||1===o.length,d=void 0,v=void 0;if(h&&o[0]){var m=e.demandItem({key:g.e,permissions:c.st,rowData:c.bt},o[0])||void 0;if(m){v=m.key;d=m.rowData;i=m.permissions}}else if(h&&s){var x=e.demandItem({key:g.e,permissions:c.st},s);if(x){v=x.key;i=x.permissions}}n=v&&v.webAbsoluteUrl;r=v&&v.listFullUrl;var T=n&&r&&e.demandItemFacet(c.Qt,y.e.serialize({webAbsoluteUrl:n,listFullUrl:r}))||void 0;if(h&&!a)if("boolean"==typeof f)h=f;else if("function"==typeof f){var N="",C="",k="";if(d){var L=d;N=L.File_x0020_Type||"";C=L.ContentTypeId||"";k=L.ProgId||""}else h=!1;h=f({permissions:i||0,extension:N,contentTypeId:C,progId:k})}if(h&&l){var A=[];o.forEach(function(t){var n=e.demandItem({itemId:c.Ie,itemUrl:c.le},t);n&&A.push({id:n.itemId||"",url:n.itemUrl||""})});T&&(l=Object(b.n)(l,A,T))}var O=S;O=l&&"javascript:LaunchApp("===l.substring(0,21)&&");"===l.substring(l.length-2)?function(){return Object(p.__awaiter)(void 0,void 0,void 0,function(){return Object(p.__generator)(this,function(e){l&&T&&Object(w.e)(l,T);return[2]})})}:function(){return Object(p.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(p.__generator)(this,function(t){(e=window.open(l,"_blank"))&&e.focus();return[2]})})};return Object(p.__assign)({isAvailable:h,onExecute:O},Object(E.t)(e,{itemKey:o[0],engagement:{name:"CustomActionNavigation",isIntentional:!0}}))})(d.e))),T=n(75),N=n(111),C=n(158),k=function(e){return Object(p.__awaiter)(void 0,void 0,void 0,function(){return Object(p.__generator)(this,function(e){return[2]})})},L=Object(m.t)(function(e,t){var n=t.itemKeys,i=t.enabledForMultipleItems,s=void 0===i?t.enabledForMultipleItems||!1:i,o=t.isEnabledFunc,a=t.commandAdapter,f=e.dispatch,l=!!s||1===n.length;if(l&&1===n.length&&"function"==typeof o){var h=e.demandItem({key:g.e,permissions:c.st,rowData:c.bt},n[0]),v="",m="",y="";if(h&&h.rowData){var b=h.rowData;v=b.File_x0020_Type||"";m=b.ContentTypeId||"";y=b.ProgId||""}else l=!1;l=l&&o({permissions:h&&h.permissions||0,extension:v,contentTypeId:m,progId:y})}if(l&&a){var w=[];n.forEach(function(t){var n=e.demandItemFacet(u.u,t);n&&w.push(n)});a.refresh(w);l=l&&a.visible}var S=k;a&&(S=function(){return Object(p.__awaiter)(void 0,void 0,void 0,function(){return Object(p.__generator)(this,function(e){return[2,a.execute()]})})});var x=!T.e.isActivated("416CBFAD-51CE-4EFF-8231-D4EFCAC3DB3C","12/13/2019","Generate rowAdapter if not available");return r.createElement(r.Fragment,null,x?r.createElement(A,{dispatch:f,itemKeys:n}):null,r.createElement(d.e,Object(p.__assign)({isAvailable:l,onExecute:S},Object(E.t)(e,{itemKey:n[0],engagement:{name:"ClientSideCommandSet",isIntentional:!0}}))))}),A=function(e){var t=e.dispatch,n=e.itemKeys;if(n.length<1)return null;var r=n[0],i=void 0;if(g.e.matches(r)){var s=g.e.deserialize(r);if(s){var o=f.e.serialize({webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl});i=t(Object(N.e)({listViewAdapter:u.o},o)).listViewAdapter}}var a={};if(i){n.forEach(function(e){var n=t(Object(N.e)({rowData:c.bt,rowAdapter:u.u},e)),r=n.rowData;if(!n.rowAdapter&&r&&i){var s=i.createRowAdapter({values:r});s&&(a[e]=Object(p.__assign)({},u.u.pack(s)))}});Object.keys(a).length>0&&t(Object(C.e)({items:a}))}return null},O=Object(v.s)()(L),M=n(578),_=n(105),D=n(35);n.d(t,"t",function(){return j});n.d(t,"n",function(){return F});n.d(t,"e",function(){return I});var P=new i.e("customActionNavigationCommand").id;function H(e){var t=e.key,n=e.name,i=e.url,s=e.iconUrl,o=e.enabledForMultipleItems,u=e.isEnabledFunc,a=e.commandAdapter;return{key:P+"-"+t,automationId:"customactionNavigation",name:n,iconProps:{iconType:M.e.image,className:"customActionCommandIcon_cd2598ba",imageProps:{src:s||"",imageFit:_.t.contain,className:"customActionCommandIcon_cd2598ba"}},action:a?r.createElement(O,{enabledForMultipleItems:o,isEnabledFunc:u,commandAdapter:a}):i?r.createElement(x,{url:i,enabledForMultipleItems:o,isEnabledFunc:u}):void 0}}var B=new i.e("customActionGroupCommand").id;function j(e,t){var n=t.webAbsoluteUrl,r=t.listFullUrl,i=a.e.serialize({webAbsoluteUrl:n,listFullUrl:r}),s=I({itemCache:e,targetCustomActionSetKey:i,keys:{webAbsoluteUrl:n,listFullUrl:r}}),o=F(e,i);s&&(o=o.concat(F(e,s)));return o}function F(e,t){var n=[],r=e.demandItemFacet(o.e,t);r&&r.itemKeys&&r.itemKeys.forEach(function(t){var r,i,a,f,l=e.demandItem({displayName:s.l,openUrl:s.L,iconUrl:h.t,childItemKeys:o.e,enabledForMultipleItems:h.e,isEnabledFunc:h.n,commandAdapter:u.i},t);if(l&&l.displayName){var c=l.displayName,p=l.openUrl,d=l.iconUrl,v=l.enabledForMultipleItems,m=l.isEnabledFunc,g=l.childItemKeys,y=l.commandAdapter;if(g&&g.itemKeys&&g.itemKeys.length>0){var b=[];g.itemKeys.forEach(function(n,r,i){var o=e.demandItem({subMenuDisplayName:s.l,openUrl:s.L,iconUrl:h.t,enabledForMultipleItems:h.e,isEnabledFunc:h.n,commandAdapter:u.i},n);o&&o.subMenuDisplayName&&b.push(H({key:t+"-"+n,name:o&&o.subMenuDisplayName,url:o&&o.openUrl,iconUrl:o&&o.iconUrl,enabledForMultipleItems:o&&o.enabledForMultipleItems,isEnabledFunc:o&&o.isEnabledFunc,commandAdapter:o&&o.commandAdapter}))});n.push((i=(r={key:t,name:c,subCommands:b}).key,a=r.name,f=r.subCommands,{key:B+"-"+i,automationId:"customActionGroupCommand",name:a,subMenuProps:{items:f}}))}else c&&n.push(H({key:t,name:c,url:p,iconUrl:d,enabledForMultipleItems:v,isEnabledFunc:m,commandAdapter:y}))}});return n}function I(e){var t=e.keys,n=t.webAbsoluteUrl,r=t.listFullUrl,i=e.itemCache,s=e.targetCustomActionSetKey,a=void 0,h=f.e.serialize({webAbsoluteUrl:n,listFullUrl:r}),p=i.demandItemFacet(u.s,h),d=i.demandItemFacet(c.mt,s),v=!!p&&!!d,m=Object(D.e)(i).itemsScopeItemKey;if(v&&m){var g=l.e.serialize({webAbsoluteUrl:n,listFullUrl:r,isSPFXandCustomActionsAvailable:v,targetCustomActionSetKey:s,itemsScopeItemKey:m});i.demandItemFacet(o.e,g)&&(a=g)}return a}},function(e,t,n){"use strict";var r,i=n("react-lib"),s=n(2),o=n(0),u=n(34),a=n(667),f=n(85),l=n(32),c=n(47),h=n(21),p=n(692),d=n(1623),v=n(59),m=n(28),g=n(1847),y=n(155),b=n(116),w=n(25),E=n(2993),S=n(1025),x=n(1024),T=n(98),N=n(678),C=n(384),k=n(10),L=n(11),A=n(115),O=n(560),M=n(71),_=n(2930),D=n(23),P=n(3460),H=n(120),B=n(324),j=n(233),F=n(2116),I=n(2551),q=((r={})[M.r.started]=function(e){return Object(D.format)(Object(D.getLocalizedCountValue)(P.e.StartedTitle,P.e.StartedTitleIntervals,e)||"",e)},r[M.r.completed]=function(e){return Object(D.format)(Object(D.getLocalizedCountValue)(P.e.CompletedTitle,P.e.CompletedTitleIntervals,e)||"",e)},r[M.r.failed]=function(e){return Object(D.format)(Object(D.getLocalizedCountValue)(P.e.FailedTitle,P.e.FailedTitleIntervals,e)||"",e)},r[M.r.canceled]=function(e){return Object(D.format)(Object(D.getLocalizedCountValue)(P.e.FailedTitle,P.e.FailedTitleIntervals,e)||"",e)},r),R=Object(L.t)(function(){return function(e){e(Object(C.e)(N.t,O.e)(Object(k.t)()(U)));e(Object(A.s)(N.t,F.t)(Object(I.e)(N.t,N.e)))}});function U(){return function(e){return z}}function z(e,t){var n,r=Object(T.i)(e,t),i=r.phase,u=r.count,a=[],f=e.demandItemFacet(H.e,t.itemKey);if(i===M.r.failed&&f){n=P.e.GenericFailureDescription;a.push(_.e);if(f instanceof B.e){var l=Object(s.r)({accessDenied:j.e,authFailure:j.r,offlineError:j.m},f.facets),c=l.accessDenied,h=l.authFailure,p=l.offlineError;c?n=P.e.AccessDeniedFailureErrorDescription:h?n=P.e.AuthFailureErrorDescription:p&&(n=P.e.DisconnectedFailureDescription)}}var d=q[i](u);return Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},d&&"item"!==t.format?{title:d}:{}),n?{description:n}:{}),{commands:a})}var W=Object(T.s)({operationTypeFacet:N.e,progressKeyFacet:N.t,initializeBatch:function(){return R}}),X=n(6),V=n(666),$=Object(y.e)(function(){return Object(o.__awaiter)(void 0,void 0,void 0,function(){return Object(o.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred.resx-deferred"),n.e("467")]).then(n.bind(null,4113))];case 1:return[2,e.sent().UniversalPrint]}})})}),J=Object(u.t)(function(e,t){var r=t.itemKey,s=t.getPrintFileItem,u=void 0===s?a.e:s,f=t.printFileItem,y=void 0===f?W:f;if(!r)return null;var w=e.dispatch,T=e.demandItemFacet(p.e,r),N=e.demandItemFacet(X.h,r),C=Object(m.e)(e,{graphEndpoint:v.c,universalPrintCache:x.e}),k=C.graphEndpoint,L=C.universalPrintCache;if(!k||!N)return null;var A=p.e.evaluate(T)(e,{itemKey:r,isAvailable:!1}).isAvailable,O=Object(V.r)(N.extension);if(!N.name||!O)return null;var M=function(){return Object(o.__awaiter)(void 0,void 0,void 0,function(){var e,t;return Object(o.__generator)(this,function(n){switch(n.label){case 0:return u?[4,w(u({items:(t={},t[r]={},t)}))]:[3,2];case 1:n.sent();if(e=w(Object(b.e)(function(e){return e.demandItemFacet(a.n,r)})))return[2,e];n.label=2;case 2:throw new Error("Failed to fetch Print File data")}})})},_=function(e){return Object(o.__awaiter)(void 0,void 0,void 0,function(){var t,r;return Object(o.__generator)(this,function(i){switch(i.label){case 0:return[4,n.e("470").then(n.bind(null,906))];case 1:t=i.sent().demandItems;return[4,w(t(function(t){return t.demandItemFacet(E.e,S.e.serialize({endpoint:k,fileType:e}))}))];case 2:if(r=i.sent())return[2,r];throw new Error("Failed to fetch list of shared printers")}})})},D=Object(h.o)(function(e){var t=e.resolve,n=w(d.e).dataRequestor;return i.createElement($,{endpoint:k,onClose:function(){return Object(o.__awaiter)(void 0,void 0,void 0,function(){return Object(o.__generator)(this,function(e){t();return[2]})})},onSubmit:function(e,n,i){return Object(o.__awaiter)(void 0,void 0,void 0,function(){var s;return Object(o.__generator)(this,function(o){switch(o.label){case 0:return[4,w(y({items:(s={},s[r]={printerId:e,printerName:n,config:i},s)}))];case 1:o.sent();t();return[2]}})})},fileDisplayName:N.name,fileExtension:N.extension,fileType:O,getPrintFileData:M,dataRequestor:n,getPrintAuthToken:function(){return Object(o.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(o.__generator)(this,function(t){switch(t.label){case 0:return[4,w(Object(g.e)(["PrinterShare.Read.All","PrintJob.ReadWrite"],k||""))];case 1:if(e=t.sent())return[2,{accessToken:e}];throw new Error("Failed to fetch Print Graph Access Token")}})})},getSharedPrinterList:_,saveUserPreferences:function(e){L&&L.setValue("userpreferernces-"+O,e)},getUserPreferences:function(){if(L)return L.getValue("userpreferernces-"+O)}})});return i.createElement(l.e,Object(o.__assign)({isAvailable:A,onExecute:D},Object(c.t)(e,{itemKey:r,engagement:{name:"PrintToUniversalPrinter",isIntentional:!0}})))}),K=Object(f.t)(function(e){return function(t){return Object(o.__awaiter)(void 0,void 0,void 0,function(){return Object(o.__generator)(this,function(n){switch(n.label){case 0:return[4,t(Object(a.e)(e))];case 1:return[2,n.sent()]}})})}}),Q=Object(f.t)(function(e){return function(t){return Object(o.__awaiter)(void 0,void 0,void 0,function(){return Object(o.__generator)(this,function(n){switch(n.label){case 0:return[4,t(W(e))];case 1:return[2,n.sent()]}})})}});var G=Object(u.e)(function(){return{getPrintFileItem:K,printFileItem:Q}})(Object(w.s)()(Object(w.r)()(J))),Y=n(3461);n.d(t,"e",function(){return Z});var Z={key:new s.e("universalPrint").id,automationId:"universalPrintCommand",action:i.createElement(G,null),name:Y.e.printToUniversalPrinter,title:Y.e.PrintToUniversalPrinterTooltip,iconProps:{iconName:"CloudPrinter"}}},,,,,,function(e,t,n){"use strict";var r=n("react-lib"),i=n(0),s=n(25),o=n(34),u=n(8),a=n(1083),f=n(6),l=n(1),c=n(60),h=n(47),p=n(155),d=n(35),v=n(21),m=n(32),g=n(849),y=Object(o.e)()(Object(p.e)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("12")]).then(n.bind(null,4230))];case 1:return[2,e.sent().EditPinnedItemExecutor]}})})})),b=Object(o.t)(function(e,t){var n=t.itemKey,s=t.editType,o=Object(d.e)(e).itemsScopeItemKey,p=Object(g.e)(e),b=e.demandItem({isMalwareDetected:f.N,permissions:l.st},n),w=b.isMalwareDetected,E=b.permissions,S=!w&&!!n&&Object(a.e)(e,t)&&!!p&&!!E&&c.e.hasItemPermission({permissions:E},c.e.manageLists)&&(function(e,t){var n=t.pinnedItemSetKey,r=t.editType,i=e.demandItemFacet(u.e,n),s=i?i.itemKeys:[],o=s.indexOf(t.itemKey),a=o>-1?0!==r:0===r;a&&(2===r?a=0!==o:3===r&&(a=o!==s.length-1));return a})(e,{itemKey:t.itemKey,pinnedItemSetKey:p,editType:s}),x=o?Object(v.o)(function(e){return r.createElement(y,Object(i.__assign)({},e,t,{itemsScopeItemKey:o,pinnedItemSetKey:p}))}):void 0;return r.createElement(m.e,Object(i.__assign)({isAvailable:S,onExecute:x},Object(h.t)(e,{itemKey:n,engagement:{name:"EditPinnedItem",isIntentional:!0}})))}),w=Object(s.s)()(Object(s.r)()(b));var E=n(572),S=n(2992),x=n(2),T=Object(x.t)("pinItem"),N=Object(x.t)("moveLeftPinnedItem"),C=Object(x.t)("moveRightPinnedItem"),k=Object(x.t)("removePinnedItem"),L=Object(x.t)("editPinnedItem");n.d(t,"t",function(){return A});n.d(t,"e",function(){return D});var A={key:T,automationId:"pinItemCommand",name:S.e.pinToTop,iconProps:{iconName:"Pin"},action:r.createElement(w,{editType:0})},O={key:N,automationId:"moveLeftPinnedItemCommand",name:S.e.moveLeftPinnedItem,iconProps:{iconName:E.e.isRightToLeft?"Forward":"Back"},action:r.createElement(w,{editType:2})},M={key:C,automationId:"moveRightPinnedItemCommand",name:S.e.moveRightPinnedItem,iconProps:{iconName:E.e.isRightToLeft?"Back":"Forward"},action:r.createElement(w,{editType:3})},_={key:k,automationId:"removePinnedItemCommand",name:S.e.unpinFromTop,iconProps:{iconName:"UnPin"},action:r.createElement(w,{editType:1})},D={key:L,automationId:"editPinnedItemCommand",name:S.e.editPin,iconProps:{iconName:"Pinned"},subMenuProps:{items:[O,M,_]}}},function(e,t,n){"use strict";var r,i,s=n(0),o=n("react-lib"),u=n(2664),a=n(114),f=n(2196),l=n(44),c=n(104),h=n(6),p=n(1),d=n(116),v=n(1198),m=n(2365),g=n(29),y=n(11),b=n(384),w=n(10),E=n(560),S=n(23),x=n(98),T=n(71),N=n(2434),C=n(8),k=n(2767),L=((r={})[T.r.started]=function(e){var t=e.count,n=e.isScheduled;return Object(S.formatToArray)(Object(S.getLocalizedCountValue)(n?k.e.schedulePublishStartedItemsTitle:k.e.publishStartedItemsTitle,k.e.publishCompletedItemsTitleIntervals,t)||"",t)},r[T.r.completed]=function(e){var t=e.count,n=e.isScheduled;return Object(S.formatToArray)(Object(S.getLocalizedCountValue)(n?k.e.schedulePublishCompletedItemsTitle:k.e.publishCompletedItemsTitle,k.e.publishCompletedItemsTitleIntervals,t)||"",t)},r[T.r.failed]=function(e){var t=e.count,n=e.isScheduled;return Object(S.formatToArray)(Object(S.getLocalizedCountValue)(n?k.e.schedulePublishFailedItemsTitle:k.e.publishFailedItemsTitle,k.e.publishFailedItemsTitleIntervals,t)||"",t)},r[T.r.canceled]=function(e){var t=e.count,n=e.isScheduled;return Object(S.formatToArray)(Object(S.getLocalizedCountValue)(n?k.e.schedulePublishFailedItemsTitle:k.e.publishFailedItemsTitle,k.e.publishFailedItemsTitleIntervals,t)||"",t)},r),A=((i={})[T.r.started]=function(e){var t=e.count,n=e.itemKey,r=e.isScheduled;return Object(S.formatToArray)(Object(S.getLocalizedCountValue)(r?k.e.schedulePublishStartedItemsTitle:k.e.publishStartedItemsTitle,k.e.publishStartedItemsDestinationTitleIntervals,t)||"",t,o.createElement(N.e,{key:"link",itemKey:n}))},i[T.r.completed]=function(e){var t=e.count,n=e.itemKey,r=e.isScheduled;return Object(S.formatToArray)(Object(S.getLocalizedCountValue)(r?k.e.schedulePublishCompletedItemsDestinationTitle:k.e.publishCompletedItemsDestinationTitle,k.e.publishCompletedItemsDestinationTitleIntervals,t)||"",t,o.createElement(N.e,{key:"link",itemKey:n}))},i[T.r.failed]=function(e){var t=e.count,n=e.itemKey,r=e.isScheduled;return Object(S.formatToArray)(Object(S.getLocalizedCountValue)(r?k.e.schedulePublishFailedItemsDestinationTitle:k.e.publishFailedItemsDestinationTitle,k.e.publishFailedItemsDestinationTitleIntervals,t)||"",t,o.createElement(N.e,{key:"link",itemKey:n}))},i[T.r.canceled]=function(e){var t=e.count,n=e.itemKey,r=e.isScheduled;return Object(S.formatToArray)(Object(S.getLocalizedCountValue)(r?k.e.schedulePublishFailedItemsDestinationTitle:k.e.publishFailedItemsDestinationTitle,k.e.publishFailedItemsDestinationTitleIntervals,t)||"",t,o.createElement(N.e,{key:"link",itemKey:n}))},i),O=Object(y.t)(function(){return function(e){e(Object(b.e)(u.e,E.e)(Object(w.t)()(M)))}});function M(){return function(e){return _}}function _(e,t){var n,r,i=Object(x.i)(e,t),o=i.phase,a=i.count,l=(function(e,t){var n=void 0,r=e.demandItemFacet(C.e,t.itemKey);if(r)for(var i=0,s=r.itemKeys;i<s.length;i++){var o=s[i],u=e.demandItemFacet(T.g,o),a=u&&u.itemKey,f=e.demandItemFacet(h.A,a),l=f&&f.itemKey;if(l)if(n){if(l!==n)break}else n=l}return n})(e,t),c=e.demandItemFacet(C.e,t.itemKey),p=c&&c.itemKeys;p&&p.length>0&&(r=e.demandItemFacet(u.t,p[0]));var d=!!r&&r.publishActionType===f.e.SchedulePublish;n="group"===t.format&&l?A[o]({count:a,itemKey:l,isScheduled:d}):L[o]({count:a,isScheduled:d});return Object(s.__assign)(Object(s.__assign)({},n&&"item"!==t.format?{title:n}:{}),{})}var D=n(75),P=n(1978),H=n(129),B=D.e.isActivated("991d2b61-3537-434c-8a72-45623f632435","1/13/2020","Use progress addon for publish")?Object(x.s)({operationTypeFacet:u.t,progressKeyFacet:u.e}):Object(x.s)({operationTypeFacet:u.t,progressKeyFacet:u.e,initializeBatch:function(){return O}}),j=(function(e){Object(s.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.state={publishItemError:void 0};return n}t.prototype.componentDidMount=function(){var e=this.props,t=e.itemCacheDispatch,n=e.itemKeys,r=e.itemSetKey,i=e.resolve,s=e.reject,o=n[0],u=t(Object(d.e)(function(e){return e.demandItem({firstItemKey:l.e,displayName:h.l},n[0])})).firstItemKey,y=t(Object(d.e)(function(e){return m.n(e,o)})),b={publishActionType:y},w=!1;if(u){var E=t(Object(d.e)(function(e){return e.demandItemFacet(p.Be,c.e.serialize({webAbsoluteUrl:u.webAbsoluteUrl,listFullUrl:u.listFullUrl}))}));w=!!E&&E.templateType===g.t.webPageLibrary}if(u&&w&&y===f.e.SubmitForApproval){var S=""+new H.e(u.webAbsoluteUrl).authority+t(Object(d.e)(function(e){return e.demandItemFacet(p.le,n[0])}));window.location.href=S}else t(B({items:Object(a.e)(n,function(){return b})})).then(function(){var e,s;t(Object(v.e)({items:(e={},e[o]=[p.un],e[o]=[p.Qe],e)}));r&&t(Object(P.e)({items:(s={},s[r]=Object(a.e)(n,function(){return{}}),s)}));i()}).catch(function(e){s(e)})};t.prototype.render=function(){return null};return t})(o.PureComponent),F=n(25),I=n(34),q=n(131),R=n(47),U=n(2449),z=n(21),W=n(32),X=n(54),V=n(379),$=n(992);n.d(t,"e",function(){return Q});n.d(t,"t",function(){return G});var J=Object(I.e)()(j),K=Object(I.e)(function(e,t){var n=t.onCancel,r=t.reject;return{onCancel:function(){return Object(s.__awaiter)(void 0,void 0,void 0,function(){return Object(s.__generator)(this,function(e){r(new q.e);n&&n();return[2]})})},title:k.e.MissingMetadataDialogTitle,prompt:k.e.MissingMetadataDialogText,cancelText:k.e.MissingMetadataDialogButton}})(U.e),Q=Object(I.t)(function(e,t){var n,r=t.itemKeys,i=t.publishType,u=t.source;if(!r||!r.length)return null;var a=Object(X.e)(e),c=e.demandItem({firstItemKey:l.e,hasMissingMetadata:h.C,contentTypeId:p.p},r[0]),d=c.firstItemKey,v=c.hasMissingMetadata,y=c.contentTypeId;if(!d)return null;var b=d&&e.demandItemFacet(p.Qt,V.e.serialize({webAbsoluteUrl:d.webAbsoluteUrl,listFullUrl:d.listFullUrl}));if(b&&(b.isAnonymousGuestUser||b.isEmailAuthenticationGuestUser))return null;var w=!1,E=!!b&&Object(D.t)(b).isActivated("f307ef95-b7d3-4b5a-af39-d71f6f4eaaf1","06/09/2020","Dont show submit for approval button when multiple items are selected"),S=m.n(e,r[0]);if(!(!E&&r.length>1&&((null===(n=b)||void 0===n?void 0:n.listBaseTemplate)!==g.n.webPageLibrary||!(S===f.e.Publish||S===f.e.Republish||S===f.e.PostNews||S===f.e.UpdateNews))))for(var x=0,T=r;x<T.length;x++){var N=T[x];if(!(w=!!m.e(e,N)&&(!(!E&&r.length>1&&!m.i(y))&&($.t(e,N)?1===i:0===i))))break}var C=Object(z.o)(function(e){if(v){return o.createElement(K,Object(s.__assign)({},e,{onCancel:function(e){}}))}return o.createElement(J,Object(s.__assign)({},e,{itemKeys:r,itemSetKey:a}))});return o.createElement(W.e,Object(s.__assign)({isAvailable:w,onExecute:C},Object(R.t)(e,{itemKey:r[0],engagement:{name:"PublishItem",isIntentional:!0,extraData:{publishSource:u}}})))}),G=Object(F.s)()(Q)},,,,,,,,,function(e,t,n){"use strict";var r=n(0),i=n(1114),s=n(51),o=n(11),u=n(159),a=n(172),f=n(2),l=n(8),c=n(116),h=n(44),p=n(98),d=n(28),v=n(2446),m=n(71),g=n(158),y=n(1);n.d(t,"e",function(){return b});n.d(t,"t",function(){return w});var b=new f.e("projection");var w=Object(o.i)()(function(e){var t=this,n=i.e.deserialize(e.itemKey).itemSetKey;return function(o){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,f,w;return Object(r.__generator)(this,function(E){t=s.e.serialize(n);(f=new u.e).resolveItems({items:(w={},w[e.itemKey]=Object(r.__assign)(Object(r.__assign)({},b.pack({})),Object(a.e)().forFacet(b).thenInvalidate(function(){return function(){o((function(e){var t=this,n=e.itemSetKey,o=s.e.deserialize(n),u=i.e.serialize({itemSetKey:o});return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(n){e(Object(c.e)(function(e){var t=Object(d.e)(e,{isProjectedUploadedItemSetEnabled:y.X}).isProjectedUploadedItemSetEnabled;if(void 0!==t&&t){var n=h.e.serialize(o),r=e.demandItemFacet(y.n,n);if(r&&Object.keys(r).length>0)return!1;for(var i=e.demandItemFacet(l.e,p.a),s=0,u=i&&i.itemKeys||[];s<u.length;s++){var a=u[s];if(e.demandItemFacet(v.t,a)){var f=e.demandItemFacet(m.o,a),c=e.demandItemFacet(h.e,f&&f.itemKey);if(c&&c.rootFolder===o.rootFolder)return!1}}}return!0}))&&e(Object(g.e)({items:(t={},t[u]=Object(r.__assign)({},l.e.pack({itemKeys:[]})),t)}));return[2]})})}})({itemSetKey:t}))}}).pack()),w[t]=Object(a.e)().forFacet(l.e).thenInvalidate(e.itemKey,b).pack(),w)});o(f.execute());return[2]})})}})},function(e,t,n){"use strict";var r,i=n(115),s=n(98),o=n(0),u=n(23),a=n(3442),f=n(2659),l=n(11),c=n(384),h=n(10),p=n(560),d=n(313),v=n(8),m=n(71),g=n(6),y=((r={})[m.r.started]=function(e,t){return Object(u.format)(Object(u.getLocalizedCountValue)(a.e.assignToGroupStartedItemsTitle,a.e.assignToGroupTitleIntervals,e)||"",e,t)},r[m.r.completed]=function(e,t){return Object(u.format)(Object(u.getLocalizedCountValue)(a.e.assignToGroupCompletedItemsTitle,a.e.assignToGroupTitleIntervals,e)||"",e,t)},r[m.r.failed]=function(e,t){return Object(u.format)(Object(u.getLocalizedCountValue)(a.e.assignToGroupFailedItemsTitle,a.e.assignToGroupTitleIntervals,e)||"",e,t)},r[m.r.canceled]=function(e,t){return Object(u.format)(Object(u.getLocalizedCountValue)(a.e.assignToGroupFailedItemsTitle,a.e.assignToGroupTitleIntervals,e)||"",e,t)},r),b=Object(l.t)(function(){return function(e){e(Object(c.e)(f.t,p.e)(Object(h.t)()(E)));e(Object(c.e)(f.t,d.n)(Object(h.t)()(w)))}});function w(){return function(e){return function(e,t){return{reportMode:d.e.pin}}}}function E(){return function(e){return S}}function S(e,t){var n=t.itemKey,r=Object(s.i)(e,t),i=r.phase,u=r.count,a=y,l=e.demandItemFacet(v.e,n),c=l&&l.itemKeys,h="",p="";if(c&&c.length>0){var d=e.demandItemFacet(f.e,c[0]),m=d&&d.groupKey;m&&(h=e.demandItemFacet(g.l,m)||"");p=a[i](u,h)}else{var b=e.demandItemFacet(f.t,n);if(b){var w=b.taskKey,E=w&&e.demandItemFacet(g.l,w);E&&(p=E)}}return Object(o.__assign)({},p&&"item"!==t.format?{title:p}:{})}n.d(t,"e",function(){return x});n.d(t,"t",function(){return T});var x=Object(i.i)({operationTypeFacet:f.e}),T=Object(s.s)({operationTypeFacet:f.e,progressKeyFacet:f.t,initializeBatch:function(){return b}})},function(e,t,n){"use strict";var r,i,s=n(0),o=n(376),u=n(44),a=n(786);(function(e){e[e.pin=0]="pin";e[e.unpin=1]="unpin";e[e.movePrevious=2]="movePrevious";e[e.moveNext=3]="moveNext"})(r||(r={}));(function(e){e[e.success=0]="success";e[e.folderDoesNotExist=1]="folderDoesNotExist";e[e.itemDoesNotExist=2]="itemDoesNotExist";e[e.tooManyItems=3]="tooManyItems";e[e.itemNotInSpotlight=4]="itemNotInSpotlight";e[e.invalidArgument=5]="invalidArgument";e[e.serverError=6]="serverError";e[e.invalidServerJSON=7]="invalidServerJSON";e[e.unknownServerResult=8]="unknownServerResult"})(i||(i={}));var f=n(121),l=n(129),c=n(1217),h=n(11),p=n(8),d=n(158),v=n(1),m=n(116),g=n(2546),y=n(114),b=n(172),w=n(6);n.d(t,"t",function(){return E});n.d(t,"e",function(){return S});n.d(t,"n",function(){return x});var E=3,S=(function(e){Object(s.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,r=t.resultType,i=void 0===r?8:r;n.resultType=i;return n}return t})(c.e),x=Object(h.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options.itemEditTypeMap;return function(e){return Object(s.__awaiter)(void 0,void 0,void 0,function(){var r,i,c,h,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q;return Object(s.__generator)(this,function(R){switch(R.label){case 0:r=Object.keys(n)[0];i=n[r].editType;return[4,e(Object(g.e)(r))];case 1:c=R.sent(),h=c.key,x=c.itemId;T=e(Object(m.e)(function(e){return e.demandItem({deserializedPinnedItemSetKey:o.e,pinnedItems:p.e},t)})),N=T.deserializedPinnedItemSetKey,C=T.pinnedItems;N||(N=o.e.deserialize(t));if(!h||!N||!x)throw new S({resultType:5});if(!(h&&N&&x))return[3,3];k="";"";N.viewKey&&(k=N.viewKey.viewId);L=N.parentItemKey.rootFolder||new l.e(N.parentItemKey.listFullUrl).path;A=void 0;(O=C&&C.itemKeys||[])&&(M=O.indexOf(r))>-1&&(2===i&&M>=2?A=O[M-2]:3===i&&M<O.length-1&&(A=O[M+1]));_=void 0;A&&(_=e(Object(m.e)(function(e){return e.demandItemFacet(v.Ie,A)})));D={webAbsoluteUrl:h.webAbsoluteUrl,listFullUrl:h.listFullUrl,itemId:x,editType:i,viewId:k,rootFolder:L,afterItemId:_};t&&(P=(function(e,t,n,r){var i=r.editType,s=[];(0===i||void 0===n&&1!==i)&&s.push(e);for(var o=0,u=t;o<u.length;o++){var a=u[o];a!==e&&s.push(a);a===n&&s.push(e)}return s})(r,O,A,D)).length<=E&&e(Object(d.e)({items:Object(s.__assign)((I={},I[t]=Object(s.__assign)({},p.e.pack({itemKeys:P})),I),Object(y.e)(P,function(){return Object(s.__assign)({},Object(b.e)().forFacet(w.f).thenInvalidate(t,p.e).pack())}))}));return(H=(function(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,r=e.viewId,i=e.editType,s=e.itemId,o=e.afterItemId,u=e.rootFolder,f=Object(a.e)({webAbsoluteUrl:t,listFullUrl:n});r&&(f=f.methodWithAliases("GetView",{viewGuid:r}));if(1!==i){var l=o?parseInt(o,10):-1;isNaN(l)&&(l=-1);f=f.methodWithAliases("AddToSpotlight",{itemId:s,folderPath:u||"",afterItemId:l})}else f=f.methodWithAliases("RemoveFromSpotlight",{itemId:s,folderPath:u||""});return f.toString()})(D))?[4,e(Object(f.t)({webAbsoluteUrl:h.webAbsoluteUrl,listFullUrl:h.listFullUrl,url:H,method:"POST",additionalHeaders:void 0,qosName:"editPinnedItem",noRedirect:!0}))]:[3,3];case 2:B=R.sent();if(0!==(j=(function(e){try{if(e.d){var t=e.d.Order?e.d.Order.results:void 0;return{resultType:e.d.ResultCode,order:t}}return{resultType:8,order:void 0}}catch(e){return{resultType:7,order:void 0}}})(B)).resultType){F=(function(e,t){var n=[];if(e.order)for(var r=0,i=e.order;r<i.length;r++){var o=i[r];n.push(u.e.serialize(Object(s.__assign)(Object(s.__assign)({},t),{itemId:o.toString()})))}return n})(j,h);e(Object(d.e)({items:Object(s.__assign)((q={},q[t]=Object(s.__assign)({},p.e.pack({itemKeys:F})),q),Object(y.e)(F,function(){return Object(s.__assign)({},Object(b.e)().forFacet(w.f).thenInvalidate(t,p.e).pack())}))}));throw new S({resultType:j.resultType})}R.label=3;case 3:return[2]}})})}})},function(e,t,n){"use strict";var r=n(44),i=n(1135),s=n(1136),o=n(104),u=n(1),a=n(2765),f=n(74),l=n(2766);function c(e,t,n,r,i,s,o){return{key:n+r,name:r,action:t(o),iconProps:p(e,s,i)}}function h(e,t,n,r,i,s,o,u){return{key:n+r.displayName,name:r.displayName,action:t(r.contentTypeId||""),iconProps:p(e,s,i)}}function p(e,t,n){return t?{iconName:t}:{iconName:"CustomIcon",style:{backgroundImage:"url("+(n?e+n:n)+")",width:"16px",height:"16px",backgroundRepeat:"no-repeat"}}}function d(e,t,n,r,i,s){return Object(l.e)(e,t,c.bind(void 0,t.webAbsoluteUrl,r),h.bind(void 0,t.webAbsoluteUrl,i),n,s)}var v=n(75);n.d(t,"e",function(){return m});function m(e,t){var n,l=t.key,c=t.listKey,h=t.listFacets,p=t.pageContext,m=[],g=(function(e,t){var n=t.listKey,r=t.listFacets,i=t.pageContext,s=o.e.serialize(n),a=e.demandItemFacet(u.d,s);return!!(i&&!Object(v.t)(i).isActivated("2DEF0213-505E-4BB3-8441-19E3AEC0D352","3/19/21a")&&a&&a.length>1&&r.contentTypesEnabled)})(e,{listFacets:h,pageContext:p,listKey:c}),y=r.e.serialize(l),b=e.demandItemFacet(u.d,y);if(b&&b.length){b.forEach(function(t){var n=e.demandItemFacet(u.jt,t);n&&m.push(n)});if((g||!Object(a.e)(m,h))&&p){var w=new f.t({context:{webAbsoluteUrl:l.webAbsoluteUrl,listUrl:l.listFullUrl}}).getUrlParts({path:l.rootFolder});n=d(m,p,w,function(t){return l&&e.demandItemFacet(u.t,i.e.serialize({listKey:c,templateUrl:t}))},function(t){return l&&e.demandItemFacet(u.t,s.e.serialize({listKey:c,contentTypeId:t}))},h)}}return{contentTypes:m,contentTypeCommands:n}}}],Array(25),[function(e,t,n){"use strict";n.r(t);n.d(t,"spProjectedUploadedItemSetAddon",function(){return m});var r=n(10),i=n(384),s=n(28),o=n(51),u=n(44),a=n(8),f=n(1114),l=n(6),c=n(1),h=n(3086),p=n(1079),d=n(11),v=Object(r.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,r=t.itemKeys,i=Object(s.e)(e,{isProjectedUploadedItemSetEnabled:c.X}).isProjectedUploadedItemSetEnabled;if(void 0!==i&&i){var p=e.demandItemFacet(o.e,n);if(p){var d=(function(e,t,n){var r=[],i=f.e.serialize({itemSetKey:t}),s=e.demandItemFacet(a.e,i);e.demandItemFacet(h.e,f.e.serialize({itemSetKey:t}));if(!s||s.itemKeys&&0===s.itemKeys.length)return;for(var o={},c={},p=0,d=s.itemKeys;p<d.length;p++){var v=d[p];r.push(v);var m=e.demandItemFacet(u.e,v);if(m){m.itemId&&(o[m.itemId]=!0);m.rootFolder&&(c[m.rootFolder]=!0)}o[v]=!0}if(n)for(var g=0,y=n;g<y.length;g++){var b=y[g],w=e.demandItemFacet(u.e,b);if(w){if(e.demandItemFacet(l.d,b)){if(w.rootFolder&&w.rootFolder in c)continue}else if(w.itemId&&w.itemId in o)continue}r.push(b)}return r})(e,p,r);return d?{itemKeys:d}:{}}}return{}}}}),m=Object(d.t)(function(){return function(e){e(Object(i.e)(o.e,p.e)(Object(r.t)()(v)))}})},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(5),i=new r.e("commands",{endpoint:Object(r.s)(),driveId:Object(r.s)({shouldNormalizeToEmpty:!0})})},function(e,t,n){"use strict";n.d(t,"e",function(){return i});n.d(t,"t",function(){return s});n.d(t,"n",function(){return o});n.d(t,"r",function(){return u});n.d(t,"i",function(){return a});n.d(t,"s",function(){return f});n.d(t,"o",function(){return l});n.d(t,"u",function(){return c});n.d(t,"a",function(){return h});n.d(t,"f",function(){return p});var r=n(2),i=new r.e("addToOneDrive"),s=new r.e("createFolder"),o=new r.e("createLink"),u=new r.e("delete"),a=new r.e("download"),f=new r.e("invite"),l=new r.e("move"),c=new r.e("officeLens"),h=new r.e("rename"),p=new r.e("upload")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("hasThumbnailAuthTokenFacet")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("specialFolder")},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(5),i=new r.e("topCollaboratorSetKeyFacet",{endpoint:Object(r.s)()})},function(e,t,n){"use strict";n.d(t,"e",function(){return i});n(44),n(1125);var r=n(129),i=function(e){return""+(""+new r.e(e).authority)+new r.e(e).segments.slice(0,-1).join("/")}},,function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(115),s=new r.e("updateItemRating"),o=Object(i.i)({operationTypeFacet:s})},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(115),s=new r.e("updateItemLikes"),o=Object(i.i)({operationTypeFacet:s})},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(115),s=new r.e("createView"),o=Object(i.i)({operationTypeFacet:s})},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(115),s=new r.e("updateView"),o=Object(i.i)({operationTypeFacet:s})},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(115),s=new r.e("modifyColumnAggregateType"),o=Object(i.i)({operationTypeFacet:s})},,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("teachingBubbleData")},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(5),i=new r.e("userExpirationItemSet",{webAbsoluteUrl:Object(r.s)()})},,,function(e,t,n){"use strict";n.d(t,"e",function(){return m});var r=n(0),i=n("react-lib"),s=n(32),o=n(21),u=n(131),a=n(155),f=n(34),l=n(25),c=n(6),h=n(90),p=n(951),d=n(1),v=Object(a.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred.resx-deferred"),n.e("386")]).then(n.bind(null,3593))];case 1:return[2,e.sent().RulesPanel]}})})}),m=Object(l.n)()(Object(f.t)(function(e,t){var n=t.itemKey,r=t.openManagementPanel,a=Object(h.e)(e,n),f=Object(p.t)(e,{mapping:{internalName:d.Ee,displayName:c.l,columnFieldType:d.ze},itemSetKey:n||""});if(!a)return null;var l=Object(o.o)(function(e){return i.createElement(v,{onDismiss:function(){e.reject(new u.e)},pageContext:a,itemKey:n,columnData:f,openManagementPanel:r||!1})});return i.createElement(s.e,{onExecute:l,engagement:{name:"LaunchRulesPanel",isIntentional:!0}})}))},,function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n("react-lib"),i=n(2),s=n(50),o=n(96),u=n(2777),a={key:Object(i.t)("launchMovePickerCommand"),automationId:"launchMovePickerCommand",name:s.e.MoveItem,ariaLabel:s.e.MoveItem,action:r.createElement(o.t,null,r.createElement(u.t,null)),iconProps:{iconName:"FabricMoveToFolder"}}},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n("react-lib"),i=n(2),s=n(50),o=n(96),u=n(2777),a={key:Object(i.t)("launchCopyPickerCommand"),automationId:"launchCopyPickerCommand",name:s.e.CopyItem,ariaLabel:s.e.CopyItem,action:r.createElement(o.t,null,r.createElement(u.e,null)),iconProps:{iconName:"Copy"}}},function(e,t,n){"use strict";n.r(t);n.d(t,"QuickEditActionExecutor",function(){return S});var r=n(0),i=n("react-lib"),s=n(32),o=n(199),u=n(21),a=n(47),f=n(504),l=n(496),c=n(51),h=n(739),p=n(164),d=n(1),v=n(92),m=n(158),g=n(75),y=n(2779),b=n(264),w=n(35),E=g.e.isActivated("8755e60f-68f8-4103-aa9e-be030b248b24","11/12/2019","Use rum one logging in quick edit."),S=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props.itemKey;return i.createElement(o.e,null,function(n){var o=n.itemCache,g=n.dispatch,S=Object(a.t)(o,{itemKey:t,engagement:{name:"QuickEdit",isIntentional:!0}}),x=o.demandItem({deserizalizeKey:c.e},t).deserizalizeKey,T=x&&x.viewKey,N=x&&h.e.serialize({listKey:{webAbsoluteUrl:x.webAbsoluteUrl,listFullUrl:x.listFullUrl},viewKey:T}),C=T&&p.e.serialize(T),k=Object(w.e)(o).itemsScopeItemKey,L=Object(b.e)(o,{itemsScopeItemKey:k});return i.createElement(u.n,{action:i.createElement(f.e,{layoutType:l.e})},function(t){var n=t.execute;return i.createElement(s.e,Object(r.__assign)({isAvailable:!0,onExecute:function(t){return Object(r.__awaiter)(e,void 0,void 0,function(){var e,i;return Object(r.__generator)(this,function(s){switch(s.label){case 0:if(!E){y.t();y.e("quickEdit.layoutManager.start")}N&&g(Object(m.e)({items:(e={},e[N]=Object(r.__assign)({},d.h.pack(new v.e)),e)}));C&&g(Object(m.e)({items:(i={},i[C]=Object(r.__assign)({},d.vt.pack(L)),i)}));return[4,n(t)];case 1:s.sent();E||y.e("quickEdit.layoutManager.end");return[2]}})})}},S))})})};return t})(i.PureComponent)},,,function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(2),i=n("react-lib"),s=n(315),o=n(712),u={action:i.createElement(o.e,null),automationId:"addShortcutFromSharedWithMeCommand",title:s.e.AddShortcutFromSharedWithMeTooltip,iconProps:{iconName:"FabricFolderLink"},key:new r.e("AddShortcutFromSharedWithMe").id,name:s.e.AddShortcutFromSharedWithMe}}],Array(14),[function(e,t,n){"use strict";n.d(t,"t",function(){return p});n.d(t,"e",function(){return d});var r=n(0),i=n(324),s=n(1528),o=n(233),u=n(146),a=n(441),f=n(2676),l=n(1623),c=n(77),h=n(59);function p(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s,o,f,c,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M;return Object(r.__generator)(this,function(_){switch(_.label){case 0:t=e.name,s=e.endpoint,o=e.sharepointIds,f=e.qosName,c=e.webAbsoluteUrl;p=n(Object(u.e)({getUserOneDriveEndpoint:h.l,isTestMode:h.m})),d=p.getUserOneDriveEndpoint,v=p.isTestMode;m=new a.e(c).authority;return(y=s)?[3,3]:(b=d)?[4,n(d({endpoint:m}))]:[3,2];case 1:b=_.sent();_.label=2;case 2:y=b;_.label=3;case 3:if(g=y)return[3,4];throw new i.e({code:"A2ODAddToOneDrive_missingDriveEndpointInfo"});case 4:w=g.replace("v2.0","v2.1");E=w+"/drives/me/root/children";S=o.listId;x=o.listItemUniqueId;T=o.siteId;N=o.siteUrl;C=o.webId;k={name:t,remoteItem:{sharepointIds:{listId:S,listItemUniqueId:x,siteId:T,siteUrl:N,webId:C}},"@microsoft.graph.conflictBehavior":"rename"};L=[{code:"notAllowed"},{code:"shortcutAlreadyExists"},{code:"nestedDescendantShortcutExists"},{code:"nestedAscendantShortcutExists"}];return[4,n(Object(l.n)({url:E,qosName:f,method:"POST",body:k,expectedErrors:L,endpoint:g}))];case 5:A=_.sent();if(v&&A){O=[];try{(M=window.localStorage.getItem("TAB.AddShortcut"))&&(O=JSON.parse(M))}catch(e){}window.localStorage.setItem("TAB.AddShortcut",JSON.stringify(Object(r.__spreadArrays)(O,[{name:t,id:A.id,endpoint:g}])))}return[2,A]}})})}}function d(e,t,n){var r=Object(s.t)(e,function(r,i){var s=e.response,u=s&&s.error;if(u){var a=u["@error.fixItItemIds"],l=u["@error.fixItWebUrl"],h=u["@error.fixItItemName"],p=[];if(a&&t&&n)for(var d=0,v=a;d<v.length;d++){var m=v[d],g=c.e.serialize({endpoint:t,driveId:n,itemId:m});p.push(g)}switch(r){case"unauthenticated":case 401:return o.r.pack({});case"itemNotFound":case 404:return o.u.pack({});case"accessDenied":case 403:return o.e.pack({});case"shortcutAlreadyExists":return f.n.pack({existShortcutUrl:l,existShortcutName:h});case"nestedDescendantShortcutExists":return f.t.pack({nestDescendantItemKeys:p});case"nestedAscendantShortcutExists":return f.e.pack({existShortcutUrl:l,existShortcutName:h});default:return o.m.pack({})}}});throw new i.e({innerError:e,facets:r})}}],Array(241),[function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(1),s=n(121),o=n(3122),u=n(183),a=n(786);function f(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,r=e.fieldInternalName,i=e.viewId,s=e.rootFolder,f=e.excludeFieldFilteringHtml,l=e.filterParams,c=e.currentUserDisplayName,h=Object(a.e)({webAbsoluteUrl:t,listFullUrl:n}).segment("RenderListFilterData").parameter("FieldInternalName",r||"");i&&(h=h.parameter("ViewId",i));s&&(h=h.parameter("RootFolder",{raw:Object(o.e)(s)}));f&&(h=h.parameter("ExcludeFieldFilteringHtml",!0));if(l){var p=u.default.getFilterParams(l,!0,{replaceMeFormatFilterWithCurrentUser:!0,currentUserDisplayName:c});h=h.rawParameter(p)}return h.toString()}var l=n(1861),c=n(1133),h=n(44),p=n(379),d=n(161),v=n(30),m=n(11),g=n(111),y=n(159),b=n(146),w=n(134);n.d(t,"getSPFilterOptionSetHandler",function(){return E});var E=Object(m.i)({maxParallelOperationCount:8})(function(e){var t=this,n=e.itemKey,o=c.e.deserialize(n);return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,u,a,c,m;return Object(r.__generator)(this,function(E){switch(E.label){case 0:t=e((function(e){var t=e.itemSetKey,n=e.fieldKey;return function(e){var r=e(Object(b.e)({spDataSourceConfiguration:i.Ot})).spDataSourceConfiguration,s=r&&r.ensureAuthToken,o=h.e.serialize(t),u=e(Object(g.e)({folderPath:i.le},o)),a=e(Object(g.e)({internalName:i.Ee,mappedColumnFieldType:i.ze,isCalculated:i.xe},d.e.serialize(n))),f=u&&u.folderPath,l=a&&a.internalName&&a.internalName,c=a&&a.mappedColumnFieldType===v.e.Taxonomy,m=a&&a.isCalculated,y=p.e.serialize({webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl}),E=e(Object(g.e)({pageContext:i.Qt},y)).pageContext,S=t.viewKey&&t.viewKey.viewId,x=S===w.e.Empty?E&&E.viewId:S;return{webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl,rootFolder:f,ensureAuthToken:s,fieldInternalName:l,isCalculatedField:m,filterParams:t.filterParams,excludeFieldFilteringHtml:c,viewId:x,currentUserDisplayName:E&&E.userDisplayName}}})({itemSetKey:o.itemSetKey,fieldKey:o.fieldKey}));return[4,e((S=t,function(e){return e(Object(s.t)({webAbsoluteUrl:S.webAbsoluteUrl,listFullUrl:S.listFullUrl,method:"POST",url:f(S),parseResponse:function(e){return e},qosName:"getFilterData",noRedirect:!0}))}))];case 1:u=E.sent();a=l.e.getFilterData(u,t.fieldInternalName||"",t.isCalculatedField);(c=new y.e).resolveItems({items:(m={},m[n]=Object(r.__assign)({},i.fe.pack(a)),m)});e(c.execute());return[2]}var S})})}})},,,,,,,,function(e,t,n){"use strict";var r=n(11),i=n(384),s=n(44),o=n(0),u=n("react-lib"),a=n(10),f=n(155),l=Object(f.e)(function(){return Object(o.__awaiter)(void 0,void 0,void 0,function(){return Object(o.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("28")]).then(n.bind(null,3033))];case 1:return[2,e.sent().PropertiesForm]}})})}),c=Object(a.t)()(function(){return function(e){return function(e,t){return{getPropertiesForm:function(e){return u.createElement(l,Object(o.__assign)({},e))}}}}});var h=n(2549);n.d(t,"e",function(){return p});var p=Object(r.t)(function(){return function(e){e(Object(i.e)(s.e,h.e)(c))}})}],Array(34),[function(e,t,n){"use strict";n.r(t);n.d(t,"uploadListItem",function(){return O});n.d(t,"mapConflictResolutionToNameConflictBehavior",function(){return M});var r=n(0),i=n(134),s=n(44),o=n(104),u=n(75),a=n(60),f=n(2330),l=n(3114),c=n(121),h=n(1),p=n(203),d=n(59),v=n(111),m=n(1976),g=n(158),y=n(2),b=n(71),w=n(786),E=n(116),S=n(167),x=n(6),T=n(29),N=n(146),C=n(2657),k=n(90),L=Object(S.e)(function(){return new l.e({maxParallelUploads:1/0})}),A=function(e){return function(t){var n=Object(k.e)(t,e);if(n){if(!!Object(u.t)(n).isActivated("3E300045-4874-4525-A1A3-29E5A7BF6BC7","10/21/2020","No longer disable streaming when download is disabled.")&&n.blockDownloadsExperienceEnabled)return!1}var r=t.demandItemFacet(h.st,e);return!(r&&!a.t.hasItemPermission({permissions:r},a.t.editListItems))}};function O(e){var t=this,n=e.itemKey,u=e.options.sourceEntries,a=s.e.deserialize(n),l=a.webAbsoluteUrl,S=a.listFullUrl,O=Object.keys(u)[0],_=u[O],D=_.progressItemKey,P=_.conflictResolution;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,u,_,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z,ee,te,ne,re,ie,se,oe,ue,ae;return Object(r.__generator)(this,function(fe){switch(fe.label){case 0:t=e(Object(c.n)({webAbsoluteUrl:l,listFullUrl:S})),u=t.dataRequestor,_=t.hasDigest;if(!t.hasTokenProvider)return[3,1];B=void 0;return[3,3];case 1:return[4,e(Object(c.e)({url:l||S,disallowCookies:!_}))];case 2:B=fe.sent();fe.label=3;case 3:H=B;if(!(j=e(Object(v.e)({sourceFile:m.t},O)).sourceFile))throw new Error("No source file for upload.");F=e(Object(v.e)({folderPath:h.le},n)).folderPath;if(!(I=void 0===F?a.rootFolder:F))throw new Error("No path information for target folder.");q=e(Object(E.e)((function(e,t){return function(t){var n=Object(k.e)(t,e);return 1024*(n&&n.maximumFileSize||Number.POSITIVE_INFINITY)*1024}})(n)));j.size>q&&Object(C.t)(q);R=Object(w.r)({webAbsoluteUrl:l,listOrItemFullUrl:S});U=new p.e(void 0);z=U.debounce(function(t){var n;D&&e(Object(g.e)({items:(n={},n[D]=Object(y.n)({progressSize:b.m},{progressSize:{current:t}}),n)}))},300,{leading:!1});W=o.e.serialize({webAbsoluteUrl:l,listFullUrl:S});X=e(Object(E.e)(function(e){return e.demandItemFacet(h.Be,W)}));V=!(!X||!X.contentTypesEnabled||X.templateType===T.t.mySiteDocumentLibrary);$=M(P);J=e(Object(N.e)({clientName:d.t})).clientName;K=new f.e({authToken:H,onProgress:z,dataRequestor:u,nameConflictBehavior:$,webApiUrl:R,fileUpload:j,destinationUrl:I,appName:J||"Unknown",throttler:e(L),canStream:e(Object(E.e)(A(n))),itemExpansion:V?"ListItemAllFields/ContentType/Fields":"ListItemAllFields"});D&&e(Object(g.e)({items:(oe={},oe[D]=Object(r.__assign)({},b.m.pack({total:j.size,current:0})),oe)}));Q=K.upload();G=e(Object(E.e)(function(e){return e.demandItemFacet(b.i,D)}));Y=G?G.token.subscribe(function(){K.abort()}):void 0;fe.label=4;case 4:fe.trys.push([4,6,7,8]);return[4,Q];case 5:Z=fe.sent();return[3,8];case 6:ee=fe.sent();K.abort();throw e(Object(C.e)(ee));case 7:Y&&Y();K.dispose();return[7];case 8:te=Z.ServerRelativeUrl;ne=Z.ListItemAllFields&&Z.ListItemAllFields.Id?String(Z.ListItemAllFields.Id):Z.ServerRelativeUrl;re=s.e.serialize({webAbsoluteUrl:l,listFullUrl:S,itemId:ne});ie=Z.UniqueId?i.e.normalizeLower(Z.UniqueId):"";se=Z.Name;D&&e(Object(g.e)({items:(ue={},ue[D]=Object(r.__assign)({},x.l.pack(se)),ue)}));e(Object(g.e)({items:(ae={},ae[re]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},x.l.pack(se)),ie?h.fn.pack(ie):{}),te?h.le.pack(te):{}),x.A.pack({itemKey:n})),ae)}));return[2,{itemKey:re}]}})})}}function M(e){switch(e){case"replace":return 1;case"rename":return 2;default:return 0}}},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("hasPdfFacet")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("sharedBy")},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r,i;(function(e){e[e.MalwareDetected=0]="MalwareDetected";e[e.ThisFileIsCheckedOut=1]="ThisFileIsCheckedOut";e[e.DLPBlocked=2]="DLPBlocked";e[e.MissingMetaData=3]="MissingMetaData";e[e.DLPWarning=4]="DLPWarning";e[e.AwaitingApproval=5]="AwaitingApproval";e[e.Trending=6]="Trending";e[e.New=7]="New";e[e.NeedsRepublishing=8]="NeedsRepublishing"})(r||(r={}));(function(e){e[e.Mail=0]="Mail";e[e.CalendarEvent=1]="CalendarEvent";e[e.Teams=2]="Teams"})(i||(i={}))},function(e,t,n){"use strict";n.d(t,"n",function(){return i});n.d(t,"e",function(){return s});n.d(t,"t",function(){return o});var r=n(5),i=new r.e("SharedByPersonKeyFacet",{displayName:Object(r.s)(),email:Object(r.s)()}),s=new r.e("dateSharedGroupKeyFacet",{relativeTime:Object(r.s)(),sharedDateTime:Object(r.s)()}),o=new r.e("relativeTimeGroupKeyFacet",{relativeTime:Object(r.s)()})},function(e,t,n){"use strict";n.d(t,"e",function(){return g});var r=n(0),i=n(11),s=n(159),o=n(673),u=n(799),a=n(1623),f=n(2433),l=n(1161),c=n(311),h=n(172),p=n(3645),d=n(2661),v=n(77),m=n(6),g=Object(i.n)({maxParallelOperationCount:1,maxItemCountPerBatch:20,areSameBatch:function(e,t){var n=o.e.deserialize(e.itemKey).driveItemKey,r=n.endpoint,i=n.driveId,s=o.e.deserialize(t.itemKey).driveItemKey,u=s.endpoint,a=s.driveId;return!!i&&!!a&&i===a&&r===u}})(function(e){var t=this,n=e.items;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,p,d,g,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V;return Object(r.__generator)(this,function($){switch($.label){case 0:t=Object.keys(n);i=t[0];p=o.e.deserialize(i);d=p.driveItemKey,g=d.endpoint,E=d.driveId;if(!g)throw new Error("No endpoint to determine activity items.");S=t.map(function(e){return o.e.deserialize(e).driveItemKey.itemId});x=Object(u.n)({endpoint:(J=g,J.replace("2.1","2.0")),driveId:E});T=x+"/ExtendedActivitiesForItems";N={driveItems:S,badgeOnly:!0};return[4,e(Object(a.n)({url:T,method:"POST",body:N,qosName:"ItemActivityFieldDataSource.extendedActivitiesForItems",endpoint:g}))];case 1:if((C=$.sent()).value){k=(function(e){for(var t={},n=0,r=e;n<r.length;n++){var i=r[n],s=i.driveItemId;if(s){(t[s]||(t[s]=[])).push(i)}}return t})(C.value);L=0;A=0;O=0;M=0;_=new s.e;for(D=0,P=t;D<P.length;D++){H=P[D];L++;B=o.e.deserialize(H);j=B.driveItemKey.itemId;F=j&&k[j];I=v.e.serialize(B.driveItemKey);q=void 0;if(F){R=new f.e;U=R.processResponse({item:{name:j||"",relativePath:"",absolutePath:"",isFolder:!1,graphItemUrl:T},response:{value:F,"@odata.nextLink":""}}).activities;z=y(U);if(W=b(U)){O++;A++;if(!z){M++;X=w(W,H).itemResolver;_.merge(X);q=W}}}_.resolveItems({items:(V={},V[H]=Object(r.__assign)({},l.e.pack(q)),V[I]=Object(r.__assign)({},Object(h.e)().forFacet(m.e).thenInvalidate(H,l.e).pack()),V)})}e(_.execute());e(Object(c.e)({name:"ItemActivityField.View",extraData:{activityFieldProcessedItemCount:L,activityFieldEligibleItemCount:A,activityFieldActiveItemCount:O,activityFieldBadgedItemCount:M,activityFieldBadgedPercent:L?Math.round(M/L*100):0},isIntentional:!1}))}return[2]}var J})})}});function y(e){var t=e[0];return!!t&&1===t.actors.length&&t.actors[0].self&&!t.type||!1}function b(e){var t=e[0],n={};if(t)for(var i=0,s=t.actors;i<s.length;i++){(l=s[i]).id&&(n[l.id]=!0)}for(var o=Object(r.__assign)(Object(r.__assign)({},t),{actors:Object(r.__spreadArrays)(t.actors||[])}),u=1;u<e.length;u++)for(var a=0,f=e[u].actors;a<f.length;a++){var l;if("string"==typeof(l=f[a]).id&&!n[l.id]){o.actors.push(l);n[l.id]=!0}}return o||t}function w(e,t){var n=new s.e,i=o.e.deserialize(t).driveItemKey,u=(function(e){var t=e.actors,n=e.action.mention&&e.action.mention.mentionees||[],i=e.action.share&&e.action.share.recipients||[],s=e.action.commentResponse&&e.action.commentResponse.commentAuthor,o=Object(r.__spreadArrays)(t,n,i);s&&o.push(s);return o})(e);if(u.length>0){var a=(function(e,t){for(var n=new s.e,r=0,i=e;r<i.length;r++){var o=E(i[r],t).itemResolver;n.merge(o)}return{itemResolver:n}})(u,i).itemResolver;n.merge(a)}return{itemResolver:n}}function E(e,t){var n=new s.e,r={itemKey:v.e.serialize(t),userKey:d.e.serialize({email:e.email||"",endpoint:t.endpoint}),user:{displayName:e.displayName,email:e.email}},i=Object(p.t)(r).itemResolver;n.merge(i);return{itemResolver:n}}},function(e,t,n){"use strict";n.d(t,"t",function(){return c});n.d(t,"e",function(){return h});var r=n(0),i=n(10),s=n(54),o=n(85),u=n(77),a=n(2152),f=n(8),l=n(158),c=Object(i.t)()(function(){return function(e){return function(e,t){var n,i,o=Object(s.e)(e),f={},l=e.demandItemFacet(a.e,t.itemKey);if(l){n=h(e,{parentItemKey:u.e.serialize(l.driveItemKey),stageItem:t.stageItem});f={itemKey:t.itemKey}}else{n=(i=(function(e,t){var n=t.folderItemKey,i=t.currentItemSetKey;if(i&&n){var s=e.demandItemFacet(a.e,i),o=e.demandItemFacet(u.e,n);if(s&&o){var f=o.endpoint,l=o.driveId,c=o.itemId;return Object(r.__assign)(Object(r.__assign)({},s),{driveItemKey:{endpoint:f,driveId:l,itemId:c}})}}return})(e,{folderItemKey:t.itemKey,currentItemSetKey:o}))&&h(e,{parentItemKey:u.e.serialize(i.driveItemKey),stageItem:t.stageItem});f=i?{itemKey:a.e.serialize(i)}:{}}return Object(r.__assign)(Object(r.__assign)({},f),n?{stageItem:n}:{})}}});function h(e,t){var n=this,i=t.parentItemKey,s=t.stageItem;if(i)return s?Object(o.t)(function(e){var t=e.itemsScopeItemKey,o=e.currentItemKey;return function(e){return Object(r.__awaiter)(n,void 0,void 0,function(){var n;return Object(r.__generator)(this,function(u){switch(u.label){case 0:e(Object(l.e)({items:(n={},n[o]=Object(r.__assign)({},f.s.pack({itemKey:i})),n)}));return[4,e(s({currentItemKey:o,itemsScopeItemKey:t}))];case 1:u.sent();return[2]}})})}}):void 0}},function(e,t,n){"use strict";n.d(t,"e",function(){return p});n.d(t,"t",function(){return v});var r=n(10),i=n(77),s=n(2753),o=n(2756),u=n(2975),a=n(3118),f=n(129),l=n(6),c=n(799),h=n(136),p=Object(r.t)()(function(){return function(e){return d}});function d(e,t){var n=t.itemKey,r=t.desiredSize,p=e.demandItemFacet(i.e,n);if(!p)return{};var d=e.demandItemFacet(a.e,n)?(function(e,t){var n=t.itemKey,r=t.desiredSize,i=v(e.demandItemFacet(s.e,n));if(i&&i.large)return{url:y(i.large.url,r),width:0,height:0}})(e,{itemKey:n,driveItem:p,desiredSize:r}):(function(e,t){var n=t.itemKey,r=t.driveItem,i=t.desiredSize;if(r.endpoint.indexOf("/_api/v2.")>-1){var s=e.demandItemFacet(l.i,n),a=e.demandItemFacet(l.c,n,{suppressGetItems:!0})||"";if(s){var p=new f.e(r.endpoint).authority+"/_api/v2.1",d=o.e.serialize({endpoint:p,driveId:r.driveId}),v=e.demandItemFacet(u.e,d);if(v){var m=Object(c.t)({endpoint:p,driveId:r.driveId,itemId:r.itemId}),g=Math.ceil(i.width),y=Math.ceil(i.height);return{url:m+"/thumbnails/0/c"+g+"x"+y+"/content?"+Object(h.e)({prefer:"noredirect,closestavailablesize",cb:a,access_token:{uriValue:v}}),width:0,height:0}}}}})(e,{itemKey:n,driveItem:p,desiredSize:r});return d?{thumbnail:d}:{}}function v(e){return e&&((t=e)&&"number"==typeof t.length)?e[0]:e;var t}var m=/width=[0-9]*/,g=/height=[0-9]*/;function y(e,t){var n="number"==typeof t.width?Math.ceil(t.width):t.width,r="number"==typeof t.height?Math.ceil(t.height):t.height,i=""+(n||"");m.test(e)?e=e.replace(m,"width="+i):e+=(e.indexOf("?")>-1?"&":"?")+"width="+i;var s=""+(r||"");g.test(e)?e=e.replace(g,"height="+s):e+=(e.indexOf("?")>-1?"&":"?")+"height="+s;return e}},,function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(115),s=new r.e("saveUploadedTemplateToView"),o=Object(i.i)({operationTypeFacet:s})},,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(16).e)("getDefaultShareLinkActionControl")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(16).e)("permissionInviteActionControl")},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(115),s=new r.e("reorderListItems"),o=Object(i.i)({operationTypeFacet:s})},,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(16).e)("removeFromShardListActionControl")},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return u});n.d(t,"t",function(){return a});var r=n(0),i=n(233),s=n(324),o=n(1528),u=function(e,t,n){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var o,u;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,fetch(e,{mode:"cors"})];case 1:return(o=r.sent()).ok?[4,o.blob()]:[3,3];case 2:u=r.sent();return[2,new File([u],t,{type:n})];case 3:throw new s.e({code:"printfiledownloaderror",facets:i.l.pack(o.status)})}})})},a=function(e){var t=Object(o.t)(e,function(e,t){switch(e){case"unauthenticated":case 401:return i.r.pack({});case"itemNotFound":case 404:return i.h.pack({});case"accessDenied":case 403:return i.e.pack({});default:return i.m.pack({})}});throw new s.e({innerError:e,facets:t})}},function(e,t,n){"use strict";n.d(t,"t",function(){return o});n.d(t,"e",function(){return u});var r=n(2),i=n(124),s=n(8),o=new r.e("expiryDate"),u=new i.e("expiringUserCount",function(e,t){var n=t.itemKey,r=e.demandItemFacet(s.e,n);if(r){var i=new Date;i.setDate(i.getDate()+21);for(var u=i.getTime(),a=0,f=0,l=r.itemKeys;f<l.length;f++){var c=l[f],h=e.demandItemFacet(o,c);h&&h<u&&a++}return a}})},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(16).e)("itemAutoRefreshControl")},,,function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(0),i=n("react-lib"),s=n(32),o=n(34),u=Object(o.t)(function(e,t){return i.createElement(s.e,{onExecute:function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(r.__generator)(this,function(n){e=null;t.selector?e=document.querySelector(t.selector):t.elementId&&(e=document.getElementById(t.elementId));if(e){e.focus();t.shouldClick&&e.click&&e.click()}return[2]})})},engagement:{name:"SetFocus",isIntentional:!0}})})}],Array(170),[function(e,t,n){"use strict";var r=n(0),i=n(172),s=n(6),o=n(8),u=n(159),a=n(673),f=n(941),l=n(5),c=new l.e("userById",{id:Object(l.s)(),endpoint:Object(l.s)()}),h=n(266),p=n(3446),d=n(2661),v=n(2331);n.d(t,"e",function(){return m});n.d(t,"t",function(){return g});function m(e){var t,n=e.itemKey,l=e.driveItemKey,h=e.parentFolderItemKey,m=e.setItemKey,y=e.driveItemResponse,b=e.endpoint,w=e.getDriveItemFacets,E=void 0===w?v.e:w,S=e.shouldInvalidateItemSetOnChildItemRename,x=void 0===S?void 0:S,T=new u.e,N=a.e.serialize({driveItemKey:l}),C=void 0;if(m){var k=Object(i.e)().forFacet(s.f).thenInvalidate(m,o.e).forFacet(s.A).thenInvalidate(m,o.e);x&&!x(b)||(k=k.forFacet(s.l).thenInvalidate(m,o.e));C=k.pack()}var L=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},E({driveItemKey:l,driveItem:y,endpoint:b,parentFolderItemKey:h})),s.e.pack({itemKey:N})),C);T.resolveItems({items:(t={},t[n]=L,t)});if(y.lastModifiedBy){if(_=y.lastModifiedBy.user){var A=_.id&&c.serialize({id:_.id,endpoint:b});if(A=_.email&&d.e.serialize({email:_.email,endpoint:b})){var O=g({itemKey:n,personFacet:s.k,userKey:A,user:_}).itemResolver;T.merge(O)}}}if(y.createdBy){var M=void 0;if((_=y.createdBy.user)&&_.email&&(M=d.e.serialize({email:_.email,endpoint:b}))){O=g({itemKey:n,personFacet:f.r,userKey:M,user:_}).itemResolver;T.merge(O)}}if(y.remoteItem&&y.remoteItem.shared&&y.remoteItem.shared.sharedBy&&y.remoteItem.shared.sharedBy.user){var _,D=void 0;if((_=y.remoteItem.shared.sharedBy.user).email&&(D=d.e.serialize({email:_.email,endpoint:b}))){O=g({itemKey:n,personFacet:p.e,userKey:D,user:_}).itemResolver;T.merge(O)}}return{itemResolver:T}}function g(e){var t,n,i=e.itemKey,o=e.personFacet,a=e.userKey,f=e.user,l=new u.e;l.resolveItems({items:Object(r.__assign)((t={},t[a]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},s.l.pack(f.displayName)),h.e.pack(f.email)),h.n.pack(f.id)),t),o&&(n={},n[i]=Object(r.__assign)({},o.pack({itemKey:a,displayValue:f.displayName})),n))});return{itemResolver:l}}}],Array(48),[function(e,t,n){"use strict";n.r(t);n.d(t,"sharePointBasicItemDataAddonDeferred",function(){return s});var r=n(11),i=n(2363),s=Object(r.t)(function(){return function(e){e(i.e)}})},,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n("react-lib"),i=n(314),s=n(2),o=n(3474),u={key:new s.e("GetNPSSurveyFocusShortcut").id,automationId:"GetNPSSurveyFocusShortcut",shortcutProps:{keySequences:["AltDown"],content:i.e.getNPSSurveyFocusShortcut},action:r.createElement(o.e,{elementId:"obf-TPromptContainer"})}},,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(117),i=n(77),s=n(1039),o=n(3130);function u(e,t){var n=Object(r.e)(e),u=e.demandItemFacet(i.e,n),a=u&&s.e.serialize(u);if(a){var f=e.demandItemFacet(o.e,a);if(f){return f[t.campaignId]||{d:!1,v:0}}}}}],Array(142),[function(e,t,n){"use strict";n.r(t);var r,i=n(0),s=n(11),o=n(115),u=n(959),a=n(274),f=n(990),l=n(738),c=n(44),h=n(376),p=n(1126),d=n(51),v=n(706),m=n(1127),g=n(1139),y=n(1138),b=n(734),w=n(1125),E=n(104),S=n(2979),x=n(2977),T=n(2664),N=n(3123),C=n(3124),k=n(2659),L=n(2548),A=n(2049),O=n(3125),M=n(2980),_=n(3126),D=n(384),P=n(826),H=n(2);(function(e){e[e.preview=0]="preview";e[e.save=1]="save"})(r||(r={}));var B=new H.e("updateColumnFormatter"),j=(Object(o.i)({operationTypeFacet:B}),n(1182)),F=n(1189),I=n(1141),q=n(1),R=n(121),U=n(159),z=n(1362),W=n(26),X=n(116),V=n(139),$=n(136),J=n(786),K=Object(s.i)({maxParallelOperationCount:4})(function(e){var t=this,n=e.itemKey,r=I.e.deserialize(n).tenantRootUrl;return function(n){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,s,o,u,a,f,l,c,h,p,d,v;return Object(i.__generator)(this,function(m){switch(m.label){case 0:t=b.e.serialize({webAbsoluteUrl:r});return[4,n(Object(z.e)(function(e){return e.demandItemFacet(q.nt,t)}))];case 1:s=m.sent();o=n(Object(X.e)(function(e){return e.demandItemFacet(W.S,V.e)}));u=!s;f=o&&o.language||"en-US";l=Object($.e)({Locale:f,v:2,msajax:1,cv:2});a=u?r+"/_layouts/15/online/handlers/SpoSuiteLinks.ashx?"+l:Object(J.n)({webAbsoluteUrl:r}).segments("Microsoft.SharePoint.Portal.SuiteNavData.GetSuiteNavData").parameters({v:2,Locale:f});return[4,n(Object(R.t)({url:a.toString(),qosName:"LoadData",method:"POST",webAbsoluteUrl:r,noRedirect:!0}))];case 2:c=m.sent();h=u?c:JSON.parse(c.d.GetSuiteNavData);p=!(!h.NavBarData||!h.NavBarData.AdminLink)||void 0;(d=new U.e).resolveItems({items:(v={},v[e.itemKey]=Object(i.__assign)({},q.sn.pack(p)),v)});n(d.execute());return[2]}})})}});var Q=Object(s.t)(function(){return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(t){e(Object(o.s)(I.e,a.e)(K));return[2]})})}}),G=n(2665),Y=n(158),Z=n(850),ee=n(8),te=n(119),ne=n(56),re=n(1081),ie={ODB:1855},se=Object(s.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options.formatterMap;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,s,o,u,a,f,l,c;return Object(i.__generator)(this,function(h){switch(h.label){case 0:r=Object.keys(n)[0];s=n[r],o=s.updateType,u=s.formatter;return 0!==o?[3,1]:[2,e(Object(Y.e)({items:(l={},l[r]=Object(i.__assign)({},q.m.pack(u)),l)}))];case 1:return 2!==o?[3,4]:[4,e(Object(z.e)(function(e){e.demandItemFacet(te.e,te.t.serialize({}))}))];case 2:h.sent();a=!1;f={};return[4,e(Object(z.e)(function(e){if(a=Object(ne.e)(e,{feature:ie})){var n=e.demandItem({schema:ee.o},t).schema,r=n&&n.columnKeys;r&&(f=Object(re.e)(e,r))}}))];case 3:h.sent();return[2,e(Object(Y.e)({items:(c={},c[r]=Object(i.__assign)({},q.hn.pack(Object(Z.e)({formatter:u,fieldFormatters:f,columnFormatterReferenceProps:{columnFormatterReferenceEnabled:a}}))),c)}))];case 4:return[2]}})})}}),oe=new H.e("modifyFieldProperties"),ue=(Object(o.i)({operationTypeFacet:oe}),n(111)),ae=n(419),fe=n(6),le=Object(s.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options.fields;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,s,o,u,a,f,l,c,h;return Object(i.__generator)(this,function(p){r=Object.keys(n)[0];s=n[r],o=s.displayName,u=s.fieldDescription,a=s.showInFiltersPane;if((f=e(Object(ue.e)({setKey:d.e},t)).setKey)&&r&&(l=e(Object(ue.e)({id:q.ue},r)).id)){c={__metadata:{type:"SP.Field"},Title:o,SchemaXml:u,ShowInFiltersPane:a};h=Object(J.e)({webAbsoluteUrl:f.webAbsoluteUrl,listFullUrl:f.listFullUrl}).method("Fields",l).toString();return[2,e(Object(R.t)({webAbsoluteUrl:f.webAbsoluteUrl,listFullUrl:f.listFullUrl,url:h,qosName:"modifyFieldProperties",body:JSON.stringify(c),method:"POST",additionalHeaders:{"X-HTTP-Method":"MERGE"}})).then(function(){var t;return e(Object(Y.e)({items:(t={},t[r]=Object(i.__assign)(Object(i.__assign)({},void 0!==a?ae.n.pack(a):{}),void 0!==o?fe.l.pack(o):{}),t)}))})]}return[2]})})}}),ce=n(191),he=n(841),pe=n(287),de=Object(s.i)()(function(e){var t=this,n=e.itemKey,r=l.e.deserialize(n),s={webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl,rootFolder:"",viewKey:{viewId:he.e}};return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,r,o;return Object(i.__generator)(this,function(i){switch(i.label){case 0:t=e(Object(ce.n)({itemSetKey:s}));return[4,e(Object(ce.t)({itemSetKey:s,contentTypes:t,qosName:"getNeedsAttentionFlag"}))];case 1:r=i.sent();i.label=2;case 2:i.trys.push([2,5,,7]);return[4,e(Object(pe.e)({getItemContext:r}))];case 3:o=i.sent();return[4,e(ve(o,n))];case 4:i.sent();return[3,7];case 5:i.sent();return[4,e(ve(void 0,n))];case 6:i.sent();return[3,7];case 7:return[2]}})})}});function ve(e,t){var n=this;return function(r){return Object(i.__awaiter)(n,void 0,void 0,function(){var n,s,o,u;return Object(i.__generator)(this,function(a){n=!1;(s=e&&e.ListData&&e.ListData.Row)&&s.length>0&&s[0]&&(n=!0);(o=new U.e).resolveItems({items:(u={},u[t]=Object(i.__assign)({},fe.C.pack(n||void 0)),u)});r(o.execute());return[2]})})}}var me=n(3398),ge=n(324),ye=n(37),be=n(134),we=n(1735),Ee=Object(s.n)()(function(e){var t=e.items;return function(n){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,o,u,a,f,l,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O;return Object(i.__generator)(this,function(M){switch(M.label){case 0:r=void 0;o=void 0;for(u=0,a=Object.keys(t);u<a.length;u++){m=a[u];f=n(Object(ue.e)({key:c.e,folderPath:q.le},m));l=e.items[m];if(f&&f.key&&f.folderPath){if(!r){o=f.key.listFullUrl;r={webAbsoluteUrl:f.key.webAbsoluteUrl,items:[],checkInOutType:l.checkInOutType,checkInText:l.checkInText,checkInVersionType:l.checkInVersionType};o=f.key.listFullUrl}r.items.push({key:m,itemFullUrl:f.folderPath})}}if(!(h=r)||!h.items.length)return[3,4];p=h.items.length>1;d=void 0;d="checkIn"===h.checkInOutType?p?"batchCheckInItems":"CheckInItem":"checkOut"===h.checkInOutType?p?"batchCheckOutItems":"CheckOutItem":p?"batchUndoCheckOutItems":"UndoCheckOutItem";v="checkOut"===h.checkInOutType;if(p)return[3,2];m=h.items[0].key;g=Se(h.webAbsoluteUrl,h.items[0].itemFullUrl,h.checkInOutType,h.checkInText,h.checkInVersionType);return[4,n(Object(R.t)({webAbsoluteUrl:h.webAbsoluteUrl,listFullUrl:o,url:g,method:"POST",qosName:d}))];case 1:M.sent();n(Object(Y.e)({items:(A={},A[m]=Object(i.__assign)({},fe.y.pack({byYou:!!v,byOther:void 0})),A)}));return[3,4];case 2:y=be.e.generate();b="multipart/mixed; boundary=batch_"+y;return[4,n(Object(R.t)({webAbsoluteUrl:h.webAbsoluteUrl,listFullUrl:o,url:we.t.getBatchOperationUrl(h.webAbsoluteUrl),body:xe(h,y),method:"POST",additionalHeaders:void 0,contentType:b,parseResponse:function(e){return we.t.processBatchResponse(e,h.items)},qosName:"batch",telemetryHandler:function(e){var t=e.response,n=e.eventData;return t&&n.resultType===ye.t.success?{eventData:Object(i.__assign)(Object(i.__assign)({},n),{resultType:t.hasError?ye.t.failure:ye.t.success})}:{eventData:n}}}))];case 3:if((w=M.sent()).hasError){N={items:{}};for(C=0,k=w.items;C<k.length;C++)(L=k[C]).error&&L.key&&(N.items[L.key]=new ge.e({message:L.error.message}));throw new s.e(N)}E=new U.e;for(S=0,x=h.items;S<x.length;S++){T=x[S];E.resolveItems({items:(O={},O[T.key]=Object(i.__assign)({},fe.y.pack({byYou:!!v,byOther:void 0})),O)})}n(E.execute());M.label=4;case 4:return[2]}})})}});function Se(e,t,n,r,i){var s;s="checkIn"===n?"CheckIn":"undoCheckOut"===n?"UndoCheckOut":"CheckOut";var o=Object(J.r)({webAbsoluteUrl:e,listOrItemFullUrl:t}).methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:t});return(o="checkIn"===n?o.methodWithAliases("CheckIn",{comment:r,checkintype:i||0}):o.segment(s)).toString()}function xe(e,t){var n=e.items,r=we.t.defaultBatchRequestPostData,i=n.map(function(t){return Se(e.webAbsoluteUrl,t.itemFullUrl,e.checkInOutType,e.checkInText,e.checkInVersionType)});return we.t.getBatchContentExtended(t,i,"POST",r)}var Te=n(2196),Ne=n(2365),Ce=Object(s.n)()(function(e){var t=e.items;return function(n){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,s,o,u,a,f,l,h,p,d,v,m,g,y,b,w,E,S,x,T,N;return Object(i.__generator)(this,function(C){switch(C.label){case 0:r=void 0;s=void 0;o="";u=!0;for(a=0,f=Object.keys(t);a<f.length;a++){S=f[a];l=n(Object(ue.e)({key:c.e,folderPath:q.le},S));h=n(Object(ue.e)({key:c.e,uiVersion:q.un,contentTypeId:q.p},S)),p=h.uiVersion,d=h.contentTypeId;o=Ne.t(p);u=Ne.i(d);v=e.items[S];m=n(Object(ue.e)({listItemId:q.Ie},S)).listItemId;if(l&&l.key&&l.folderPath){if(!r){s=l.key.listFullUrl;r={webAbsoluteUrl:l.key.webAbsoluteUrl,items:[],publishActionType:v.publishActionType,publishText:v.publishText};s=l.key.listFullUrl}r.items.push({key:S,itemFullUrl:l.folderPath,listItemId:m})}}if(!(g=r)||!g.items.length)return[3,4];y=g.publishActionType===Te.e.SchedulePublish;b=y?"ScheduleItem":"PublishItem";w=0;C.label=1;case 1:if(!(w<g.items.length))return[3,4];E=g.items[w];S=E.key;x=u&&g.publishActionType!==Te.e.CancelApproval;T=x?(function(e,t,n){return e+"/_api/sitepages/pages("+t+")/"+(n?"schedulepublish":"publish")})(g.webAbsoluteUrl,E.listItemId,y):(function(e,t,n){var r="Publish";n&&n===Te.e.CancelApproval&&(r="UnPublish");var i=Object(J.r)({webAbsoluteUrl:e,listOrItemFullUrl:t}).methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:t});return(i=i.segment(r)).toString()})(g.webAbsoluteUrl,g.items[0].itemFullUrl,g.publishActionType);return[4,n(Object(R.t)({webAbsoluteUrl:g.webAbsoluteUrl,listFullUrl:s,url:T,body:!y&&x?'{"__metadata":{"type":"SP.Publishing.SitePage"}}':"",method:"POST",qosName:b}))];case 2:C.sent();""!==o&&n(Object(Y.e)({items:(N={},N[S]=Object(i.__assign)({},q.un.pack(o)),N)}));C.label=3;case 3:w++;return[3,1];case 4:return[2]}})})}});var ke=n(1198),Le=n(2546),Ae=Object(s.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,s,o,u,a,f,l,c;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return[4,e(Object(Le.e)(t))];case 1:r=i.sent(),s=r.key,o=r.itemId;u=s.webAbsoluteUrl,a=s.listFullUrl;f=E.e.serialize({webAbsoluteUrl:u,listFullUrl:a});return(l=e(Object(X.e)(function(e){return e.demandItemFacet(q.Be,f)})))&&l.id&&o?[4,e(Object(R.t)({webAbsoluteUrl:u,listFullUrl:a,url:Object(J.n)({webAbsoluteUrl:u}).methodWithAliases("Microsoft.Office.Server.ReputationModel.Reputation.SetRating",{listID:l.id,itemID:o,rating:n.userNewRating}).toString(),method:"POST",qosName:"updateRating"}))]:[3,3];case 2:i.sent();e(Object(ke.e)({items:(c={},c[t]=[fe.l],c)}));i.label=3;case 3:return[2]}})})}}),Oe=Object(s.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,s,o,u,a,f,l,c;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return[4,e(Object(Le.e)(t))];case 1:r=i.sent(),s=r.key,o=r.itemId;u=s.webAbsoluteUrl,a=s.listFullUrl;f=E.e.serialize({webAbsoluteUrl:u,listFullUrl:a});return(l=e(Object(X.e)(function(e){return e.demandItemFacet(q.Be,f)})))&&l.id&&o?[4,e(Object(R.t)({webAbsoluteUrl:u,listFullUrl:a,url:Object(J.n)({webAbsoluteUrl:u}).methodWithAliases("Microsoft.Office.Server.ReputationModel.Reputation.SetLike",{listID:l.id,itemID:o,like:n.liked}).toString(),method:"POST",qosName:"updateLikes"}))]:[3,3];case 2:i.sent();e(Object(ke.e)({items:(c={},c[t]=[fe.l],c)}));i.label=3;case 3:return[2]}})})}}),Me=n(129),_e=n(74),De=Object(s.i)({maxParallelOperationCount:4})(function(e){var t=this,n=e.itemKey,r=e.options,s=r.newDocumentKey,o=r.extension;return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,r,u,a,f;return Object(i.__generator)(this,function(l){switch(l.label){case 0:t=c.e.deserialize(n);r=t.rootFolder||new Me.e(t.listFullUrl).path;u=new _e.t({context:{webAbsoluteUrl:t.webAbsoluteUrl,listUrl:t.listFullUrl}});a=u.getUrlParts({path:r});f=a.fullItemUrl;return[4,e(Object(R.t)({webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl,url:Pe({webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl,parentFolderPath:a.listRelativeItemUrl||"",extension:o}),method:"POST",parseResponse:function(e){return JSON.parse(e)},qosName:"createCustomDocument",noRedirect:!0})).then(function(t){var r,o,u=t&&t.d&&t.d.CreateDocumentWithDefaultName;if(!u)throw"Fail to create custom document";var a=f+"/"+u;e(Object(Y.e)({items:(r={},r[s]=Object(i.__assign)(Object(i.__assign)({},fe.l.pack(u)),fe.i.pack(a)),r)}));e(Object(ke.e)({items:(o={},o[n]=[ee.t],o)}))})];case 1:l.sent();return[2]}})})}});function Pe(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,r=e.extension,i=e.parentFolderPath;if(!r)throw new Error("document extension is not valid");return Object(J.e)({webAbsoluteUrl:t,listFullUrl:n}).methodWithAliases("CreateDocumentWithDefaultName",{folderPath:i,extension:r}).toString()}var He=n(3088),Be=n(164),je=n(391),Fe=n(2013),Ie=n(508);function qe(e){var t=e.sourceView,n=e.deserializedItemSetKey,r=e.appliedFilters,i=new je.e(t.getEffectiveViewXml());n.sortFieldKey&&i.updateSort({fieldName:n.sortFieldKey,isAscending:n.sortAscending},{overwriteAll:!0});n.groupByFieldKey&&i.updateGroupBy({group1:{fieldName:n.groupByFieldKey,isAscending:!0}});if(r)for(var s in r)if(r.hasOwnProperty(s)){var o=r[s];Fe.updateFilter(i,o)}try{var u=Object(Ie.e)(t.id,!0);if(u){i.updateColumnWidths(u);Object(Ie.t)(t.id)}}catch(e){}return i}var Re=n(146),Ue=n(75),ze=n(90),We=Object(s.i)({mergeForSameItemKey:!1,maxParallelOperationCount:4})(function(e){var t=e.itemKey,n=e.options.views;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,s,o,u,a,f,l,c,h,v,m,g,y,b,w,E,S,x,T,N,C,k,A,O,M,_,D,P;return Object(i.__generator)(this,function(H){r=p.e.deserialize(t);s=Object.keys(n)[0];o=n[s],u=o.sourceView,a=o.isPublic,f=o.itemSetKey,l=o.progressItemKey;if(u&&r){c=e(Object(ue.e)({deserializedItemSetKey:d.e,filterableSet:q.Ht,childItems:ee.e,parentItem:ee.s,schema:ee.o},f)),h=c.deserializedItemSetKey,v=c.filterableSet,m=c.childItems,g=c.parentItem,y=c.schema;b=h&&h.viewKey&&Be.e.serialize(h.viewKey)||"";w=e(Object(ue.e)({viewType:q.pn},b)).viewType;(E=h?qe({sourceView:u,deserializedItemSetKey:h,appliedFilters:v&&v.appliedFilters}):u).prepareForSaving();S=e(Object(X.e)(function(e){return Object(ze.e)(e,f)}));x=S&&Object(Ue.t)(S).isActivated("E05C14DE-D6D7-4E39-9616-2D192123BAC3","2/1/21","Include ViewTypeKind in payload");T=w&&je.e.getViewTypeInfo(w);N=!x&&T?T.viewTypeKind:void 0;C=T?T.viewType2:void 0;k=Object(J.e)({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl}).segment("Views").segment("Add");_=u.getEffectiveAggregatesFieldXml();D=u.viewData,P=u.customFormatter;return[2,e(Object(R.t)({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl,url:k.toString(),method:"POST",body:JSON.stringify({parameters:Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({__metadata:{type:"SP.ViewCreationInformation"},Title:s,ViewFields:{__metadata:{type:"Collection(Edm.String)"},results:u.getEffectiveFieldNames()},Query:E.getEffectiveQueryXml(!1),Paged:!0,PersonalView:!a,RowLimit:u.rowLimit},N?{ViewTypeKind:N}:{}),C?{ViewType2:w}:{}),{ViewData:D})}),qosName:"addView",noRedirect:!0})).then(function(t){var n,r,s;if(!t||!t.d)throw new Error("No view returned by /Views/Add");var o=t.d;O={viewId:be.e.normalizeLower(o.Id,!1)};A=new je.e(t.d);Object(Ie.n)(A);var u=new U.e;u.resolveItems({items:(n={},n[Be.e.serialize(O)]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},Be.e.pack(O)),q.wt.pack(o)),q.v.pack(A)),q.St.pack(!1)),n)});if(h){M=d.e.serialize(Object(i.__assign)(Object(i.__assign)({},h),{filterParams:void 0,sortFieldKey:void 0,sortAscending:void 0,groupByFieldKey:void 0,viewKey:O}));u.resolveItems({items:(r={},r[M]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},m?ee.e.pack(m):{}),g?ee.s.pack(g):{}),y?ee.o.pack(y):{}),r)})}l&&u.resolveItems({items:(s={},s[l]=Object(i.__assign)({},Be.e.pack(O)),s)});return e(u.execute())}).then(function(){var n,r;if(u.scope||_||P){var s={};u.scope&&(s.scope=u.scope);e(Object(Re.e)({enableModernColumnTotalsSettings:q.q})).enableModernColumnTotalsSettings&&_&&(s.aggregations=_);P&&(s.customFormatter=P);return e(Object(L.e)({items:(n={},n[t]={views:(r={},r[A.id]=Object(i.__assign)({},s),r)},n)}))}}).then(function(){var n,r;return e(Object(ke.e)({items:Object(i.__assign)((n={},n[t]=[ee.e],n),_?(r={},r[Be.e.serialize(O)]=[q.Nt],r):{})}))})]}return[2]})})}}),Xe=Object(s.i)({mergeForSameItemKey:!1,maxParallelOperationCount:4})(function(e){var t=e.itemKey,n=e.options.views;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,s,o,u,a,f,l,c,h,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O;return Object(i.__generator)(this,function(M){r=p.e.deserialize(t);s=Object.keys(n)[0];o=n[s],u=o.isPublic,a=o.viewType,f=o.viewFields,l=o.viewStyles,c=o.viewData,h=o.queryXml,v=o.rowLimit,m=o.itemSetKey,g=o.progressItemKey;if(r){y=e(Object(ue.e)({deserializedItemSetKey:d.e,childItems:ee.e,parentItem:ee.s,schema:ee.o},m)),b=y.deserializedItemSetKey,w=y.childItems,E=y.parentItem;S=a&&je.e.getViewTypeInfo(a);x=S?S.viewTypeKind:void 0;T=S?S.viewType2:void 0;N=Object(J.e)({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl});C=N.segment("Views").segment("Add");return[2,e(Object(R.t)({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl,url:C.toString(),method:"POST",body:JSON.stringify({parameters:Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({__metadata:{type:"SP.ViewCreationInformation"},Title:s,ViewFields:{__metadata:{type:"Collection(Edm.String)"},results:f}},x?{ViewTypeKind:x}:{}),T?{ViewType2:T}:{}),{ViewData:c,CalendarViewStyles:l,Query:h,Paged:!0,PersonalView:!u,RowLimit:v})}),qosName:"CreateFreshView",noRedirect:!0})).then(function(t){var n,r,s;if(!t||!t.d)throw new Error("No view returned by /Views/Add");var o=t.d;L=be.e.normalizeLower(o.Id,!1);A={viewId:L};k=new je.e(o);Object(Ie.n)(k);var u=new U.e;u.resolveItems({items:(n={},n[Be.e.serialize(A)]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},Be.e.pack(A)),q.wt.pack(o)),q.v.pack(k)),q.St.pack(!1)),n)});if(b){O=d.e.serialize(Object(i.__assign)(Object(i.__assign)({},b),{filterParams:void 0,sortFieldKey:void 0,sortAscending:void 0,groupByFieldKey:void 0,viewKey:A}));u.resolveItems({items:(r={},r[O]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},w?ee.e.pack(w):{}),E?ee.s.pack(E):{}),ee.o.pack({columnKeys:[]})),r)})}g&&u.resolveItems({items:(s={},s[g]=Object(i.__assign)({},Be.e.pack(A)),s)});return e(u.execute())}).then(function(){var n;return e(Object(ke.e)({items:(n={},n[t]=[ee.e],n)}))})]}return[2]})})}}),Ve=n(379),$e=Object(s.i)({mergeForSameItemKey:!1,maxParallelOperationCount:4})(function(e){var t=e.itemKey,n=e.options.views;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,s,o,u,a,f,l,c,h,d,v;return Object(i.__generator)(this,function(i){r=p.e.deserialize(t);s=Object.keys(n)[0];o=n[s],u=o.viewXml,a=o.viewTitle;if(r){f=r.webAbsoluteUrl,l=r.listFullUrl;c=Object(J.e)({webAbsoluteUrl:f,listFullUrl:l});h=c.method("Views",s);d=e(Object(X.e)(function(e){return f&&l?e.demandItemFacet(q.Qt,Ve.e.serialize({webAbsoluteUrl:f,listFullUrl:l})):void 0}));v=!!d&&!Object(Ue.t)(d).isActivated("D554A99B-07B1-4652-8A7E-940F6CD0EE85","01/08/2021","Enable updating View Title in Edit view dialog");return[2,e(Object(R.t)({webAbsoluteUrl:f,listFullUrl:l,url:h.method("SetViewXml").toString(),method:"POST",body:JSON.stringify({viewXml:u}),qosName:"saveViewXML"})).then(function(){v&&a&&e(Object(R.t)({webAbsoluteUrl:f,listFullUrl:l,url:h.toString(),method:"MERGE",body:JSON.stringify({__metadata:{type:"SP.View"},Title:a}),qosName:"updateViewTitle"}))})]}return[2]})})}}),Je=Object(s.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options.views,r=p.e.deserialize(t),s=Object.keys(n)[0];return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var o,u,a;return Object(i.__generator)(this,function(f){if(r&&s){o=n[s];u=Object(J.e)({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl}).method("Views",s);a={__metadata:{type:"SP.View"},DefaultView:o.isDefault,Title:o.title};"number"==typeof o.scope&&(a.Scope=o.scope);if(o.aggregations){a.Aggregations=o.aggregations;a.AggregationsStatus="On"}o.customFormatter&&(a.CustomFormatter="<![CDATA["+o.customFormatter+"]]>");return[2,e(Object(R.t)({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl,url:u.toString(),method:"POST",body:JSON.stringify(a),additionalHeaders:{"X-HTTP-Method":"PATCH"},qosName:"modifyView"})).then(function(){var n,r,u=e(Object(ue.e)({childItems:ee.e},t)).childItems;if(u){for(var a=new U.e,f=Be.e.serialize({viewId:s}),l=void 0,c=void 0,h=void 0,p=0,d=u.itemKeys;p<d.length;p++){var v=d[p],m=e(Object(ue.e)({view:q.v},v)).view;if(m){if(m.isDefault){l=m;c=v}v===f&&(h=m)}}if("boolean"==typeof o.isDefault){if(o.isDefault&&l&&c){l.isDefault=!1;a.resolveItems({items:(n={},n[c]=Object(i.__assign)({},q.v.pack(l)),n)})}if(h&&f){h.isDefault=o.isDefault;a.resolveItems({items:(r={},r[f]=Object(i.__assign)({},q.v.pack(h)),r)})}}return e(a.execute())}})]}return[2]})})}}),Ke=n(1061),Qe=n(266),Ge={key:Ke.e,displayName:fe.l,email:Qe.e,picture:Qe.t},Ye=Object(s.i)()(function(e){var t=this,n=e.itemKey,r=m.e.deserialize(n),s=r&&r.spItem,o=s.webAbsoluteUrl,u=s.listFullUrl,a=s.itemId;return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,r,s,f,l,c,h;return Object(i.__generator)(this,function(p){switch(p.label){case 0:t=a&&Object(J.e)({webAbsoluteUrl:o,listFullUrl:u}).method("GetItemById",a).segment("likedByInformation");r=new U.e;return(f=t)?[4,e(Object(R.r)({url:t.toString()+"&$expand=likedby&$top=10",method:"GET",qosName:"likedByInformation",webAbsoluteUrl:o,listFullUrl:u}))]:[3,2];case 1:f=p.sent();p.label=2;case 2:l=[];(c=(s=f)&&s.d&&s.d.likedBy&&s.d.likedBy.results)&&c.forEach(function(e){var t,n=e.email,i=Ke.e.serialize({id:String(n)});r.resolveItems({items:(t={},t[i]=Object(H.n)(Ge,{key:{id:String(n)},displayName:e.name,email:n,picture:n}),t)});l.push(i)});r.resolveItems({items:(h={},h[n]=Object(i.__assign)({},fe.x.pack({personKeys:l})),h)});e(r.execute());return[2]}})})}});var Ze=n(2758),et={ODB:60069},tt=Object(s.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options,r=n.views,s=n.qosName;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var n,o,u,a,f,l,c,h,v,m,g,y,b,w,E,S,x,T,N;return Object(i.__generator)(this,function(i){switch(i.label){case 0:n=p.e.deserialize(t);o=Object.keys(r)[0];if(!n||!o)return[3,4];u=r[o],a=u.itemSetKey,f=u.shouldSaveViewFieldsOnly,l=u.newDocumentTemplatesJsonString,c=u.shouldSaveAggregationsOnly;h=e(Object(ue.e)({deserializedViewKey:Be.e,currentDerivedView:q.v},o)),v=h.deserializedViewKey,m=h.currentDerivedView;g=v&&v.viewId;if(!m||!g)return[3,4];y=void 0;return f||l||c?[4,e(Object(Ze.e)({webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:n.listFullUrl,viewId:g}))]:[3,2];case 1:if((b=i.sent())&&b.view){y=b.view;f?y.replaceFields(m.getEffectiveFieldNames()):l?y.updateNewDocumentTemplates(l):c&&y.replaceAggregates(m.getEffectiveAggregatesData())}return[3,3];case 2:w=e(Object(ue.e)({deserializedItemSetKey:d.e,filterableSet:q.Ht},a)),E=w.deserializedItemSetKey,S=w.filterableSet;if(E){y=qe({sourceView:m,deserializedItemSetKey:E,appliedFilters:S&&S.appliedFilters});(x=e(Object(ue.e)({viewType:q.pn},o)).viewType)&&y.updateViewType(x)}i.label=3;case 3:if(y){y.prepareForSaving();T=!1;e(Object(X.e)(function(e){var t=Object(ze.e)(e,a);if(Object(ne.e)(e,{feature:et,pageContext:t})){var n=d.e.matches(a)&&d.e.deserialize(a);n&&(n.filterParams||n.sortFieldKey||n.groupByFieldKey)&&m&&(T=!!m.customOrder)}}));T&&y.updateCustomOrder("");if(m.isDirty()||y.isDirty()){N=Object(J.e)({webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:n.listFullUrl}).method("Views",g).method("SetViewXml");return[2,e(Object(R.t)({webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:n.listFullUrl,url:N.toString(),method:"POST",body:JSON.stringify({viewXml:y.getEffectiveViewXml()}),qosName:s||"saveView"}))]}}i.label=4;case 4:return[2]}})})}}),nt=n(89),rt=Object(s.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options.columnModifyTypeMap;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,s,o,u,a,f,l,c,h,v,m,g,y,b,w,S,x,T,N,C,k,L;return Object(i.__generator)(this,function(O){switch(O.label){case 0:if(!(r=e(Object(ue.e)({setKey:d.e},t)).setKey))return[3,3];s=Object.keys(n)[0];o=n[s],u=o.modifyType,a=o.targetIndex;if(!(f=r.viewKey?Be.e.serialize(r.viewKey):void 0))return[3,3];if(!(l=e(Object(ue.e)({currentDerivedView:q.v},f)).currentDerivedView))return[3,3];c=l.getEffectiveFieldNames();if(!(h=e(Object(ue.e)({internalName:q.Ee},s)).internalName))return[3,3];if((v=c.indexOf(h))<0||1===u&&0===v||2===u&&v===c.length-1)return[2];m=l.isDirty();switch(u){case 0:l.updateField(h);break;case 1:l.updateField(h,v-1);break;case 2:l.updateField(h,v+1);break;case 3:l.updateField(h,a)}g={ODB:1318};y=e(Object(X.e)(function(e){return e.demandItemFacet(q.Qt,Ve.e.serialize({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl}))}));b=e(Object(X.e)(function(e){return{isAutoSaveEnabled:Object(ne.e)(e,{feature:g,pageContext:y}),list:e.demandItemFacet(q.Be,E.e.serialize({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl}))}})),w=b.isAutoSaveEnabled,S=b.list;x=!1;return w&&S&&S.permissions&&S.permissions.manageLists?[4,e(Object(A.e)({items:(N={},N[p.e.serialize({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl})]={views:(C={},C[f]={shouldSaveViewFieldsOnly:!0},C),qosName:"autoSaveModifyColumn"},N)})).then(function(){m||(l.baseViewXml=l.getEffectiveViewXml());x=!0},function(e){nt.e.logError(e,{eventName:"ModifyColumn",feature:"ColumnFieldsAutoSave",columnFieldName:h,modifyType:u,errorCode:e.errorData.code,correlationId:e.errorData.correlationId,status:e.errorData.status});throw e})]:[3,2];case 1:O.sent();O.label=2;case 2:T=new U.e;w&&x||T.resolveItems({items:(k={},k[f]=Object(i.__assign)({},q.St.pack(!0)),k)});T.invalidateItems({items:(L={},L[t]=[ee.e],L[f]=[q.v],L)});e(T.execute());O.label=3;case 3:return[2]}})})}}),it=Object(s.i)({mergeForSameItemKey:!1})(function(e){var t=e.options.columnFormatterMap;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var n,r,s,o,u;return Object(i.__generator)(this,function(a){n=Object.keys(t)[0];r=t[n],s=r.updateType,o=r.formatter;return 0===s?[2,e(Object(Y.e)({items:(u={},u[n]=Object(i.__assign)({},q.m.pack(o)),u)}))]:[2]})})}}),st=n(3087),ot=n(2969),ut=n(1976),at=n(71),ft=Object(s.i)({mergeForSameItemKey:!1,maxParallelOperationCount:3,timeout:864e5})(function(e){var t=this,n=e.itemKey,r=e.options.sourceEntries,s=v.e.deserialize(n),o=s&&s.itemSetKey,u=o.webAbsoluteUrl,a=o.listFullUrl,f=o.rootFolder,l=c.e.serialize({webAbsoluteUrl:u,listFullUrl:a,rootFolder:f}),h=Object.keys(r)[0],p=r[h].progressItemKey;return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,s,o,u,a,f,c;return Object(i.__generator)(this,function(d){switch(d.label){case 0:t=e(Object(ue.e)({sourceFile:ut.t},h)).sourceFile;s=e(Object(Re.e)({listItemUploader:q.qe})).listItemUploader,o=void 0===s?ot.e:s;return[4,e(o({itemKey:l,options:{sourceEntries:r}}))];case 1:u=d.sent().itemKey;d.label=2;case 2:d.trys.push([2,4,,5]);return[4,e(Object(st.e)({items:(a={},a[u]={groupKey:n},a)}))];case 3:d.sent();return[3,5];case 4:d.sent();return[3,5];case 5:e(Object(ke.e)({items:(f={},f[l]=[ee.t],f)}));p&&t&&e(Object(Y.e)({items:(c={},c[p]=Object(i.__assign)(Object(i.__assign)({},at.s.pack({itemKey:u})),Object(H.n)({progressSize:at.m},{progressSize:{current:t.size}})),c)}));return[2]}})})}});var lt=n(1145),ct=Object(s.i)({maxParallelOperationCount:8})(function(e){var t=this,n=e.itemKey,r=p.e.deserialize(n),s=r.webAbsoluteUrl,o=r.listFullUrl;return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,u,a,f,l,c,h,d,v,m;return Object(i.__generator)(this,function(g){switch(g.label){case 0:t=[];u=new U.e;a=E.e.serialize({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl});f=e(Object(ue.e)({list:q.Be},a));l=e(Object(Re.e)({localeConfiguration:W.S})).localeConfiguration;return[4,e(Object(Ze.t)({webAbsoluteUrl:s,listFullUrl:o,listTemplate:f.list&&f.list.templateType,preferredLanguage:l&&l.language}))];case 1:c=g.sent();h={};d=void 0;c.filter(function(e){return!!e.view}).map(function(n){var r,a=n.serverView,f=n.view,l={viewId:f.id},c=Be.e.serialize(l);if(f.isDefault){d=c;var p=f.getDomParts().newDocumentTemplates;p&&p.textContent&&u.merge(Object(lt.e)({webAbsoluteUrl:s,listFullUrl:o,newDocumentTemplatesString:p.textContent}).itemResolver)}h[c]=f;Object(Ie.n)(f);var v=e(Object(X.e)(function(e){if(e.isItemFacetResolved(q.v,c))return e.demandItemFacet(q.v,c)})),m=!!v&&v.getEffectiveViewXml().replace(/ \/>/g,"/>")===f.getEffectiveViewXml().replace(/ \/>/g,"/>");u.resolveItems({items:(r={},r[c]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},Be.e.pack(l)),q.wt.pack(a)),m?{}:q.v.pack(f)),q.St.pack(!1)),q.pn.pack(f.viewType)),r)});t.push(c)});t.sort(function(e,t){return h[e].compareTo(h[t])});u.resolveItems({items:(v={},v[n]=Object(i.__assign)(Object(i.__assign)({},p.e.pack(r)),ee.e.pack({itemKeys:t})),v)});d&&u.resolveItems({items:(m={},m[a]=Object(i.__assign)({},q.b.pack({viewKey:d})),m)});e(u.execute());return[2]}})})}});var ht=n(1137),pt=n(691),dt=n(272),vt=n(2760),mt=n(222),gt=n(46),yt=n(2728),bt=n(29);var wt=n(863),Et=n(54),St=n(1140),xt="ClientSideExtension.ListViewCommandSet",Tt="ClientSideExtension.ListViewCommandSet.ContextMenu",Nt="ClientSideExtension.ListViewCommandSet.CommandBar";function Ct(e){var t=e.customActionSetKey,n=e.customActions,r=e.context,s=g.e.deserialize(t),o=s.webAbsoluteUrl,u=s.listFullUrl;return function(e){var s=new U.e,a=St.e.serialize({webAbsoluteUrl:o,listFullUrl:u}),f=e(Object(ue.e)({enableDebugClientSideExtensions:q.T},V.e)).enableDebugClientSideExtensions;f&&f.customActions&&(function(e,t){if(!t)return;var n=e.ContextMenu||[],r=e["Ribbon.Documents"]||[],s=e["Ribbon.List"]||[],o={"ClientSideExtension.ListViewCommandSet.ContextMenu":"ContextMenu:","ClientSideExtension.ListViewCommandSet.CommandBar":"CommandBar:"};try{var u=JSON.parse(t);if(u)for(var a=0,f=Object.keys(u);a<f.length;a++){var l=f[a];try{var c=u[l],h=c.location,p=c.properties,d={text:o[h],action:"",allowMultiSelect:!0,isEnabled:!0,clientSideComponentId:l,clientSideComponentProperties:"object"==typeof p?JSON.stringify(p):""},v=h===xt,m=h===Nt||v;(h===Tt||v)&&n.push(d);if(m){r.push(Object(i.__assign)({},d));s.push(Object(i.__assign)({},d))}}catch(e){console.log("Error processing query parameter for "+l)}}}catch(e){console.log("error in parsing query parameter for custom actions")}})(n,f.customActions);var l=kt({setKey:t,actions:n[r.isDocumentLibrary?"Ribbon.Documents":"Ribbon.List"]}).itemResolver,c=kt({setKey:a,actions:n.ContextMenu}).itemResolver;s.merge(c);s.merge(l);return s}}function kt(e){for(var t,n,r,s=e.setKey,o=e.actions,u=new U.e,a=[],f=0,l=0,c=o;l<c.length;l++){var h=c[l],p=[];if(Object(yt.e)(h))for(var d=0,v=0,m=h.children;v<m.length;v++){var g=m[v],y=g.id?g.id:g.text+f+"."+d,b=ht.e.serialize({actionId:y});Lt(g)||u.resolveItems({items:(t={},t[b]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},fe.l.pack(g.text)),fe.L.pack(g.action)),vt.e.pack(g.allowMultiSelect)),vt.n.pack(g.isEnabled||!1)),vt.t.pack(g.iconUrl)),t)});p.push(b);d++}if(Object(yt.e)(h)||!Lt(h)){var w=h.id?h.id:h.text+f.toString(),E=ht.e.serialize({actionId:w});u.resolveItems({items:(n={},n[E]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},fe.l.pack(h.text)),ee.e.pack({itemKeys:p})),fe.L.pack(Object(yt.e)(h)?"":h.action)),Object(yt.e)(h)?{}:vt.e.pack(h.allowMultiSelect)),Object(yt.e)(h)?{}:vt.n.pack(h.isEnabled||!1)),Object(yt.e)(h)?{}:vt.t.pack(h.iconUrl)),n)});a.push(E)}f++}var S=a.length>0?{itemKeys:a}:void 0;u.resolveItems({items:(r={},r[s]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},gt.s.pack(!0)),ee.e.pack(S)),q.mt.pack(o)),r)});return{itemResolver:u}}function Lt(e){return e&&(!!e.clientSideCommandAdapter||e.clientSideComponentId&&e.clientSideComponentId!==be.e.Empty)||!1}var At=Object(s.i)()(function(e){var t=e.itemKey,n=g.e.deserialize(t),r=n.webAbsoluteUrl,s=n.listFullUrl;return function(e){var n,o=e((function(e){var t=e.webAbsoluteUrl,n=e.listFullUrl;return function(e){var r=e(Object(ue.e)({pageContext:q.Qt},Ve.e.serialize({webAbsoluteUrl:t,listFullUrl:n}))),i=e(Object(ue.e)({list:q.Be},E.e.serialize({webAbsoluteUrl:t,listFullUrl:n})));return{currentUserIsSiteAdmin:r.pageContext&&r.pageContext.isSiteAdmin||!1,listTemplate:i.list&&i.list.templateType||bt.n.invalidType,listId:i.list&&i.list.id||"",isDocumentLibrary:i.list&&i.list.isDocumentLibrary||!1}}})({webAbsoluteUrl:r,listFullUrl:s}));if(o.listTemplate===bt.t.mySiteDocumentLibrary){var u=new U.e;u.resolveItems({items:(n={},n[t]=Object(i.__assign)({},ee.e.pack(void 0)),n)});e(u.execute());return Promise.resolve()}return e((function(e,t,n){var r=Object(J.e)({webAbsoluteUrl:e,listFullUrl:t}).segment("CustomActionElements");return function(i){return i(Object(R.r)({webAbsoluteUrl:e,listFullUrl:t,method:"POST",url:r.toString(),qosName:"getLegacyCustomActions",noRedirect:!0})).then(function(e){return Object(yt.t)(e.d.CustomActionElements.Items.results,n)})}})(r,s,o)).then(function(n){return e(Ct({customActionSetKey:t,customActions:n,context:o}))}).then(function(t){return e(t.execute())})}}),Ot=Object(s.i)()(function(e){var t=this,n=e.itemKey,r=y.e.deserialize(n),s=r.webAbsoluteUrl,o=r.listFullUrl,u=r.isSPFXandCustomActionsAvailable,a=r.targetCustomActionSetKey,f=r.itemsScopeItemKey;return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,r,l,c,h,p,d,m,g,y,b;return Object(i.__generator)(this,function(w){switch(w.label){case 0:t=new U.e;r=E.e.serialize({webAbsoluteUrl:s,listFullUrl:o});l=e(Object(X.e)(wt.e));c=function(){var n;t.resolveItems({items:(n={},n[r]=mt.o.pack(void 0),n)});e(t.execute())};if(!u&&!l){c();return[2]}return(p=l)?[4,l()]:[3,2];case 1:p=w.sent();w.label=2;case 2:d=!1;if(!(h=p))return[3,7];m=h.createListViewAdapter();t.resolveItems({items:(b={},b[r]=Object(i.__assign)({},m?mt.o.pack(m):{}),b)});g=e(Object(ue.e)({rawCustomActions:q.mt},a)).rawCustomActions;return[4,Mt({setKey:n,actions:g||[],listViewAdapter:m})];case 3:y=w.sent().itemResolver;t.merge(y);return[4,e(Object(z.e)(function(e){var n=Object(Et.e)(e,f);if(n&&m){var r=e.demandItemFacet(ee.e,n),u=r&&r.itemKeys,a=function(n){var r,s=e.isItemFacetResolved(q.bt,n)?e.demandItemFacet(q.bt,n):void 0;if(s&&m){var o=m.createRowAdapter({values:s});t.resolveItems({items:(r={},r[n]=Object(i.__assign)({},o?mt.u.pack(o):{}),r)})}else if(e.demandItemFacet(v.e,n)){var u=e.isItemFacetResolved(ee.e,n)?e.demandItemFacet(ee.e,n):void 0;if(u)for(var f=0,l=u.itemKeys;f<l.length;f++){var c=l[f];a(c)}}};if(u)for(var l=0,c=u;l<c.length;l++){var h=c[l];a(h)}var p=e.demandItemFacet(ee.o,n),g=p&&p.columnKeys||[];if(g&&m)for(var y=function(n){var r,i=e.demandItem({fieldId:q.ue,internalName:q.Ee,realFieldName:q.gt,fieldType:q.oe,isRequired:dt.r,displayName:fe.l,clientSideComponentId:mt.e,clientSideComponentProperties:mt.t},n),u=i.fieldId,a=i.internalName,f=i.realFieldName,l=i.fieldType,c=i.isRequired,h=i.displayName,p=i.clientSideComponentId,v=i.clientSideComponentProperties;if(u&&a){d=!0;var g={listKey:{webAbsoluteUrl:s,listFullUrl:o},internalName:a},y={id:u,internalName:f||a,fieldType:l||"Text",isRequired:c||!1,isVisible:!0,displayName:h||"",clientSideComponentId:p||be.e.Empty,clientSideComponentProperties:v||"",onSetVisible:function(e){return console.log("ISpfxAdapter.IColumn.onSetVisible not implemented")},onFieldCustomizerError:function(e){console.log("Fail to load customizer for column: "+a+",\n                      componentId: "+p+", error: "+e.message)}},b=m.addColumnAdapter(y);if(p&&p!==be.e.Empty){var w=pt.e.serialize(g);t.resolveItems({items:(r={},r[w]=mt.n.pack(b),r[n]=mt.r.pack(w),r)})}}},b=0,w=g;b<w.length;b++){y(w[b])}}}))];case 4:w.sent();return d?[4,m.loadFieldCustomizers()]:[3,6];case 5:w.sent();w.label=6;case 6:return[3,8];case 7:c();w.label=8;case 8:e(t.execute());return[2]}})})}});function Mt(e){return Object(i.__awaiter)(this,void 0,void 0,function(){var t,n,r,s,o,u,a,f,l,c,h;return Object(i.__generator)(this,function(p){switch(p.label){case 0:t=e.setKey,n=e.actions,r=e.listViewAdapter;s=new U.e;o=[];u=0;a=function(e){var t,n,a,f,l,c,h,p,d,v,m,g;return Object(i.__generator)(this,function(i){switch(i.label){case 0:t=[];if(!Object(yt.e)(e))return[3,5];n=e.children;a=0;f=0,l=n;i.label=1;case 1:if(!(f<l.length))return[3,5];c=l[f];h=c.id?c.id:c.text+u+"."+a;p=ht.e.serialize({actionId:h});return Dt(c)&&r?[4,_t({action:c,listViewAdapter:r})]:[3,3];case 2:d=i.sent(),g=d.actionKeys,m=d.itemResolver;s.merge(m);g.forEach(function(e){t.push(e)});i.label=3;case 3:t.push(p);a++;i.label=4;case 4:f++;return[3,1];case 5:return!Object(yt.e)(e)&&Dt(e)&&r?[4,_t({action:e,listViewAdapter:r})]:[3,7];case 6:v=i.sent(),m=v.itemResolver,g=v.actionKeys;s.merge(m);o=o.concat(g);i.label=7;case 7:u++;return[2]}})};f=0,l=n;p.label=1;case 1:if(!(f<l.length))return[3,4];c=l[f];return[5,a(c)];case 2:p.sent();p.label=3;case 3:f++;return[3,1];case 4:s.resolveItems({items:(h={},h[t]=Object(i.__assign)(Object(i.__assign)({},gt.s.pack(!0)),ee.e.pack(0===o.length?void 0:{itemKeys:o})),h)});return[2,{itemResolver:s}]}})})}function _t(e){return Object(i.__awaiter)(this,void 0,void 0,function(){var t,n,r,s,o,u,a;return Object(i.__generator)(this,function(f){switch(f.label){case 0:t=e.action,n=e.listViewAdapter;r=new U.e;s=[];o=t.clientSideComponentId&&t.clientSideComponentId.toString()||"";u=t.clientSideComponentProperties||"";return o&&o!==be.e.Empty?[4,n.loadCommandSet(o,u).catch(function(){})]:[2,{itemResolver:r,actionKeys:[]}];case 1:(a=f.sent())&&a.commandAdapters&&a.commandAdapters.forEach(function(e){var n,o=t.clientSideComponentId+"."+e.commandId,u=ht.e.serialize({actionId:o});r.resolveItems({items:(n={},n[u]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},fe.l.pack(e.title)),fe.L.pack(t.action)),vt.e.pack(t.allowMultiSelect)),vt.n.pack(t.isEnabled||!1)),vt.t.pack(e.iconUrl||t.iconUrl)),mt.i.pack(e)),n)});s.push(u)});return[2,{itemResolver:r,actionKeys:s}]}})})}function Dt(e){return e&&(!!e.clientSideCommandAdapter||e.clientSideComponentId&&e.clientSideComponentId!==be.e.Empty)||!1}var Pt=Object(s.i)({maxParallelOperationCount:4})(function(e){var t=this,n=e.itemKey,r=b.e.deserialize(n).webAbsoluteUrl;return function(n){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,s,o,u,a,f,l;return Object(i.__generator)(this,function(c){switch(c.label){case 0:t=Object(J.n)({webAbsoluteUrl:r}).segments("ComponentContextInfo");return[4,n(Object(R.t)({url:t.toString(),qosName:"GetWebPageContext",method:"GET",webAbsoluteUrl:r,noRedirect:!0}))];case 1:s=c.sent();o=JSON.parse(s.d.SerializedData);u=o.isSPO,a=void 0===u||u;(f=new U.e).resolveItems({items:(l={},l[e.itemKey]=Object(i.__assign)(Object(i.__assign)({},q.nt.pack(a?void 0:{})),q.Qt.pack(o)),l)});n(f.execute());return[2]}})})}});var Ht=n(161),Bt=n(183),jt=n(2547),Ft=n(1978),It=Object(s.n)()(function(e){var t=e.items,n=Object.keys(t),r=t[n[0]].groupKey;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var t,s,o,u,a,f,l,c,h,p,m,g,y,b,w,E,S,x,T,N;return Object(i.__generator)(this,function(i){switch(i.label){case 0:t=e(Object(X.e)(function(e){return e.demandItemFacet(v.e,r)}));if(!(s=t&&t.itemSetKey&&d.e.serialize(t.itemSetKey))||n.length<1||!r)return[2];o=e(Object(ue.e)({spGroupField:q.qt,groupValue:q.be,parentGroupKey:q.it,defaultCollapsed:gt.t},r)),u=o.spGroupField,a=o.groupValue,f=o.parentGroupKey,l=o.defaultCollapsed;c=[];u&&u.internalName&&a&&c.push({FieldName:u.internalName,FieldValue:a});if(f&&f.itemKey){h=e(Object(ue.e)({parentGroupField:q.qt,parentGroupValue:q.be},f.itemKey)),p=h.parentGroupField,m=h.parentGroupValue;p&&p.internalName&&m&&c.push({FieldName:p.internalName,FieldValue:m})}if(t&&t.itemSetKey&&t.itemSetKey.filterParams&&(g=Bt.default.getFilterList(t.itemSetKey.filterParams,void 0,!0)).length>0)for(y=0;y<g.length;y++){b=g[y];w=e(Object(ue.e)({isReadOnly:q.ke},Ht.e.serialize({listKey:t.itemSetKey,internalName:b.fieldName}))).isReadOnly;1===b.values.length&&!1===w&&c.push({FieldName:b.fieldName,FieldValue:b.values[0]})}return[4,e(Object(jt.e)({items:(S={},S[s]={itemKeys:n,formValues:c,qosName:"AssignItemsToGroup"},S)}))];case 1:i.sent();E={};n.forEach(function(e){E[e]={}});return[4,e(Object(Ft.e)({items:(x={},x[s]=E,x)}))];case 2:i.sent();e(l?Object(ke.e)({items:(T={},T[r]=[ee.e],T)}):Object(ke.e)({items:(N={},N[s]=[ee.e],N)}));return[2]}})})}}),qt=n(3455),Rt=n(10),Ut=n(2982),zt=Object(Rt.t)()(function(){return function(e){return Wt}});function Wt(e,t){var n=t.itemKey,r=e.demandItem({driveItem:c.e,canonicalLinkUrl:fe.i},n),s=r.driveItem,o=r.canonicalLinkUrl;return{isAvailable:!0,getShareLink:function(){return(function(e){var t=this;return function(n){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,r,s,o,u,a,f,l,c,h,p;return Object(i.__generator)(this,function(i){switch(i.label){case 0:t=e.driveItem,r=e.canonicalLinkUrl;if(t&&r)return[3,1];throw new Error("Unable to obtain default share URL");case 1:s=void 0;if(r){o=new Me.e(r);u=o.authority;for(a=0,f=o.segments;a<f.length;a++)""!==(l=f[a])&&(u=u+"/"+encodeURIComponent(l));c=Object(Ut.e)(u.toString());s="u!"+c.replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-")}h=new Me.e(t.webAbsoluteUrl).authority;return[4,n(Object(R.t)({webAbsoluteUrl:h,listFullUrl:void 0,url:h+"/_api/v2.0/shares/"+s+"/driveItem/invite",body:void 0,method:"POST",additionalHeaders:{prefer:"getDefaultLink","Content-type":"application/json",Accept:"application/json"},qosName:"getDefaultShareLink",noRedirect:!0}))];case 2:return[2,{url:(p=i.sent()).value[0].link.webUrl,scope:p.value[0].link.scope}]}})})}})({driveItem:s,canonicalLinkUrl:o})}}}var Xt=n(2366),Vt=n(23),$t=Object(s.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options,r=n.isNewDocumentUpdate,s=n.checkInComment,o=n.formValues;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var n,u,a,f,l;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return o.length>0?[4,e(Object(Le.e)(t))]:[3,3];case 1:n=i.sent(),u=n.key,a=n.itemId;f=(function(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,r=e.itemId;return Object(J.e)({webAbsoluteUrl:t,listFullUrl:n}).method("Items",r).method("ValidateUpdateListItem").toString()})({webAbsoluteUrl:u.webAbsoluteUrl,listFullUrl:u.listFullUrl,itemId:a||u.itemId||""});(l={}).formValues=o;l.bNewDocumentUpdate=r;l.checkInComment=s;return[4,e(Object(R.t)({body:JSON.stringify(l),listFullUrl:u.listFullUrl,method:"POST",qosName:"updateItem.ValidateUpdateListItem",url:f,webAbsoluteUrl:u.webAbsoluteUrl,noRedirect:!0})).then(function(e){var t=!1,n="";e.d.ValidateUpdateListItem.results.forEach(function(e){if(e.HasException){t=!0;n+=Vt.format("{0}: {1} ",e.FieldName,e.ErrorMessage)}});if(t)throw new Error(n||void 0)})];case 2:i.sent();i.label=3;case 3:return[2]}})})}});var Jt=n(304),Kt=n(951);var Qt=n(251),Gt=n(292),Yt=Object(s.i)()(function(e){var t=e.itemKey;return function(n){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,s,o,u,a,f;return Object(i.__generator)(this,function(l){switch(l.label){case 0:r=d.e.deserialize(t);s=n(Object(ce.n)({itemSetKey:r}));o=Object.keys(e.options);return[4,n((h={itemSetKey:t,itemKeys:o},function(e){for(var t=h.itemSetKey,n=h.itemKeys,r=e(Object(X.e)(function(e){var n=e.demandItemFacet(d.e,t)||d.e.deserialize(t);return Object(i.__assign)(Object(i.__assign)({},n),{pageContext:Object(ze.e)(e,c.e.serialize(n))})})),s=r.webAbsoluteUrl,o=r.listFullUrl,u=r.pageContext,a=[],f=0,l=n;f<l.length;f++){var p=l[f],v=c.e.deserialize(p).itemId;v||(v=e(Object(ue.e)({listItemId:q.Ie},p)).listItemId);v&&a.push(v)}var m=e(Object(Kt.e)({internalName:q.Ee},t)),g=["Modified"];if(m)for(var y=0,b=m;y<b.length;y++){var w=b[y];w.internalName&&"Modified"!==w.internalName&&g.push(w.internalName)}return{webAbsoluteUrl:s,listFullUrl:o,currentPageContext:u,qosName:"refreshItemsInSet",viewXml:Object(Jt.r)({itemIds:a,recurseInFolders:!0,pageSize:n.length,fieldNames:g.length>0?g:void 0}),postDataContext:{needsSchema:!0}}}))];case 1:u=l.sent();return[4,n(Object(pe.e)({getItemContext:u}))];case 2:a=l.sent();f=n(Object(Qt.t)({serverData:a,itemSetKey:r,currentPageContext:u.currentPageContext,contentTypes:s,isItemSetRequest:!0})).itemResolver;n(f.execute());n(Object(Gt.e)({itemSetKey:t,serverData:a,isItemSetRequest:!0}));return[2]}var h})})}}),Zt=n(3456),en=Object(Rt.t)()(function(){return function(e){return tn}});function tn(e,t){var n=t.itemKey,r=t.link,s=t.recipients,o=e.demandItem({driveItem:c.e},n).driveItem;return{isAvailable:!0,permissionInvite:function(){return(function(e){var t=this;return function(n){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,r,s,o,u,a,f,l,c,h;return Object(i.__generator)(this,function(i){switch(i.label){case 0:t=e.driveItem,r=e.link,s=e.recipients;if(!t)return[3,2];void 0;u=Object(Ut.e)(r);o="u!"+u.replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-");a=s.map(function(e){return{email:e}});f={recipients:a,roles:["read"]};l=new Me.e(t.webAbsoluteUrl).authority;return[4,n(Object(R.t)({webAbsoluteUrl:l,listFullUrl:void 0,url:l+"/_api/v2.0/shares/"+o+"/permission/invite",body:JSON.stringify(f),method:"POST",additionalHeaders:{"Content-type":"application/json",Accept:"application/json"},qosName:"permissionInvite",noRedirect:!0}))];case 1:c=i.sent();h=c.value[0].grantedToIdentities.map(function(e){return{email:e.user.email}});return[2,{recipients:h}];case 2:throw new Error("Unable to set permissions on the sharing URL")}})})}})({driveItem:o,link:r,recipients:s})}}}var nn=n(2448),rn=Object(Rt.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,r=e.demandItemFacet(c.e,n);if(!r)return{};var i={webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl},s=e.demandItemFacet(q.Be,E.e.serialize(i)),o=e.demandItemFacet(q.Qt,Ve.e.serialize(i));if(!o)return{};var u=s&&s.templateType===bt.t.mySiteDocumentLibrary||!1;return{sharedPostData:{cultureName:o.currentUICultureName||o.currentCultureName||"en-US",client:u?"OneDrive":"SharePoint",domainHint:"organizations",userId:o.userLoginName}}}}});var sn=n(2981),on=n(77),un=n(799),an=n(360),fn=Object(Rt.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,r=void 0,i=e.demandItem({key:c.e,driveItemKey:on.e},n),s=i.key,o=i.driveItemKey;if(o)return{driveItemFullUrl:Object(un.t)(o)};if(s){var u={webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl},a=e.demandItem({listMediaFacets:an.t},E.e.serialize(u)).listMediaFacets;if(a&&a[".driveUrl"]){var f=a[".driveUrl"],l=s.rootFolder||"",h="";if(l){var p=new _e.t({context:{webAbsoluteUrl:s.webAbsoluteUrl,listUrl:s.listFullUrl}}).getUrlParts();p.serverRelativeListUrl&&"/"!==(h=l.replace(p.serverRelativeListUrl,"")).charAt(0)&&(h="/"+h)}return{driveItemFullUrl:r=f+"/items/root"+(h?":":"")+h}}}return{driveItemFullUrl:r}}}});var ln=n(467),cn=Object(s.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options,r=n.aggregateType,s=n.columnKey;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var n,o,u,a,f,l,c,h,v,m,g,y,b;return Object(i.__generator)(this,function(i){switch(i.label){case 0:if(!(n=e(Object(ue.e)({setKey:d.e},t)).setKey))return[3,2];if(!(o=n.viewKey?Be.e.serialize(n.viewKey):void 0))return[3,2];if(!(u=e(Object(ue.e)({currentDerivedView:q.v},o)).currentDerivedView))return[3,2];a=e(Object(ue.e)({internalName:q.Ee,fieldType:q.ae,fieldFieldType:q.oe},s)),f=a.internalName,l=a.fieldType,c=a.fieldFieldType;if(!f)return[3,2];h=e(Object(ue.e)({spFolderAggregates:q.l},t)).spFolderAggregates;v=u.isDirty();if(!(m=h&&h[s]?h[s].aggregateFunctionType:void 0)&&0===r||m===ln.e[r])return[2];g=0===r?void 0:ln.e[r];u.updateColumnAggregateType(f,g);return[4,e(Object(A.e)({items:(y={},y[p.e.serialize({webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:n.listFullUrl})]={views:(b={},b[o]={shouldSaveAggregationsOnly:!0},b),qosName:"SaveModifyColumnAggregateType"},y)})).then(function(){var n,r=u.getEffectiveViewXml(),i=new je.e(u.baseViewXml||"");i.replaceAggregates(u.getEffectiveAggregatesData());u.baseViewXml=i.getEffectiveViewXml();u.setDom(r);u.setIsDirty(v);var s=new U.e;s.invalidateItems({items:(n={},n[t]=[ee.e],n[o]=[q.Nt],n)});e(s.execute())},function(e){nt.e.logError(e.errorData,{eventName:"ModifyColumnAggregateType",feature:"ModernColumnTotalsSettings",fieldType:l,fieldFieldType:c,currentAggregateType:m||"None",newAggregateType:g||"None",errorCode:e.errorData.code,correlationId:e.errorData.correlationId,status:e.errorData.status});u.updateColumnAggregateType(f,m);u.setIsDirty(v);throw e})];case 1:i.sent();i.label=2;case 2:return[2]}})})}}),hn=n(3127),pn=Object(s.i)()(function(e){var t=e.itemKey,n=e.options,r=n.itemKeys,s=n.bNewDocumentUpdate,o=n.checkInComment,u=n.formValues,a=n.qosName;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var n,f,l,c,h,p,v,m,g,y,b,w,E,S,x;return Object(i.__generator)(this,function(i){switch(i.label){case 0:if(!(u&&u.length&&r&&r.length))return[2];n=d.e.deserialize(t),f=n.viewKey,l=n.rootFolder,c=n.webAbsoluteUrl,h=n.listFullUrl;p=l||"";f&&(!(v=e(Object(ue.e)({currentDerivedView:q.v},Be.e.serialize(f))).currentDerivedView)||1!==v.scope&&2!==v.scope||(p=""));m=[];g={};y=0,b=r;i.label=1;case 1:if(!(y<b.length))return[3,4];w=b[y];return[4,e(Object(Le.e)(w))];case 2:E=i.sent().itemId;m.push(parseInt(E,10));g[E]=w;i.label=3;case 3:y++;return[3,1];case 4:S=Object(J.e)({webAbsoluteUrl:c,listFullUrl:h}).method("BulkValidateUpdateListItems").toString();x={itemIds:m,formValues:u,folderPath:p,bNewDocumentUpdate:s,checkInComment:o};return[4,e(Object(R.t)({body:JSON.stringify(x),listFullUrl:h,method:"POST",qosName:a,url:S,webAbsoluteUrl:c,noRedirect:!0})).then(function(n){for(var r,i="",s={},o=0,u=n.d.BulkValidateUpdateListItems.results;o<u.length;o++){var a=u[o];if(a.HasException)i=a.ErrorMessage+"\n"+i;else{g[a.ItemId]&&(s[g[a.ItemId]]={})}}Object.keys(s).length>0&&e(Object(Ft.e)({items:(r={},r[t]=s,r)}));if(i)throw new Error(i)})];case 5:i.sent();return[2]}})})}}),dn=n(1364),vn=n(1365),mn=n(1366),gn=n(1162),yn=n(2983),bn=n(465),wn=n(422),En=n(217),Sn=n(441),xn=Object(s.n)()(Nn),Tn=Object(s.n)()(Nn);function Nn(e){var t=this,n=e.items,r=n[Object.keys(n)[0]].itemSetKey;return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,s,o,u,a,f,l,c,h,p,d,v,m;return Object(i.__generator)(this,function(i){switch(i.label){case 0:t=[];return[4,e(Cn({itemSetKey:r}))];case 1:o=i.sent();u=function(n){var r=e(Object(X.e)(function(e){return e.demandItemFacet(fe.i,n)}))||"",i={DecodedUrl:decodeURIComponent(r)};i&&t.push(i)};for(a=0,f=Object.keys(n);a<f.length;a++){l=f[a];u(l)}s=JSON.stringify({itemPaths:t});c="RemoveItemsFromSharedWithMeViewByPath";h=Object(J.n)({webAbsoluteUrl:o}).segment("SP.Sharing.DocumentSharingManager."+c);return[4,e(Object(R.t)({url:h.toString(),qosName:"RemoveFromSharedList",method:"POST",webAbsoluteUrl:o,body:s,noRedirect:!0}))];case 2:if((p=i.sent())&&p.d&&p.d[c]&&p.d[c].results){if((d=p.d[c].results).length<1)throw new ge.e({message:bn.e.DefaultTitle});d.forEach(function(e){if(!e.Success&&-3!==e.ErrorCode)throw new ge.e({message:e.ErrorMessage||void 0})})}(v=new U.e).invalidateItems({items:(m={},m[r]=[ee.e],m)});e(v.execute());return[2]}})})}}function Cn(e){var t=this,n=e.itemSetKey;return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,r,s;return Object(i.__generator)(this,function(i){switch(i.label){case 0:"";t=e(Object(X.e)(function(e){return e.demandItemFacet(En.e,n)}));r=t&&t.driveItemKey.endpoint||"";return[4,e(Object(z.e)(function(e){return e.demandItemFacet(c.e,wn.e.serialize({tenantRootUrl:new Sn.e(r).authority}))}))];case 1:s=i.sent();return[2,s&&s.webAbsoluteUrl||""]}})})}}var kn=n(3865),Ln=n(3694),An=Object(s.i)()(function(e){var t=e.itemKey,n=e.options,r=n.itemKeys,s=n.relativeItemKey,o=n.insertAfter,u=void 0!==o&&o,a=[];r.forEach(function(e){if(c.e.matches(e)){var t=c.e.deserialize(e).itemId;void 0===t||isNaN(Number(t))||a.push(Number(t))}});var f=d.e.deserialize(t),l=f.webAbsoluteUrl,h=f.listFullUrl,p=f.viewKey,v=!!p&&p.viewId,m=void 0;if(s&&c.e.matches(s)){var g=c.e.deserialize(s);g&&(m=g.itemId&&!isNaN(Number(g.itemId))?Number(g.itemId):void 0)}var y=p&&Be.e.serialize(p);if(!v||a.length<1||!s||!m||!y)throw new Error("Invalid parameters to reorderListItemsOperationHandler");var b=Object(J.e)({webAbsoluteUrl:l,listFullUrl:h}).method("AddCustomOrderToView").toString();return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var n,r,s,o,f,c,p,d;return Object(i.__generator)(this,function(g){switch(g.label){case 0:n={viewId:v,itemIds:a,relativeItemId:m,insertAfter:u};r=e(Object(ue.e)({currentDerivedView:q.v},y)).currentDerivedView;return[4,e(Object(R.t)({webAbsoluteUrl:l,listFullUrl:h,url:b,body:JSON.stringify(n),method:"POST",qosName:"ReorderListItems",noRedirect:!0}))];case 1:if(s=g.sent()){o=s.d&&s.d.AddCustomOrderToView||"";f=!r;if(r){r.updateCustomOrder(o);e(Object(Y.e)({items:(c={},c[y]=Object(i.__assign)({},q.v.pack(r)),c)}))}e(Object(ke.e)({items:Object(i.__assign)((p={},p[t]=[ee.e],p),f?(d={},d[y]=[q.wt,q.v],d):{})}))}return[2]}})})}}),On=n(3457),Mn=n(98),_n=new H.e("addContentTypesToList");new Mn.e("addContentTypesToList");n.d(t,"spDataOnlyAddonDeferred",function(){return Dn});n.d(t,"spItemUploadItemsOperationHandler",function(){return dn.spItemUploadItemsOperationHandler});n.d(t,"spItemCreateFolderOperationHandler",function(){return vn.spItemCreateFolderOperationHandler});n.d(t,"spItemCreateDocumentOperationHandler",function(){return mn.spItemCreateDocumentOperationHandler});n.d(t,"getSPFilterOptionSetHandler",function(){return me.getSPFilterOptionSetHandler});var Dn=Object(s.t)(function(){return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(t){e(Object(o.s)(l.e,a.e)(de));e(Object(o.s)(c.e,x.t)(Ee));e(Object(o.s)(c.e,T.t)(Ce));e(Object(o.s)(c.e,N.t)(Ae));e(Object(o.s)(c.e,C.t)(Oe));e(kn.sharePointBasicActionsAddonDeferred);e(Object(o.s)(c.e,f.t)(De));e(Object(o.s)(h.e,S.e)(He.n));e(Object(o.s)(c.e,k.e)(It));e(Object(o.s)(p.e,O.t)(We));e(Object(o.s)(p.e,M.t)(Xe));e(Object(o.s)(p.e,_.t)($e));e(Object(o.s)(p.e,L.t)(Je));e(Object(o.s)(p.e,A.t)(tt));e(Object(o.s)(d.e,P.t)(rt));e(Object(o.s)(d.e,hn.t)(cn));e(Object(o.s)(d.e,B)(it));e(Object(o.s)(d.e,Ft.t)(Yt));e(Object(o.s)(d.e,jt.t)(pn));e(Object(o.s)(v.e,u.t)(ft));e(Object(o.s)(m.e,a.e)(Ye));e(Object(o.s)(p.e,a.e)(ct));e(Object(o.s)(g.e,a.e)(At));e(Object(o.s)(y.e,a.e)(Ot));e(Object(o.s)(b.e,a.e)(Pt));e(Object(o.s)(d.e,G.t)(se));e(Object(o.s)(d.e,oe)(le));e(Object(D.e)(c.e,nn.e)(rn));e(Object(D.e)(c.e,sn.e)(fn));e(Ln.sharePointBasicItemDataAddonDeferred);e(gn.e);e(j.e);e(F.e);e(Q);e(Object(D.e)(c.e,qt.e)(zt));e(Object(o.s)(c.e,Xt.e)($t));e(Object(D.e)(c.e,Zt.e)(en));e(Object(o.s)(c.e,yn.n)(xn));e(Object(o.s)(w.e,yn.n)(Tn));e(Object(o.s)(d.e,On.t)(An));e(Object(o.s)(E.e,_n)(Object(s.r)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e("39").then(n.bind(null,4022))];case 1:return[2,e.sent().spListAddContentTypesToListOperationHandler]}})})})));return[2]})})}})},,function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(11),s=n(115),o=n(384),u=n(77),a=n(1007),f=n(967),l=n(1004),c=n(959),h=n(587),p=n(846),d=n(845),v=n(448),m=n(568),g=n(824),y=n(799),b=n(1623),w=n(71),E=n(8),S=n(2331),x=n(159),T=Object(i.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options.folders,i=u.e.deserialize(t),s=i.endpoint,o=i.driveId,a=i.itemId,f=Object.keys(n)[0],l=n[f].progressItemKey,c=Object(y.n)(i);return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var n,h,p,d,v,m,g,T;return Object(r.__generator)(this,function(N){switch(N.label){case 0:n=Object(y.t)(i)+"/children";h={name:f,folder:{},"@microsoft.graph.conflictBehavior":"rename"};o&&a&&(h.parentReference={driveId:o,id:a});return[4,e(Object(b.n)({url:n,driveUrl:c,method:"POST",body:h,qosName:"createFolder",endpoint:s}))];case 1:p=N.sent();d=u.e.serialize({endpoint:s,driveId:o,itemId:p.id});v=new x.e;l&&v.resolveItems({items:(m={},m[l]=Object(r.__assign)({},w.s.pack({itemKey:d})),m)});v.invalidateItems({items:(g={},g[t]=[E.t],g)});v.resolveItems({items:(T={},T[d]=Object(r.__assign)({},Object(S.e)({driveItem:p,parentFolderItemKey:t,endpoint:s})),T)});e(v.execute());return[2]}})})}}),N=n(1198),C=n(6),k=Object(i.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=u.e.deserialize(t);return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var i,s;return Object(r.__generator)(this,function(r){switch(r.label){case 0:i=Object(y.t)(n);return[4,e(Object(b.n)({url:i,method:"DELETE",qosName:"deleteItem",endpoint:n.endpoint}))];case 1:r.sent();e(Object(N.e)({items:(s={},s[t]=[C.f],s)}));return[2]}})})}}),L=n(324),A=n(233),O=n(111),M=n(1528),_=Object(i.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options.names,i=u.e.deserialize(t);return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var s,o,u,a,f,l,c,h;return Object(r.__generator)(this,function(p){switch(p.label){case 0:s=Object.keys(n)[0];o=n[s],u=o.newName,a=o.newExtension;f=Object(y.t)(i);l=Object(y.n)(i);c=e(Object(O.e)({fileName:C.h},t)).fileName;h="string"==typeof a?a:c&&c.extension||"";return[4,e(Object(b.n)({url:f,driveUrl:l,method:"PATCH",body:{name:""+u+h},qosName:"renameItem",endpoint:i.endpoint})).then(function(n){var i,s,o=new x.e;o.invalidateItems({items:(i={},i[t]=[C.l],i)});o.resolveItems({items:(s={},s[t]=Object(r.__assign)(Object(r.__assign)({},C.l.pack(n.name)),C.h.pack(Object(S.t)(n.name||"",!!n.folder))),s)});e(o.execute())}).catch(function(e){if(e instanceof M.e&&e.status===L.t)throw new L.e({facets:Object(r.__assign)({},A.m.pack({})),innerError:e});throw e})];case 1:p.sent();return[2]}})})}}),D=n(3148),P=n(3146),H=n(3735),B=n(3147),j=n(3145),F=n(1847),I=n(203),q=n(167),R=n(116),U=n(1976),z=n(158),W=n(2),X=n(94),V=n(131),$=Object(q.e)(function(){return new H.e({},{})}),J=Object(q.e)(function(e){var t=e(b.e).dataRequestor,n=(function(e){Object(r.__extends)(t,e);function t(t){return e.call(this,t,{performanceNow:j.t})||this}return t})(j.e),i=new P.e({},{dataRequestor:t}),s=new B.e({},{activityBandwidthVerifierType:n,uploadService:i});return new D.e({},{uploadService:i,uploadStateMachine:s})}),K=0;function Q(e){var t=this,n=e.itemKey,i=e.options.sourceEntries,s=u.e.deserialize(n),o=s.endpoint,a=s.driveId,f=Object.keys(i)[0],l=i[f],c=l.progressItemKey,h=l.conflictResolution,p=void 0===h?"fail":h;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,l,h,d,v,m,g,b,T;return Object(r.__generator)(this,function(N){switch(N.label){case 0:if(!(t=e(Object(O.e)({sourceFile:U.t},f)).sourceFile))throw new Error("No source file for Graph upload.");i=Object(y.t)(s)+":";l=Object(y.n)(s);c&&e(Object(z.e)({items:(m={},m[c]=Object(r.__assign)({},w.m.pack({total:t.size,current:0})),m)}));return[4,e(G({progressItemKey:c,sourceFile:t,itemUrl:i,driveUrl:l,conflictResolution:p,endpoint:o}))];case 1:h=N.sent();d=u.e.serialize({endpoint:o,driveId:a,itemId:h.id});v=new x.e;c&&v.resolveItems({items:(g={},g[c]=Object(r.__assign)(Object(r.__assign)({},w.s.pack({itemKey:d})),Object(W.n)({progressSize:w.m},{progressSize:{current:t.size}})),g)});v.invalidateItems({items:(b={},b[n]=[E.t],b)});v.resolveItems({items:(T={},T[d]=Object(r.__assign)({},Object(S.e)({driveItem:h,parentFolderItemKey:n,endpoint:o})),T)});return[2,{itemResolver:v,driveItem:h,itemKey:d}]}})})}}function G(e){var t=this,n=e.progressItemKey,i=e.sourceFile,s=e.itemUrl,o=e.driveUrl,u=e.endpoint,a=(function(e){switch(e){case"rename":return"rename";case"replace":return"replace";default:return"fail"}})(e.conflictResolution);return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,f,l,h,p,d,v,m,g,y;return Object(r.__generator)(this,function(b){switch(b.label){case 0:t=e(J);f=e($);return[4,e(Object(F.t)(u,o))];case 1:l=b.sent();h=new I.e;p=0;d=h.debounce(function(t){var r;if(t>p){n&&e(Object(z.e)({items:(r={},r[n]=Object(W.n)({progressSize:w.m},{progressSize:{current:t}}),r)}));p=t}},300,{leading:!1});v=e(Object(R.e)(function(e){return e.demandItemFacet(w.i,n)}));m=t.upload({conflictBehavior:a,qosData:{uploadId:""+ ++K},accessToken:l,fileName:i.name,content:i,itemUrl:s,onProgress:d,onPromptForConfictBehavior:function(e){return Promise.reject(e)},onWait:function(e){return f.wait(e)},select:"*,sharepointIds"});g=v?v.token.subscribe(function(){m.cancel()}):void 0;b.label=2;case 2:b.trys.push([2,4,5,6]);return[4,m];case 3:return[2,b.sent()];case 4:y=b.sent();if(X.n.isCanceled(y))throw new V.e;throw new c.e({facets:Object(r.__assign)({},Object(M.t)(y,function(e){switch(e){case"authFailure":case"unauthenticated":case 401:return A.e.pack({});case"nameAlreadyExists":case 409:return A.i.pack({supportsRename:!0})}})||Object(W.n)({},{})),innerError:y});case 5:g&&g();h.dispose();return[7];case 6:return[2]}})})}}var Y=Object(i.i)({mergeForSameItemKey:!1,maxParallelOperationCount:3,timeout:864e5})(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,n(Q(e))];case 1:t=r.sent().itemResolver;n(t.execute());return[2]}})})}});var Z=n(10),ee=n(2662),te=Object(Z.t)()(function(){return function(){return function(e,t){var n=t.itemKey;return{isAvailable:e.demandItemFacet(ee.e,n)}}}});var ne=n(2757),re=Object(Z.t)()(function(){return function(){return function(e,t){var n=t.itemKey;return{isAvailable:e.demandItemFacet(ee.r,n),validator:ne.e}}}});var ie=Object(Z.t)()(function(){return function(){return function(e,t){var n=t.itemKey;return{isAvailable:e.demandItemFacet(ee.t,n)}}}});var se=Object(Z.t)()(function(){return function(){return function(e,t){var n=t.itemKey;return{isAvailable:e.demandItemFacet(ee.i,n)}}}});var oe=Object(Z.t)()(function(){return function(e){return ue}});function ue(e,t){if(1!==t.itemKeys.length)return{};var n=t.itemKeys[0];if(e.demandItemFacet(C.d,n))return{};var i=e.demandItemFacet(u.e,n),s=i?Object(y.t)(i):void 0,o=i?Object(y.n)(i):void 0,a=i&&i.endpoint||"";return{isAvailable:e.demandItemFacet(ee.n,n),getDownloadData:s&&o?function(){return(function(e){var t=this,n=e.itemUrl,i=e.driveUrl,s=e.endpoint;return function(o){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,u,a,f;return Object(r.__generator)(this,function(r){switch(r.label){case 0:r.trys.push([0,2,,3]);return[4,o(Object(b.n)({url:e.itemUrl,driveUrl:i,method:"GET",qosName:"getItemDownloadUrl",endpoint:s}))];case 1:t=r.sent();if(!(u=(function(e){return 0===e.toLowerCase().lastIndexOf("https://graph.microsoft.com",0)})(n)?t["@microsoft.graph.downloadUrl"]:t["@content.downloadUrl"]))throw new Error("Unable to obtain download URL.");return[2,{method:"GET",url:u}];case 2:if((a=r.sent())instanceof M.e){f=Object(M.t)(a,function(e,t){switch(e){case"unauthenticated":case 401:return A.r.pack({});case"itemNotFound":case 404:return A.u.pack({});case"accessDenied":case 403:return A.e.pack({});default:return A.m.pack({})}});throw new L.e({innerError:a,facets:f})}throw a;case 3:return[2]}})})}})({itemUrl:s,driveUrl:o,endpoint:a})}:void 0}}var ae=Object(Z.t)()(function(){return function(e){return fe}});function fe(e,t){var n=t.itemKey,i=e.demandItemFacet(u.e,n);return{isAvailable:!0,getShareLink:function(){return(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o;return Object(r.__generator)(this,function(r){switch(r.label){case 0:if(!(t=e.driveItem))return[3,2];i=Object(y.t)(t)+"/invite";s=Object(y.n)(t);return[4,n(Object(b.r)({url:i,driveUrl:s,method:"POST",qosName:"getDefaultShareLink",endpoint:t.endpoint,headers:{prefer:"getDefaultLink","Content-type":"application/json"}}))];case 1:if(!(o=r.sent()))throw new Error("Unable to obtain default share URL");return[2,{url:o.value[0].link.webUrl,scope:o.value[0].link.scope}];case 2:throw new Error("Unable to obtain default share URL")}})})}})({driveItem:i})}}}var le=Object(Z.t)()(function(){return function(){return function(){return{}}}});var ce=Object(Z.t)()(function(){return function(e){return he}});function he(e,t){var n=t.itemKey,i=t.link,s=t.recipients,o=e.demandItemFacet(u.e,n);return{isAvailable:!0,permissionInvite:function(){return(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u,a,f,l,c,h,p,d;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=e.driveItem,i=e.link,s=e.recipients;if(!t||!i)throw new Error("Unable to obtain default share URL");o=t.endpoint;a=btoa(i);u="u!"+a.replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-");f=s.map(function(e){return{email:e}});l={recipients:f,roles:["read"]};c=o.replace("v1.0","beta");h=c+"/shares/"+u+"/permission/grant";return[4,n(Object(b.r)({url:h,method:"POST",qosName:"permissionGrant",endpoint:t.endpoint,headers:{"Content-type":"application/json",Accept:"application/json"},body:l}))];case 1:p=r.sent();d=p.value[0].grantedToIdentities.map(function(e){return{email:e.user.email}});return[2,{recipients:d}]}})})}})({driveItem:o,link:i,recipients:s})}}}var pe=n(3455),de=n(3456),ve=n(503),me=n(59),ge=n(146),ye=Object(i.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options,i=n.isFollowed,s=n.progressItemKey,o=ve.e.deserialize(t),a=o.driveItemKey,f=a.itemId,l=void 0===f?"":f,c=Object(y.n)(a);return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,n,f,h,p,d,v,m,g;return Object(r.__generator)(this,function(y){switch(y.label){case 0:t=e(Object(ge.e)({saveForLaterGraphEndpoint:me.E})).saveForLaterGraphEndpoint;n=new x.e;f=ve.e.serialize(o);h=t||a.endpoint;s&&e(Object(z.e)({items:(v={},v[s]=Object(r.__assign)({},w.g.pack({itemKey:u.e.serialize(a)})),v)}));p=i?{url:h+"/drives/"+a.driveId+"/items/"+l+"/follow",method:"POST",qosName:"followItem"}:{url:h+"/drives/"+a.driveId+"/following/"+l,method:"DELETE",qosName:"unfollowItem"};y.label=1;case 1:y.trys.push([1,3,,4]);return[4,e(Object(b.n)({url:p.url,driveUrl:c,method:p.method,qosName:p.qosName,endpoint:h}))];case 2:y.sent();n.invalidateItems({items:(m={},m[f]=[C.b],m)});n.resolveItems({items:(g={},g[f]=Object(r.__assign)({},C.b.pack(i||void 0)),g)});e(n.execute());return[3,4];case 3:d=y.sent();throw new Error(d.message);case 4:return[2]}})})}}),be=n(477),we=n(862),Ee=n(2152),Se=n(2755);function xe(e,t){return Se.e.serialize(Object(r.__assign)({driveItemKey:e.driveItemKey},t?{searchTerm:t}:{searchTerm:void 0}))}var Te=Object(Z.t)()(Ce),Ne=Object(Z.t)()(Ce);function Ce(){return function(e){return function(e,t){var n,r=t.itemKey,i=e.demandItemFacet(Ee.e,r);if(i)n=function(e){return i?xe(i,e):void 0};else{var s=e.demandItemFacet(Se.e,r);n=function(e){return s?xe(s,e):void 0}}return{isAvailable:!0,getSearchItemKey:n}}}}var ke=n(501),Le=n(665),Ae=n(361),Oe=Object(Z.t)()(function(){return function(e){return Me}});function Me(e,t){var n=t.handlers,i=t.itemKey,s=e.demandItemFacet(Ee.e,i),o=e.demandItemFacet(Se.e,i);if(n&&(s||o)){for(var u=[],a=0,f=n;a<f.length;a++){var l=f[a];if(l.key===Ae.u.key)u.push("photo");else if(l.key===Ae.a.key)u.push("video");else if(l.key===Ae.t.key)u.push("folder");else if(l.key===Ae.o.key)u.push("onenote");else if(l.key===Ae.i.key)u.push("!photo");else if(l.key===Ae.s.key)u.push("!video");else if(l.key===Ae.n.key)u.push("!folder");else if(l.key===Ae.r.key)u.push("!onenote");else{var c=Object(Le.e)(l);c&&u.push(c)}}if(s)return{itemKey:Ee.e.serialize(Object(r.__assign)(Object(r.__assign)({},s),{extFilters:u}))}}return{}}var _e=n(1000),De=n(1362),Pe=n(2974),He=Object(i.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options,i=Object.keys(n)[0];return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var s,o,a,f,l,c,h,p,d,v,m,g,w,S;return Object(r.__generator)(this,function(T){switch(T.label){case 0:if(!e(Object(R.e)(function(e){return e.demandItemFacet(u.e,i)})))throw new Error("Source item does not have a driveItem key");s=n[i],o=s.isMove,a=s.conflictBehavior,f=s.progressItemKey;l=u.e.deserialize(t);return[4,e(Object(De.e)(function(e){return e.demandItemFacet(u.e,i)}))];case 1:if(!(c=T.sent()))throw new Error("Unable to get metadata for destination item.");h=Object(y.t)(c);p=Object(y.n)(c);d=c.endpoint;T.label=2;case 2:T.trys.push([2,4,,5]);return[4,e(Object(b.n)({url:h+(o?"":"/copy"),driveUrl:p,method:o?"PATCH":"POST",body:{parentReference:{id:l.itemId||Pe.n,driveId:l.driveId||""},"@microsoft.graph.conflictBehavior":a},qosName:o?"moveItem":"copyItem",endpoint:d}))];case 3:v=T.sent();(m=new x.e).invalidateItems({items:(w={},w[i]=o?[C.A,C.f]:[],w[t]=[E.t],w)});f&&!o&&v.name&&m.resolveItems({items:(S={},S[f]=Object(r.__assign)({},C.l.pack(v.name)),S)});e(m.execute());return[3,5];case 4:if((g=T.sent())instanceof M.e&&g.status===L.t)throw new _e.e({innerError:g,facets:Object(r.__assign)({},A.l.pack(g.status))});throw g;case 5:return[2]}})})}}),Be=n(1031),je=Object(Z.t)()(function(){return function(){return function(e,t){return{validator:ne.e}}}});var Fe=n(41),Ie=n(83),qe=n(673),Re=n(274),Ue=n(3449),ze=n(130),We=n(680),Xe=n(2973),Ve=n(217),$e=n(3156),Je=Object(i.i)()(function(e){var t=e.itemKey,n=e.options.itemSetKey;return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var i,s,o,a,f,l;return Object(r.__generator)(this,function(r){switch(r.label){case 0:if(!Ve.e.matches(n))throw new L.e({code:"invalidItemSetForAddToOneDrive"});i=Ve.e.deserialize(n).driveItemKey.endpoint;s=e(Object(R.e)(function(e){return{fileName:e.demandItemFacet(C.h,t),sharepointIds:e.demandItemFacet(Xe.e,t),remoteDriveInfo:e.demandItemFacet(u.e,t)}})),o=s.fileName,a=s.sharepointIds,f=s.remoteDriveInfo;if(!(i&&o&&f&&a))throw new L.e({code:"missingItemInfoForAddToOneDrive"});r.label=1;case 1:r.trys.push([1,3,,4]);return[4,e(Object($e.t)({name:o.name,sharepointIds:a,qosName:"AddToOneDrive_SWM",endpoint:i}))];case 2:r.sent();return[3,4];case 3:if(!((l=r.sent())instanceof M.e))throw l;Object($e.e)(l);return[3,4];case 4:return[2]}})})}});n.d(t,"graphAddonDataOnlyDeferred",function(){return Qe});var Ke=Object(Ie.e)(function(){return Promise.all([n.e("deferred.resx-deferred"),n.e("deferred.office-ui-fabric-react"),n.e("deferred.items-view"),n.e("deferred.odsp-common"),n.e("deferred.odsp-datasources"),n.e("deferred.odsp-shared-react"),n.e("odsp.knockout.lib"),n.e("deferred")]).then(n.bind(null,4080))},{chunkName:"addon-graph-deferredoperations"}),Qe=Object(i.t)(function(){return function(e){var t=e(Object(ge.e)({useBatchedDeleteConfiguration:me.T})).useBatchedDeleteConfiguration;e(Object(ze.e)(function(){e(Object(o.e)(Ee.e,we.e)(Te));e(Object(o.e)(Se.e,we.e)(Ne));e(Object(o.e)(Ee.e,ke.e)(Oe));e(Object(s.s)(u.e,a.t)(T));e(t?Object(s.s)(u.e,f.t)(Object(i.r)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,e(Object(Fe.o)())];case 1:t.sent();return[4,Ke()];case 2:return[2,t.sent().driveItemDeleteItemsBatchedOperationHandler]}})})})):Object(s.s)(u.e,f.t)(k));e(Object(s.s)(u.e,l.t)(_));e(Object(s.s)(u.e,c.t)(Y));e(Object(s.s)(u.e,_e.t)(He));e(Object(s.s)(u.e,We.t)(Je));e(Object(o.e)(u.e,h.e)(te));e(Object(o.e)(u.e,Be.e)(je));e(Object(o.e)(u.e,p.e)(re));e(Object(o.e)(u.e,d.e)(ie));e(Object(o.e)(u.e,v.e)(se));e(Object(o.e)(u.e,pe.e)(ae));e(Object(o.e)(u.e,de.e)(ce));e(Object(o.e)(u.e,m.e)(oe));e(Object(o.e)(u.e,g.e)(le));e(Object(s.s)(ve.e,be.e)(ye));e(Object(s.s)(qe.e,Re.e)(Ue.e))}))}})},,,,,,,function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(11),s=n(115),o=n(384),u=n(869),a=n(44),f=n(1125),l=n(967),c=n(1004),h=Object(i.i)({mergeForSameItemKey:!1})(function(e){return function(t){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,n.e("34").then(n.bind(null,4023))];case 1:return[4,(0,r.sent().renameItemCore)(t,e)];case 2:r.sent();return[2]}})})}}),p=n(846),d=n(379),v=n(104),m=n(1),g=n(60),y=n(3692),b=n(10),w=n(6),E=n(2757);function S(e){return!!e&&0===e.toLowerCase().indexOf("team.channel")}var x=n(29),T=n(56),N=Object(b.t)()(function(){return function(e){return function(e,t){var n,i,s=t.itemKey,o=e.demandItem({key:a.e,permissions:m.st,isCheckedOut:w.y,isFolder:w.d,rowData:m.bt},s),u=o.key,f=o.permissions,l=o.isCheckedOut,c=o.isFolder,h=o.rowData,p=u&&e.demandItemFacet(m.Qt,d.e.serialize({webAbsoluteUrl:u.webAbsoluteUrl,listFullUrl:u.listFullUrl})),b=u&&v.e.serialize({webAbsoluteUrl:u.webAbsoluteUrl,listFullUrl:u.listFullUrl}),N=(null===(n=e.demandItemFacet(m.Be,b))||void 0===n?void 0:n.templateType)===x.n.contentCenterModelLibrary,k=Object(T.e)(e,{feature:C,pageContext:p})&&N,L=void 0,A=!1,O=E.e;if(p){L=h&&l&&!!l.byOther;var M=e.demandItemFacet(m.$e,s,{suppressGetItems:!0}),_=S(null===(i=h)||void 0===i?void 0:i.ProgId);A=!(M||p.isAnonymousGuestUser||_)&&g.e.hasItemPermission({permissions:f},g.e.deleteListItems)&&g.e.hasItemPermission({permissions:f},g.e.editListItems)&&!k;p.supportPercentStorePath&&p.supportPoundStorePath||(O=E.t)}var D={},P=u&&e.demandItemFacet(m.Be,v.e.serialize({webAbsoluteUrl:u.webAbsoluteUrl,listFullUrl:u.listFullUrl}));if(L){D.lockedWarningMessage=y.e.FileCheckedoutOrLockedWarning;D.title=y.e.FileCheckedoutOrLockedWarningTitle}else if(P&&P.isForceCheckout&&l&&!l.byYou&&!c){D.lockedWarningMessage=y.e.CheckoutRequired;D.title=y.e.Error}return Object(r.__assign)({isAvailable:A,validator:O,isFolder:!!c},D)}}}),C={ODB:1517};var k=n(568),L=n("react-lib"),A=n(121),O=n(1023),M=n(2978),_=n(134),D=n(864),P=n(786),H=n(403),B=n(109),j=n(28),F=n(129),I=n(136),q=n(102),R=n(75);function U(e){var t=e.defaultRender,n=Object(r.__rest)(e,["defaultRender"]);return t?L.createElement(t,Object(r.__assign)({},n,{preferOpenInBrowser:!0})):null}function z(e){var t=e.defaultRender,n=Object(r.__rest)(e,["defaultRender"]);return t?L.createElement(t,Object(r.__assign)({},n,{preferSameWindow:!0})):null}var W=Object(b.t)()(V),X=Object(b.t)()(V);function V(){return function(e){var t=new q.e;return function(e,n){var i=n.itemKeys,s=i[0],o=e.demandItemFacet(w.d,s),u=e.demandItemFacet(B.i,s),f=e.demandItemFacet(m.E,s);return 1!==i.length||o||u||f?i.length>0?(function(e,t){var n=t.itemKeys,i=e.demandItemFacet(a.e,n[0]);if(!i||!i.webAbsoluteUrl||!i.listFullUrl)return{};var s=i.webAbsoluteUrl,o=i.listFullUrl,u=v.e.serialize({webAbsoluteUrl:s,listFullUrl:o}),f=e.demandItem({listFacets:m.Be,downloadZipApiUrl:D.e},u),l=f.listFacets,c=f.downloadZipApiUrl;if(!l||!c||l.templateType===x.t.webPageLibrary)return{};for(var h=[],p=Object(j.e)(e,{enableOAuthTokenInDownload:m.U}).enableOAuthTokenInDownload,d=void 0!==p&&p,y=!1,b=0,E=n;b<E.length;b++){var S=E[b],T=e.demandItem({name:w.l,size:w.p,itemUrl:w.j,folder:w.d,permissions:m.st,itemComplianceStatus:H.e,isOneNote:B.i},S),N=T.name,C=T.size,k=T.itemUrl,L=T.folder,M=T.permissions,P=T.itemComplianceStatus;if(T.isOneNote)return{isAvailable:!1};var I=void 0,q=void 0,R=e.demandItemFacet(m.$e,S,{suppressGetItems:!0});if(R){I=void 0;q=new F.e(R.siteUrl).authority+"/_api/v2.1/drives/"+R.driveId+"/items/"+R.itemId;y=!0}else{if(!k)return{};I=e.demandItemFacet(D.t,u);q=Object(O.n)(k,(I?I.accessToken:void 0)||"")}if(q){var U=!!L;3!==P&&4!==P&&g.e.hasItemPermission({permissions:M},g.e.openItems)&&h.push({name:N||"",size:C||0,docId:q,isFolder:U})}}if(0===h.length)return{};return{isAvailable:!0,getDownloadData:function(){return(function(e){var t=this,n=e.zipApiUrl,i=e.itemsData,s=e.useOAuthToken;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,o,u;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=void 0;return s?[4,e(Object(A.e)({url:new F.e(n).authority}))]:[3,2];case 1:t=r.sent();r.label=2;case 2:o=i&&1===i.length?i[0].name+".zip":"OneDrive_"+ ++$+"_"+(new Date).toLocaleDateString().replace(/\//g,"-").replace(/[^ -~]/g,"")+".zip";u=_.e.generate();return[2,{url:n,method:"POST",postData:{zipFileName:o,guid:u,provider:"spo",files:JSON.stringify({items:i}),oAuthToken:t||""}}]}})})}})({zipApiUrl:c,itemsData:h,useOAuthToken:d||y})}}})(e,{itemKeys:i}):{}:(function(e,t){var n=t.itemKey,i=t.platformDetection,s=e.demandItem({spItem:a.e,permissions:m.st,folderPath:m.le,uniqueId:m.fn,itemComplianceStatus:H.e,isBFile:m.Se},t.itemKey),o=s.spItem,u=s.permissions,f=s.folderPath,l=s.uniqueId,c=s.itemComplianceStatus,h=s.isBFile,p=e.demandItemFacet(w.N,t.itemKey),y=o&&d.e.serialize(o),b=e.demandItemFacet(m.Qt,y);if(!b||!o||h)return{};var E=o.webAbsoluteUrl,S=o.listFullUrl,T=v.e.serialize(o),N=e.demandItemFacet(m.Be,T);if(N&&N.templateType===x.t.webPageLibrary)return{};if(3===c||4===c||!g.e.hasItemPermission({permissions:u},g.e.openItems))return{};var C=Object(j.e)(e,{spCookieDomainConfiguration:m.kt,enableMalwareDownloadInNewWindow:m.j}),k=C.spCookieDomainConfiguration,L=C.enableMalwareDownloadInNewWindow;if(p){if(!b.allowInfectedDownload)return{};var O=e.demandItemFacet(w.i,n);return O?L?{isAvailable:!0,downloader:U,getDownloadData:function(){return J({canconicalUrl:O})}}:k?new F.e(k).authority!==new F.e(O).authority?{}:Object(r.__assign)(Object(r.__assign)({isAvailable:!!l},i.isIE?{downloader:z}:{}),{getDownloadData:function(){return J({canconicalUrl:O})}}):{}:{}}if(!f)return{};var _=b.layoutsUrl;if(!_)return{};var D=!k||new F.e(k).authority!==new F.e(E).authority,B=b&&Object(R.t)(b),q=!!B&&B.isActivated("d1181e40-8c18-49bf-bff9-efd9518c28c0","10/10/2020","Use PostBody Download"),W=Object(j.e)(e,{disableDownloadWithAspxUrlWithToken:m.w}).disableDownloadWithAspxUrlWithToken,X=void 0!==W&&W;return Object(r.__assign)(Object(r.__assign)({isAvailable:!0},i.isIE?{downloader:z}:{}),{getDownloadData:function(){return q||X?k&&l&&!D?(function(e){var t=this,n=e.webAbsoluteUrl,i=e.layoutsUrl,s=e.uniqueId;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return[2,{url:n+"/"+i+"/download.aspx?"+Object(I.e)({UniqueId:s}),method:"GET"}]})})}})({webAbsoluteUrl:E,uniqueId:l,layoutsUrl:_}):(function(e){var t=this,n=e.webAbsoluteUrl,i=e.listFullUrl,s=e.folderPath;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,o,u,a,f,l;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=e(Object(A.n)({webAbsoluteUrl:n,listFullUrl:i})),o=t.dataRequestor,u=t.hasDigest;if(!t.hasTokenProvider)return[3,1];f=void 0;return[3,3];case 1:return[4,e(Object(A.e)({url:n||i,disallowCookies:!u}))];case 2:f=r.sent();r.label=3;case 3:a=f;l=Object(P.r)({webAbsoluteUrl:n,listOrItemFullUrl:i});return[4,Object(M.e)({dataRequestor:o,authToken:a,serverRelativeItemUrl:s,webApiUrl:l})];case 4:return[2,{url:r.sent(),method:"GET"}]}})})}})({webAbsoluteUrl:E,listFullUrl:S,folderPath:f,layoutsUrl:_}):(function(e){var t=this,n=e.webAbsoluteUrl,i=e.listFullUrl,s=e.uniqueId,o=e.layoutsUrl,u=e.isCrossSite;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,a,f,l;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=e(Object(A.n)({webAbsoluteUrl:n,listFullUrl:i})),a=t.hasDigest;if(!t.hasTokenProvider&&u)return[3,1];l=void 0;return[3,3];case 1:return[4,e(Object(A.e)({url:n||i,disallowCookies:!a}))];case 2:l=r.sent();r.label=3;case 3:f=l;return[2,{url:n+"/"+o+"/download.aspx?"+Object(I.e)({UniqueId:s}),method:u?"POST":"GET",postData:{oAuthToken:f||""}}]}})})}})({webAbsoluteUrl:E,listFullUrl:S,uniqueId:l||"",layoutsUrl:_,isCrossSite:D})}})})(e,{itemKey:s,platformDetection:t})}}}var $=0;function J(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(n){(t=e.canconicalUrl)&&(-1===t.indexOf("?")?t+="?avcmd=1":t+="&avcmd=1");return[2,{url:t,method:"GET"}]})})}}var K=n(845),Q=n(23),G=n(34),Y=n(3693),Z=Object(b.t)()(function(){return function(e){return function(e,t){var n,r=t.itemKey,i=t.isBatchDelete,s=e.demandItemFacet(m.$e,r,{suppressGetItems:!0}),o=e.demandItemFacet(m.st,r,{suppressGetItems:!0}),u=S(null===(n=e.demandItemFacet(m.bt,r,{suppressGetItems:!0}))||void 0===n?void 0:n.ProgId),a=g.e.hasItemPermission({permissions:o},g.e.deleteListItems)&&!u;if(a&&s){a=!!Object(j.e)(e,{enableDeleteCommandForMountPointConfiguration:m.N}).enableDeleteCommandForMountPointConfiguration&&i}return{isAvailable:a,deleteWizard:ee}}}});var ee=Object(G.t)(function(e,t){var n,i,s,o,u,a,f=t.itemKeys,l=t.defaultRender,c=Object(r.__rest)(t,["itemKeys","defaultRender"]),h=void 0,p=Object(j.e)(e,{enableDeleteCommandForMountPointConfiguration:m.N}).enableDeleteCommandForMountPointConfiguration;if(1===f.length){var d=e.demandItemFacet(m.Je,f[0]);if(d){var v=d&&Object(Q.formatToArray)(Object(Q.getLocalizedCountValue)(Y.e.deleteItemThatIsMountedDescription,Y.e.deleteItemThatIsMountedIntervals,d)||"",d),g=c.deleteWizardStrings.confirmText;h=Object(r.__assign)(Object(r.__assign)({},c),{deleteWizardStrings:Object(r.__assign)(Object(r.__assign)({},c.deleteWizardStrings),{confirmTitle:Y.e.deleteItemThatIsMountedTitle,confirmText:[v," ",g]})})}}else if(p){n=0;f.forEach(function(t){e.demandItemFacet(m.$e,t,{suppressGetItems:!0})&&n++});if(n>0){var y=f.length-n;h=Object(r.__assign)(Object(r.__assign)({},c),{deleteWizardStrings:Object(r.__assign)(Object(r.__assign)({},c.deleteWizardStrings),{confirmTitle:Y.e.deleteItems,confirmText:(i=n,s=y,o=Object(Q.format)(Object(Q.getLocalizedCountValue)(Y.e.deleteShortcutsFormat,Y.e.deleteShortcutsIntervals,i)||"",i),u=Object(Q.format)(Object(Q.getLocalizedCountValue)(Y.e.deleteOtherItemsFormat,Y.e.deleteOtherItemsIntervals,s)||"",s),a=Object(Q.format)(Y.e.deleteItemsAndMountPointsFormat,o,u),a)})})}}var b=h||c;return l?L.createElement(l,Object(r.__assign)({itemKeys:f},b)):null});var te=Object(b.t)()(function(){return function(e){return function(e,t){var n=t.itemKeys;if(!Object(j.e)(e,{enableDeleteCommandForMountPointConfiguration:m.N}).enableDeleteCommandForMountPointConfiguration)return{};for(var r=0,i=n;r<i.length;r++){var s=i[r];if(!e.demandItemFacet(m.$e,s,{suppressGetItems:!0}))return{}}return{isAvailable:!1}}}});n.d(t,"sharePointBasicActionsAddonDeferred",function(){return ne});var ne=Object(i.t)(function(){return function(e){e(Object(s.s)(a.e,l.t)(Object(i.r)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e("32").then(n.bind(null,4226))];case 1:return[2,e.sent().spItemDeleteItemsOperationHandler]}})})})));e(Object(s.s)(a.e,c.t)(h));e(Object(o.e)(a.e,p.e)(N));e(Object(o.e)(a.e,k.e)(W));e(Object(o.e)(f.e,k.e)(X));e(Object(o.e)(a.e,K.e)(Z));e(Object(o.e)(a.e,u.e)(te))}})}],Array(15),[function(e,t,n){"use strict";var r=n(0),i=n(11),s=n(115),o=n(130),u=n(158),a=n(274),f=n(1018),l=n(1017),c=n(94),h=n(116),p=n(159),d=n(281),v=n(1740),m=n(121),g=n(1),y=n(858);var b=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=l.e.deserialize(n).webAbsoluteUrl;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s,o,u,a,l,b,w;return Object(r.__generator)(this,function(E){switch(E.label){case 0:t=new d.t({webAbsoluteUrl:i}).build().segments("Site","ReadOnly").toString();s=e((function(e){return function(t){var n=t(Object(h.e)(function(t){var n=y.e.serialize({webAbsoluteUrl:e.webAbsoluteUrl});return t.demandItemFacet(g.Gt,n)}));return new v.e({id:"SiteReadOnlyCache"},{pageContext:n})}})({webAbsoluteUrl:i}));o=s.getRequestKey(t,"POST");u=function(){return c.n.resolve(e(Object(m.t)({url:t,webAbsoluteUrl:i,method:"GET",needsRequestDigest:!0,qosName:"SiteReadOnly"})))};return[4,s.getDataUtilizingCache({cacheRequestKey:o,cachingStrategy:1,getData:u})];case 1:a=E.sent();l=-2;a&&a.d&&(a.d.ReadOnly?l=0:!1===a.d.ReadOnly&&(l=-1));(b=new p.e).resolveItems({items:(w={},w[n]=Object(r.__assign)({},f.e.pack(l)),w)});e(b.execute());return[2]}})})}});n.d(t,"e",function(){return w});var w=Object(i.t)(function(){return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){e(Object(o.e)(function(){e(Object(u.t)({keyFacet:l.e,facets:[l.e,f.e]}));e(Object(s.s)(l.e,a.e)(b))}));return[2]})})}})},function(e,t,n){"use strict";var r=n(0),i=n(11),s=n(115),o=n(8),u=n(130),a=n(158),f=n(274),l=n(3131),c=n(94),h=n(116),p=n(266),d=n(6),v=n(159),m=n(281),g=n(1740),y=n(121),b=n(1061),w=n(3470),E=n(1),S=n(858);var x=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=l.e.deserialize(n).webAbsoluteUrl;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s,u,a,f,l,x,N;return Object(r.__generator)(this,function(C){switch(C.label){case 0:t=new m.t({webAbsoluteUrl:i}).build().segments("web","SiteUserInfoList","GetItems").parameters({$top:50,$orderby:{raw:"UserExpiration desc"},$select:{raw:"Title,ID,Name,UserExpiration,IsSiteAdmin,EMail"}}).toString();s=e((function(e){return function(t){var n=t(Object(h.e)(function(t){var n=S.e.serialize({webAbsoluteUrl:e.webAbsoluteUrl});return t.demandItemFacet(E.Gt,n)}));return new g.e({id:"UserExpirationCache"},{pageContext:n})}})({webAbsoluteUrl:i}));u=s.getRequestKey(t,"POST",T);a=function(){return c.n.resolve(e(Object(y.t)({url:t,body:T,webAbsoluteUrl:i,method:"POST",needsRequestDigest:!0,qosName:"GetUsersWithExpirations"})))};return[4,s.getDataUtilizingCache({cacheRequestKey:u,cachingStrategy:1,getData:a})];case 1:f=C.sent();l=[];x=new v.e;f.d.results.forEach(function(e){var t,n=b.e.serialize({id:String(e.ID)});l.push(n);x.resolveItems({items:(t={},t[n]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},d.l.pack(e.Name)),p.e.pack(e.EMail)),w.t.pack(new Date(e.UserExpiration).getTime())),t)})});x.resolveItems({items:(N={},N[n]=Object(r.__assign)({},o.e.pack({itemKeys:l})),N)});e(x.execute());return[2]}})})}}),T=JSON.stringify({query:{__metadata:{type:"SP.CamlQuery"},ViewXml:"<View><Query><Where><IsNotNull><FieldRef Name='UserExpiration'/></IsNotNull></Where></Query></View>"}});n.d(t,"e",function(){return N});var N=Object(i.t)(function(){return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){e(Object(u.e)(function(){e(Object(a.t)({keyFacet:l.e,facets:[l.e,o.e]}));e(Object(s.s)(l.e,f.e)(x))}));return[2]})})}})}],Array(39),[function(e,t,n){"use strict";n.r(t);n.d(t,"getSPFollowedSitesItemSet",function(){return b});var r=n(0),i=n(11),s=n(6),o=n(855),u=n(838),a=n(854),f=n(466),l=n(727),c=n(861),h=n(534),p=n(8),d=n(364),v=n(1),m=n(159),g=n(172),y=n(146),b=Object(i.i)()(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,d,y,b,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B;return Object(r.__generator)(this,function(j){switch(j.label){case 0:t=o.e.deserialize(e.itemKey).tenantRootUrl;i=new m.e;return[4,n(w(t))];case 1:d=j.sent();y=[];b=u.e.serialize({tenantRootUrl:t});E=a.e.serialize({tenantRootUrl:t});for(S=0,x=d.Items;S<x.length;S++){T=x[S];N=f.e.serialize({webAbsoluteUrl:T.Url});C=l.e.serialize({webAbsoluteUrl:T.Url});k=T.ItemReference||{},L=k.SiteId,A=void 0===L?void 0:L,O=k.WebId,M=void 0===O?void 0:O,_=k.GroupId,D=void 0===_?void 0:_;P=c.e.serialize({rootItemKey:b,itemKey:N});i.resolveItems({items:(H={},H[N]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},s.l.pack(T.Title)),v.e.pack(T.Acronym)),v.o.pack(T.BannerColor)),v.u.pack(T.BannerImageUrl)),v.Me.pack(!0)),s.d.pack({})),f.e.pack({webAbsoluteUrl:T.Url})),v.xt.pack(A)),v.dn.pack(M)),v.me.pack(D)),p.t.pack({itemKey:C})),H[P]=Object(r.__assign)(Object(r.__assign)({},v.ut.pack(T.PinOrder)),Object(g.e)().forFacet(v.ut).thenInvalidate(E,p.e).forFacet(v.ut).thenInvalidate(e.itemKey,p.e).pack()),H[C]=Object(r.__assign)({},p.s.pack({itemKey:N})),H)});y.push(N)}i.resolveItems({items:(B={},B[e.itemKey]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},s.l.pack(h.e.followed)),p.e.pack({itemKeys:y})),v.it.pack({itemKey:b})),B)});n(i.execute());return[2]}})})}});function w(e){var t=this;return function(i){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return!1!==i(Object(y.e)({enableSPHomeServiceConfiguration:v.Q})).enableSPHomeServiceConfiguration?[3,3]:[4,n.e("29").then(n.bind(null,3701))];case 1:t=r.sent().getFollowedSitesData;return[4,i(t(e))];case 2:return[2,r.sent()];case 3:return[4,i(Object(d.n)(e))];case 4:return[2,r.sent()]}})})}}},function(e,t,n){"use strict";n.r(t);n.d(t,"universalPrintLicenseCheckOperationHandler",function(){return d});var r=n(0),i=n(159),s=n(146),o=n(11),u=n(708),a=n(1024),f=n(529),l=n(59),c=n(1623),h=n(2670),p=n(1847),d=Object(o.i)()(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,o,d,v,m,g,y,b,w,E,S,x,T,N,C;return Object(r.__generator)(this,function(k){switch(k.label){case 0:t=e.itemKey;o=n(Object(s.e)({universalPrintLicenseCache:a.e})).universalPrintLicenseCache;if(void 0!==(d=null===(N=o)||void 0===N?void 0:N.getValue("licenseinfo"))){(S=new i.e).resolveItems({items:(x={},x[t]=Object(r.__assign)({},u.e.pack(d.hasValidLicense)),x)});n(S.execute())}if(!(void 0===d||Date.now()-d.lastModified>=1728e5))return[3,3];v=n(Object(s.e)({graphEndpoint:l.c})).graphEndpoint;m=n(c.e).dataRequestor;g=new h.e({},{dataRequestor:m});y=f.e.deserialize(t);b=v||y.graphEndpoint;return[4,n(Object(p.t)(b))];case 1:w=k.sent();return[4,g.hasValidUniversalPrintLicense({endpoint:b,accessToken:w})];case 2:E=k.sent();o&&o.setValue("licenseinfo",{hasValidLicense:E,lastModified:Date.now()});if((null===(C=d)||void 0===C?void 0:C.hasValidLicense)!==E){(S=new i.e).resolveItems({items:(T={},T[t]=Object(r.__assign)({},u.e.pack(E)),T)});n(S.execute())}k.label=3;case 3:return[2]}})})}})},function(e,t,n){"use strict";n.r(t);n.d(t,"universalPrintPrinterShareListOperationHandler",function(){return c});var r=n(0),i=n(159),s=n(11),o=n(2993),u=n(1623),a=n(2670),f=n(1025),l=n(1847),c=Object(s.i)()(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s,c,h,p,d,v,m,g;return Object(r.__generator)(this,function(y){switch(y.label){case 0:t=e.itemKey;s=n(u.e).dataRequestor;c=new a.e({},{dataRequestor:s});h=f.e.deserialize(t);p=h.endpoint;return[4,n(Object(l.t)(p))];case 1:d=y.sent();return[4,c.getPrinterSharesList({endpoint:p,accessToken:d,topQueryOption:100,filterQueryOption:"capabilities/contentTypes/any(c:c eq '"+h.fileType+"')"})];case 2:v=y.sent();(m=new i.e).resolveItems({items:(g={},g[t]=Object(r.__assign)({},o.e.pack(v)),g)});n(m.execute());return[2]}})})}})},function(e,t,n){"use strict";n.r(t);n.d(t,"itemGetPrintFileUrlOperationHandler",function(){return v});var r=n(0),i=n(11),s=n(77),o=n(667),u=n(116),a=n(159),f=n(666),l=n(799),c=n(1623),h=n(3445),p=n(3451),d=n(2753),v=Object(i.i)()(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,v,m,g,y,b,w,E,S,x,T,N,C,k;return Object(r.__generator)(this,function(L){switch(L.label){case 0:t=e.itemKey;i=n(Object(u.e)(function(e){return{hasPdf:e.demandItemFacet(h.e,t),thumbnailSet:e.demandItemFacet(d.e,t)}})),v=i.hasPdf,m=i.thumbnailSet;g=Object(p.t)(m);if(!v||!g)return[3,1];b=Object(f.n)(g.large.url);y={fileUrl:b};return[3,3];case 1:if(!(w=n(Object(u.e)(function(e){return e.demandItem({driveItemKey:s.e},t)})).driveItemKey))return[2];E=Object(l.t)(w);S=Object(l.n)(w);x=w.endpoint;return[4,n(Object(c.n)({url:E,driveUrl:S,method:"GET",qosName:"getItemPrintFileDataUrl",endpoint:x}))];case 2:T=L.sent();if(!(N=(function(e){return 0===e.toLowerCase().lastIndexOf("https://graph.microsoft.com",0)})(E)?T["@microsoft.graph.downloadUrl"]:T["@content.downloadUrl"]))throw new Error("Unable to obtain Print file URL.");y={fileUrl:N};L.label=3;case 3:(C=new a.e).resolveItems({items:(k={},k[t]=Object(r.__assign)({},o.n.pack(y)),k)});n(C.execute());return[2]}})})}})},function(e,t,n){"use strict";n.r(t);n.d(t,"printToUniversalPrinterOperationHandler",function(){return g});var r=n(0),i=n(11),s=n(6),o=n(146),u=n(116),a=n(324),f=n(1528),l=n(2670),c=n(666),h=n(59),p=n(667),d=n(1847),v=n(1623),m=n(3469),g=Object(i.i)()(function(e){var t=e.itemKey,n=e.options,i=n.printerId,g=n.config;return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var n,y,b,w,E,S,x,T,N,C,k,L;return Object(r.__generator)(this,function(r){switch(r.label){case 0:if(!(n=e(Object(o.e)({graphEndpoint:h.c})).graphEndpoint))throw new a.e({code:"missinggraphendpointinfoforprinttoup"});return[4,e(Object(d.t)(n))];case 1:y=r.sent();b=e(v.e).dataRequestor;w=new l.e({},{dataRequestor:b});r.label=2;case 2:r.trys.push([2,11,,12]);return[4,e(Object(p.e)({items:(L={},L[t]={},L)}))];case 3:r.sent();E=e(Object(u.e)(function(e){return{fileName:e.demandItemFacet(s.h,t),fileNameUrl:e.demandItemFacet(p.n,t)}})),S=E.fileName;if(!(x=E.fileNameUrl)||!S||!x.file&&!x.fileUrl)return[3,9];T=void 0;if(!x.file)return[3,4];T=x.file;return[3,7];case 4:if(!x.fileUrl)return[3,6];N="oxps"===S.extension?c.t:c.e;return[4,Object(m.e)(x.fileUrl,S.name,N)];case 5:T=r.sent();return[3,7];case 6:throw new a.e({code:"missingiteminforprinttoup"});case 7:C={endpoint:n,printerId:i,file:T,contentType:T.type,config:g,accessToken:y};return[4,w.submitPrintJob(C)];case 8:r.sent();return[3,10];case 9:throw new a.e({code:"missingiteminforprinttoup"});case 10:return[3,12];case 11:if(!((k=r.sent())instanceof f.e))throw k;Object(m.t)(k);return[3,12];case 12:return[2]}})})}})},function(e,t,n){"use strict";n.r(t);n.d(t,"printToUniversalPrinterOperationHandler",function(){return g});var r=n(0),i=n(11),s=n(6),o=n(116),u=n(324),a=n(1528),f=n(2670),l=n(667),c=n(1847),h=n(1623),p=n(3469),d=n(146),v=n(59),m=n(666),g=Object(i.i)()(function(e){var t=e.itemKey,n=e.options,i=n.printerId,g=n.config;return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var n,y,b,w,E,S,x,T,N,C,k,L;return Object(r.__generator)(this,function(r){switch(r.label){case 0:if(!(n=e(Object(d.e)({graphEndpoint:v.c})).graphEndpoint))throw new u.e({code:"missinggraphendpointinfoforprinttoup"});return[4,e(Object(c.t)(n))];case 1:y=r.sent();b=e(h.e).dataRequestor;w=new f.e({},{dataRequestor:b});r.label=2;case 2:r.trys.push([2,11,,12]);return[4,e(Object(l.e)({items:(L={},L[t]={},L)}))];case 3:r.sent();E=e(Object(o.e)(function(e){return{fileName:e.demandItemFacet(s.h,t),fileNameUrl:e.demandItemFacet(l.n,t)}})),S=E.fileName;if(!(x=E.fileNameUrl)||!S||!x.file&&!x.fileUrl)return[3,9];T=void 0;if(!x.file)return[3,4];T=x.file;return[3,7];case 4:if(!x.fileUrl)return[3,6];N=Object(m.i)(S.extension)?m.e:m.t;return[4,Object(p.e)(x.fileUrl,S.name,N)];case 5:T=r.sent();return[3,7];case 6:throw new u.e({code:"missingiteminforprinttoup"});case 7:C={endpoint:n,printerId:i,file:T,contentType:T.type,config:g,accessToken:y};return[4,w.submitPrintJob(C)];case 8:r.sent();return[3,10];case 9:throw new u.e({code:"missingiteminforprinttoup"});case 10:return[3,12];case 11:if(!((k=r.sent())instanceof a.e))throw k;Object(p.t)(k);return[3,12];case 12:return[2]}})})}})}],Array(152),[function(e,t,n){"use strict";n.r(t);n.d(t,"driveItemDeleteItemsBatchedOperationHandler",function(){return g});var r,i=n(0),s=n(324),o=n(11),u=n(323),a=n(114),f=n(71),l=n(158),c=n(1198),h=n(6),p=n(77),d=n(799),v=n(1623),m=n(233);(function(e){e.Completed="completed";e.Failed="failed";e.InProgress="inProgress"})(r||(r={}));var g=Object(o.n)({maxParallelOperationCount:4,timeout:3e5,areSameBatch:function(e,t){var n=p.e.deserialize(e.itemKey).driveId,r=p.e.deserialize(t.itemKey).driveId;return!!n&&!!r&&n===r}})(function(e){var t=this,n=e.items,g=Object.keys(n),y=g.map(function(e){return p.e.deserialize(e)});return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,p,b,w,E,S,x;return Object(i.__generator)(this,function(T){switch(T.label){case 0:e(Object(l.e)({items:Object(a.t)(n,function(e){e.progressItemKey;return Object(i.__assign)(Object(i.__assign)({},f.m.pack({total:1,current:0})),f.p.pack(!0))},function(e,t){return t.progressItemKey})}));t={value:y.map(function(e){return{id:e.itemId,deleted:{}}})};p="";b=Object(d.n)(y[0]);return[4,e(Object(v.n)({url:b+"/items",method:"PATCH",body:t,qosName:"deleteItems",endpoint:y[0].endpoint,parseResponse:function(e){p=e.getResponseHeader("Location")||""}}))];case 1:T.sent();w=0;E=!1;S=!1;Object(u.t)(3e5).then(function(){return S=!0});x=function(){var t;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return[4,e(Object(v.n)({url:p,qosName:"getOperationStatus",endpoint:y[0].endpoint}))];case 1:t=i.sent();g.forEach(function(){e(Object(l.e)({items:Object(a.t)(n,function(e){e.progressItemKey;return f.m.pack({total:1,current:t.percentageComplete/g.length})},function(e,t){return t.progressItemKey})}))});if(t.status!==r.Completed&&t.status!==r.Failed)return[3,2];E=!0;w=t.summary.failed;return[3,4];case 2:return[4,Object(u.t)(500)];case 3:i.sent();i.label=4;case 4:return[2]}})};T.label=2;case 2:return[5,x()];case 3:T.sent();T.label=4;case 4:if(!E&&!S)return[3,2];T.label=5;case 5:if(S)throw new s.e({facets:Object(i.__assign)({},m.l.pack(408))});e(Object(c.e)({items:Object(a.e)(g,function(){return[h.f]})}));if(w>0)throw new o.e({items:Object(a.e)(g.slice(0,w),function(){return new s.e({facets:Object(i.__assign)({},m.l.pack(500))})})});return[2]}})})}})}],Array(19),[function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(11),s=n(115),o=n(217),u=n(41),a=n(384),f=n(362),l=n(10),c=n(505),h=n(268),p=Object(r.__assign)(Object(r.__assign)({},c.e),{key:h.n,minWidth:32,maxWidth:32}),d=n(2727),v=n(902),m=n(1075),g=n(53),y=n(953),b=n(670),w=n(26),E=n(139),S=Object(g.i)({name:m.e.dateSharedColumnHeaderText,key:h.e,fieldName:"",minWidth:g.e.regularMin,maxWidth:g.e.regularMax,isCollapsable:!0,sortProps:g.t},b.e)(function(e,t){var n=e.demandItemFacet(y.e,t),r=n&&new Date(n.sharedDateTime).getTime();if("number"!=typeof r||isNaN(r))return{text:""};var i=e.demandItemFacet(w.S,E.e);return i&&i.language||window.navigator.language?{text:Object(v.r)(new Date(r),!1)}:{dateValue:r}}),x=n(583),T=n(266),N=n(3446),C=n(2661),k=n(3120),L=n("react-lib"),A=n(1321),O=n(554),M=n(23),_=n(1372),D=n(3689),P=(function(e){Object(r.__extends)(t,e);function t(t){return e.call(this,t)||this}t.prototype.render=function(){var e=this.props,t=e.userName,n=e.isPlaceholder,r=L.createElement(O.e,{className:"topCollaboratorIcon_77af8729",iconName:"TeamFavorite"}),i=L.createElement("span",{className:"topCollaboratorUserName_77af8729"},t),s=L.createElement("div",{className:"topCollaboratorTooltip_77af8729"},M.formatToArray(D.e.topCollaboratorWith,i));return L.createElement("div",{className:"topCollaPlaceHolder_77af8729"},n?null:t?L.createElement(_.e,{content:s},r):r)};return t})(A.e),H=n(8),B=Object(g.i)({name:m.e.sharedByColumnHeaderText,key:h.i,fieldName:"",minWidth:g.e.regularMin,maxWidth:g.e.regularMax,isCollapsable:!0,sortProps:g.r,headerClassName:"columnHeader_77af8729"},x.e)(function(e,t){var n=e.demandItem({shareByPerson:N.e},t).shareByPerson,r=e.demandItem({sharedBy:y.e},t).sharedBy,i=n&&n.itemKey,s=n&&n.displayValue||r&&r.sharedBy&&r.sharedBy.user&&r.sharedBy.user.displayName,o=!1;if(i&&C.e.matches(i)){var u=C.e.deserialize(i).email,a=e.demandItemFacet(H.e,k.e.serialize({endpoint:"https://graph.microsoft.com/beta"}));a&&(o=a.itemKeys.slice(0,3).some(function(t){var n=e.demandItemFacet(T.e,t);return!!n&&n===u}))}return i||s?{people:[{itemKey:i||"",displayValue:s}],onRenderUser:function(e,t){if(!e||!t)return null;var n=t(e),r=e.user;return L.createElement("div",{className:"userWithTopCollaborator_77af8729"},L.createElement(P,{userName:r.title,isPlaceholder:!o}),n)}}:{people:[]}},function(e,t){return""+e.demandItemFacet(T.e,t)}),j=Object(l.t)()(function(){return function(e){return I}});var F=[p,d.e,S,B];function I(e,t){return{columns:F}}var q=n(6),R=n(681),U=n(158),z=n(274),W=n(77),X=n(799),V=n(1623),$=n(2331),J=n(3645),K=n(2974),Q=n(5),G=new Q.e("driveItem",{endpoint:Object(Q.s)(),driveId:Object(Q.s)({shouldNormalizeToEmpty:!0}),canonicalUrl:Object(Q.s)()}),Y=n(129);function Z(e){var t,n,i,s,o=e.driveItemResponse,u=e.endpoint,a=e.getDriveItemFacets,f=void 0===a?$.e:a,l=o.remoteItem,c=l&&l.parentReference,h=o.parentReference,p=h||c,d=p&&p.driveId,v=p&&p.id,m="personal"===(p&&p.driveType),g=!!o.root;if(l){s=l.id;c&&(d=c.driveId)}else s=m&&o.root?K.n:o.id;var y={endpoint:u,driveId:d,itemId:s},b=W.e.serialize(y),w=o&&(o.webDavUrl||o.webUrl),E=m&&p&&p.path===K.e?K.n:v||void 0,S=p&&E?W.e.serialize({endpoint:u,driveId:p.driveId||d,itemId:E}):void 0,x=[],T="";if(w){var N=new Y.e(w);x.push.apply(x,N.path.split("/").slice(1,-1).map(function(e){return decodeURIComponent(e)}));x.unshift(N.authority);T=x.join("/")}p&&!g&&!E&&T&&(S=G.serialize({endpoint:u,driveId:p.driveId,canonicalUrl:T}));var C=Object(J.e)(Object(r.__assign)(Object(r.__assign)({},e),{itemKey:b,driveItemKey:y,parentFolderItemKey:S})).itemResolver;C.resolveItems({items:Object(r.__assign)({},S&&(t={},t[S]=Object(r.__assign)({},T?q.L.pack(T):{}),t))});if(l&&c){var k=W.e.serialize({endpoint:u,driveId:h&&h.driveId,itemId:o.id}),L=W.e.serialize({endpoint:u,driveId:c.driveId,itemId:l.id});C.mapKeys({mappings:(n={},n[k]=L,n)});C.resolveItems({items:(i={},i[L]=Object(r.__assign)({},f({driveItem:o,endpoint:u})),i)})}return{itemResolver:C,actualDriveItemKey:y,actualItemKey:b}}var ee=n(120),te=n(146),ne=n(59);function re(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=e.endpoint;i=n(Object(te.e)({getUserOneDriveEndpoint:ne.l,graphEndpoint:ne.c})),s=i.getUserOneDriveEndpoint;return(o=i.graphEndpoint)&&t!==o&&s?[4,n(s({endpoint:t}))]:[3,2];case 1:u=r.sent();t=u;r.label=2;case 2:return[2,t]}})})}}var ie=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=W.e.deserialize(n);return function(s){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,o,u,a,f,l,c,h,p,d;return Object(r.__generator)(this,function(v){switch(v.label){case 0:t=i;return i.driveId&&"me"!==i.driveId?[3,2]:[4,s(re({endpoint:i.endpoint}))];case 1:(o=v.sent())!==i.endpoint&&(t=Object(r.__assign)(Object(r.__assign)({},i),{endpoint:o}));v.label=2;case 2:u=Object(X.n)(t);return[4,s(Object(V.r)({url:Object(X.t)(t)+"?$expand=thumbnails",driveUrl:u,qosName:"getItem",endpoint:t.endpoint}))];case 3:a=v.sent();f=Z({driveItemResponse:a,endpoint:t.endpoint}),l=f.itemResolver,c=f.actualItemKey;l.resolveItems({items:(h={},h[e.itemKey]=Object(r.__assign)({},ee.r.pack(W.e)),h)});l.mapKeys({mappings:(p={},p[c]=n,p)});i.driveId&&"me"!==i.driveId||l.mapKeys({mappings:(d={},d[W.e.serialize(Object(r.__assign)(Object(r.__assign)({},i),{driveId:"me"}))]=W.e.serialize(Object(r.__assign)(Object(r.__assign)({},i),{driveId:""})),d[n]=W.e.serialize(t),d)});s(l.execute());return[2]}})})}});var se=n(507),oe=n(941),ue=n(3872),ae=n(3447),fe=n(721),le=n(2447),ce=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=se.e.deserialize(n).driveItemKey,s=i.endpoint;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,o,u,a,f,l,c,h,p,d=this;return Object(r.__generator)(this,function(v){t={Caller:"HoverCard"};o=e(Object(te.e)({enableCookiesForAnalyticsRequests:ne.s})).enableCookiesForAnalyticsRequests,u=void 0!==o&&o;a="GetItemAnalytics_addon-graph";f=Object(r.__awaiter)(d,void 0,void 0,function(){var o,f,l,c,h,p;return Object(r.__generator)(this,function(d){switch(d.label){case 0:return[4,e(Object(V.r)({url:(v=Object(X.t)(i),m=he(v),g="$expand=analytics($expand=allTime($expand=activities))",y="$select=*,id,reactions,trending",b=y+"&"+g+",insights($expand=keyPoints)",w=m+"?"+b,w),qosName:a+"_GetAnalyticsSections",endpoint:s,timeout:6e3,headers:t,driveUrl:he(Object(X.n)(i)),allowCookies:u}))];case 1:o=d.sent();f=Object(ue.t)(o);if(l=f.createdBy){c=C.e.serialize({email:l.email,endpoint:s});e(Object(U.e)({items:(h={},h[c]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},q.l.pack(l.displayName)),T.e.pack(l.email)),T.t.pack(l.image)),T.n.pack(l.id)),h[n]=Object(r.__assign)({},oe.r.pack({itemKey:c,displayValue:l.displayName})),h)}))}e(Object(U.e)({items:(p={},p[n]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},oe.h.pack(f.viewCount)),oe.p.pack(f.viewerCount)),oe.o.pack(f.isTrending)),oe.e.pack(f.activities)),oe.f.pack(f.likeCount)),oe.t.pack(f.commentCount)),oe.a.pack(f.lifeCycleStatus)),oe.u.pack(f.keyPointsData)),oe.s.pack(f.incompleteData)),oe.i.pack(f.createdDateTime)),p)}));return[2]}var v,m,g,y,b,w})});l=[f];c=Object(r.__awaiter)(d,void 0,void 0,function(){var o,f,l,c;return Object(r.__generator)(this,function(h){switch(h.label){case 0:return[4,e(Object(V.r)({url:(p=Object(X.t)(i),d=he(p),d+"?$expand=recommendedActionSet($expand=nonAggregatedRecommendedActions,aggregatedEditRecommendedAction($expand=importantActorsAndActivities)),conversationSet($expand=emailConversations($expand=participants),meetingConversations($expand=participants),teamsConversations($expand=participants))"),qosName:a+"_GetRecommendedActionsAndConversations",endpoint:s,timeout:6e3,headers:t,driveUrl:he(Object(X.n)(i)),allowCookies:u}))];case 1:o=h.sent();f=(function(e){var t=e.recommendedActionSet,n=t.nonAggregatedRecommendedActions;t.aggregatedEditRecommendedAction&&t.aggregatedEditRecommendedAction.recentEditorCount&&(n=n.concat(t.aggregatedEditRecommendedAction));return n})(o);l=(function(e){var t=e.conversationSet,n=t.emailConversations.concat(t.meetingConversations,t.teamsConversations),r={},i=[];n.forEach(function(e){var t=e.teamsMessageThreadId||e.conversationInstance.conversationId;if(!r.hasOwnProperty(t)){r[t]=!0;i.push({activityTimestamp:e.conversationInstance.sharedByTime,context:e.conversationInstance.subject,conversationType:ae.e[e.conversationInstance.referenceType],deepLink:e.conversationInstance.deepLink,referencePreview:e.conversationInstance.referencePreview,isSharedByMe:e.conversationInstance.isSharedByMe,sharedByUserDisplayName:e.sharedByUser.displayName,sharedByUserEmail:e.sharedByUser.email,participants:e.participants})}});return i.sort(function(e,t){return Date.parse(t.activityTimestamp)-Date.parse(e.activityTimestamp)})})(o);e(Object(U.e)({items:(c={},c[n]=Object(r.__assign)(Object(r.__assign)({},oe.l.pack(f)),oe.n.pack(l)),c)}));return[2]}var p,d})});l.push(c);if(Object(le.t)()){h=Object(r.__awaiter)(d,void 0,void 0,function(){var o,f;return Object(r.__generator)(this,function(l){switch(l.label){case 0:return[4,e(Object(V.r)({url:(c=Object(X.t)(i),h=he(c),h+"/recommendations/shareWith/users?$top=2&$filter=userType eq 'Internal'"),driveUrl:he(Object(X.n)(i)),qosName:a+"_GetShareWithPeople",endpoint:s,timeout:6e3,headers:t,allowCookies:u}))];case 1:o=l.sent();e(Object(U.e)({items:(f={},f[n]=Object(r.__assign)({},oe.c.pack(o.value)),f)}));return[2]}var c,h})});l.push(h)}else e(Object(U.e)({items:(p={},p[n]=Object(r.__assign)({},oe.c.pack([])),p)}));return[2,Object(fe.e)(l)]})})}});function he(e){return e.replace("2.0","2.1")}var pe=new Q.e("specialDriveItem",{endpoint:Object(Q.s)(),driveId:Object(Q.s)({shouldNormalizeToEmpty:!0}),name:Object(Q.s)()}),de=n(2152),ve=n(159),me=n(93),ge=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=pe.deserialize(n),s=i.driveId,o=i.endpoint,u=Object(X.n)(i);return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,a,f,l,c,h,p,d,v;return Object(r.__generator)(this,function(m){switch(m.label){case 0:return[4,e(Object(V.n)({url:Object(X.i)(i),driveUrl:u,qosName:"getItem",endpoint:o}))];case 1:t=m.sent();a=new ve.e;f=t&&t.parentReference;l=f&&f.driveId;c={endpoint:o,driveId:l||s,itemId:t.id};h=W.e.serialize(c);p=f&&f.id?W.e.serialize({endpoint:o,driveId:l,itemId:f.id}):void 0;a.resolveItems({items:(d={},d[h]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},Object($.e)({driveItem:t,endpoint:o,parentFolderItemKey:p})),me.r.pack(W.e)),H.t.pack({itemKey:de.e.serialize({driveItemKey:c,sortBy:"",isAscending:!0})})),d)});a.mapKeys({mappings:(v={},v[h]=n,v)});e(a.execute());return[2]}})})}});var ye=new Q.e("driveItemPage",{endpoint:Object(Q.s)(),setItemKey:Object(Q.s)(),token:Object(Q.s)()}),be=n(172),we=n(206);function Ee(e){return e.reduce(function(e,t){return e&&t?"("+e+" or "+t+")":t||e})}function Se(e){return e.reduce(function(e,t){return e&&t?"("+e+" and "+t+")":t||e})}function xe(e){return function(t){for(var n=void 0,r=void 0,i=0;i<e.length;i++){var s=e[i],o=!1,u=s;if("!"===s[0]){u=s.slice(1);o=!0}if("."===u[0])if(t.name){var a=new RegExp(u.toLocaleLowerCase()+"$"),f=t.name.toLocaleLowerCase().split(a),l=2===f.length&&""===f[1]||!1;o?n=void 0!==n?n&&!l:l:r=r||l}else{n=!1;r=!1}else if("folder"===u){var c=void 0!==t.folder||void 0!==t.remoteItem&&void 0!==t.remoteItem.folder||!1;o?n=void 0!==n?n&&!c:c:r=r||c}else if("onenote"===u){var h=t.package&&"oneNote"===t.package.type||t.remoteItem&&t.remoteItem.package&&"oneNote"===t.remoteItem.package.type||!1;o?n=void 0!==n?n&&!h:h:r=r||h}}return void 0===r?void 0!==n&&n:(void 0===n||n)&&!r}}var Te=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=ye.deserialize(n),s=i.setItemKey,o=i.endpoint,u=i.token,a=Q.e.get(s).deserialize(s),f=a.extFilters,l=a.driveItemKey,c=Object(X.n)(l);return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,a,l,h,p,d,v,m,g,y,b,w,E,S,x;return Object(r.__generator)(this,function(T){switch(T.label){case 0:return[4,e(Object(V.n)({endpoint:o,url:u,driveUrl:c,qosName:"getChildrenPage"}))];case 1:t=T.sent();i=f&&f.length>0?xe(f):void 0;a=new ve.e;l=[];h=0,p=t.value;T.label=2;case 2:if(!(h<p.length))return[3,5];d=p[h];if(!!i&&i(d))return[3,4];v=d&&(d.parentReference||d.remoteItem&&d.remoteItem.parentReference);m=v&&v.driveId;g=W.e.serialize({itemId:d.id,driveId:m,endpoint:o});y=v?W.e.serialize({itemId:v.id,driveId:m,endpoint:o}):void 0;l.push(g);a.resolveItems({items:(x={},x[g]=Object(r.__assign)(Object(r.__assign)({},Object($.e)({driveItem:d,endpoint:o,parentFolderItemKey:y})),Object(be.e)().forFacet(q.l).thenInvalidate(n,H.e).forFacet(q.f).thenInvalidate(n,H.e).pack()),x)});return(b=e(Object(te.e)({processDriveItemFromSharePoint:ne.g})).processDriveItemFromSharePoint)?[4,e(b.process({itemKey:g,driveItem:d}))]:[3,4];case 3:w=T.sent().itemResolver;a.merge(w);T.label=4;case 4:h++;return[3,2];case 5:if(E=t["@odata.nextLink"]){S=ye.serialize({setItemKey:s,endpoint:o,token:E});a.merge(Object(we.t)({itemKey:S}).itemResolver);l.push(S)}a.merge(Object(we.e)({itemKey:n,itemSetKey:s,childItemKeys:l}).itemResolver);e(a.execute());return[2]}})})}});var Ne=n(398),Ce=n(494),ke=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=Ne.e.deserialize(n);return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s;return Object(r.__generator)(this,function(u){(t=new ve.e).resolveItems({items:(s={},s[n]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},H.t.pack({itemKey:o.e.serialize({driveItemKey:i,sortBy:"",isAscending:!0})})),q.l.pack(Ce.e.sharedWithMe)),q.d.pack({})),q.A.pack(void 0)),s)});e(t.execute());return[2]})})}});var Le=n(312),Ae=n(331),Oe=n(48),Me=n(116),_e=n(46),De=n(2),Pe=new De.e("itemSetEngagementExtraData");var He=n(123),Be=n(97);function je(e){var t=e.itemKey,n=e.itemSetKeyFacet,i=e.parentItemKeyFacet,s=e.childItemsResponse,o=e.parentItemResponse,u=e.mapItemSetKey,a=n.deserialize(t),f=i.serialize(a.driveItemKey),l=a.driveItemKey.endpoint;return function(n){var i;Be.r(He.e.processData.start);var a=n((function(e){return function(t){var n,i,s,o,u,a=e.itemKey,f=e.parentItemKey,l=e.itemSetKeyFacet,c=e.filterChildItems,h=e.onProcessResponse,p=e.groupChildItems,d=e.response,v=e.skip,m=void 0===v?0:v,g=e.enableRandomAccess,y=void 0!==g&&g,b=e.totalChildCount,w=e.getDriveItemFacets,E=l.deserialize(a),S=E.driveItemKey.endpoint,x=new ve.e,T=t(Object(Ae.e)({name:"remoteItemsMissingParentRef"})),N="number"==typeof d["@odata.count"]?d["@odata.count"]:b||d.value.length,C=d["@odata.nextLink"],k=!!C,L=t(Object(Me.e)(function(e){return{childItemsFacetResolved:e.isItemFacetResolved(H.e,a),prevChildKeys:e.demandItemFacet(H.e,a)}})),A=L.childItemsFacetResolved,O=L.prevChildKeys,M=O&&O.itemKeys,_=0,D=0;y&&(A&&M?u=M.slice(0):"number"==typeof N&&(u=new Array(N+(k&&N<=d.value.length?1:0))));u||(u=new Array(d.value.length+(k?1:0)));for(var P=m,B=0,j=0,F=d.value;j<F.length;j++){var I=F[j],q=c&&c(I),R=I.remoteItem,U=!(I.remoteItem&&I.remoteItem.parentReference&&I.remoteItem.parentReference.driveId),z=R&&U;z&&B++;if(q||z){u.splice(P,1);N--}else{var W=I.webDavUrl||I.remoteItem&&I.remoteItem.webDavUrl||I.webUrl,X=t(Object(te.e)({graphEndpoint:ne.c,graphRecentEndpoint:ne.h,processDriveItemSet:ne.y})),V=X.graphEndpoint,$=X.graphRecentEndpoint,J=X.processDriveItemSet,K=S.indexOf("/_api/v2.0")>-1||S.indexOf("/_api/v2.1")>-1,Q=V||$;if(W&&K){var G=W&&decodeURIComponent(W);S=Q?new Y.e(G).authority+"/_api/v2.0":""+new Y.e(G).authority+new Y.e(S).path}var ee=Z({shouldInvalidateItemSetOnChildItemRename:J&&J.shouldInvalidateItemSetOnChildItemRename,setItemKey:a,driveItemResponse:I,endpoint:S,getDriveItemFacets:w}),re=ee.itemResolver,ie=ee.actualItemKey,se=ee.actualDriveItemKey,oe=I.thumbnails,ue=I.remoteItem;_++;(oe||ue&&ue.thumbnails)&&D++;u[P]=ie;x.merge(re);if(h){var ae=h({itemKey:a,driveItemKey:se,item:I});ae&&x.merge(ae.itemResolver)}var fe=t(Object(te.e)({processDriveItemFromSharePoint:ne.g})).processDriveItemFromSharePoint;if(fe&&(K||Q)){var le=t(fe.process({itemKey:ie,driveItem:I})).itemResolver;x.merge(le)}P++}}t(T(Object(r.__assign)({resultType:B<1?Oe.e.Success:Oe.e.Failure},B>0?{extraData:{count:B}}:{})));if(k){var ce=ye.serialize({setItemKey:a,endpoint:S,token:C});x.merge(Object(we.t)({itemKey:ce}).itemResolver);u[P]=ce}if(p){var he=p(E);he&&x.merge(he.itemResolver)}else x.resolveItems({items:(n={},n[a]=Object(r.__assign)({},H.e.pack({itemKeys:u})),n)});x.resolveItems({items:(i={},i[a]=Object(r.__assign)({},Pe.pack({childCount:_,childCount_withThumbnail:D})),i)});N!==b&&x.resolveItems({items:(s={},s[f]=Object(r.__assign)({},_e.e.pack(N)),s)});x.resolveItems({items:(o={},o[a]=Object(r.__assign)(Object(r.__assign)({},H.s.pack({itemKey:f})),Object(be.e)().forFacet(H.e).thenInvalidate(Le.e).pack()),o)});return{itemResolver:x}}})(Object(r.__assign)(Object(r.__assign)({},e),{response:s,parentItemKey:f}))).itemResolver;if(u){var c=u().itemResolver;a.merge(c)}if(o){var h=Z({setItemKey:t,driveItemResponse:o,endpoint:l}).itemResolver;a.merge(h)}a.resolveItems({items:(i={},i[f]=Object(r.__assign)({},Object(be.e)().forFacet(H.t).thenInvalidate(e.itemKey,H.e).pack()),i)});Be.r(He.e.processData.end);return{itemResolver:a}}}function Fe(e){var t=this,n=e.itemKey,i=e.itemSetKeyFacet,s=e.getUrl,o=e.sortChildItems,u=e.qosName,a=e.preprocessResponse,f=e.expectedErrors,l=i.deserialize(n),c=l.driveItemKey.endpoint;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,h,p,d;return Object(r.__generator)(this,function(v){switch(v.label){case 0:t=Object(X.n)(l.driveItemKey);return[4,n(Object(V.r)({url:s(l),driveUrl:t,qosName:"getChildren"+(u?"."+u:""),endpoint:c,headers:e.additionalHeaders,expectedErrors:f}))];case 1:i=v.sent();h=Object(r.__spreadArrays)(i.value);p=a?a(h):i.value;d=o?o(p):p;return[4,n(je(Object(r.__assign)(Object(r.__assign)({},e),{childItemsResponse:Object(r.__assign)(Object(r.__assign)({},i),{value:d})})))];case 2:return[2,{itemResolver:v.sent().itemResolver}]}})})}}var Ie=n(70),qe=n(648),Re=n(1509),Ue=n(207);function ze(e,t){var n=new Date(e.valueOf());n.setDate(n.getDate()-t);return n}var We=n(1816),Xe="fileName",Ve="sharedByName",$e="dateModified";var Je=new Map([["code",Ie.e.text],["csv",Ie.e.excel],["docx",Ie.e.word],["dotx",Ie.e.word],["one",Ie.e.onenote],["onepkg",Ie.e.onenote],["onetoc",Ie.e.onenote],["pdf",Ie.e.pdf],["photo",Ie.e.media],["potx",Ie.e.powerpoint],["ppsx",Ie.e.powerpoint],["pptx",Ie.e.powerpoint],["rtf",Ie.e.text],["txt",Ie.e.text],["video",Ie.e.media],["xlsx",Ie.e.excel],["xltx",Ie.e.excel],["zip",Ie.e.zip]]);function Ke(e,t){var n,r,i=(n=e,r=Object(qe.t)(n,!0),Object(Re.t)(r)),s=Je.get(i);return!!s&&Object(Ie.t)(t.filters,s)}function Qe(e,t){void 0===t&&(t=[]);return t.every(function(t){var n,r=!(t.type===Ve)||(function(e,t){var n=e.remoteItem&&e.remoteItem.shared&&e.remoteItem.shared.sharedBy&&e.remoteItem.shared.sharedBy.user&&e.remoteItem.shared.sharedBy.user.displayName;return!!n&&t.indexOf(n)>-1})(e,t.values),i=!(t.type===Xe)||(function(e,t){return!!e.name&&Ke(e.name,t)})(e,Object(Ue.t)(t.values)),s=!(t.type===$e)||(function(e,t){var n=e.lastModifiedDateTime||"";return(n&&new Date(n))>=t})(e,(function(e){var t=new Date,n=new Date(t.getFullYear(),t.getMonth(),t.getDate());switch(e){case We.e.today:return n;case We.e.yesterday:return ze(n,1);case We.e.last7Days:return ze(n,7);case We.e.last30Days:return ze(n,30);case We.e.last3Months:return ze(n,90);default:return new Date(0)}})((n=t.values).length<1||-1===Object.keys(We.e).indexOf(n[0])?We.e.none:We.e[n[0]]));return r&&i&&s})}var Ge=n(235);function Ye(e,t,n){var r=e.lastModifiedDateTime,i=t.lastModifiedDateTime,s=r&&i&&new Date(r).getTime()-new Date(i).getTime()||0,o=r&&i&&new Date(i).getTime()-new Date(r).getTime()||0;return n?s:o}function Ze(e,t,n){var r=e&&e.remoteItem&&e.remoteItem.shared&&e.remoteItem.shared.sharedDateTime,i=t&&t.remoteItem&&t.remoteItem.shared&&t.remoteItem.shared.sharedDateTime,s=r&&i&&new Date(r).getTime()-new Date(i).getTime()||0,o=r&&i&&new Date(i).getTime()-new Date(r).getTime()||0;return n?s:o}function et(e,t,n){var r=e.name,i=t.name,s=r&&i&&r.localeCompare(i)||0,o=r&&i&&i.localeCompare(r)||0;return n?s:o}function tt(e,t,n){var r=e.remoteItem&&e.remoteItem.shared&&e.remoteItem.shared.sharedBy&&e.remoteItem.shared.sharedBy.user&&e.remoteItem.shared.sharedBy.user.displayName,i=t.remoteItem&&t.remoteItem.shared&&t.remoteItem.shared.sharedBy&&t.remoteItem.shared.sharedBy.user&&t.remoteItem.shared.sharedBy.user.displayName,s=r&&i&&r.localeCompare(i)||0,o=r&&i&&i.localeCompare(r)||0;return n?s:o}function nt(e,t,n,i){return(function(e,t){return Object(r.__spreadArrays)(e).sort(t)})(e,function(e,r){var s=e.folder,o=r.folder;return n&&s&&!o?-1:n&&!s&&o?1:i(e,r,t)})}var rt=n(3448),it=n(3686),st=n(489),ot=n(33),ut=n(3687);function at(e){if(o.e.matches(e)){var t=o.e.deserialize(e).groupBy;if(t===h.t[h.i])return(function(e){var t={};return{onProcessResponse:function(e){var n,r=e.driveItemKey,i=e.item;if(i&&r){var s=i.remoteItem,o=s&&s.shared&&s.shared.sharedBy,u=o&&o.user,a=W.e.serialize(r);if(u&&u.email){var f=rt.n.serialize({displayName:u.displayName,email:u.email});if(n=f,t.hasOwnProperty(n))t[f].push(a);else{t[f]=[];t[f].push(a)}}}},groupChildItems:function(n){for(var i,s,o=new ve.e,u=(function(e){for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n];if(!rt.n.matches(i))return e;var s=rt.n.deserialize(i);t.push(s)}return t.sort(function(e,t){return e&&t&&e.displayName.localeCompare(t.displayName)}).map(function(e){return rt.n.serialize(e)})})(Object.keys(t)),a=[],f=0,l=u;f<l.length;f++){var c=l[f];if(rt.n.matches(c)){var h=rt.n.deserialize(c);o.resolveItems({items:(i={},i[c]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},q.l.pack(h.displayName)),_e.s.pack(!0)),H.e.pack({itemKeys:t[c]})),i)});a.push(c)}}o.resolveItems({items:(s={},s[e]=Object(r.__assign)(Object(r.__assign)({},H.e.pack({itemKeys:a})),ot.e.pack(!0)),s)});return{itemResolver:o}}}})(e);if(t===h.t[h.e])return(function(e){var t={};return{onProcessResponse:function(e){var n,r=e.driveItemKey,i=e.item;if(i&&r){var s=i.remoteItem,o=s&&s.shared&&s.shared.sharedDateTime,u=W.e.serialize(r);if(o){var a=(function(e,t){if(!e)return it.e.older;var n=new Date(t.getFullYear(),t.getMonth(),t.getDate());if(e>=n)return st.e.today;n.setDate(n.getDate()-1);if(e>=n)return st.e.yesterday;n.setDate(t.getDate()-t.getDay());if(e>=n)return it.e.thisWeek;n.setDate(n.getDate()-7);if(e>n)return it.e.lastWeek;var r=new Date(t.getFullYear(),t.getMonth(),1),i=new Date(t.getFullYear(),t.getMonth()-1,1);if(e>=i&&e<r)return it.e.lastMonth;n.setDate(n.getDate()-7);if(e>n)return it.e.twoWeeksAgo;n.setDate(n.getDate()-7);if(e>n)return it.e.threeWeeksAgo;if(e>=r)return it.e.thisMonth;var s=t.getFullYear()===e.getFullYear(),o=ut.e[e.getMonth()];if(s)return o;return M.format(st.e.MonthAndYear,o,e.getFullYear())})(new Date(o),new Date),f=rt.e.serialize({relativeTime:a,sharedDateTime:o});if(n=f,t.hasOwnProperty(n))t[f].push(u);else{t[f]=[];t[f].push(u)}}}},groupChildItems:function(n){for(var i,s,o=new ve.e,u=(function(e){for(var t={},n=(function(e){for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n];if(!rt.e.matches(i))return e;var s=rt.e.deserialize(i);t.push(s)}return t.sort(function(e,t){return e&&t&&new Date(t.sharedDateTime).getTime()-new Date(e.sharedDateTime).getTime()}).map(function(e){return rt.e.serialize(e)})})(Object.keys(e)),r=function(e){return t.hasOwnProperty(e)},i=0,s=n;i<s.length;i++){var o=s[i];if(rt.e.matches(o)){var u=rt.e.deserialize(o).relativeTime,a=rt.t.serialize({relativeTime:u});if(r(a))for(var f=e[o],l=0,c=f;l<c.length;l++){var h=c[l];t[a].push(h)}else{t[a]=[];f=e[o];for(var p=0,d=f;p<d.length;p++){h=d[p];t[a].push(h)}}}}return t})(t),a=[],f=0,l=Object.keys(u);f<l.length;f++){var c=l[f];if(rt.t.matches(c)){var h=rt.t.deserialize(c).relativeTime;o.resolveItems({items:(i={},i[c]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},q.l.pack(h)),_e.s.pack(!0)),H.e.pack({itemKeys:u[c]})),i)});a.push(c)}}o.resolveItems({items:(s={},s[e]=Object(r.__assign)(Object(r.__assign)({},H.e.pack({itemKeys:a})),ot.e.pack(!0)),s)});return{itemResolver:o}}}})(e)}return{onProcessResponse:void 0,groupChildItems:void 0}}var ft=Object(i.i)()(function(e){var t=this,n=o.e.deserialize(e.itemKey),i=n.filters,s=n.sortBy,u=n.isAscending;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,a,f,l,c,p,d,v;return Object(r.__generator)(this,function(m){switch(m.label){case 0:t=at(e.itemKey),a=t.onProcessResponse,f=t.groupChildItems;l=o.e.deserialize(e.itemKey);c=l.driveItemKey.endpoint;p=n(Object(te.e)({graphSharedWithMeEndpoint:ne.p})).graphSharedWithMeEndpoint;c=p||c;return[4,n(Object(V.i)(c))];case 1:d=m.sent();return[4,n(Fe(Object(r.__assign)(Object(r.__assign)({},e),{qosName:"sharedWithMe",itemSetKeyFacet:o.e,parentItemKeyFacet:Ne.e,getUrl:function(e){return d?c+"/drive/view.sharedWithMe?allowExternal=true":c+"/me/drive/sharedWithMe?expand=formats&allowExternal=true&$top=500"},filterChildItems:function(e){return!Qe(e,i)},sortChildItems:function(e){return(function(e,t,n,r){void 0===r&&(r=!1);var i=h.t[h.e],s=h.t[h.i],o=h.t[Ge.t],u=h.t[h.r],a=h.t[Ge.r];switch(t){case i:return nt(e,n,r,Ze);case s:return nt(e,n,r,tt);case o:case a:return nt(e,n,r,et);case u:return nt(e,n,r,Ye);default:return e}})(e,s,u,!0)},onProcessResponse:a,groupChildItems:f})))];case 2:v=m.sent().itemResolver;n(v.execute());return[2]}})})}});var lt=new Q.e("sharedByMeRootItem",{endpoint:Object(Q.s)()}),ct=new Q.e("sharedByMeItemSet",{driveItemKey:Object(Q.o)(W.e)}),ht=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=lt.deserialize(n);return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s;return Object(r.__generator)(this,function(o){(t=new ve.e).resolveItems({items:(s={},s[n]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},H.t.pack({itemKey:ct.serialize({driveItemKey:i})})),q.l.pack(Ce.e.sharedByMe)),q.d.pack({})),q.A.pack(void 0)),s)});e(t.execute());return[2]})})}});var pt=Object(i.i)()(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(i){switch(i.label){case 0:return[4,n(Fe(Object(r.__assign)(Object(r.__assign)({},e),{qosName:"sharedByMe",itemSetKeyFacet:ct,parentItemKeyFacet:lt,getUrl:function(e){return e.driveItemKey.endpoint+"/drive/shared"}})))];case 1:t=i.sent().itemResolver;n(t.execute());return[2]}})})}});var dt=n(406),vt=n(218),mt=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=vt.e.deserialize(n);return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s,o;return Object(r.__generator)(this,function(u){t=e(Object(te.e)({groupBy:ne.w})).groupBy;(s=new ve.e).resolveItems({items:(o={},o[n]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},H.t.pack({itemKey:dt.e.serialize({driveItemKey:i,sortBy:"",isAscending:!0,groupBy:t||""})})),q.l.pack(Ce.e.recentTitle)),q.d.pack({})),q.A.pack(void 0)),o)});e(s.execute());return[2]})})}});var gt=n(987),yt=n(289),bt=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=yt.e.deserialize(n);return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s;return Object(r.__generator)(this,function(o){(t=new ve.e).resolveItems({items:(s={},s[n]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},H.t.pack({itemKey:gt.e.serialize({driveItemKey:i,sortBy:"",isAscending:!0})})),q.l.pack(Ce.e.saved)),q.d.pack({})),q.A.pack(void 0)),s)});e(t.execute());return[2]})})}});var wt,Et=n(118),St=new Q.e("recentGroup",{relativeTime:Object(Q.s)()});(function(e){e.today="Today";e.yesterday="Yesterday";e.thisWeek="This week";e.lastWeek="Last week";e.twoWeeksAgo="Two weeks ago";e.threeWeeksAgo="Three weeks ago";e.thisMonth="This month";e.lastMonth="Last month";e.twoMonthsAgo="Two months ago";e.older="Older"})(wt||(wt={}));function xt(e){var t=new Date;return(function(e,t){return Tt(t,e)})(e,t)?wt.today:(function(e,t){return Tt(new Date(t.getTime()-864e5),e)})(e,t)?wt.yesterday:(function(e,t){var n=t.setHours(0,0,0,0)-864e5*t.getDay();return e.getTime()>n})(e,t)?wt.thisWeek:(function(e,t){var n=t.setHours(0,0,0,0)-864e5*(t.getDay()+7);return e.getTime()>n})(e,t)?wt.lastWeek:(function(e,t){var n=t.setHours(0,0,0,0)-12096e5;return e.getTime()>n})(e,t)?wt.twoWeeksAgo:(function(e,t){var n=t.setHours(0,0,0,0)-18144e5;return e.getTime()>n})(e,t)?wt.threeWeeksAgo:(function(e,t){return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()})(e,t)?wt.thisMonth:(function(e,t){var n=t.getMonth(),r=e.getMonth();return n-r==11||t.getFullYear()===e.getFullYear()&&t.getMonth()-e.getMonth()==1})(e,t)?wt.lastMonth:(function(e,t){var n=t.getFullYear(),r=e.getFullYear(),i=t.getMonth(),s=e.getMonth(),o=n-r==1&&i-s==-10;return n===r&&i-s==2||o})(e,t)?wt.twoMonthsAgo:""}function Tt(e,t){return e.toDateString()===t.toDateString()}var Nt=["January","February","March","April","May","June","July","August","September","October","November","December"],Ct=n(3118);var kt=function(e,t){var n=new RegExp("^"+t+"\\/","i");return e.filter(function(e){var t=e&&e.remoteItem||e;return!(!t||!t.file)&&n.test(t.file.mimeType)})},Lt=Object(i.i)()(function(e){var t=this,n=dt.e.deserialize(e.itemKey),i=n.filters,s=void 0===i?[]:i,o=n.groupBy,u=void 0===o?"":o,a=n,f=Object(Ue.e)({extFilters:Object(Ue.t)(s),allowedMediaTypes:[Ie.e.photo,Ie.e.video],fileTypeIconMap:Et.e}),l=Object(Ue.e)({extFilters:Object(Ue.t)(s),allowedMediaTypes:[Ie.e.photo],fileTypeIconMap:Et.e}),c=Object(Ue.e)({extFilters:Object(Ue.t)(s),allowedMediaTypes:[Ie.e.video],fileTypeIconMap:Et.e});return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,o,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,B,j;return Object(r.__generator)(this,function(F){switch(F.label){case 0:if(!(t=n(Object(te.e)({graphRecentEndpoint:ne.h})).graphRecentEndpoint))return[3,1];a=Object(r.__assign)(Object(r.__assign)({},a),{driveItemKey:Object(r.__assign)(Object(r.__assign)({},a.driveItemKey),{endpoint:t})});return[3,3];case 1:return[4,n(re({endpoint:a.driveItemKey.endpoint}))];case 2:(i=F.sent())!==a.driveItemKey.endpoint&&(a=Object(r.__assign)(Object(r.__assign)({},a),{driveItemKey:Object(r.__assign)(Object(r.__assign)({},a.driveItemKey),{endpoint:i})}));F.label=3;case 3:o=dt.e.serialize(a);h=St.serialize({relativeTime:"today"});p=St.serialize({relativeTime:"yesterday"});d=St.serialize({relativeTime:"thisWeek"});v=St.serialize({relativeTime:"lastWeek"});m=St.serialize({relativeTime:"twoWeeksAgo"});g=St.serialize({relativeTime:"threeWeeksAgo"});y=St.serialize({relativeTime:"lastMonth"});b=St.serialize({relativeTime:"twoMonthsAgo"});w=[];E=[];S=[];x=[];T=[];N=[];C=[];k=[];L="";A="date"===u;O=function(e){var t,n=e.driveItemKey,i=e.item,s=new ve.e;if(i&&n){var o=i.remoteItem,u=o&&o.fileSystemInfo,a=u&&u.lastAccessedDateTime,f=W.e.serialize(n);if(A&&a){var l=new Date(a);switch(xt(l)){case wt.today:w.push(f);break;case wt.yesterday:E.push(f);break;case wt.thisWeek:S.push(f);break;case wt.lastWeek:x.push(f);break;case wt.twoWeeksAgo:T.push(f);break;case wt.threeWeeksAgo:N.push(f);break;case wt.lastMonth:C.push(f);break;case wt.twoMonthsAgo:k.push(f);L=Nt[l.getMonth()]}}s.resolveItems({items:(t={},t[f]=Object(r.__assign)({},q.d.pack(void 0)),t)});return{itemResolver:s}}};M=!f&&A?function(t){var n,i,s=new ve.e;s.resolveItems({items:(n={},n[h]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},q.l.pack("Today")),_e.s.pack(!0)),H.e.pack({itemKeys:w})),n[p]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},q.l.pack("Yesterday")),_e.s.pack(!0)),H.e.pack({itemKeys:E})),n[d]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},q.l.pack("This Week")),_e.s.pack(!0)),H.e.pack({itemKeys:S})),n[v]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},q.l.pack("Last Week")),_e.s.pack(!0)),H.e.pack({itemKeys:x})),n[m]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},q.l.pack("Two Weeks Ago")),_e.s.pack(!0)),H.e.pack({itemKeys:T})),n[g]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},q.l.pack("Three Weeks Ago")),_e.s.pack(!0)),H.e.pack({itemKeys:N})),n[y]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},q.l.pack("Last Month")),_e.s.pack(!0)),H.e.pack({itemKeys:C})),n[b]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},q.l.pack(L)),_e.s.pack(!0)),H.e.pack({itemKeys:k})),n)});var o=[];w.length>0&&o.push(h);E.length>0&&o.push(p);S.length>0&&o.push(d);x.length>0&&o.push(v);T.length>0&&o.push(m);N.length>0&&o.push(g);C.length>0&&o.push(y);k.length>0&&o.push(b);s.resolveItems({items:(i={},i[e.itemKey]=Object(r.__assign)({},H.e.pack({itemKeys:o})),i)});return{itemResolver:s}}:void 0;return[4,n(Object(V.i)(a.driveItemKey.endpoint))];case 4:_=F.sent();D=[{code:"notAllowed",message:"You do not have permission to create this personal site or you do not have a valid license"},{code:"notAllowed",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"notAllowed",message:"Operation not allowed"},{code:"BadRequest",message:"Tenant does not have a SPO license."},{code:"AccessDenied",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"UnknownError",message:"401 UNAUTHORIZED"},{code:"503"},{code:"ItemNotFound"},{code:"activityLimitReached"},{code:"serviceNotAvailable"}];return[4,n(Fe(Object(r.__assign)(Object(r.__assign)({},e),{qosName:f?"recentMedia":_?"ODC-recent":"recent",itemKey:o,itemSetKeyFacet:dt.e,parentItemKeyFacet:vt.e,getUrl:function(e){var t=e.driveItemKey.endpoint+"/"+(e.driveItemKey.endpoint.indexOf("/v2.")>-1?"drives/me":"me/drive")+"/recent?";if(_)t=e.driveItemKey.endpoint+"/drive/view.recent?";else if(f){return t+="$filter=(remoteItem/image ne null or remoteItem/video ne null)&$expand=thumbnails"}return""+t+(function(e){if(!e||0===e.length)return"";for(var t=[],n=[],i=0;i<e.length;i++){var s=e[i],o=!1,u=s;if("!"===s[0]){u=s.slice(1);o=!0}"folder"===u?!o&&t.push("folder ne null"):"onenote"===u?o?n.push("(remoteItem/package/type ne 'oneNote' and package/type ne 'oneNote')"):t.push("(remoteItem/package/type eq 'oneNote' or package/type eq 'oneNote')"):"."!==u[0]||!o&&t.push("(endsWith(name, '"+u.toLowerCase()+"') or endsWith(remoteItem/name, '"+u.toLowerCase()+"'))")}return t.length>0||n.length>0?"&$filter="+(0===n.length?Ee(t):0===t.length?Se(n):Se(Object(r.__spreadArrays)([Ee(t)],n))):""})(s)},getDriveItemFacets:function(e){var t=Object($.e)(e),n=e.driveItem,i=n.thumbnails,s=n.remoteItem,o=i||s&&s.thumbnails;return Object(r.__assign)(Object(r.__assign)({},t),o?Object(r.__assign)({},Ct.e.pack(!1)):{})},expectedErrors:D,preprocessResponse:function(e){l?e=kt(e,"image"):c&&(e=kt(e,"video"));return(function(e){if(!e)return e;return e.filter(function(e,t,n){return n.map(function(e){return e.id}).indexOf(e.id)===t})})(e.sort(function(e,t){var n=e.remoteItem&&e.remoteItem.fileSystemInfo&&e.remoteItem.fileSystemInfo.lastAccessedDateTime,r=t.remoteItem&&t.remoteItem.fileSystemInfo&&t.remoteItem.fileSystemInfo.lastAccessedDateTime;return n||r?n?r?n>r?-1:1:-1:1:0}))},additionalHeaders:f?{Prefer:"ApiVersion=2.1,RecentOnlyMediaApp,NoPreAuthThumbnailUrls"}:{Prefer:"ApiVersion=2.1;ODC,returnparentresource,returnowner"},onProcessResponse:O,groupChildItems:M})))];case 5:P=F.sent().itemResolver;f&&P.resolveItems({items:(B={},B[e.itemKey]=Object(r.__assign)({},_e.u.pack({})),B)});P.mapKeys({mappings:(j={},j[o]=e.itemKey,j)});n(P.execute());return[2]}})})}});var At=n(503);function Ot(e){var t,n,r=e.name&&(t=e.name,n=".aspx",t.substr(t.length-n.length)===n),i=e.package||e.remoteItem&&e.remoteItem.package,s=i&&"oneNote"===i.type;return r||s||!1}var Mt=Object(i.i)()(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u,a;return Object(r.__generator)(this,function(f){switch(f.label){case 0:t=n(Object(te.e)({saveForLaterGraphEndpoint:ne.E})).saveForLaterGraphEndpoint;i=gt.e.deserialize(e.itemKey);if(!t||t===i.driveItemKey.endpoint)return[3,1];i=Object(r.__assign)(Object(r.__assign)({},i),{driveItemKey:Object(r.__assign)(Object(r.__assign)({},i.driveItemKey),{endpoint:t})});return[3,3];case 1:return[4,n(re({endpoint:i.driveItemKey.endpoint}))];case 2:(s=f.sent())!==i.driveItemKey.endpoint&&(i=Object(r.__assign)(Object(r.__assign)({},i),{driveItemKey:Object(r.__assign)(Object(r.__assign)({},i.driveItemKey),{endpoint:s})}));f.label=3;case 3:o=gt.e.serialize(i);u=[{code:"provisioningNotAllowed",message:"You do not have permission to create this personal site or you do not have a valid license"},{code:"BadRequest",message:"Unable to retrieve user's mysite URL."},{code:"InvalidAuthenticationToken",message:"Access token has expired."},{code:"resourceBeingProvisioned",message:"The requested resource is being automatically provisioned. Please try again in a few minutes."}];return[4,n(Fe(Object(r.__assign)(Object(r.__assign)({},e),{itemKey:o,qosName:"savedForLater",itemSetKeyFacet:gt.e,parentItemKeyFacet:yt.e,getUrl:function(e){if(e.driveItemKey.endpoint===t){return e.driveItemKey.endpoint+"/me/drive/following?top=5000&select="+["followed","name","parentReference","webDavUrl","webUrl","id","size","lastModifiedBy","lastModifiedDateTime","sharepointIds"].join(",")}return e.driveItemKey.endpoint+"/drives/me/followed?top=5000&select=*,webDavUrl"},onProcessResponse:function(e){var t,n,i=e.itemKey,s=e.driveItemKey,o=e.item,u=new ve.e;if(s&&o){var a=W.e.serialize(s),f=At.e.serialize({driveItemKey:s}),l=o&&(o.webDavUrl||o.webUrl);u.resolveItems({items:(t={},t[a]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},q.v.pack({itemKey:f})),q.i.pack(l)),q.p.pack(o.size)),t[f]=Object(r.__assign)(Object(r.__assign)({},q.b.pack(!0)),Object(be.e)().forFacet(q.b).thenInvalidate(i,H.e).pack()),t)});u.invalidateItems({items:(n={},n[i]=[H.e],n)})}return{itemResolver:u}},filterChildItems:Ot,getDriveItemFacets:function(e){var t=e.driveItem,n=t.root,i=t.remoteItem,s=t.name,o=n?Ce.e.files:s||i&&i.name||"",u=!t.webDavUrl,a=t.followed&&t.followed.followedDateTime;return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},Object($.e)(Object(r.__assign)(Object(r.__assign)({},e),{shouldReturnShareFacets:!1}))),q.h.pack(Object($.t)(o,u))),a?q.u.pack(new Date(a).getTime()):{}),q.d.pack(u?{}:void 0))},mapItemSetKey:function(){var t,n=new ve.e;n.mapKeys({mappings:(t={},t[o]=e.itemKey,t)});return{itemResolver:n}},expectedErrors:u})))];case 4:a=f.sent().itemResolver;n(a.execute());return[2]}})})}});var _t=n(3449),Dt=n(1362),Pt=Object(i.n)()(function(e){var t=this,n=e.items;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b;return Object(r.__generator)(this,function(S){switch(S.label){case 0:return[4,e(Object(Me.e)(function(e){return e.demandItemFacet(w.c,E.e)}))];case 1:if(!S.sent())return[2];t=Object.keys(n);i=t[0];s=At.e.deserialize(i);if(!(o=s.driveItemKey.endpoint))throw new Error("No endpoint to determine followed items.");u=gt.e.serialize({driveItemKey:{endpoint:o},sortBy:"",isAscending:!0});return[4,e(Object(Dt.e)(function(e){return e.demandItemFacet(H.e,u)}))];case 2:a=S.sent();f=a&&a.itemKeys||[];l=new ve.e;c={};for(h=0,p=f;h<p.length;h++){g=p[h];c[g]=!0}for(d=0,v=t;d<v.length;d++){m=v[d];g=At.e.deserialize(m).driveItemKey;y=!!c[W.e.serialize(g)];l.resolveItems({items:(b={},b[m]=Object(r.__assign)(Object(r.__assign)({},q.b.pack(y||void 0)),Object(be.e)().forFacet(q.b).thenInvalidate(u,H.e).pack()),b)})}e(l.execute());return[2]}})})}});var Ht=n(2755),Bt=new Q.e("searchRootItem",{endpoint:Object(Q.s)()}),jt=Object(i.i)()(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i;return Object(r.__generator)(this,function(s){switch(s.label){case 0:t=[{code:"AccessDenied",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"UnknownError",message:"401 UNAUTHORIZED"},{code:"503"},{code:"ItemNotFound"},{code:"activityLimitReached"},{code:"serviceNotAvailable"}];return[4,n(Fe(Object(r.__assign)(Object(r.__assign)({},e),{qosName:"search",itemSetKeyFacet:Ht.e,parentItemKeyFacet:Bt,getUrl:function(e){var t,n=e.driveItemKey,r=e.searchTerm;r&&(t=encodeURIComponent(r));return Object(X.t)(n)+"/search(q='"+t+"')?$expand=thumbnails&select=*,webDavUrl"},expectedErrors:t})))];case 1:i=s.sent().itemResolver;n(i.execute());return[2]}})})}});var Ft=n(1008);function It(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F;return Object(r.__generator)(this,function(I){switch(I.label){case 0:t=e.itemKey,i=e.top,s=e.skip;o=de.e.deserialize(t);u=o.driveItemKey,a=o.extFilters;f=o.sortBy,l=o.isAscending;c=o;h=u;return u.driveId&&"me"!==u.driveId?[3,2]:[4,n(re({endpoint:u.endpoint}))];case 1:if((p=I.sent())!==u.endpoint){h=Object(r.__assign)(Object(r.__assign)({},u),{endpoint:p});c=Object(r.__assign)(Object(r.__assign)({},o),{driveItemKey:h})}I.label=2;case 2:d=W.e.serialize(h);v=Object(X.n)(h);return[4,n(Object(Me.e)(function(e){return{isParentItemResolved:e.isItemFacetResolved(W.e,d),totalChildCount:e.isItemFacetResolved(_e.e,d)?e.demandItemFacet(_e.e,d):void 0,driveType:e.isItemFacetResolved(Ft.e,d)?e.demandItemFacet(Ft.e,d):void 0}}))];case 3:m=I.sent(),g=m.isParentItemResolved,y=m.totalChildCount,b=m.driveType;return[4,n(Object(V.i)(h.endpoint))];case 4:w=I.sent();E=Promise.resolve(void 0);g||(E=n(Object(V.r)({url:Object(X.t)(h),driveUrl:v,useMultiPartIfSupported:w,qosName:"getItem",endpoint:h.endpoint})));S=[{code:"notAllowed",message:"You do not have access to create this personal site or you do not have a valid license"},{code:"BadRequest",message:"Tenant does not have a SPO license."},{code:"AccessDenied",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"UnknownError",message:"401 UNAUTHORIZED"},{code:"ItemNotFound"},{code:"503"}];x=Object(X.t)(u);T=s?"&skiptoken="+(s+1)+"/"+y+"&skip="+s:"";N=f&&void 0!==l?Object(V.t)(f,l):"";C=(function(e){if(!e||0===e.length)return"";for(var t=[],n=[],i=0;i<e.length;i++){var s=e[i],o=!1,u=s;if("!"===s[0]){u=s.slice(1);o=!0}if("folder"===u)!o&&t.push("folder ne null");else if("."!==u[0]);else{t=[];n=[]}}return t.length>0||n.length>0?"&$filter="+(0===n.length?Ee(t):0===t.length?Se(n):Se(Object(r.__spreadArrays)([Ee(t)],n))):""})(a);k=n(Object(V.r)({url:x+"/children?$top="+i+T+N+"&$expand=thumbnails&select=*,webDavUrl"+C,driveUrl:v,qosName:"getChildren.folder",useMultiPartIfSupported:w,endpoint:h.endpoint,expectedErrors:S}));L=[k,E];A=!1;if(!Be.t(He.e.dataFetch.start)){Be.r(He.e.dataFetch.start);A=!0}return[4,Promise.all(L)];case 5:O=I.sent(),M=O[0],_=O[1];A&&Be.r(He.e.dataFetch.end);if(_){_.folder&&(y=_.folder.childCount);_.parentReference&&_.parentReference.driveType&&(b=_.parentReference.driveType)}D=n(Object(V.s)(h.endpoint,b));(P=new ve.e).mapKeys({mappings:(j={},j[de.e.serialize(c)]=e.itemKey,j[d]=W.e.serialize(o.driveItemKey),j)});o.driveItemKey.driveId&&"me"!==o.driveItemKey.driveId||P.mapKeys({mappings:(F={},F[W.e.serialize(Object(r.__assign)(Object(r.__assign)({},o.driveItemKey),{driveId:"me"}))]=W.e.serialize(Object(r.__assign)(Object(r.__assign)({},o.driveItemKey),{driveId:""})),F)});B=(H=P).merge;return[4,n(je({itemKey:t,itemSetKeyFacet:de.e,parentItemKeyFacet:W.e,parentItemResponse:_,childItemsResponse:M,filterChildItems:a&&a.length>0?xe(a):void 0,skip:s,enableRandomAccess:D,totalChildCount:y,onProcessResponse:function(e){var t,n=e.driveItemKey,i=new ve.e;n&&i.resolveItems({items:(t={},t[W.e.serialize(n)]=Object(r.__assign)({},ee.r.pack(W.e)),t)});return{itemResolver:i}}}))];case 6:B.apply(H,[I.sent().itemResolver]);return[2,P]}})})}}var qt=Object(i.i)()(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i;return Object(r.__generator)(this,function(s){switch(s.label){case 0:t=n(Object(te.e)({pageSize:ne.r})).pageSize;return[4,n(It(Object(r.__assign)(Object(r.__assign)({},e),{skip:0,top:t||K.t})))];case 1:i=s.sent();Be.r(He.e.resolveData.start);n(i.execute());Be.r(He.e.resolveData.end);return[2]}})})}});var Rt=n(130),Ut=Object(i.t)(function(){return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){e(Object(Rt.e)(function(){e(Object(U.t)({keyFacet:de.e,facets:[de.e,H.e]}));e(Object(s.s)(de.e,z.e)(qt))}));return[2]})})}}),zt=n(673),Wt=n(3117),Xt=n(3116),Vt=Object(i.i)()(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u,a,f;return Object(r.__generator)(this,function(l){switch(l.label){case 0:t=e.itemKey;i=Xt.e.deserialize(t);s=i.endpoint;o=Object(X.n)(i);return[4,n($t({url:Object(X.e)(i),driveUrl:o,qosName:"commands",endpoint:s}))];case 1:u=l.sent();(a=new ve.e).resolveItems({items:(f={},f[t]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},Wt.e.pack(u.addToOneDrive)),Wt.t.pack(u.createFolder)),Wt.n.pack(u.createLink)),Wt.r.pack(u.delete)),Wt.i.pack(u.download)),Wt.s.pack(u.invite)),Wt.o.pack(u.move)),Wt.u.pack(u.officeLens)),Wt.a.pack(u.rename)),Wt.f.pack(u.upload)),f)});n(a.execute());return[2]}})})}});function $t(e){var t=this;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return[2,{addToOneDrive:{roles:["write"]},createFolder:{roles:["owner","write"]},createLink:{defaultScope:"anonymous",linkTypes:["view","edit"],scopes:["anonymous","application"]},delete:{roles:["owner","write"]},download:{roles:["owner","write","read"]},invite:{roles:["owner","write"]},move:{roles:["owner","write"]},officeLens:{extensions:["jpeg","jpg","jpe"],lensNames:["officeLens"],roles:["owner"]},rename:{roles:["owner","write"]},upload:{roles:["owner","write"]}}]})})}}var Jt=n(3450),Kt=n(248),Qt=n(3451),Gt=n(946),Yt=n(501),Zt=n(665),en=n(361),tn=Object(l.t)()(function(){return function(e){return nn}});function nn(e,t){var n=t.handlers,i=t.itemKey,s=e.demandItemFacet(dt.e,i);if(n&&s){for(var o=[],u=0,a=n;u<a.length;u++){var f=a[u];if(f.key===en.u.key)o.push("photo");else if(f.key===en.a.key)o.push("video");else if(f.key===en.t.key)o.push("folder");else if(f.key===en.o.key)o.push("onenote");else if(f.key===en.i.key)o.push("!photo");else if(f.key===en.s.key)o.push("!video");else if(f.key===en.n.key)o.push("!folder");else if(f.key===en.r.key)o.push("!onenote");else{var l=Object(Zt.e)(f);l&&o.push(l)}}return{itemKey:dt.e.serialize(Object(r.__assign)(Object(r.__assign)({},s),{filters:o}))}}return{}}var rn=n(657),sn=n(368),on=n(205),un=Object(l.t)()(fn),an=Object(l.t)()(fn);function fn(){return function(e){return function(e,t){var n=t.itemKey;if(n){var r=e.demandItemFacet(dt.e,n);if(r&&r.filters&&Object(Ue.e)({extFilters:Object(Ue.t)(r.filters),allowedMediaTypes:[Ie.e.photo,Ie.e.video],fileTypeIconMap:Et.e}))return{defaultLayout:on.e,isLayoutResolved:!0}}return{}}}}var ln=n(432),cn=new Q.e("sharesItem",{endpoint:Object(Q.s)(),shareId:Object(Q.s)()}),hn=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=cn.deserialize(n),s=i.endpoint;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,o,u,a,f,l,c,h,p;return Object(r.__generator)(this,function(d){switch(d.label){case 0:return[4,e(Object(V.n)({url:Object(X.r)(i)+"?$expand=thumbnails&select=*,webDavUrl",qosName:"getSharesItem",endpoint:s,headers:{Prefer:"redeemSharingLinkIfNecessary"}}))];case 1:t=d.sent();o=new ve.e;u=t&&t.parentReference;a=u&&u.driveId;f={endpoint:s,driveId:a,itemId:t.id};l=W.e.serialize(f);c=u&&u.id?W.e.serialize({endpoint:s,driveId:a,itemId:u.id}):void 0;o.resolveItems({items:(h={},h[l]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},Object($.e)({driveItem:t,endpoint:s,parentFolderItemKey:c})),me.r.pack(W.e)),H.t.pack({itemKey:de.e.serialize({driveItemKey:f,sortBy:"",isAscending:!0})})),h)});o.mapKeys({mappings:(p={},p[l]=n,p)});e(o.execute());return[2]}})})}});var pn=n(1148),dn=new Q.e("driveItemVirtualizedPage",{endpoint:Object(Q.s)(),setItemKey:Object(Q.s)(),skip:Object(Q.i)(),top:Object(Q.i)()}),vn=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=dn.deserialize(n),s=i.setItemKey,o=i.top,u=i.skip;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i;return Object(r.__generator)(this,function(a){switch(a.label){case 0:return[4,n(It(Object(r.__assign)(Object(r.__assign)({},e),{itemKey:s,skip:u,top:o})))];case 1:(t=a.sent()).resolveItems({items:(i={},i[s]=Object(r.__assign)({},Object(be.e)().forFacet(H.e).thenInvalidate(e.itemKey,H.e).pack()),i)});n(t.execute());return[2]}})})}});var mn=n(83),gn=Object(mn.e)(function(){return Promise.all([n.e("deferred.resx-deferred"),n.e("deferred.office-ui-fabric-react"),n.e("deferred.items-view"),n.e("deferred.odsp-common"),n.e("deferred.odsp-datasources"),n.e("deferred.odsp-shared-react"),n.e("odsp.knockout.lib"),n.e("deferred")]).then(n.bind(null,3858))},{chunkName:"graphaddondeferred"}),yn=Object(i.t)(function(){return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:e(Object(Rt.e)(function(){e(Object(U.t)({keyFacet:W.e,facets:[W.e,q.l,q.p,q.d,q.L,q.a,H.t,q.A,q.i,q.c,R.n]}));e(Object(U.t)({keyFacet:ye,facets:[ye,H.e,H.r]}));e(Object(U.t)({keyFacet:Ne.e,facets:[Ne.e,q.l,q.p,q.d,q.L,q.i,q.a,H.t,q.A,R.n]}));e(Object(U.t)({keyFacet:o.e,facets:[o.e,H.e]}));e(Object(U.t)({keyFacet:lt,facets:[lt,q.l,q.p,q.d,q.L,q.i,q.a,H.t,q.A,R.n]}));e(Object(U.t)({keyFacet:ct,facets:[ct,H.e]}));e(Object(U.t)({keyFacet:vt.e,facets:[vt.e,q.l,q.p,q.d,q.L,q.a,H.t,q.A,R.n]}));e(Object(U.t)({keyFacet:dt.e,facets:[dt.e,H.e]}));e(Object(U.t)({keyFacet:yt.e,facets:[yt.e,q.l,q.p,q.d,q.L,q.a,H.t,q.A]}));e(Object(U.t)({keyFacet:Xt.e,facets:[Wt.e,Wt.t,Wt.n,Wt.r,Wt.i,Wt.s,Wt.o,Wt.u,Wt.a,Wt.f]}));e(Object(U.t)({keyFacet:se.e,facets:[oe.h]}));e(Ut);e(Object(s.s)(W.e,z.e)(ie));e(Object(s.s)(dn,z.e)(vn));e(Object(s.s)(se.e,z.e)(ce));e(Object(s.s)(pe,z.e)(ge));e(Object(s.s)(cn,z.e)(hn));e(Object(s.s)(ye,z.e)(Te));e(Object(s.s)(Ne.e,z.e)(ke));e(Object(s.s)(o.e,z.e)(ft));e(Object(s.s)(lt,z.e)(ht));e(Object(s.s)(ct,z.e)(pt));e(Object(s.s)(vt.e,z.e)(mt));e(Object(s.s)(yt.e,z.e)(bt));e(Object(s.s)(dt.e,z.e)(Lt));e(Object(s.s)(gt.e,z.e)(Mt));e(Object(s.s)(Ht.e,z.e)(jt));e(Object(U.t)({keyFacet:At.e,facets:[q.b]}));e(Object(s.s)(At.e,z.e)(Pt));e(Object(s.s)(zt.e,z.e)(_t.e));e(Object(s.s)(Xt.e,z.e)(Vt));e(Object(a.e)(W.e,Kt.e)(Jt.t));e(Object(a.e)(de.e,Kt.e)(Jt.t));e(Object(a.e)(dt.e,Yt.e)(tn));e(Object(a.e)(dt.e,rn.e)(un));e(Object(a.e)(dt.e,sn.e)(an));e(Object(a.e)(W.e,Gt.e)(Qt.e));e(pn.e)}));return[4,e(Object(u.o)({waitIndefinitely:!0}))];case 1:r.sent();r.label=2;case 2:r.trys.push([2,4,,5]);return[4,gn()];case 3:if(!(t=r.sent().graphAddonDataOnlyDeferred))throw new Error("Couldn't load extended Microsoft Graph features.");e(t);return[3,5];case 4:n=r.sent();e(Object(ln.e)({error:n}));return[3,5];case 5:return[2]}})})}}),bn=n(1174),wn=n(514),En=n(827),Sn=Object(l.t)()(function(){return function(){return function(e,t){var n=t.setItemKey,r=e.demandItemFacet(de.e,n);if(!n||!r)return{};var i=r.driveItemKey.endpoint,s=W.e.serialize(r.driveItemKey),o=e.demandItemFacet(Ft.e,s),u=e.demandItemFacet(ne.r,E.e)||K.t,a=e.demandItemFacet(ne.x,E.e);if(a&&a(i,o)){return{totalItemCount:e.demandItemFacet(_e.e,s),getPageKey:function(e,t){return dn.serialize({setItemKey:n,endpoint:r.driveItemKey.endpoint,skip:e,top:t-e})},pageSize:u}}return{}}}});var xn=n(413),Tn=n(833),Nn=n(784),Cn=n(876),kn=n(834),Ln=Object(l.t)()(function(){return function(e){return On}});var An=[c.e,xn.e,Tn.e,kn.e,Nn.e,Cn.e];function On(e,t){return{columns:An}}var Mn=n(589),_n=Object(i.t)(function(){return function(e){e(Object(a.e)(W.e,Mn.e)(Object(l.n)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,e(Object(u.o)())];case 1:t.sent();return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred.resx-deferred"),n.e("odsp.react.lib"),n.e("5")]).then(n.bind(null,3960))];case 2:return[2,t.sent().driveItemActivityFieldControlHandler]}})})})))}}),Dn=n(273),Pn=n(28),Hn=Object(l.t)()(function(){return function(e){return Bn}});function Bn(e,t){return(function(e,t,n){var i=n.itemSetKey,s=n.handler,o=s.columnKey,u=s.isAscending,a=e.demandItemFacet(t,i);if(!a)return{};var f=e.demandItemFacet(Ft.e,W.e.serialize(Object(r.__assign)({},a.driveItemKey)));if(!f||"business"===f||"documentLibrary"===f)return{};if(!a.sortBy&&o===xn.e.key&&!0===u)return{newItemSetKey:i};var l=Object(Pn.e)(e,{customColumnKeysToFieldNamesConfiguration:ne.n}).customColumnKeysToFieldNamesConfiguration,c=Object(r.__assign)(Object(r.__assign)({},h.t),l),p=c?c[o]:void 0;if(!p)return{};return{newItemSetKey:t.serialize(Object(r.__assign)(Object(r.__assign)({},a),{sortBy:p,isAscending:u}))}})(e,de.e,t)}var jn=n(450),Fn=Object(l.t)()(function(){return function(e){return function(e,t){return{isAvailable:!0}}}});var In=n(2756),qn=n(1847),Rn=n(2975),Un=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=In.e.deserialize(n),s=i.endpoint,o=i.driveId;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,u,a,f;return Object(r.__generator)(this,function(l){switch(l.label){case 0:t=Object(X.n)({endpoint:s,driveId:o});return[4,e(Object(qn.t)(s,t))];case 1:i=l.sent();u=i&&i.accessToken;(a=new ve.e).resolveItems({items:(f={},f[n]=Object(r.__assign)({},Rn.e.pack(u)),f)});e(a.execute());return[2]}})})}});var zn,Wn=n(578),Xn=n(105),Vn=n(34),$n=n(275),Jn=n(3119),Kn=n(2754),Qn=n(261);(function(e){e.vaultOpen="vaultopen";e.vaultClosed="vaultclosed"})(zn||(zn={}));var Gn={small:{vaultclosed:"vaultCoverSmallVaultClosed",vaultopen:"vaultCoverSmallVaultOpen"},large:{vaultclosed:"VaultCoverLargeVaultClosed",vaultopen:"VaultCoverLargeVaultOpen"}},Yn=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e,t=this.props,n=t.vaultCoverSize,i=void 0===n?"large":n,s=t.vaultCoverType,o=void 0===s?"vaultclosed":s,u=(t.ref,t.children,t.isFluent),a=Object(r.__rest)(t,["vaultCoverSize","vaultCoverType","ref","children","isFluent"]),f=Gn[i][o];"small"===i?e="vaultCoverIsSmall_62866f94":"large"===i&&(e="vaultCoverIsLarge_62866f94");return L.createElement("div",Object(r.__assign)({},a,{className:"root_62866f94 "+e+" "+(u?"isFluent":"")}),L.createElement(O.e,{"aria-hidden":!0,className:"ms-VaultCover cover_62866f94",iconName:f}))};return t})(L.Component);var Zn=Object(l.t)()(function(){return function(e){return function(e,t){var n,i,s,o,u=t.itemKey,a=e.demandItemFacet(Kn.e,u);if(a&&a.root){var f=e.demandItemFacet(q.l,u),l=a.isLocked?zn.vaultClosed:zn.vaultOpen,c={iconType:Wn.e.Image,ariaLabel:f,imageProps:{src:(n=l,"https://spoprod-a.akamaihd.net/files/fabric-cdn-prod_20201207.001//assets/item-types/"+(i||"20")+(o&&"png"===s?"_2x":"")+"/"+n+"."+(s||"png")),imageFit:Xn.t.contain,className:"fileHandlerFileTypeIcon_a90a8987"}};return{iconAs:function(e){return L.createElement(O.e,Object(r.__assign)({},e,c))}}}return{fileTypeIconAs:er}}}});var er=Object(Vn.t)(function(e,t){var n=t.defaultRender,i=Object(r.__rest)(t,["defaultRender"]),s=i.isFolder,o=i.itemKey,u=i.type,a=u;if(s&&void 0===u){var f=e.demandItemFacet(Jn.e,o);void 0!==f&&("desktop"===f?a=$n.e.desktopFolder:"documents"===f?a=$n.e.documentsFolder:"pictures"===f&&(a=$n.e.picturesFolder))}return n?L.createElement(n,Object(r.__assign)({},i,{type:a})):null}),tr=n(317),nr=n(966),rr=n(188),ir=n(113);(function(e,t){void 0===e&&(e="https://spoprod-a.akamaihd.net/files/fabric/office-ui-fabric-react-assets/foldericons");Object(Qn.n)({fontFace:{},style:{width:78,height:58,overflow:"hidden"},icons:{vaultCoverSmallVaultClosed:L.createElement("img",{src:e+"/vault-sm.svg"}),vaultCoverSmallVaultOpen:L.createElement("img",{src:e+"/vault-sm-open.svg"})}},t);Object(Qn.n)({fontFace:{},style:{width:118,height:86,overflow:"hidden"},icons:{VaultCoverLargeVaultClosed:L.createElement("img",{src:e+"/vault-lg.svg"}),VaultCoverLargeVaultOpen:L.createElement("img",{src:e+"/vault-lg-open.svg"})}},t)})("https://spoprod-a.akamaihd.net/files/fabric/office-ui-fabric-react-assets/foldericons",{disableWarnings:!0});var sr=Object(l.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,i=e.demandItemFacet(Kn.e,n);return Object(r.__assign)(Object(r.__assign)({},i&&i.root?{tileAs:ur}:{}),{folderCoverControlHandler:function(t,n){var r=n.signalData;if(r&&r.signal)return{};var i=e.demandItem({specialFolder:Jn.e},n.itemKey).specialFolder;if(!i)return{};var s=(function(e){var t=null;"desktop"===e?t=L.createElement(rr.n,null):"documents"===e?t=L.createElement(rr.r,null):"pictures"===e&&(t=L.createElement(rr.c,null));return{signal:t,key:e||""}})(i);return s&&s.signal?{signalData:s}:{}}})}}});var or=Object(Vn.t)(function(e,t){var n=t.itemKey,i=Object(r.__rest)(t,["itemKey"]),s=e.demandItemFacet(Kn.e,n),o=s&&s.isLocked?zn.vaultClosed:zn.vaultOpen;return L.createElement(Yn,Object(r.__assign)({},i,{vaultCoverSize:i.folderCoverSize,vaultCoverType:o}))}),ur=Object(Vn.t)(function(e,t){var n=t.defaultRender,i=t.foreground,s=Object(r.__rest)(t,["defaultRender","foreground"]),o=t.itemKey,u=i,a=e.demandItemFacet(Kn.e,o);a&&a.root&&(u=Object(ir.r)(e,L.createElement(or,Object(r.__assign)({},s,{folderCoverSize:s.tileSize,itemKey:o}))));return n?L.createElement(n,Object(r.__assign)({},s,{foreground:u})):null}),ar=n(643),fr=n(99),lr=n(1356),cr=n(2660),hr=n(2153),pr=n(25),dr=n(1326),vr=n(32),mr=n(47),gr=n(16),yr=new gr.e("openInOfficeOnlineActionControl"),br=Object(Vn.e)(function(e,t){var n=t.itemKey,i=e.demandItem({openUrl:q.L,appFacet:cr.e,isMalwareDetected:q.N},n),s=i.openUrl,o=i.appFacet,u=i.isMalwareDetected,a=e.dispatch,f=!u&&!!o&&!!s,l=e.demandItemFacet(yr,n);return Object(r.__assign)({isAvailable:f,onExecute:s?function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var e,t;return Object(r.__generator)(this,function(r){e=(new Date).getTime().toString();t=dr.e.AddWopiPerfMarkToTargetUrl(e,"ItemsView",s);a(Object(Me.e)(function(e){return yr.evaluate(l)(e,{itemKey:n,forceInSameWindow:!1})})).forceInSameWindow?window.location.href=t:window.open(t);return[2]})})}:void 0},Object(mr.t)(e,{itemKey:n,engagement:{name:"OpenInOfficeOnline",isIntentional:!0}}))})(vr.e),wr=Object(pr.s)()(Object(pr.r)()(br)),Er={key:new De.e("openInOfficeOnline").id,automationId:"openInOfficeOnlineCommand",action:L.createElement(wr,null),facets:Object(r.__assign)({},fr.t.pack(!0))},Sr=n(102),xr=n(1089),Tr=new gr.e("openInOfficeClientActionControl"),Nr=n(2662),Cr=new Sr.e,kr=function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return[2]})})},Lr=Object(Vn.e)(function(e,t){var n=t.itemKey,i=e.demandItem({key:W.e,appMap:cr.e,fileName:q.h,openUrl:q.L,canonicalUrl:q.i,isMalwareDetected:q.N},n),s=i.key,o=i.appMap,u=i.fileName,a=i.openUrl,f=i.canonicalUrl,l=i.isMalwareDetected,c=!1,h=kr,p=Object(Nr.s)(e,{itemKey:n,oneOfRequiredRoles:["write","owner"]});if(n){var d=!l&&!!o&&!!a&&(Cr.isMac||Cr.isWindows||Cr.isIOS||Cr.isWinPhone||Cr.isAndroid),v=e.demandItemFacet(Tr,n),m=Tr.evaluate(v)(e,{itemKey:n,isAvailable:d,protocolCallback:Or}),g=m.protocolCallback,y=m.isAvailable;c=d&&y;s&&c&&(h=(function(e){var t=this,n=e.key,i=e.openUrl,s=e.canonicalUrl,o=e.canEdit,u=e.appMap,a=e.fileName,f=e.isNew,l=e.defaultLocation,c=e.protocolCallback;return function(){return Object(r.__awaiter)(t,void 0,void 0,function(){var e,t;return Object(r.__generator)(this,function(r){if(!n)return[2];e=!!o;t=function(){i&&window.open(i)};Object(xr.e)({app:u||"",itemUrl:s||"",extension:a&&a.extension||"",shouldEdit:e,isNew:Boolean(f),defaultLocation:l||"",platformDetection:Cr,onNavigate:c,onFailureCallback:t});return[2]})})}})({key:s,openUrl:a,canonicalUrl:f,canEdit:p,appMap:o,fileName:u,protocolCallback:g}))}return Object(r.__assign)({isAvailable:c,onExecute:h},Object(mr.t)(e,{itemKey:n,engagement:{name:"OpenInOfficeClient",isIntentional:!0}}))})(vr.e),Ar=Object(pr.s)()(Object(pr.r)()(Lr));function Or(e){window.location.href=e}var Mr={key:new De.e("openInOfficeClient").id,automationId:"openInOfficeClientCommand",action:L.createElement(Ar,null),facets:Object(r.__assign)({},fr.t.pack(!0))},_r=new De.e("fileHandlerOpenCommand").id,Dr=(Object(pr.s)()(Object(pr.r)()(Object(Vn.e)(function(e,t){var n=t.itemKey,r=t.item,i=e.demandItem({appMap:cr.e},n).appMap,s=r.name;r.key===Er.key&&(s=s||(i?Object(hr.s)(i,!0):hr.e.OpenInBrowser));return{name:s}})(function(e){return L.createElement("div",{className:"contextualMenuItemLinkContent_aa42db57"},L.createElement("span",{dir:"auto",className:"contextualMenuItemTextLabel_aa42db57"},e.name))}))),Object(pr.s)()(Object(pr.r)()(Object(Vn.e)(function(e,t){var n=t.itemKey,i=t.menuProps,s=e.demandItem({appMap:cr.e,fileName:q.h},n),o=s.appMap,u=s.fileName,a={};if(i&&i.items){var f=i.items[0];f&&-1!==f.key.indexOf(_r)&&f.iconProps&&(a=f.iconProps)}var l=!!u&&!!u.extension&&".pdf"===u.extension.toLowerCase(),c=o&&Object(hr.n)(o),h={iconName:o?Object(hr.t)(o):l?"PDF":"OpenFile"},p=void 0;i&&i.items&&(p=i.items.map(function(e){return e.key===Er.key?Object(r.__assign)(Object(r.__assign)({},e),{iconProps:h,name:e.name||o&&Object(hr.s)(o,!0)||(l?hr.e.OpenInBrowser:hr.e.Open),onRenderIcon:c?Pr.bind(void 0,c,!0):void 0}):e.key===Mr.key?Object(r.__assign)(Object(r.__assign)({},e),{iconProps:h,name:e.name||o&&Object(hr.i)(o),onRenderIcon:c?Pr.bind(void 0,c,!0):void 0}):e}));return{iconProps:a||h,onRenderIcon:c?Pr.bind(void 0,c,!1):void 0,text:hr.e.Open,menuProps:p?Object(r.__assign)(Object(r.__assign)({},i),{items:p}):i}})(lr.e))));function Pr(e,t){return e?L.createElement("span",{className:t?"menuItemIconContainer_aa42db57":"iconContainer_aa42db57"},L.createElement(O.e,{iconName:e.logoFill16,className:"logoFillIcon_aa42db57"}),L.createElement(O.e,{iconName:e.logo16,className:"logoIcon_aa42db57"})):null}var Hr={key:ar.e.key,automationId:ar.e.automationId,subMenuProps:{items:[Er,Mr]},onRender:function(e){return L.createElement(Dr,Object(r.__assign)({},e,{menuProps:e.subMenuProps}))},facets:Object(r.__assign)({},fr.t.pack(!0))},Br=Object(l.t)()(function(){return function(e){return function(e,t){var n=t.commands,i=t.overflowCommands,s=t.farCommands,o=i?Object(r.__spreadArrays)(i):[],u=n?Object(r.__spreadArrays)(n):[],a=s;return{commands:u=jr(e,{defaultCommands:u}).overrideDefaultCommands,overflowCommands:o,farCommands:a}}}});function jr(e,t){for(var n=[],r=0,i=t.defaultCommands;r<i.length;r++){var s=i[r];s.key===ar.e.key?n.push(Hr):n.push(s)}return{overrideDefaultCommands:n}}var Fr=n(310),Ir=n(449),qr=n(1172),Rr=n(21),Ur=n(414),zr={key:new De.e("openInOfficeOnlineDefaultClickHandler").id,evaluate:function(e,t){var n=t.itemKey,r=e.demandItem({openUrl:q.L,appMap:cr.e},n),i=r.openUrl,s=r.appMap;return{action:!!i&&!!s?L.createElement(Ur.e,{itemKey:n,action:Object(Rr.i)(e,L.createElement(br,{itemKey:n}))}):void 0}}},Wr={key:new De.e("openInOfficeClientDefaultClickHandler").id,evaluate:function(e,t){var n=t.itemKey,r=e.demandItem({openUrl:q.L,appMap:cr.e},n),i=r.openUrl,s=r.appMap;return{action:!!i&&!!s?L.createElement(Ur.e,{itemKey:n,action:Object(Rr.i)(e,L.createElement(Lr,{itemKey:n}))}):void 0}}},Xr=Object(l.t)()(function(){return function(e){return function(e,t){var n=t.handlers,i=void 0===n?[]:n;return{handlers:Object(r.__spreadArrays)([qr.e,zr,Wr],i)}}}});var Vr=n(538),$r=n(162),Jr=n(286),Kr=Object(g.i)({key:new De.e("dateAccessedColumn").id,name:$r.e.AccessedDate,fieldName:"",minWidth:g.e.regularMin,maxWidth:g.e.regularMax,isCollapsable:!0},b.e)(function(e,t){var n=e.demandItemFacet(q.s,t,{suppressGetItems:!0}),r=n&&new Date(n).getTime();if("number"!=typeof r||isNaN(r))return{text:""};var i=e.demandItemFacet(w.S,E.e),s=i&&i.language||window.navigator.language;return s?{text:Object(Jr.n)(new Date(r),s)}:{dateValue:r}},function(e,t){return""+e.demandItemFacet(q.s,t)}),Qr=Object(l.t)()(function(){return function(e){return Yr}});var Gr=[p,d.e,Kr];function Yr(e,t){return{columns:Gr}}var Zr=n(562),ei=n(490),ti=Object(pr.s)()(Object(pr.r)()(Object(Vn.t)(function(e,t){var n=t.itemKey,r=e.demandItemFacet(q.A,n);return r?L.createElement(ei.e,{itemKey:r.itemKey}):null}))),ni=n(315),ri={key:"OpenFileLocation",name:ni.e.OpenFileLocation,title:ni.e.OpenFileLocation,action:ti,iconProps:{iconName:"FabricFolder"}},ii=Object(l.t)()(function(){return function(e){return oi}});var si=[ar.e,ri,Zr.n,Zr.t];function oi(e,t){return{commands:jr(0,{defaultCommands:si}).overrideDefaultCommands}}var ui=n(211),ai=Object(l.t)()(function(){return function(e){return ci}});var fi={name:"-",key:"divider_1",itemType:ui.e.Divider},li=[ar.e,ri,fi,Zr.n,Zr.t];function ci(e,t){return{commands:li}}var hi=n(932),pi=Object(l.t)()(function(){return function(e){return function(e,t){return{isAvailable:!1}}}});var di=n(252),vi=n(54),mi=Object(l.t)()(function(){return function(e){return function(e,t){var n=t.itemsScopeItemKey,i=t.engagement,s=i&&i.name;return{engagement:{datasource:"Recent",extraData:Object(r.__assign)({},"ItemsView.Load"===s?gi(e,{itemsScopeItemKey:n}):{})}}}}});function gi(e,t){var n=t.itemsScopeItemKey,i=Object(vi.e)(e,n),s=e.demandItemFacet(Pe,i);return Object(r.__assign)({},s)}var yi=Object(i.t)(function(){return function(e){e(Object(a.e)(vt.e,di.e)(mi))}}),bi=Object(i.t)(function(){return function(e){e(Object(a.e)(dt.e,f.e)(Qr));e(Object(a.e)(vt.e,Fr.e)(ii));e(Object(a.e)(vt.e,hi.e)(ai));e(Object(a.e)(St,Kt.e)(pi));e(yi)}}),wi=n(502),Ei=Object(g.i)({key:new De.e("dateFollowedColumn").id,name:$r.e.SavedDate,fieldName:"",minWidth:g.e.regularMin,maxWidth:g.e.regularMax,isCollapsable:!0},b.e)(function(e,t){var n=e.demandItemFacet(q.u,t),r=n&&new Date(n).getTime();if("number"!=typeof r||isNaN(r))return{text:""};var i=e.demandItemFacet(w.S,E.e),s=i&&i.language||window.navigator.language;return s?{text:Object(Jr.n)(new Date(r),s)}:{dateValue:r}},function(e,t){return""+e.demandItemFacet(q.u,t)}),Si=n(1160),xi=Object(l.t)()(function(){return function(e){return Ni}});var Ti=[p,d.e,Ei,Si.e];function Ni(e,t){return{columns:Ti}}var Ci=n(294),ki=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return this.props.group?L.createElement("div",{className:"root_3c32ab3a"},this.props.group.name):null};return t})(L.PureComponent),Li=n(1363),Ai=n(794),Oi=n(415),Mi=n(255),_i=n(671);function Di(e,t){var n=t.signals;if(n){var i=Object(Mi.t)(n,function(e){return e.key===_i.n});if(i&&i.index>-1){var s=i.index;return{signals:Object(r.__spreadArrays)(n.slice(0,s),n.slice(s+1))}}}return{}}var Pi=Object(l.t)()(function(){return function(e){return Bi}});var Hi=function(e){var t=e.defaultRender,n=Object(r.__assign)({},Oi.e.pack(Di));return t?L.createElement(Ai.e,{controlHandlers:n},L.createElement(t,Object(r.__assign)({},e))):null};function Bi(){return{groupHeaderRenderer:ki,rowRenderer:Hi,groupProps:{collapseAllVisibility:Li.e.hidden}}}var ji=Object(l.t)()(function(){return function(e){return qi}});function Fi(e,t){var n=t.itemKey,r=e.demandItemFacet(q.u,n,{suppressGetItems:!0}),i=r&&new Date(r).getTime();if("number"==typeof i&&!isNaN(i)){var s=e.demandItemFacet(w.S,E.e),o=s&&s.language||window.navigator.language,u=Object(Jr.n)(new Date(i),o);return{itemActivity:u&&L.createElement(b.e,{text:u})||null}}return{}}var Ii=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.defaultRender,n=Object(r.__rest)(e,["defaultRender"]),i=Object(r.__assign)(Object(r.__assign)({},Oi.e.pack(Di)),nr.e.pack(Fi));return t?L.createElement(Ai.e,{controlHandlers:i},L.createElement(t,Object(r.__assign)({},n))):null};return t})(L.PureComponent);function qi(){return{tileRenderer:Ii}}var Ri=n(416),Ui=n(3690),zi=Object(l.t)()(function(){return function(e){return function(e,t){return{emptyFolderIconUrl:"https://static2.sharepointonline.com/files/fabric/onedrive-assets/images/empty_state_sfl.svg",emptyFolderTitle:Ui.e.savedForLaterEmptyStateTitle}}}});var Wi=Object(i.t)(function(){return function(e){e(Object(a.e)(gt.e,Ci.e)(Pi));e(Object(a.e)(gt.e,wi.e)(ji));e(Object(a.e)(gt.e,f.e)(xi));e(Object(a.e)(gt.e,Ri.e)(zi));e(Object(a.e)(yt.e,Fr.e)(Br))}}),Xi=n(1211);n.d(t,"graphAddon",function(){return $i});var Vi=Object(mn.e)(function(){return Promise.all([n.e("deferred.resx-deferred"),n.e("deferred.office-ui-fabric-react"),n.e("deferred.items-view"),n.e("deferred.odsp-common"),n.e("deferred.odsp-datasources"),n.e("deferred.odsp-shared-react"),n.e("odsp.knockout.lib"),n.e("deferred")]).then(n.bind(null,4114))},{chunkName:"graphaddondeferred"}),$i=Object(i.t)(function(){return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:e(Object(Rt.e)(function(){e(yn);e(Object(a.e)(de.e,f.e)(Ln));e(Object(a.e)(de.e,Dn.e)(Hn));e(Object(a.e)(o.e,f.e)(j));e(Object(a.e)(W.e,wn.e)(bn.e));e(Object(a.e)(de.e,En.e)(Sn));e(Object(a.e)(W.e,jn.e)(Fn));e(Object(s.s)(In.e,z.e)(Un));e(Object(a.e)(W.e,tr.e)(Zn));e(Object(a.e)(pe,tr.e)(Zn));e(Object(a.e)(W.e,nr.e)(sr));e(Object(a.e)(pe,nr.e)(sr));e(Object(a.e)(W.e,Ir.e)(Xr));e(Object(a.e)(vt.e,Fr.e)(Br));e(Object(a.e)(W.e,Vr.e)(Xi.e));e(_n);e(bi);e(Wi)}));return[4,e(Object(u.o)({waitIndefinitely:!0}))];case 1:r.sent();r.label=2;case 2:r.trys.push([2,4,,5]);return[4,Vi()];case 3:if(!(t=r.sent().graphAddonDeferred))throw new Error("Couldn't load extended Microsoft Graph features.");e(t);return[3,5];case 4:n=r.sent();e(Object(ln.e)({error:n}));return[3,5];case 5:return[2]}})})}})},,,,function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(11),s=n(115),o=n(384),u=n(448),a=new(n(16).e)("itemsBreadcrumbControl"),f=n(248),l=n(310),c=n(932),h=n(584),p=n(44),d=n(706),v=n(1135),m=n(1136),g=n(1142),y=n(104),b=n(51),w=n(466),E=n(1114),S=n(707),x=n(3856),T=n(2904),N=n(379),C=n(1140),k=n(1),L=n(2912),A=n(498),O=n(2246),M=n(2177),_=n(3076),D=n(2761),P=n(10),H=n(3069),B=n(129),j=n(220),F=n(1080),I=n(1165),q=n(2269),R=n(56),U=n(29),z=n(75),W=n(663),X=n(676),V=n(562),$=n(366),J=n(146),K=n(37),Q=n(3070),G=n(59),Y=n(28),Z={ODB:1544},ee=Object(P.t)()(function(){return function(e){return function(t,n){var i,s=n.itemKey,o=n.commands,u=t.demandItemFacet(p.e,s);if(u){var a=y.e.serialize(u);i=t.demandItemFacet(k.Be,a)}var f=o?Object(r.__spreadArrays)(o):[];f.push(_.t,_.e);var l=void 0;if(u){var c=u.listFullUrl,h=u.webAbsoluteUrl,d=Object(D.i)({listFacets:i}),v=t.demandItemFacet(k.Qt,N.e.serialize({webAbsoluteUrl:h,listFullUrl:c}));if(i&&!i.isDocumentLibrary){f=[L.t];for(var m=0,g=Object(L.e)(v);m<g.length;m++){var b=g[m];b.key===V.n.key&&Object(R.e)(t,{feature:Z,pageContext:v})?f.push(V.e):b.key!==A.e.key&&f.push(b)}}f.push(d);var w=C.e.serialize({webAbsoluteUrl:h,listFullUrl:c}),E=Object(H.e)({itemCache:t,targetCustomActionSetKey:w,keys:{webAbsoluteUrl:h,listFullUrl:c}});f=f.concat(Object(H.n)(t,w));E&&(f=f.concat(Object(H.n)(t,E)));if(v&&i&&(i.templateType===U.t.documentLibrary||i.templateType===U.t.mySiteDocumentLibrary)){var S=new B.e(h||c).authority+"/_api/v2.0",x=j.t.serialize({endpoint:S});l=Object(q.e)(t,{itemKey:x})}}var O=!z.e.isActivated(T.e,"7/5/2019","Show file handler commands before OOB commands"),M=!!Object(Y.e)(t,{enableUniversalPrint:G.u}).enableUniversalPrint;return{commands:te(f,l,i&&i.templateType===U.t.mySiteDocumentLibrary,O,M),onMenuOpened:function(){e(function(e){var t=(e(Object(J.e)({spLoggerConfiguration:K.o})).spLoggerConfiguration||{}).scenarioId,n=void 0===t?"":t;e($.t(n))})}}}}});function te(e,t,n,r,i){for(var s=[],o=0,u=e;o<u.length;o++){var a=u[o],f=a.key;if(f===O.e.key){var l=t&&t.open||[];l.length>0&&M.t.subMenuProps&&(M.t.subMenuProps.items=Object(q.t)(M.t.subMenuProps.items,l,r));s.push(M.t)}else{s.push(a);if(f===W.e.key)s.push(I.e);else if(f===X.e.key){s.push(F.e);i&&n&&s.push(Q.e)}}}return t&&t.custom&&t.custom.length>0?Object(q.t)(s,t.custom):s}var ne=n(54),re=n(8),ie=n(85),se=n(158),oe=n(521),ue=Object(P.t)()(function(){return function(e){return function(e,t){var n=Object(ne.e)(e),i=(function e(t,n,i){var s=n,o=i;if(n&&i){var u=t.demandItem({spGroupField:k.qt,groupValue:k.be,parentGroupKey:k.it,groupFilterByValue:k.ve,groupValueDisplayValue:k.ye},n),a=u.spGroupField,f=u.groupValue,l=u.parentGroupKey,c=u.groupFilterByValue,h=u.groupValueDisplayValue;l&&(o=e(t,l.itemKey,i));var p=t.demandItemFacet(b.e,o);if(p){var v=t.demandItemFacet(d.e,n),m=Object(oe.e)(Object(r.__assign)(Object(r.__assign)({},p),v?{viewKey:v.viewKey}:{})),g=c||f;if(void 0!==g&&a&&a.internalName&&a.fieldType){var y=!z.e.isActivated("b53559e1-298d-4488-a512-60e0d8b8b827","09/15/2020","Include fitler displays for group that has raw value for filterByValue")&&"DateTime"===a.fieldType,w=!z.e.isActivated("e278b853-095c-41f6-a0b9-8ad603442ce7","2/22/2021","Use group display value as the filterDisplays");s=m({filterField:a.internalName,filterValues:[g],filterDisplays:w&&!!h&&[h]||y&&[f||g]||[],filterType:a.fieldType,useLookupId:!1})}}}return s})(e,t.itemKey,n),s=e.demandItem({parentItem:re.s},n).parentItem,o=(function(e){var t=this,n=e.stageItem,i=e.parentItemKey;return n?Object(ie.t)(function(e){var s=e.itemsScopeItemKey,o=e.currentItemKey;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(u){switch(u.label){case 0:i&&e(Object(se.e)({items:(t={},t[o]=Object(r.__assign)({},re.s.pack({itemKey:i})),t)}));return[4,e(n({currentItemKey:o,itemsScopeItemKey:s}))];case 1:u.sent();return[2]}})})}}):void 0})({parentItemKey:s&&s.itemKey,stageItem:t.stageItem});return i?Object(r.__assign)({itemKey:i},o?{stageItem:o}:{}):{}}}});var ae=n(727),fe=n(124),le=n(117),ce=new fe.e("siteTargetDocumentLibraryItem",function(e,t){var n=t.itemKey,r=e.demandItemFacet(re.t,n),i=r&&r.itemKey,s=e.demandItemFacet(re.e,i),o=s&&s.itemKeys;if(o&&1===o.length)return{itemKey:o[0]}}),he=Object(P.t)()(function(){var e=this;return function(){return function(t,i){var s,o=i.itemKey,u=i.stageItem,a=Object(le.e)(t),f=Object(ne.e)(t),l=t.demandItemFacet(w.e,o);if(l){var c=t.demandItemFacet(p.e,a),h=t.demandItemFacet(ae.e,f);c?l.webAbsoluteUrl===c.webAbsoluteUrl&&(s={isToggled:!0}):h&&l.webAbsoluteUrl===h.webAbsoluteUrl&&(s={isToggled:!0})}var d=t.demandItemFacet(ce,o,{suppressGetItems:!0});return Object(r.__assign)(Object(r.__assign)({},s||{}),d?{itemKey:d.itemKey}:{stageItem:function(t){return function(i){return Object(r.__awaiter)(e,void 0,void 0,function(){var e,s,o,a,f,l;return Object(r.__generator)(this,function(c){switch(c.label){case 0:o=[Object(r.__assign)({},t)];return(a=u)?[4,i(u(t))]:[3,2];case 1:a=c.sent();c.label=2;case 2:e=r.__assign.apply(void 0,o.concat([a||{}])).currentItemKey,s=void 0===e?t.currentItemKey:e;return[4,n.e("470").then(n.bind(null,906))];case 3:f=c.sent().demandItems;return[4,i(f(function(e){return e.demandItemFacet(ce,s)}))];case 4:return(l=c.sent())?[2,{currentItemKey:l.itemKey}]:[2]}})})}}})}}});var pe=n(183),de=n(865),ve=n(224),me=n(6),ge=Object(P.t)()(function(){return function(e){return function(e,t){var n=t.createOpenItem,r=t.rootItemKey,i=t.itemKey,s=Object(ne.e)(e),o=void 0;if(r){var u=e.demandItemFacet(p.e,r);u&&(o=p.e.serialize(u))}return{getBreadcrumbItems:function(){var t=[],u={},a=e.demandItemFacet(b.e,s),f=a&&a.filterParams,l=e.demandItemFacet(k.Ht,s),c=l&&l.filterList;!l&&f&&(c=pe.default.getFilterList(f,void 0,!0));if(c&&c.length&&f)for(var h=c.length-1;h>=0;h--){var p=c[h],d=(p.displays&&p.displays.length?p.displays:p.values).map(function(e){return e||ve.e.EmptyFilterOptionLabel}),v=pe.default.formatBreadcrumbFilterValues(d,p.type||"",{booleanFalse:ve.e.booleanFalse,booleanTrue:ve.e.booleanTrue}),m=ye(f,c,h+1),g=(y=Object(de.e)(e,{folderItemKey:i,currentItemSetKey:s,newFilterParams:m}))?b.e.serialize(y):i;t.unshift({key:p.fieldName,text:v,onClick:n&&g?n(g):void 0})}for(;i&&!u[i];){u[i]=!0;var y,w=e.demandItem({displayName:me.l,parentFolder:me.A},i),E=w.displayName,S=w.parentFolder;g=(y=Object(de.e)(e,{folderItemKey:i,currentItemSetKey:s,newFilterParams:""}))?b.e.serialize(y):i;t.unshift({key:i,text:E||"",onClick:n&&g?n(g):void 0});if(r&&(r===i||o===i))break;i=S&&S.itemKey||""}return t}}}}});function ye(e,t,n){for(var r=n=n||0;r<t.length;r++){var i=t[r];e=pe.default.addFilterInfo(e,i.fieldName,"",!0)}return e}var be=n("react-lib"),we=n(46),Ee=n(1116),Se=n(367),xe=n(2),Te=n(320),Ne=n(210),Ce=Te.t.serialize({}),ke={key:new xe.e("uploadToGroupDefaultDropActionHandler").id,evaluate:function(e,t){var n=t.itemKey,r=e.demandItemFacet(Te.n,Ce),i=r&&r.draggedItem,s=!i||i.type===Ne.t,o=e.demandItemFacet(we.s,n);return{action:s&&o?be.createElement(Ee.e,{itemKey:n}):void 0}},canHandleEvent:function(e){return function(t){return e.event&&e.event&&Object(Se.n)(e.event)||!1}}},Le=n(34),Ae=n(32),Oe=n(47),Me=n(114),_e=n(3087),De={isAvailable:!1,onExecute:void 0},Pe=Object(Le.e)(function(e,t){var n=t.itemKeys,i=t.groupKey;if(!(!!e.demandItemFacet(d.e,i)&&n&&n.length>0))return De;var s=e.demandItem({childItems:re.e},i).childItems,o=s&&s.itemKeys||[],u=!!e.demandItemFacet(d.e,o[0]);if(0===o.length||u)return De;var a=n.filter(function(e){return!o.some(function(t){return t===e})});if(0===a.length)return De;var f=a[0],l=e.dispatch;return Object(r.__assign)({isAvailable:!0,onExecute:function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(r.__generator)(this,function(t){e={groupKey:i};return[2,l(Object(_e.t)({items:Object(Me.e)(n,function(){return e})}))]})})}},Object(Oe.t)(e,{itemKey:f,engagement:{name:"Move",isIntentional:!0}}))})(Ae.e),He=Te.t.serialize({}),Be={key:new xe.e("moveToGroupDefaultDropActionHandler").id,evaluate:function(e,t){var n=t.itemKey,r=e.demandItemFacet(we.s,n),i=e.demandItemFacet(Te.n,He),s=i&&i.draggedItem;return{action:(!s||s.type===Ne.e)&&r?be.createElement(Pe,{itemKeys:s&&s.itemKeys||[],groupKey:n}):void 0}},canHandleEvent:function(e){return function(t){if(e&&e.event){var n=e.event.dataTransfer.draggedItem;return n&&n.type===Ne.e||!1}return!1}}},je=n(21),Fe=n(43),Ie=n(155),qe=Object(Fe.e)()(Object(Ie.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("18")]).then(n.bind(null,4026))];case 1:return[2,e.sent().ReorderListItemsUnsupportedDialog]}})})})),Re=Object(Fe.e)()(Object(Le.e)()(Object(Ie.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("18")]).then(n.bind(null,4026))];case 1:return[2,e.sent().ReorderListItemsActionExecutor]}})})}))),Ue=Object(Le.t)(function(e,t){var n=t.itemKeys,i=t.targetItemKey,s=t.targetItemIndex,o=Object(ne.e)(e)||"",u=e.demandItemFacet(k.s,o),a=!!u&&u.viewNotSupportedReason,f=u&&!!o&&n.length>0&&!!i&&void 0!==s,l=a?Object(je.o)(function(e){return be.createElement(qe,Object(r.__assign)({},e))}):Object(je.o)(function(e){return be.createElement(Re,Object(r.__assign)({itemSetKey:o},t,e))});return be.createElement(Ae.e,Object(r.__assign)({isAvailable:f,onExecute:l},Object(Oe.t)(e,{itemKey:n[0],engagement:{name:"ReorderListItems",isIntentional:!0,extraData:{CannotReorderReason:a,ReorderItemsCount:n.length}}})))}),ze=Te.t.serialize({}),We={key:new xe.e("reorderListItemsDefaultDropActionHandler").id,evaluate:function(e,t){var n=t.itemKey,r=t.itemIndex,i=e.demandItemFacet(k.Ie,n),s=e.demandItemFacet(me.d,n),o=e.demandItemFacet(Te.n,ze),u=o&&o.draggedItem,a=u&&u.itemKeys||[],f=a.length>1||1===a.length&&a[0]!==n;return{action:(!u||u.type===Ne.e)&&!!i&&f&&!s&&void 0!==r?be.createElement(Ue,{itemKeys:a,targetItemKey:n,targetItemIndex:r}):void 0}},canHandleEvent:function(e){return function(t){var n,r,i,s,o=null===(n=e.event)||void 0===n?void 0:n.dataTransfer,u=null===(r=o)||void 0===r?void 0:r.dropToPosition;return(null===(s=null===(i=o)||void 0===i?void 0:i.draggedItem)||void 0===s?void 0:s.type)===Ne.e&&void 0!==u||!1}}},Xe=Object(P.t)()(function(){return function(e){return function(e,t){var n=t.handlers;return{handlers:Object(r.__spreadArrays)([ke,Be],n||[])}}}});var Ve=Object(P.t)()(function(){return function(e){return function(e,t){var n=Object(ne.e)(e)||"",i=e.demandItemFacet(k.s,n),s=t.handlers;return i?{handlers:Object(r.__spreadArrays)([We],s||[])}:Object(r.__assign)({},t)}}});var $e=n(60),Je=Object(P.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,r=e.demandItem({key:d.e,isDropEnabled:we.i},n),i=r.key,s=r.isDropEnabled,o=i&&i.itemSetKey&&p.e.serialize(i.itemSetKey),u=o&&e.demandItemFacet(k.st,o),a=$e.e.hasItemPermission({permissions:u},$e.e.insertListItems);if(a){var f=i&&i.itemSetKey&&e.demandItemFacet(k.Be,y.e.serialize({webAbsoluteUrl:i.itemSetKey.webAbsoluteUrl,listFullUrl:i.itemSetKey.listFullUrl}));a=!!s&&!!f&&!!f.isDocumentLibrary&&f.templateType!==U.t.webPageLibrary}return{isAvailable:a}}}});var Ke=n(2991),Qe=n(1062),Ge=n(25),Ye=Object(Le.e)()(Object(Ie.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e("9").then(n.bind(null,4027))];case 1:return[2,e.sent().ContentTypeNavigationCreator]}})})})),Ze=Object(Le.t)(function(e,t){var n,i=t.itemKey,s=e.demandItemFacet(p.e,i),o=!1;if(s&&(n=e.demandItemFacet(k.Qt,N.e.serialize({webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl})))&&!n.isAnonymousGuestUser){var u=e.demandItemFacet(k.st,i);o=$e.e.hasItemPermission({permissions:u},$e.e.insertListItems)}var a=Object(je.o)(function(e){return be.createElement(Ye,Object(r.__assign)({},e,t,{pageContext:n}))});return be.createElement(Ae.e,Object(r.__assign)({isAvailable:o,onExecute:a},Object(Oe.t)(e,{itemKey:i,engagement:{name:"ContentTypeNavigation",isIntentional:!0}})))}),et=Object(Ge.i)()(Ze),tt=n(111),nt=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=m.e.deserialize(n);return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s,o,u;return Object(r.__generator)(this,function(a){t=e(Object(tt.e)({listFacets:k.Be},y.e.serialize(i.listKey))).listFacets;s=Qe.e.serialize({listKey:{webAbsoluteUrl:i.listKey.webAbsoluteUrl,listFullUrl:i.listKey.listFullUrl},contentTypeId:i.contentTypeId});o=!!t&&t.openInClient;e(Object(se.e)({items:(u={},u[n]=Object(r.__assign)({},k.t.pack(function(){return be.createElement(et,{contentTypeId:i.contentTypeId,openInClient:o,contentTypeKey:s})})),u)}));return[2]})})}});var rt=n(274),it=n(121),st=n(1664),ot=n(159),ut=Object(i.i)()(function(e){var t=this,n=g.e.deserialize(e.itemKey),i=n.webAbsoluteUrl,s=n.listFullUrl;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,o,u,a,f,l;return Object(r.__generator)(this,function(c){t=n(Object(tt.e)({pageContext:k.Qt},N.e.serialize({webAbsoluteUrl:i,listFullUrl:s}))).pageContext;o=n(Object(it.n)({webAbsoluteUrl:i,listFullUrl:s})).hasTokenProvider;if(t){u=o?void 0:function(e){return n(Object(it.e)({url:e}))};a=new st.e({},{pageContext:t,getAuthToken:u});(f=new ot.e).resolveItems({items:(l={},l[e.itemKey]=Object(r.__assign)({},k.Zt.pack(a)),l)});n(f.execute())}return[2]})})}});var at=n(3453),ft=new xe.e("saveTemplatesToView"),lt=(Object(s.i)({operationTypeFacet:ft}),n(860)),ct=n(1126),ht=n(2049),pt=n(3064),dt=n(495),vt=n(90),mt=n(1030),gt=n(3089),yt=n(2989),bt=new fe.e("newCommands",function(e,t){var n=t.itemKey,i=e.demandItemFacet(y.e,n);if(i){var s=p.e.serialize(Object(r.__assign)(Object(r.__assign)({},i),{rootFolder:""})),o=e.demandItemFacet(p.e,s);if(o){var u=Object(vt.e)(e,s),a=e.demandItemFacet(k.Be,n);if(u&&a){var f=a.templateType===U.t.mySiteDocumentLibrary,l=e.demandItemFacet(k.Ye,n),c=Object(mt.t)(e,s,o);Object(z.t)(u).isActivated("97F46AEC-F105-436C-9A00-8268455640F0","11/19/20","Folder always available")||(c=!0);var h=Object(gt.e)(e,{key:o,listFacets:a,listKey:i,pageContext:u}),d=h.contentTypes,v=h.contentTypeCommands,m=Object(yt.e)(e,{isODB:f,key:o,listFacets:a,pageContext:u}).fileHandlerCommands,g=dt.e;return Object(pt.e)(e,{contentTypes:d,newCommandMenu:g,fileHandlerCommands:m,isCreateFolderAvailable:c,newDocumentTemplates:l,contentTypeCommands:v,listKey:i}).allCommands}}}}),wt=Object(i.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options.childItemKey;return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var i,s,o,u,a,f,l,c,h,d,v,m,g,b,w,E,S,x,T;return Object(r.__generator)(this,function(N){i=e(Object(tt.e)({deserializedItemKey:p.e,displayName:me.l},n)),s=i.deserializedItemKey,o=i.displayName;if(s&&o){u=e(Object(tt.e)({contentTypeKeys:k.d},t)).contentTypeKeys;a=[];u&&u.length&&u.forEach(function(t){var n=e(Object(tt.e)({contentType:k.Jt},t)).contentType;n&&a.push(n)});f=a.length?a[0].contentTypeId:void 0;l=o.replace(/\.[^.]+$/,"");if(!(c={contentTypeId:f,isUpload:!0,templateId:l,title:l,url:s.itemId,visible:!0}).url)throw new Error("No template URL to save.");if((h=e(Object(tt.e)({defaultView:k.b},t)).defaultView)&&h.viewKey){d=h.viewKey;v=e(Object(tt.e)({existingTemplates:k.Ye},t)).existingTemplates,m=void 0===v?[]:v;(g=Object(r.__spreadArrays)(m)).length||(b=e(Object(tt.e)({newCommands:bt},t)).newCommands)&&b.forEach(function(e){var t=e.contentTypeId,n=e.isContentType,r=e.templateId,i=e.title,s=e.visible;g.push({contentTypeId:t,isContentType:n,templateId:r,title:i,visible:s})});g.filter(function(e){return e.url===c.url}).length>0||g.push(Object(r.__assign)({},c));w=y.e.deserialize(t);E=lt.e.serialize({templateUrl:c.url,listKey:w});e(Object(se.e)({items:(S={},S[t]=Object(r.__assign)({},k.Ye.pack(g)),S[E]=Object(r.__assign)({},k.Ge.pack(c)),S)}));return[2,e(Object(ht.e)({items:(x={},x[ct.e.serialize({webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl})]={views:(T={},T[d]={newDocumentTemplatesJsonString:JSON.stringify(g)},T),qosName:"saveNewTemplatesToDefaultView"},x)}))]}}return[2]})})}}),Et=n(1203),St=Object(i.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options.templates;return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var i;return Object(r.__generator)(this,function(s){e(Object(se.e)({items:(i={},i[t]=Object(r.__assign)({},k.Ye.pack(n)),i)}));return[2]})})}}),xt=n(850),Tt=n(119),Nt=n(311),Ct=n(2768),kt=n(794),Lt=n(966),At=n(951),Ot=n(1170),Mt=n(42),_t=n(629),Dt=n(128),Pt=n(1081),Ht=n(1469),Bt=n(276),jt=n(101),Ft=n(48),It=n(3695),qt=n(103);function Rt(e,t){return{enableItemHoverCard:!1}}var Ut=Object(Le.e)(function(e,t){var n=Wt(e,t.itemSetKey),r=n.viewFormatter,i=n.isGenerated,s=n.isTileDesignerTemplateApplied,o=n.qosEndPayload;return{customFormatterFeature:r&&e.demandItemFacet(Tt.n,Tt.t.serialize({})),viewFormatter:r,isGenerated:i,qosEndPayload:o,telemetry:Object(qt.n)(e).telemetry,isTileDesignerTemplateApplied:s,dispatch:e.dispatch,isDefaultCardEnabled:Object(R.e)(e,{feature:{ODB:1615}}),cardDesignerFeatureEnabled:Object(Ot.e)(e)}})(function(e){var t=be.useMemo(function(){var t=e.telemetry,n=e.qosEndPayload,r=function(){};if(0===e.selectionIndex){var i=new(t(jt.e))({name:"customItemTileRenderQoS"});n&&n.resultType===Ft.e.Failure?i.end(n):r=function(e){i&&i.end(e?{resultType:Ft.e.Failure,error:e.errorString,extraData:e.extraData}:{resultType:Ft.e.Success})}}return{customItemTileRenderQoSEnd:r}},[]).customItemTileRenderQoSEnd;Object(be.useEffect)(function(){if(d&&d.isTileFormatterAvailable()&&0===w){document.querySelectorAll(".sp-card-defaultClickButton")&&t();g||y.isTileDesignerTemplateApplied?e.dispatch(Object(Nt.e)({name:"GalleryViewRender",isIntentional:!0})):e.dispatch(Object(Nt.e)({name:"CustomFormatterTileLoad",isIntentional:!0}));d.hasFormatterReferences()&&e.dispatch(Object(Nt.e)({name:"FormatterReferenceTile",isIntentional:!0}))}},[]);var n=be.useState(!1),i=n[0],s=n[1],o=be.useState([]),u=o[0],a=o[1],f=be.useState(-1),l=f[0],c=f[1],h=e.defaultRender,p=e.customFormatterFeature,d=e.viewFormatter,v=e.isDefaultCardEnabled,m=e.cardDesignerFeatureEnabled,g=e.isGenerated,y=Object(r.__rest)(e,["defaultRender","customFormatterFeature","viewFormatter","isDefaultCardEnabled","cardDesignerFeatureEnabled","isGenerated"]);if(!h)return null;var b=p&&p.tileRenderer,w=y.selectionIndex,E=y.itemKey,S=y.itemSetKey,x=void 0===S?"":S;if(d&&d.isTileFormatterAvailable()&&b){var T=d.shouldHideSelectionInTiles(),N=d.getTileFormatter(),C=be.createElement(It.e,{qosEvent:t},be.createElement(h,Object(r.__assign)({},y,m?{href:void 0,invokeSelection:!1}:{},{className:Object(Mt.e)(y.className,"customTile_76f7b1c2"),itemName:null,itemActivity:null,foreground:null,isSelectable:!T,selection:T?void 0:y.selection,selectionIndex:T?-1:y.selectionIndex,background:be.createElement(Ht.e,{handleTabKey:Bt.t.all,direction:Bt.e.domOrder,tabIndex:i?0:-1,onKeyDown:function(e){if(e.which===Dt.e.tab){var t=l+1;if(t<u.length&&u[t]){u[t].focus();c(t);e.stopPropagation();e.preventDefault()}}else c(-1)},className:"customTileFocusZone_76f7b1c2"},be.createElement(b,{rowIndex:w,itemKey:E,itemSetKey:x,formatter:N,qosEvent:t})),onFocus:function(e){s(!0);var t=e.currentTarget.querySelectorAll(".sp-card-keyboard-focusable");a(t)},onBlur:function(e){s(!1);a([]);c(-1)}})));return v&&N?be.createElement(kt.e,{controlHandlers:Lt.e.pack(Rt)},C):C}return be.createElement(h,Object(r.__assign)({},y))}),zt=new fe.e("generatedViewFormatter",function(e,t){var n,r=t.itemKey;if(e.isItemFacetResolved(k.Re,r)&&r){var i=Object(Ct.e)(e,{itemSetKey:r}),s=e.demandItemFacet(Tt.n,Tt.t.serialize({})),o=e.demandItemFacet(b.e,r);if(o&&i&&s){var u=e.demandItemFacet(k.Be,y.e.serialize(o)),a=Object(At.t)(e,{mapping:{fieldData:k.ie},itemSetKey:r}),f=Object(R.e)(e,{feature:{ODB:522}}),l=Object(R.e)(e,{feature:{ODB:1822}}),c=a.map(function(e){return e.fieldData}),h={};if(l){var p=e.demandItem({schema:re.o},r).schema,d=p&&p.columnKeys;d&&f&&(h=Object(Pt.e)(e,d))}var v=u&&u.templateType||U.n.invalidType,m=void 0;if(c&&c.length>0&&v===U.n.genericList){var g=Object.keys(h).length>0?{fieldFormatters:h}:void 0;n=void 0===(m=s.tileDesigner.createDefaultTileProps(c,g))?{resultType:Ft.e.Failure,error:"Error generating defaultTileProps",extraData:{fields:JSON.stringify(c)}}:{resultType:Ft.e.Success}}var w=Object(xt.e)({formatter:void 0,fieldFormatters:h,generatedTileProps:m,columnFormatterReferenceProps:{columnFormatterReferenceEnabled:l}});if(w)return{viewFormatter:w.viewFormatter,qosEndPayload:n}}}});function Wt(e,t){var n,r=!1;if(!t)return{viewFormatter:void 0,isGenerated:r,isTileDesignerTemplateApplied:!1,qosEndPayload:n};var i=e.demandItemFacet(k.hn,Object(Ct.e)(e,{itemSetKey:t})),s=i&&i.viewFormatter,o=s&&s.getTileProps(),u=Boolean(s&&s.isTileDesignerTemplateApplied());u&&(s=e.demandItemFacet(Xt,t));if(!(o&&o.formatter&&o.formatter)&&Object(Ot.e)(e)){var a=e.demandItemFacet(zt,t);s=a&&a.viewFormatter;n=a&&a.qosEndPayload;r=!0}return{viewFormatter:s,isGenerated:r,isTileDesignerTemplateApplied:u,qosEndPayload:n}}var Xt=new fe.e("postColumnDeleteViewFormatterFacet",function(e,t){var n=t.itemKey,r=e.demandItemFacet(k.hn,Object(Ct.e)(e,{itemSetKey:n})),i=r&&r.viewFormatter;if(n){for(var s=Object(At.t)(e,{mapping:{fieldData:k.ie},itemSetKey:n}),o=[],u={},a=0;a<s.length;a++){var f=s[a],l=f.fieldData?f.fieldData.RealFieldName:"";if(l){o.push(f.fieldData);u[l]=f.fieldData}}var c=i&&i.getTileFormatterDesignerConfig(),h=e.demandItemFacet(Tt.n,Tt.t.serialize({})),p=e.demandItemFacet(b.e,n),d=p&&e.demandItemFacet(k.Be,y.e.serialize(p)),v=d&&d.templateType||U.n.invalidType,m=Object(R.e)(e,{feature:{ODB:522}}),g=Object(R.e)(e,{feature:{ODB:1822}});if(h){var w=h.tileDesigner,E=w.encodeTileDesignerConfig,S=w.decodeTileDesignerConfig,x=w.createJSONFromConfig,T=w.shouldExcludeColumnInCards,N=w.encodeTileDesignerConfigForDocLib,C=c&&S(c),L=[],A={};if(m){var O=e.demandItem({schema:re.o},n).schema,M=O&&O.columnKeys;M&&(A=Object(Pt.e)(e,M))}if(C){var _=!1;for(a=0;a<C.columns.length;a++){var D=C.columns[a],P=void 0;switch(D.id){case"LinkTitle":P="Title";break;case"LinkFilename":P="FileLeafRef";break;default:P=D.id}T(u[P],P)?_=!0:L.push(D)}C.columns=L;var H=v===U.n.documentLibrary?N(C,!0):E(C);if(_||m){var B=x(o,H,Object.keys(A).length>0?{fieldFormatters:A}:void 0,v),j=Object(xt.e)({formatter:JSON.stringify({tileProps:B}),fieldFormatters:A,columnFormatterReferenceProps:{columnFormatterReferenceEnabled:g}});return j&&j.viewFormatter}}}}return i});function Vt(e){return function(){return Object(r.__assign)(Object(r.__assign)({},e?{headerRenderer:e}:{}),{maxItemCount:30})}}var $t=n(1171),Jt=Object(P.t)()(function(){return function(e){return function(e,t){var n=t.itemSetKey;if(n)return(function(e,t){var n=Wt(e,t).viewFormatter,r=n&&n.isTileFormatterAvailable(),i=Object(_t.t)(e)?Object(_t.e)(t,"TILES"):void 0;if(!r)return i?{groupControlHandler:Vt(i)}:{};var s=(function(e){var t=254,n=340,r=e&&e.getTileProps(),i=r&&r.width&&r.width>=0?r.width:t;return{height:r&&r.height&&r.height>=0?r.height:n,width:i,disableMarqueeSelection:r&&r.hideSelection}})(n),o=s.height,u=s.width,a=s.disableMarqueeSelection,f=n&&n.fillCardsHorizontally()?3:1;return{tileRenderer:Ut,grid:{minRowHeight:o,mode:f},className:"sp-gallery-listContainer",disableMarqueeSelection:a,tileControlHandler:function(){return{desiredSize:{width:u,height:o}}},groupControlHandler:Vt(i)}})(e,n);var r=Object(Y.e)(e,{enableMediaTilesInDocumentGroup:k.I}).enableMediaTilesInDocumentGroup;return void 0===r||r?{tileControlHandler:$t.e}:{}}}});var Kt=n(502),Qt=n(843),Gt=n(26),Yt=n(1147),Zt=n(3628),en=n(13),tn=n(441),nn=n(1945),rn=Object(P.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,i=Object(Y.e)(e,{graphTokenProvider:nn.e,spRestTokenProvider:k.nn,logger:K.o}),s=i.graphTokenProvider,o=i.spRestTokenProvider,u=i.logger,a=Object(vt.e)(e,n),f=a&&(a.env2||a.env),l=u&&u.scenarioId;return{initializeShareFrame:function(e){var t=e.parentElement,n=e.calloutProps,i=e.sharingInformation,u=e.onError,a=n.defaultRecipients,c=n.itemName,h=n.locale,p=n.mode,d=n.openManageAccess,v=n.theme,m=n.getClientId,g=i.authToken,y=i.isListSharing,b=i.listId,w=i.serverRelativeItemUrl,E=i.shareItemKey,S=i.webAbsoluteUrl,x=m(),T={authToken:g||"",clientId:x,defaultRecipients:a,itemName:c,mode:Number(p),theme:v||Object(en.O)(),webAbsoluteUrl:S||""},N={};if(E&&Yt.e.matches(E)){var C=Yt.e.deserialize(E);N={listId:C.listId,uniqueId:C.uniqueId,webAbsoluteUrl:C.webAbsoluteUrl}}else{var k=""+new tn.e(S).authority+w;y&&x===K.e[K.e.listsHome]&&(l="list");N={isListSharing:y,itemUrl:k,listId:b,scenarioId:l}}new Zt.e({element:t,environment:f||Gt.e.prod,locale:h,context:Object(r.__assign)(Object(r.__assign)({},T),N),options:{onError:u,openManageAccess:d,graphTokenProvider:s,spRestTokenProvider:o}}).initializeUI()}}}}});var sn=n(969),on=n(3463),un=n(73),an=n(2985),fn=Object(P.t)()(function(){return function(e){return function(t,n){var r=n.itemKey,i=t.demandItemFacet(p.e,r),s=i&&N.e.serialize(i),o=t.demandItemFacet(k.Qt,s),u=t.demandItemFacet(k.fn,r),a=t.demandItemFacet(me.i,r),f=i&&i.listFullUrl,l=i&&i.webAbsoluteUrl,c=t.demandItemFacet(me.h,r);return{checkInAction:be.createElement(an.e,{checkInOutType:"checkIn"}),undoCheckOutAction:be.createElement(an.e,{checkInOutType:"undoCheckOut"}),onDismiss:function(t,n){var r=e(Object(it.n)({webAbsoluteUrl:l||"",listFullUrl:f})).dataRequestor,i={ListId:o&&o.listId,ListItemUniqueId:u,Operation:"RecommendationActedOn",AffectedResourceUrl:a,ItemType:"File",json:JSON.stringify({FileName:c&&c.name,Scenario:"RecommendedActions",SourceRelativeUrl:f,DismissRecommendationsCategory:"FocusedTask",PositionNumber:(n+1).toString(),TotalRecommendationsPresented:"3",RecommendationAlgorithmVersion:"1",ReferringCorrelationId:t,Canvas:"Web",Workload:"SharePoint",WebId:o&&o.webId,SiteId:o&&o.siteId,SiteUrl:o&&o.siteAbsoluteUrl,ClientLocalTime:(new Date).toISOString(),SourceFileName:c&&c.name,SourceFileExtension:c&&c.extension,ClientUTCOffsetInMinutes:(new Date).getTimezoneOffset().toString(),RecommendationId:t,ActionType:"Dismiss"})},s=new un.t(l+"/_api/web/ActivityLogger/FeedbackDirect");r.getData({url:s.toString(),qosName:"DismissActions",method:"POST",needsRequestDigest:!0,additionalPostData:JSON.stringify(i),timeout:6e3,qosExtraData:{Caller:"HoverCard"}})}}}}});var ln=n(3077),cn=n(873),hn=n(2767),pn=n(992),dn=Object(P.t)()(function(){return function(e){return function(e,t){var n=t.signalData,i=t.itemKey;if(n&&i&&n.key===cn.t.key){var s=e.demandItemFacet(k.Qe,i),o=e.demandItemFacet(p.e,i),u=o&&N.e.serialize(o),a=e.demandItemFacet(k.Qt,u);if(!s||!a||a.listBaseTemplate!==U.n.webPageLibrary)return{};var f=a&&Object(z.t)(a);if(!(!!f&&f.isActivated("eccf828d-ab98-4d4e-b9dd-25467f4f2f10","9/7/2020","Remove file card flight"))){var l=e.demandItemFacet(k.un,i),c=e.demandItemFacet(k.Ve,i),h=Object(pn.t)(e,i),d=!!f&&f.isActivated("0b95f189-dff4-441e-a8e1-e860c9d15392","4/9/2020","add schedule action to hoverCard"),v=hn.e.publishNowAction,m=0,g=cn.t.signal,y=hn.e.pageNeedsRepublishing;if(c)v=hn.e.submitNowAction;else if(!d&&h){v=hn.e.scheduleAction;m=1;g=cn.e.signal;y=hn.e.pageNeedsScheduling}else if(l){var b=Math.floor(Number(l)/512);v=0===b?hn.e.publishNowAction:hn.e.republishNowAction}return{onRenderLifeCycleSignal:function(e,t){return t?be.createElement(je.n,{action:be.createElement(ln.e,{itemKeys:[i],publishType:m,source:"FileCard"})},function(n){var i=n.isAvailable,s=n.execute,o=i?function(){s()}:void 0,u=Object(r.__assign)(Object(r.__assign)({},e),{actionName:v,action:o,content:y,signal:g});return t(u)}):null}}}return{}}return{}}}});var vn=n(1196),mn=n(643),gn=n(290),yn=n(513),bn=n(50),wn=n(96),En=n(99),Sn={key:new xe.e("manageAccess").id,automationId:"manageAccessCommand",name:bn.e.ManageAccess,title:bn.e.ManageAccessCommandTooltipV3,action:be.createElement(wn.t,null,be.createElement(yn.t,null)),iconProps:{iconName:"PlayerSettings"},facets:Object(r.__assign)({},En.r.pack(!0))},xn=!z.e.isActivated(T.e,"7/5/2019","Show file handler commands before OOB commands"),Tn=Object(P.t)()(function(){return function(e){return Cn}});var Nn=[mn.e,V.n,V.t,Sn];function Cn(e,t){var n=kn(e,t.itemKey);return{commands:(function(e,t){return e.map(function(e){return e.key===mn.e.key?Object(T.n)(t,xn):e})})(Nn,n)}}function kn(e,t){var n,r=e.demandItemFacet(gn.t,t);if(r){var i=new B.e(r.tenantRootUrl).authority+"/_api/v2.0",s=j.t.serialize({endpoint:i});n=Object(q.e)(e,{itemKey:s})}return n}var Ln=!z.e.isActivated(T.e,"7/5/2019","Show file handler commands before OOB commands"),An=[mn.e,V.n,V.t],On=Object(P.t)()(function(){return function(e){return Mn}});function Mn(e,t){var n=kn(e,t.itemKey);return{commands:te(An,n,!0,Ln,!1)}}var _n=n(505),Dn=n(2727),Pn=n(834),Hn=Object(P.t)()(function(){return function(e){return jn}});var Bn=[_n.e,Dn.e,Pn.e];function jn(e,t){return{columns:Bn}}var Fn=n(362),In=n(324),qn=n(410),Rn=n(3697),Un=n(786),zn=n(233),Wn=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=gn.t.deserialize(n).tenantRootUrl;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s,o,u,a,f;return Object(r.__generator)(this,function(l){switch(l.label){case 0:t=Object(Un.n)({webAbsoluteUrl:i}).segments("SP.Directory.DirectorySession","me").rawParameter("$select=mySite");return[4,e(Object(it.t)({url:t.toString(),qosName:"GetMyOneDriveUrl",method:"POST",webAbsoluteUrl:i,noRedirect:!0}))];case 1:if(!((s=l.sent())&&s.d&&s.d.mySite))throw new In.e({facets:Object(r.__assign)({},zn.h.pack({}))});o=s.d.mySite.replace(/\/$/,"");u=qn.t.serialize({webAbsoluteUrl:o||i});(a=new ot.e).resolveItems({items:(f={},f[n]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},re.t.pack({itemKey:u})),me.l.pack(Rn.e.sharedByYou)),me.d.pack({})),f)});e(a.execute());return[2]}})})}});var Xn=n(2042),Vn=n(172),$n=n(266),Jn=n(109),Kn=n(3121),Qn=n(1125),Gn=n(1061),Yn=n(275),Zn=n(673),er=n(461),tr=n(507),nr=n(503),rr=n(77),ir=n(198);function sr(e,t){var n=[];e.d.results.forEach(function(e){var i,s,o,u,a=""+new B.e(e.SiteUrl).authority+e.UrlPath,f=e.LinkingUrl?e.LinkingUrl:a,l=Qn.e.serialize({itemFullUrl:a});n.push(l);var c=Object(Xn.t)(e.Modified),h=(function(e){var t=Object(Kn.e)(e),n={itemFullUrl:t};return{parentItemUrl:t,parentItemKey:Qn.e.serialize(n)}})(a),p=h.parentItemKey,d=h.parentItemUrl;t.mapKeys({mappings:(i={},i[Qn.e.serialize({itemFullUrl:d})]=p,i)});var v=(function(e,t){var n=void 0!==t?t:3,r=!1,i=!1;if(e.IsContainer){n=Yn.e.folder;i=!0}"OneNote.Notebook"===e.ProgId&&(r=!0);return{isOneNote:r,isDocSet:!1,fileIconType:n,isFolder:i}})(e),m=e.SpItemUrl?Object(er.e)(e.SpItemUrl):void 0;if(m)for(var g=0,y=Object(er.t)(m);g<y.length;g++){var b=y[g];t.mapKeys({mappings:(s={},s[b]=l,s)})}var w=e.Editor,E=Gn.e.serialize({id:w.email}),S={itemKey:E,displayValue:w.name};t.resolveItems({items:(o={},o[E]=Object(r.__assign)(Object(r.__assign)({},me.l.pack(w.name)),$n.e.pack(w.email)),o)});t.resolveItems({items:(u={},u[l]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},me.l.pack(e.FileLeafRef)),me.E.pack(!0)),me.h.pack({name:e.FileLeafRef,extension:e.Extension})),Jn.e.pack(v.fileIconType)),me.a.pack(c.getTime())),me.i.pack(a)),me.A.pack({itemKey:p})),me.k.pack(S)),Jn.i.pack(v.isOneNote?{}:void 0)),me.d.pack(v.isFolder?{}:void 0)),me.L.pack(f)),rr.e.pack(m)),k.Ie.pack(e.ListItemId.toString())),e.UniqueId?k.fn.pack(Object(ir.normalizeLower)(e.UniqueId,!1)):{}),e.ListId?k.Fe.pack(Object(ir.normalizeLower)(e.ListId,!1)):{}),m?Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},me.n.pack({itemKey:tr.e.serialize({driveItemKey:m})})),me.v.pack({itemKey:nr.e.serialize({driveItemKey:m})})),me.e.pack({itemKey:Zn.e.serialize({driveItemKey:m})})):{}),Object(Vn.e)().forFacet(me.l).thenInvalidate(l,re.e).pack()),u[p]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},me.d.pack({})),me.i.pack(d)),me.L.pack(d)),u)})});return n}var or=n(1286),ur=n(206),ar=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=qn.t.deserialize(n).webAbsoluteUrl;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s,o,u,a,f,l,c,h;return Object(r.__generator)(this,function(p){switch(p.label){case 0:t=(t=Object(Un.r)({webAbsoluteUrl:i,listOrItemFullUrl:""})).segment("OneDriveSharedItems").parameter("$top",100).parameter("$expand",{raw:"SpItemUrl,DriveAccessToken,DriveAccessTokenV21,DriveUrl"});s=t.toString();return[4,e(Object(it.t)({url:s,method:"GET",qosName:"getSharedByMeDocs",webAbsoluteUrl:i}))];case 1:o=p.sent();u=new ot.e;a=sr(o,u);f=""+new B.e(i).authority;l=gn.t.serialize({tenantRootUrl:f});if(o.d.__next){c=or.e.serialize({itemSet:qn.t.deserialize(n),after:o.d.__next});a.push(c);u.merge(Object(ur.t)({itemKey:c}).itemResolver)}u.resolveItems({items:(h={},h[n]=Object(r.__assign)(Object(r.__assign)({},re.e.pack({itemKeys:a})),re.s.pack({itemKey:l})),h[l]=Object(r.__assign)({},Object(Vn.e)().forFacet(re.t).thenInvalidate(n,re.e).pack()),h)});e(u.execute());return[2]}})})}});var fr=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=or.e.deserialize(n).after,s=or.e.deserialize(n).itemSet;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,o,u,a,f;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,e(Object(it.t)({url:i,method:"GET",qosName:"getSharedByMeDocs",webAbsoluteUrl:s.webAbsoluteUrl}))];case 1:t=r.sent();o=qn.t.serialize(s);u=new ot.e;a=sr(t,u);if(t.d.__next){f=or.e.serialize({itemSet:s,after:t.d.__next});a.push(f);u.merge(Object(ur.t)({itemKey:f}).itemResolver)}u.merge(Object(ur.e)({itemKey:n,itemSetKey:o,childItemKeys:a}).itemResolver);e(u.execute());return[2]}})})}});var lr=n(3086),cr=n(1204),hr=n(1164),pr=n(670),dr=n(1094),vr=n(113),mr=Object(P.t)()(function(){return function(e){return function(e,t){return(function(e,t){var n=t.itemKey,i=Object(Y.e)(e,{enableItemActivityField:k.P}).enableItemActivityField,s=e.demandItemFacet(k.ce,n),o=i&&Object(vr.r)(e,be.createElement(dr.e,{itemKey:n,isCompact:!0,hideDate:!0}))||s&&be.createElement(pr.e,{text:s}),u=e.demandItemFacet(k.$e,n);return Object(r.__assign)(Object(r.__assign)({},o?{itemActivity:o}:{}),{folderCoverControlHandler:function(e,t){return u?{folderCoverAs:gr}:{}}})})(e,t)}}});function gr(e){var t=e.defaultRender,n=Object(r.__rest)(e,["defaultRender"]);return t?be.createElement(t,Object(r.__assign)({},n,{folderCoverType:"linked"})):null}var yr=n(1197),br=n(946),wr=n(2552),Er=n(1082),Sr=n(1362),xr=n(360),Tr=n(136),Nr=n(646);function Cr(e){var t=e.listMediaTransformSchema,n=e.itemMediaTransformSchema;if(t&&n){var i=t[".transformUrl"],s=n[".hasThumbnail"],o=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},t),n),{".method":"thumbnail"});if("True"===s&&i)return function(e,t){var n=t?{width:e,height:t}:{width:e};return Object(Nr.n)(i,o)+"&"+Object(Tr.e)(n)}}}var kr=Object(i.i)({maxParallelOperationCount:16})(function(e){var t=this,n=Er.e.deserialize(e.itemKey).itemKey;return function(i){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s,o,u;return Object(r.__generator)(this,function(a){switch(a.label){case 0:return[4,i(Object(Sr.e)(function(e){var t=e.demandItemFacet(p.e,n),r=t&&y.e.serialize(t);return{generator:Cr({listMediaTransformSchema:e.demandItemFacet(xr.t,r),itemMediaTransformSchema:e.demandItemFacet(xr.e,n)})}}))];case 1:t=a.sent().generator;(s=new ot.e).resolveItems(((o={items:(u={},u[e.itemKey]=Object(r.__assign)({},xr.r.pack(t)),u)})[n]=Object(r.__assign)({},Object(Vn.e)().forFacet(xr.e).thenInvalidate(e.itemKey,xr.r).pack()),o));i(s.execute());return[2]}})})}});var Lr=Object(i.t)(function(){return function(e){e(Object(s.s)(Er.e,rt.e)(kr));e(Object(o.e)(p.e,br.e)(wr.t))}}),Ar=Object(i.t)(function(){return function(e){e(Object(o.e)(p.e,Lt.e)(mr));e(Lr);e(yr.e)}}),Or=n(3464),Mr=Object(P.t)()(function(){return function(e){return function(e,t){var n=t.itemKey;return{isAvailable:!!e.demandItemFacet(p.e,n)}}}});var _r=n(590),Dr=n(1166),Pr=n(3115),Hr=n(456),Br=n(350),jr=n(697),Fr=n(3698),Ir=n(1335),qr=n(35),Rr=n(33),Ur=n(69),zr=n(23),Wr=Object(P.t)()(function(){return function(e){return function(e,t){return{errorRenderer:Xr}}}});var Xr=Object(Le.t)(function(e,t){var n=t.defaultRender,i=(t.itemKey,t.title,Object(r.__rest)(t,["defaultRender","itemKey","title"])),s=i.error;if(s instanceof Ur.e&&s.extraData&&404===s.extraData.status){var o=Object(qr.e)(e).itemsScopeItemKey,u=e.demandItemFacet(Rr.n,o),a=e.demandItemFacet(Br.e,u&&u.itemKey),f=a&&a.localItemKey,l=void 0,c=Fr.e.mountPointNotFoundDefaultErrorMessage;if(f){var h=e.demandItemFacet(me.l,f);h&&(c=zr.format(Fr.e.mountPointNotFoundErrorMessage,h));l=be.createElement("div",null,be.createElement(je.n,{action:be.createElement(jr.e,{itemKeys:[f]})},function(e){var t=e.execute;return be.createElement(Ir.e,{onClick:function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,t().then(function(){window.location.href="#"}).catch()];case 1:e.sent();return[2]}})})}},Fr.e.removeThisShortcut)}))}return be.createElement(be.Fragment,null,n?be.createElement(n,Object(r.__assign)({key:"error"},i,{title:Fr.e.mountPointNotFoundErrorTitle,subText:c,actions:l})):null)}return n?be.createElement(n,Object(r.__assign)({},t)):null}),Vr=n(1065),$r=n(1623),Jr={key:Gn.e,displayName:me.l,email:$n.e},Kr=Object(i.i)()(function(e){var t=e.itemKey,n=Vr.e.deserialize(t);return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var i,s,o,u,a,f,l,c,h;return Object(r.__generator)(this,function(p){switch(p.label){case 0:i=n.siteUrl||"";s=n.listId||"";o=n.uniqueId||"";u=i+"/_api/web/Lists('"+s+"')/GetPlacesInformation('"+o+"')?$expand=places";p.label=1;case 1:p.trys.push([1,3,,4]);return[4,e(Object($r.n)({url:u,qosName:"GetPlacesInformation",method:"GET",endpoint:i}))];case 2:a=p.sent();f=new ot.e;l=[];(c=a&&a.places)&&c.forEach(function(e){var t,n=e.userEntity.email,r=Gn.e.serialize({id:String(n)});f.resolveItems({items:(t={},t[r]=Object(xe.n)(Jr,{key:{id:String(n)},displayName:e.userEntity.name,email:n}),t)});l.push(r)});f.resolveItems({items:(h={},h[t]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},k.ft.pack({locationKeys:l})),k._e.pack(a.itemSourcePath)),me.l.pack(a.itemSourceSiteTitle)),h)});e(f.execute());return[3,4];case 3:throw p.sent();case 4:return[2]}})})}});n.d(t,"SpAddonDeferred",function(){return Qr});n.d(t,"spProjectedUploadedItemSetAddon",function(){return Pr.spProjectedUploadedItemSetAddon});var Qr=Object(i.t)(function(){return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){e(Et.e);e(vn.e);e(cr.e);e(x.spDataOnlyAddonDeferred);if(e(Object(J.e)({enablePltCommands:k.W})).enablePltCommands)e(Object(o.e)(p.e,hr.e)(T.t));else{e(Object(o.e)(p.e,l.e)(T.r));e(Object(o.e)(p.e,_r.e)(Dr.e))}e(Object(o.e)(p.e,c.e)(ee));e(Object(o.e)(d.e,f.e)(ue));e(Object(o.e)(p.e,a)(ge));e(Object(o.e)(d.e,h.e)(Xe));e(Object(o.e)(p.e,h.e)(Ve));e(Object(o.e)(d.e,u.e)(Je));e(Ar);e(Object(s.s)(v.e,rt.e)(Ke.e));e(Object(s.s)(m.e,rt.e)(nt));e(Object(s.s)(g.e,rt.e)(ut));e(Object(s.s)(y.e,at.t)(wt));e(Object(s.s)(y.e,ft)(St));e(Object(o.e)(b.e,Kt.e)(Jt));e(Object(o.e)(p.e,Qt.e)(rn));e(Object(o.e)(p.e,sn.e)(fn));e(Object(o.e)(gn.t,l.e)(Tn));e(Object(o.e)(qn.t,Fn.e)(Hn));e(Object(o.e)(gn.t,c.e)(On));e(Object(s.s)(gn.t,rt.e)(Wn));e(Object(s.s)(qn.t,rt.e)(ar));e(Object(s.s)(or.e,rt.e)(fr));e(Object(s.s)(Vr.e,rt.e)(Kr));e(Object(o.e)(w.e,f.e)(he));e(Object(o.e)(p.e,on.e)(dn));e(Object(s.s)(E.e,rt.e)(lr.t));e(Object(o.e)(S.e,Hr.e)(Wr));e(Object(o.e)(p.e,Or.e)(Mr));return[2]})})}})},,,,,,,,,,function(e,t,n){"use strict";n.r(t);var r,i=n(11),s=n(115),o=n(310),u=n(932),a=n(384),f=n(10),l=n(643),c=n(562),h=n(3141),p=n(96),d=n(2),v=n("react-lib"),m=n(315),g=n(697),y={action:v.createElement(p.t,null,v.createElement(g.t,null)),automationId:"removeShortcutFromSharedWithMeCommand",title:m.e.RemoveShortcutFromSWMTooltip,iconProps:{iconName:"FabricFolderLink"},key:new d.e("RemoveShortcutFromSWM").id,name:m.e.RemoveShortcutFromSWM},b=n(0),w=n(131),E=n(199),S=n(1848),x=n(98),T=n(2983),N=n(6),C=n(34),k=n(54),L=n(114),A=n(21),O=n(32),M=n(25),_=n(3464),D=n(47),P=n(217),H=n(75),B=Object(C.t)(function(e,t){var n=t.itemKeys,r=t.removeFromSharedListWizard,i=t.removeItemsFromSharedList,s=void 0===i?T.t:i,o=Object(k.e)(e)||"",u=e.demandItemFacet(P.e,o);if(0===n.length)return null;for(var a=u&&n.length<=200,f=r,l=0,c=n;l<c.length;l++){var h=c[l],p=e.demandItemFacet(_.e,h),d=!H.e.isActivated("6c28a705-1f14-4f06-97c7-ee39b2d66e9e","11/5/2020","Action should be available unless otherwise stated in control handler");_.e.evaluate(p)(e,{itemKey:h,isAvailable:d}).isAvailable||(a=!1)}var m=e.dispatch,g=function(){return Object(b.__awaiter)(void 0,void 0,void 0,function(){var e,t;return Object(b.__generator)(this,function(r){switch(r.label){case 0:e={itemSetKey:o};t=Object(L.e)(n,function(){return e});return[4,m(s({items:t}))];case 1:r.sent();return[2]}})})},y=Object(A.o)(function(e){return v.createElement(f,Object(b.__assign)({},e,{onItemRemoved:g,itemKeys:n}))});return v.createElement(O.e,Object(b.__assign)({isAvailable:a,onExecute:y},Object(D.t)(e,{itemKey:void 0,engagement:{name:"RemoveFromSharedList",isIntentional:!0,extraData:{itemCount:n.length}}})))}),j=Object(M.s)()(B),F=n(3736),I=n(3534),q=n(23),R=n(71),U=n(560),z=((r={})[R.r.started]=function(e){return Object(q.formatToArray)(Object(q.getLocalizedCountValue)(I.e.removeStartedItemsTitle,I.e.removeCompletedItemsTitleIntervals,e)||"",e)},r[R.r.completed]=function(e){return Object(q.formatToArray)(Object(q.getLocalizedCountValue)(I.e.removeCompletedItemsTitle,I.e.removeCompletedItemsTitleIntervals,e)||"",e)},r[R.r.failed]=function(e){return Object(q.formatToArray)(Object(q.getLocalizedCountValue)(I.e.removeFailedItemsTitle,I.e.removeFailedItemsTitleIntervals,e)||"",e)},r[R.r.canceled]=function(e){return Object(q.formatToArray)(Object(q.getLocalizedCountValue)(I.e.removeFailedItemsTitle,I.e.removeFailedItemsTitleIntervals,e)||"",e)},r),W=Object(i.t)(function(){return function(e){e(Object(a.e)(T.e,U.e)(Object(f.t)()(X)))}});function X(){return function(e){return V}}function V(e,t){var n,r=Object(x.i)(e,t),i=r.phase,s=r.count;n=z[i](s);return Object(b.__assign)({},n&&"item"!==t.format?{title:n}:{})}var $=(function(e){Object(b.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props,n=t.resolve,r=t.reject,i=t.onItemRemoved,s=t.itemKeys,o=function(){return Object(b.__awaiter)(e,void 0,void 0,function(){return Object(b.__generator)(this,function(e){switch(e.label){case 0:n();return[4,i()];case 1:e.sent();return[2]}})})},u=function(){return Object(b.__awaiter)(e,void 0,void 0,function(){return Object(b.__generator)(this,function(e){r(new w.e);return[2]})})};return v.createElement(E.e,null,function(e){var t=e.itemCache,n=J(t,s),r=n.title,i=n.prompt;return v.createElement(S.e,{onCancel:u,onConfirm:o,yesText:I.e.removeFromSharedListConfirmButtonText,noText:F.e.removeFromSharedListCancelButtonText,defaultToYes:!0,title:r,prompt:i})})};return t})(v.PureComponent),J=function(e,t){if(t.length>1)return{title:F.e.itemsTitleWithAccess,prompt:F.e.itemsSubTextWithAccess};if(1===t.length){var n=e.demandItemFacet(N.d,t[0]);return{title:n?F.e.folderTitleWithAccess:F.e.fileTitleWithAccess,prompt:n?F.e.folderSubTextWithAccess:F.e.fileSubTextWithAccess}}return{title:"",prompt:""}},K=Object(x.s)({operationTypeFacet:T.n,progressKeyFacet:T.e,initializeBatch:function(){return W}});var Q=Object(C.e)(function(){return{removeFromSharedListWizard:$,removeItemsFromSharedList:K}})(j),G={key:new d.e("removeFromSharedList").id,automationId:"removeFromSharedListCommand",name:m.e.removeFromSharedList,title:m.e.removeFromSharedListTooltip,action:v.createElement(p.t,null,v.createElement(Q,null)),iconProps:{iconName:"Cancel"}},Y=Object(f.t)()(function(){return function(e){return ee}});var Z=[l.e,c.n,c.t,h.e,y,G];function ee(e,t){return{commands:Z}}var te=n(3858),ne=n(398),re=Object(f.t)()(function(){return function(e){return se}});var ie=[l.e,c.n,c.t,h.e,y,G];function se(e,t){return{commands:ie}}var oe,ue=n(273),ae=n(268),fe=n(235),le=((oe={})[fe.t]=!0,oe[fe.r]=!0,oe[ae.i]=!0,oe[ae.e]=!0,oe[ae.r]=!0,oe),ce=Object(f.t)()(function(){return function(e){return he}});function he(e,t){var n=t.itemSetKey,r=t.handler,i=r.columnKey,s=r.isAscending;if(!le[i])return{};var o=e.demandItemFacet(P.e,n);if(!o)return{};var u=ae.t[i];return u?{newItemSetKey:P.e.serialize(Object(b.__assign)(Object(b.__assign)({},o),{sortBy:u,isAscending:s}))}:{}}var pe,de=n(248),ve=n(426),me=n(3450),ge=Object(f.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,r=e.demandItemFacet(P.e,n),i=r&&r.driveItemKey.endpoint,s=i&&Object(me.e)(e,{parentItemKey:ne.e.serialize({endpoint:i}),stageItem:t.stageItem});return Object(b.__assign)({},s?{stageItem:s}:{})}}});var ye=((pe={})[ae.i]=!0,pe[ae.e]=!0,pe),be=Object(f.t)()(function(){return function(e){return we}});function we(e,t){var n=t.itemSetKey,r=t.handler.columnKey;if(!ye[r])return{};var i=e.demandItemFacet(P.e,n);if(!i)return{};var s=ae.t[r];return s?{newItemSetKey:P.e.serialize(Object(b.__assign)(Object(b.__assign)({},i),{groupBy:s}))}:{}}var Ee=Object(f.t)()(function(){return function(e){return Se}});function Se(e,t){var n=t.itemSetKey,r=e.demandItemFacet(P.e,n);return r?{newItemSetKey:P.e.serialize(Object(b.__assign)(Object(b.__assign)({},r),{groupBy:void 0}))}:{}}var xe=n(3448),Te=Object(f.t)()(function(){return function(e){return function(e,t){return{isAvailable:!1}}}});var Ne=Object(f.t)()(function(){return function(e){return function(e,t){return{isAvailable:!1}}}});var Ce=n(130),ke=n(3120),Le=n(274),Ae=n(159),Oe=n(146),Me=n(59),_e=n(1623),De=n(5),Pe=new De.e("topCollaboratorItemKeyFacet",{id:Object(De.s)()}),He=n(158),Be=n(266),je=n(8),Fe=Object(i.i)()(function(e){var t=this,n=e.itemKey;return function(r){return Object(b.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y;return Object(b.__generator)(this,function(w){switch(w.label){case 0:t=new Ae.e;i=r(Object(Oe.e)({graphEndpoint:Me.c})).graphEndpoint;s=ke.e.deserialize(n);o=i||s.endpoint;u=o+"/me/people/";return[4,r(Object(_e.n)({url:u,qosName:"getTopCollaborator",endpoint:o}))];case 1:a=w.sent();f=[];for(l=0,c=a.value;l<c.length;l++){h=c[l];p=h.id,d=h.displayName,v=h.userPrincipalName;m=Pe.serialize({id:p});r(Object(He.e)({items:(g={},g[m]=Object(b.__assign)(Object(b.__assign)({},N.l.pack(d)),Be.e.pack(v)),g)}));f.push(m)}t.resolveItems({items:(y={},y[e.itemKey]=Object(b.__assign)({},je.e.pack({itemKeys:f})),y)});r(t.execute());return[2]}})})}});n.d(t,"graphAddonDeferred",function(){return Ie});var Ie=Object(i.t)(function(){return function(e){e(Object(Ce.e)(function(){e(te.graphAddonDataOnlyDeferred);e(Object(a.e)(ne.e,o.e)(re));e(Object(a.e)(ne.e,u.e)(Y));e(Object(a.e)(P.e,ue.e)(ce));e(Object(a.e)(P.e,de.e)(ge));e(Object(a.e)(P.e,ve.e)(be));e(Object(a.e)(P.e,ve.t)(Ee));e(Object(a.e)(xe.n,de.e)(Te));e(Object(a.e)(xe.t,de.e)(Ne));e(Object(s.s)(ke.e,Le.e)(Fe))}))}})},,,,,,,,,,,,function(e,t,n){"use strict";n.r(t);var r,i=n(11),s=n(384),o=n(51),u=n(3471),a=n(0),f=n("react-lib"),l=n(331),c=n(10),h=n(28),p=n(8),d=n(6),v=n(159),m=n(212),g=n(171),y=n(1063),b=n(3472),w=n(1528),E=n(101),S=n(48);(function(e){e[e.New=0]="New";e[e.Update=1]="Update";e[e.Delete=2]="Delete"})(r||(r={}));var x={ODB:819,ODC:"EnablePushChannelLogging"},T={ODB:459},N=(function(){function e(e){var t=this;this.subscribe=function(){t._log("Subscribe");if(0===t._subscribers){t._async=new m.e;var e=t._async.debounce(function(){return t._onNotification()},1e4,{leading:!0,maxWait:1e4});t._pushChannelService.setupNotificationHandler({source:b.t.WebhookSubscription},function(){t._log("PushChannelMessageSource",b.t.WebhookSubscription);e()});t._pushChannelService.setupNotificationHandler({source:b.t.EventHub},function(){t._log("PushChannelMessageSource",b.t.EventHub);e()});t._pushChannelService.addConnectionHandler(t._id,function(e){return t._onPushChannelConnection(e)})}t._subscribers++;t._pushChannelService.isConnected()||t._pushChannelService.connect(t._getNotification(),{methodInvoker:"ItemAutoRefreshHelper.subscribe"});return t._unsubscribe.bind(t)};this._id=e.id;this._driveUrlParts=e.driveUrl?Object(y.e)(e.driveUrl):void 0;this._dispatch=e.dispatch;this._template=e.template;this._itemScopeItemKey=e.itemsScopeItemKey||"";this._pushChannelService=e.pushChannelService;this._onUnsubscribe=e.onUnsubscribe;this._isTestMode=e.isTestMode;this._onPushChannelConnected=e.onPushChannelConnected;this._onNotificationReceived=e.onNotificationReceived;this._subscribers=0;this._syncToken="latest";this._getChangesAttempts=0}e.prototype._unsubscribe=function(){this._log("Unsubscribe");this._subscribers--;this._template.onUnsubscribe(this._subscribers);if(0===this._subscribers){if(this._async){this._async.dispose();this._async=void 0;this._refreshSubscriptionTimeoutId=void 0}this._pushChannelService.setupNotificationHandler({source:b.t.WebhookSubscription},function(){});this._pushChannelService.removeConnectionHandler(this._id);this._pushChannelService.disconnect()}this._onUnsubscribe(this._subscribers);return this._subscribers};e.prototype._onPushChannelConnection=function(e){return Object(a.__awaiter)(this,void 0,void 0,function(){var t,n,r=this;return Object(a.__generator)(this,function(i){switch(i.label){case 0:if(!e){this._log("Disconnected");this._clearRefreshSubscriptionTimeout();return[2]}this._log("Connected");this._isTestMode&&this._onPushChannelConnected&&this._onPushChannelConnected();if("latest"!==this._syncToken)return[3,4];i.label=1;case 1:i.trys.push([1,3,,4]);return[4,this._getChangeMessages()];case 2:i.sent();return[3,4];case 3:t=i.sent();this._getChangesAttempts++;if(this._getChangesAttempts>10)return[2];n=!1;if(Object(w.s)(t))switch(t.status){case 404:case 410:n=!0;this._syncToken="latest"}n&&this._async&&this._async.setTimeout(function(){return r._onPushChannelConnection(r._pushChannelService.isConnected())},500+Math.pow(2,this._getChangesAttempts));return[2];case 4:this._refreshSubscriptionHandler();return[2]}})})};e.prototype._getNotification=function(){return this._template.getSubscription&&this._template.getSubscription(this._dispatch)};e.prototype._refreshSubscriptionHandler=function(){var e=this;if(this._async){var t=this._pushChannelService.getSocketIoSubscription();if(t){var n=105001*Math.random()+15e3,r=Date.parse(t.expirationDateTime),i=Date.now(),s=r-i-n;if(s<12e4){if(g.e.isFeatureEnabled(T)){var o={refreshDelay:s,expirationDateTime:t.expirationDateTime,expirationDateTimeinMS:r,dateTimeNow:i,recreateBufferRandom:n};new E.e({name:"ItemAutoRefreshHelper.refreshSubscription",extraData:o}).end({resultType:S.e.Failure,extraData:o})}s=12e4}this._clearRefreshSubscriptionTimeout();this._refreshSubscriptionTimeoutId=this._async.setTimeout(function(){return Object(a.__awaiter)(e,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:this._log("Refreshing subscription");this._refreshSubscriptionTimeoutId=void 0;return[4,this._pushChannelService.refreshSubscription()];case 1:!0===e.sent()&&this._refreshSubscriptionHandler();return[2]}})})},s)}}};e.prototype._clearRefreshSubscriptionTimeout=function(){if(this._async&&void 0!==this._refreshSubscriptionTimeoutId){this._async.clearTimeout(this._refreshSubscriptionTimeoutId);this._refreshSubscriptionTimeoutId=void 0}};e.prototype._getChangeMessages=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){var e;return Object(a.__generator)(this,function(t){switch(t.label){case 0:return[4,this._template.getChangeMessages(this._dispatch,this._syncToken,this._driveUrlParts)];case 1:e=t.sent();this._syncToken=e.syncToken?e.syncToken:"latest";this._getChangesAttempts=0;return[2,e]}})})};e.prototype._onNotification=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){var e,t,n,i,s,o,u,f,l,c;return Object(a.__generator)(this,function(a){switch(a.label){case 0:a.trys.push([0,2,,3]);if(this._template.hasPendingRequest())return[2];e=new v.e;this._isTestMode&&this._onNotificationReceived&&this._onNotificationReceived();return[4,this._getChangeMessages()];case 1:t=a.sent();this._log("Change messages",t);n=this._processMessages(t.messages);this._log("Changes",n);e.merge(t.itemResolver);for(i=0,s=n;i<s.length;i++)switch((o=s[i]).type){case r.New:e.invalidateItems({items:(f={},f[o.invalidateKey]=[p.t],f)});break;case r.Update:o.hasSelection&&this._itemScopeItemKey?this._updateItems(o.invalidateKey):e.invalidateItems({items:(l={},l[o.invalidateKey]=[o.invalidateFacet],l)});break;case r.Delete:e.invalidateItems({items:(c={},c[o.invalidateKey]=[d.f],c)})}this._dispatch(e.execute());return[3,3];case 2:u=a.sent();this._log("onNotification error",u);return[3,3];case 3:return[2]}})})};e.prototype._processMessages=function(e){var t=[];e.sort(function(e,t){return e.parentItemKey?0:1});for(var n=0;n<e.length;n++){var r=e[n],i=this._template.processMessage(this._dispatch,r,this._itemScopeItemKey);if(void 0!==i){this._log("Change",i.invalidateKey,i.reason);t.push(i)}else if(r.parentItemKey)for(var s=n+1;s<e.length;s++){if(e[s].itemKey===r.parentItemKey){e.splice(s,1);break}}}return t};e.prototype._updateItems=function(e){this._template.updateItems(this._dispatch,e)};e.prototype._log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];g.e.isFeatureEnabled(x)&&console.log.apply(console,Object(a.__spreadArrays)(["ItemAutoRefreshHelper"],e))};return e})(),C=n(1623),k=n(1847),L=n(59),A=n(3705),O=n(3704),M=n(29),_=n(75),D=n(360),P=n(56),H=n(1),B=n(44),j=n(379),F=n(104),I=n(121),q=n(111),R=n(116),U=n(146),z=n(77),W=n(461),X=n(438),V=n(1125),$=n(69),J=(function(){function e(e){this._dataRequestor=e.dataRequestor;this._rootItemKey=e.rootItemKey;this._pendingRequest=!1}e.prototype.onUnsubscribe=function(e){};e.prototype.getSubscription=function(e){var t,n,r,i,s,o,u,a,f,l=this,c=e(Object(R.e)(function(e){return{spItem:e.demandItemFacet(B.e,l._rootItemKey)}})).spItem;if((null===(t=c)||void 0===t?void 0:t.webAbsoluteUrl)&&c.listFullUrl){var h=F.e.serialize({webAbsoluteUrl:null===(n=c)||void 0===n?void 0:n.webAbsoluteUrl,listFullUrl:null===(r=c)||void 0===r?void 0:r.listFullUrl}),p=e(Object(R.e)(function(e){return e.demandItemFacet(H.Ue,h)}));if((null===(i=p)||void 0===i?void 0:i.notificationUrl)&&(null===(s=p)||void 0===s?void 0:s.expirationDateTime)&&(null===(o=p)||void 0===o?void 0:o.subscribeID))return{notificationUrl:null===(u=p)||void 0===u?void 0:u.notificationUrl,expirationDateTime:null===(a=p)||void 0===a?void 0:a.expirationDateTime,id:null===(f=p)||void 0===f?void 0:f.subscribeID}}};e.prototype.hasPendingRequest=function(){return this._pendingRequest};e.prototype.getChangeMessages=function(e,t,n){var r;return Object(a.__awaiter)(this,void 0,void 0,function(){var i,s,o,u,f,l,c,h,p,d,m,g,y,b,w,E,S,x,T,N,C,A,O,M,P,J,K,Q,G,Y,Z,ee=this;return Object(a.__generator)(this,function(te){switch(te.label){case 0:if(void 0===n||void 0===n.endpoint||void 0===n.driveId)throw"Invalid drive url parts";i=n.endpoint+"/drives/"+n.driveId;s=e(Object(U.e)({isTAB:L.m})).isTAB;o=e(Object(R.e)(function(e){var t=e.demandItemFacet(B.e,ee._rootItemKey);return{spItem:t,pageContext:t&&e.demandItemFacet(H.Qt,j.e.serialize(t))}})),u=o.spItem,f=o.pageContext;l=new v.e;if("latest"===t&&u){c=F.e.serialize({webAbsoluteUrl:u.webAbsoluteUrl,listFullUrl:u.listFullUrl});h=e(Object(R.e)(function(e){return e.demandItemFacet(H.Be,c)}));if(p=null===(r=h)||void 0===r?void 0:r.tick){d=p-621355968e9;d/=1e4;return[2,{syncToken:""+new Date(d).toISOString(),messages:[],itemResolver:l}]}}if(!f||!Object(_.t)(f).isActivated("60D2CD4A-EAEC-4EBC-94E9-B0FB14B7CBB5","01/23/2020","Use Graph auth for auto-refresh"))return[3,4];if(!s)return[3,1];m=e(Object(R.e)(function(e){var t=u&&F.e.serialize(u),n=e.demandItemFacet(D.t,t),r=n&&n[".driveAccessToken"];return r&&r.replace("access_token=","")}));return[3,3];case 1:return[4,e(Object(I.e)({url:i,disallowCookies:!0}))];case 2:m=te.sent();te.label=3;case 3:return[3,7];case 4:return(y=n.endpoint)?[4,e(Object(k.t)(n.endpoint,i))]:[3,6];case 5:y=te.sent();te.label=6;case 6:m=(g=y)&&g.accessToken;te.label=7;case 7:if(void 0===m)throw new $.e({code:"authFailure"});this._pendingRequest=!0;b=f&&Object(_.t)(f).isActivated("C827C03F-4B57-4B6A-8BAB-3AE30D6AB56B","01/23/2020","including drive endpoint in the path")?"/drive/root/view.delta?token="+encodeURIComponent(t):i+"/root/view.delta?token="+encodeURIComponent(t);return[4,this._dataRequestor.send({apiName:"viewDelta",path:b,accessToken:{accessToken:m,tokenUrl:i},useAuthorizationHeaders:!0,headers:Object(a.__assign)({"X-RestrictedReadCapabilities":"ForceCheckOut,RequiredColumn,ContentApproval,Irm,ExcludeFromOfflineClient,DocumentParser,DraftItemSecurity,ItemLevelPermissions"},s?{}:{ScenarioType:"BGO"})})];case 8:w=te.sent();E=[];if(w&&w.value)for(S=0,x=w.value;S<x.length;S++){T=x[S];N=void 0;C={endpoint:n.endpoint,driveId:n.driveId,itemId:T.id};if(T.root){J=Object(W.t)(C);for(A=0,O=J;A<O.length;A++){G=O[A];l.mapKeys({mappings:(Y={},Y[G]=this._rootItemKey,Y)})}}else if(T.webUrl&&(M=Object(X.n)(T.webUrl))){P=V.e.serialize({itemFullUrl:M});if(e(Object(q.e)({spItemKey:B.e},P)).spItemKey){J=Object(W.t)(C);for(K=0,Q=J;K<Q.length;K++){G=Q[K];l.mapKeys({mappings:(Z={},Z[G]=P,Z)})}}}if(!T.root){T.parentReference&&(N=T.parentReference.id);E.push({itemKey:z.e.serialize(C),parentItemKey:N&&z.e.serialize({endpoint:n.endpoint,driveId:n.driveId,itemId:N}),isDeleted:!!T.deleted,isShared:!!T.shared,name:T.name,dateModified:T.lastModifiedDateTime,eTag:T.eTag})}}this._pendingRequest=!1;return[2,{syncToken:w["@delta.token"],messages:E,itemResolver:l}]}})})};e.prototype.updateItems=function(e,t,n){};e.prototype.processMessage=function(e,t,n){if(t.isDeleted){if(e(Object(q.e)({deleted:d.f},t.itemKey)).deleted)return;return{type:r.Delete,invalidateKey:t.itemKey,reason:"Deleted"}}var i=e(Object(q.e)({spItemKey:B.e,mediaTransformSchema:D.e,displayName:d.l},t.itemKey)),s=i.spItemKey,o=i.mediaTransformSchema,u=i.displayName;if(void 0===s){if(!t.parentItemKey)return;return{type:r.New,invalidateKey:t.parentItemKey,reason:"New item"}}if(o&&t.eTag){var a=o[".etag"];if(a&&t.eTag&&t.eTag!==a)return{type:r.Update,invalidateKey:t.itemKey,invalidateFacet:D.e,reason:"eTag changed from "+a+" to "+t.eTag}}if(void 0!==t.name&&u!==t.name)return{type:r.Update,invalidateKey:t.itemKey,invalidateFacet:d.l,reason:"Name changed from "+u+" to "+t.name}};return e})(),K=n(391),Q=n(30),G=n(37),Y=n(1539),Z=n(134),ee=n(141),te=n(786),ne={ODB:819,ODC:"EnablePushChannelLogging"},re=(function(){function e(e){this._dispatch=e.dispatch;this._webAbsoluteUrl=e.webAbsoluteUrl;this._listFullUrl=e.listFullUrl;this._listId=e.listId}e.prototype.getSocketIoSubscription=function(e){return Object(a.__awaiter)(this,void 0,void 0,function(){var t,n,r,i,s,o,u,f,c,h,p,d,v,m,g;return Object(a.__generator)(this,function(a){switch(a.label){case 0:if(e.existingSubscription)return[3,5];n=Object(te.n)({webAbsoluteUrl:this._webAbsoluteUrl}).segments("microservicemanager","getserviceurls").parameter("service","push");return[4,this._dispatch(Object(I.t)({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,url:n.toString(),method:"GET",qosName:"GetServiceUrls",noRedirect:!0})).catch(function(e){ee.n.isFeatureEnabled(ne)&&console.log("Error getting service url: ",e)})];case 1:r=a.sent();i=this._dispatch(Object(U.e)({isTest:L.m})).isTest;if(!(s=r&&r.d&&r.d.GetServiceUrls&&r.d.GetServiceUrls.results&&r.d.GetServiceUrls.results[0])&&!i)throw new Error("Unable to retrieve PushChannel base url");i&&(s="https://northcentralus0-pushs.svc.ms");o=s+"/notifications/register";u=Z.e.generate();f=this._dispatch(Object(l.e)({name:"SubscriptionServiceGenericList.Register"}));c={correlationId:u};a.label=2;case 2:a.trys.push([2,4,,5]);return[4,Y.e.start({url:o,method:"GET",headers:{"X-Correlation-Id":u},requestTimeoutInMS:1e4})];case 3:(h=a.sent())&&h.responseText&&h.responseText.length>0&&(p=JSON.parse(h.responseText))&&p.serverUrl&&p.webhookUrl&&(t=p.webhookUrl);if(void 0===t)throw new Error("Unable to retireve PushChannel notification url");this._dispatch(f({resultType:G.t.success,extraData:c}));return[3,5];case 4:d=a.sent();this._dispatch(f({resultType:G.t.failure,extraData:c}));throw d;case 5:v=Object(te.r)({webAbsoluteUrl:this._webAbsoluteUrl,listOrItemFullUrl:this._listFullUrl}).segment("lists").method("GetById",this._listId);if(e.existingSubscription){v=v.method("Subscriptions",{guid:e.existingSubscription.id}).segment("Update");t=e.existingSubscription.notificationUrl}else v=v.segments("Subscriptions","Add");m={parameters:{resource:this._listId,notificationUrl:t,expirationDateTime:new Date(Date.now()+3e5).toISOString(),clientState:""}};return[4,this._dispatch(Object(I.t)({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,url:v.toString(),body:JSON.stringify(m),qosName:"SubscriptionServiceGenericList.getSocketIoSubscription",method:"POST",noRedirect:!0}))];case 6:if((g=a.sent())&&g.d){delete g.d.__metadata;if(e.existingSubscription){g.d.id=e.existingSubscription.id;g.d.notificationUrl=e.existingSubscription.notificationUrl;g.d.expirationDateTime=m.parameters.expirationDateTime}return[2,g.d]}throw new Error("Invalid subscription object")}})})};e.prototype.deleteSocketIoSubscription=function(e){var t=Object(te.r)({webAbsoluteUrl:this._webAbsoluteUrl,listOrItemFullUrl:this._listFullUrl}).segment("lists").method("GetById",this._listId).method("Subscriptions",e.id);return this._dispatch(Object(I.t)({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,url:t.toString(),qosName:"SubscriptionServiceGenericList.deleteSocketIoSubscription",method:"DELETE",noRedirect:!0}))};return e})(),ie=n(287),se=n(90),oe=n(184),ue=n(251),ae=n(191),fe=(function(){function e(e){this._pushChannelService=e.pushChannelService;this._subscriptionService=e.subscriptionService;this._webAbsoluteUrl=e.webAbsoluteUrl;this._listFullUrl=e.listFullUrl;this._itemSetKey=e.itemSetKey;this._serverResponse=void 0;this._pendingRequest=!1}e.prototype.onUnsubscribe=function(e){if(0===e&&this._subscriptionService instanceof re){var t=this._pushChannelService.getSocketIoSubscription();t&&this._subscriptionService&&this._subscriptionService.deleteSocketIoSubscription(t)}};e.prototype.getSubscription=function(e){var t,n,r,i,s,o;if(this._webAbsoluteUrl&&this._listFullUrl){var u=F.e.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl}),a=e(Object(R.e)(function(e){return e.demandItemFacet(H.Ue,u)}));if((null===(t=a)||void 0===t?void 0:t.notificationUrl)&&(null===(n=a)||void 0===n?void 0:n.expirationDateTime)&&(null===(r=a)||void 0===r?void 0:r.subscribeID))return{notificationUrl:null===(i=a)||void 0===i?void 0:i.notificationUrl,expirationDateTime:null===(s=a)||void 0===s?void 0:s.expirationDateTime,id:null===(o=a)||void 0===o?void 0:o.subscribeID}}};e.prototype.getChangeMessages=function(e,t,n){var r;return Object(a.__awaiter)(this,void 0,void 0,function(){var n,i,s,o,u,f,l,c,h,p,d,m,g,y,b,w,E,S,x,T,N,C,k,A,O,M,D,P,j,I,q,z,W,X=this;return Object(a.__generator)(this,function(V){switch(V.label){case 0:if("latest"===t){n=F.e.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl});i=e(Object(R.e)(function(e){return e.demandItemFacet(H.Be,n)}));if(s=null===(r=i)||void 0===r?void 0:r.lastItemModifiedTime){o=new v.e;return[2,{syncToken:"SPO_LIST,"+s,messages:[],itemResolver:o}]}}this._pendingRequest=!0;if(l=!!t&&"SPO_LIST,"===t.substr(0,9)){c=t.split(",");h=c[1];p='<Gt><FieldRef Name="Modified" />';p+='<Value Type="DateTime" IncludeTimeValue="True" StorageTZ="True">'+h+"</Value>";u=p+="</Gt>";f=["ID","FileRef","Modified","Title"];d=this._getListColumns(e);for(m=0,g=d;m<g.length;m++)"ID"!==(y=g[m]).internalName&&"FileRef"!==y.internalName&&"Modified"!==y.internalName&&"Title"!==y.internalName&&f.push(y.internalName)}else f=["ID","FileRef","Modified"];"ID";b=l;w=l?200:1;E=new K.e("<View></View>");u&&E.addFilters([u]);f&&E.replaceFields(f);E.updateSort({fieldName:"ID",isAscending:b});E.updateRowLimit({rowLimit:w,isPerPage:!1});S=e(Object(R.e)(function(e){return Object(se.e)(e,B.e.serialize({webAbsoluteUrl:X._webAbsoluteUrl,listFullUrl:X._listFullUrl}))}));return[4,e(Object(U.e)({isTAB:L.m}))];case 1:x=V.sent().isTAB;this._requestDatesInUtc=!S||Object(_.t)(S).isActivated("3599C6B2-C5C1-42F2-A5E1-CA0C352D20AB","01/09/2020","Do not request dates in UTC for autorefresh");return[4,e(Object(ie.e)({getItemContext:Object(a.__assign)(Object(a.__assign)({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,qosName:"ItemAutoRefreshGenericList.GetChanges",viewXml:E.getEffectiveViewXml()},x?{}:{isBackground:!0}),{postDataContext:{requestDatesInUtc:this._requestDatesInUtc,needsSchema:!0},currentPageContext:S})}))];case 2:T=V.sent();this._serverResponse=T;N=T.ListData;C=N&&N.Row||[];k=[];A=l?this._getLastModifiedTimeInList(C,S):(new Date).toISOString();for(O=0,M=C;O<M.length;O++)if(void 0!==(D=M[O]).FileRef){P={};j=Object.keys(D);for(I=0,q=j;I<q.length;I++){z=q[I];W=0===z.indexOf("OData_")?z.substr(6):z;P[W]=D[z]}k.push(Object(a.__assign)(Object(a.__assign)({itemKey:B.e.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,itemId:D.ID}),parentItemKey:B.e.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl}),isDeleted:!1,isShared:!1,name:D.Title||""},D.Modified?{dateModified:""+D.Modified}:{}),{fields:P}))}0===k.length&&k.push({itemKey:B.e.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl}),isDeleted:!1,isShared:!1});this._pendingRequest=!1;return[2,{syncToken:"SPO_LIST,"+A,messages:k,itemResolver:new v.e}]}})})};e.prototype.hasPendingRequest=function(){return this._pendingRequest};e.prototype.updateItems=function(e,t){if(t&&o.e.matches(this._itemSetKey)&&this._serverResponse){var n=o.e.deserialize(this._itemSetKey),r={webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:n.listFullUrl,rootFolder:n.rootFolder||""},i=e(Object(ae.n)({itemSetKey:r})),s=e(Object(ae.e)(n,i,"getSPItem")),u=e(Object(ue.t)({serverData:this._serverResponse,itemSetKey:r,contentTypes:i,currentPageContext:s.currentPageContext,isItemSetRequest:!1})).itemResolver;e(u.execute())}this._serverResponse=void 0};e.prototype.processMessage=function(e,t,n){var i=e(Object(R.e)(function(e){return e.isItemFacetResolved(B.e,t.itemKey)?{rowData:e.demandItemFacet(H.bt,t.itemKey),spItemKey:e.demandItemFacet(B.e,t.itemKey),title:e.demandItemFacet(H.on,t.itemKey),selectedItemKeys:Object(oe.e)(e,{itemsScopeItemKey:n})}:{rowData:void 0,spItemKey:void 0,title:void 0,selectedItemKeys:void 0}})),s=i.rowData,o=i.spItemKey,u=i.title,a=i.selectedItemKeys,f=a&&a.length>0;if(void 0===t.parentItemKey){if(f)return;return{type:r.New,invalidateKey:t.itemKey,reason:"Deleted an unknown item"}}if(t.isDeleted){if(e(Object(q.e)({deleted:d.f},t.itemKey)).deleted||f)return;return{type:r.Delete,invalidateKey:t.itemKey,reason:"Deleted"}}if(void 0===o||void 0===s){if(!t.parentItemKey)return;if(void 0===e(Object(q.e)({spParentItemKey:B.e},t.parentItemKey)).spParentItemKey)return;return f?void 0:{type:r.New,invalidateKey:t.parentItemKey,reason:"New item"}}if(void 0!==u&&void 0!==t.name&&u!==t.name)return{type:r.Update,invalidateKey:t.itemKey,invalidateFacet:H.on,reason:'Item title changed from "'+u+'" to '+t.name+")"};if(t.fields){f||(this._serverResponse=void 0);for(var l=this._getListColumns(e),c=function(e){for(var n=e.internalName,i=0,o=Object.keys(t.fields).filter(function(e){return e!==n+".COUNT"&&0===e.indexOf(n)});i<o.length;i++){var u=o[i],a=s&&s[u],l=t.fields[u];try{"object"==typeof a&&(a=JSON.stringify(a));"object"==typeof l&&(l=JSON.stringify(l));if(h._requestDatesInUtc&&"DateTime"===e.fieldType){var c=Date.parse(a),p=Date.parse(l);if(!isNaN(c)&&!isNaN(p)){a=c;l=p}}}catch(e){continue}if(a!==l)return{value:{type:r.Update,invalidateKey:t.itemKey,invalidateFacet:H.bt,hasSelection:f,reason:'Item field "'+n+'" changed from "'+a+'" ('+typeof a+') to "'+l+'" ('+typeof l+")"}}}},h=this,p=0,v=l;p<v.length;p++){var m=c(v[p]);if("object"==typeof m)return m.value}}};e.prototype._getLastModifiedTimeInList=function(e,t){var n=(new Date).toISOString();if(e&&e.length>0)for(var r=void 0,i=0,s=e;i<s.length;i++){var o=s[i];if(this._requestDatesInUtc){var u=o.Modified;if(u){f=new Date(u);if(void 0===r||r<f){r=f;n=""+u}}}else{var a=o["Modified."];if(a){var f=new Date(a),l=t&&t.webTimeZoneData?t.webTimeZoneData.Bias-f.getTimezoneOffset():0;l&&f.setTime(f.getTime()+6e4*l);if(void 0===r||r<f){r=f;n=f.toISOString()}}}}return n};e.prototype._getListColumns=function(e){var t=[],n=e(Object(q.e)({schema:p.o},this._itemSetKey)).schema,r=n&&n.columnKeys;if(r)for(var i=0,s=r;i<s.length;i++){var o=s[i],u=e(Object(q.e)({internalName:H.Ee,fieldType:H.ae,mappedFieldType:H.ze},o)),a=u.internalName,f=u.fieldType,l=u.mappedFieldType;void 0!==a&&void 0!==f&&void 0!==l&&l!==Q.t.Title&&t.push({internalName:a,fieldType:f,mappedFieldType:l})}return t};return e})(),le=n(302),ce=n(167),he=n(35),pe=n(5),de=n(264),ve=n(496),me=n(139),ge=n(2778),ye=(function(){function e(e){this._connectionCallbacks={};this._notificationCallback=void 0;this._notificationId=void 0;this._siteId=e.siteId;this._listId=e.listId;this._isConnected=!1;this._client=e.dataSyncClient}e.prototype.isConnected=function(){return this._isConnected};e.prototype.getSocketIoSubscription=function(){};e.prototype.addConnectionHandler=function(e,t){this._connectionCallbacks[e]=t};e.prototype.removeConnectionHandler=function(e){this._connectionCallbacks[e]&&delete this._connectionCallbacks[e]};e.prototype.setupNotificationHandler=function(e,t){this._notificationCallback=t;return!0};e.prototype.disconnect=function(){this._notificationCallback=void 0;this._connectionCallbacks={};this._notificationId&&this._client&&this._client.removeListStatusCallback(this._notificationId);this._isConnected=!1};e.prototype.refreshSubscription=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(e){return[2,!0]})})};e.prototype.connect=function(e,t){return Object(a.__awaiter)(this,void 0,void 0,function(){var e,t,n,r,i;return Object(a.__generator)(this,function(s){switch(s.label){case 0:t=(e=this)._client,n=e._siteId,r=e._listId;i={siteId:n,listId:r};return[4,t.isListDataSyncEnabled(i)];case 1:if(s.sent()){this._notificationId=t.addListStatusCallback(this._onNotification.bind(this),i,{sendConnectionNotifications:!0});return[2,!0]}return[2,!1]}})})};e.prototype._onNotification=function(e){if(1===e.length){var t=e[0];t.dataRefreshNeeded?this._notificationCallback&&this._notificationCallback(void 0):t.state===ge.e.ListStatusConnected?this._notifyConnectionHandlers(!0):t.state===ge.e.ListStatusConnectionLost&&this._notifyConnectionHandlers(!1)}};e.prototype._notifyConnectionHandlers=function(e){this._isConnected=e;for(var t in this._connectionCallbacks)this._connectionCallbacks.hasOwnProperty(t)&&this._connectionCallbacks[t](e)};return e})(),be=n(2289),we={ODB:860},Ee={ODB:818},Se=new pe.e("itemAutoRefreshHelper",{itemsScopeItemKey:Object(pe.s)(),spPageContextKey:Object(pe.s)()}),xe=Object(ce.e)(function(e){return{}});function Te(e){var t=e.spPageContextKey,n=e.pageContext,r=e.listId,i=e.webAbsoluteUrl,s=e.listFullUrl,o=e.isTAB,u=e.itemKey,a=e.driveUrl,f=e.itemsScopeItemKey,c=e.getDataSyncClient;return function(h){var p=h(xe),d=Se.serialize({itemsScopeItemKey:f,spPageContextKey:t}),v=p[d];if(!v){var m,g=void 0,y=void 0,b=!n||!Object(_.t)(n).isActivated("f3c67c53-3465-4927-924d-963e1011836b","09/29/2020","Skip checking the subscription service");if(c&&e.pushChannelService&&(b||e.subscriptionService)){g=e.pushChannelService;y=e.subscriptionService}else{if(n&&!Object(_.t)(n).isActivated("1280C2A6-E41F-4140-9BBD-AD7F6BC4C604","10/31/2019","Use socketIo api for list subscriptions")){var w=h(C.e).dataRequestor;y=new A.e({listId:r,webAbsoluteUrl:i},{dataRequestor:w})}else y=new re({dispatch:h,webAbsoluteUrl:i,listFullUrl:s,listId:r});g=new O.e({disableWebSockets:!0},{subscriptionService:y})}m=new fe({pushChannelService:g,subscriptionService:y,webAbsoluteUrl:i,listFullUrl:s,itemSetKey:u});v=p[d]=new N({id:d,isTestMode:o,onPushChannelConnected:function(){return window._isPushChannelConnected=!0},onNotificationReceived:function(){return window._tabPushNotification=!0},driveUrl:a,dispatch:h,template:m,itemsScopeItemKey:f,pushChannelService:g,logQoS:function(e){var t=h(Object(l.e)(e));return function(e){return h(t(e))}},onUnsubscribe:function(e){0===e&&delete p[d]}})}return v}}function Ne(e){var t=Object(le.t)();f.useLayoutEffect(function(){if(e.getDataSyncClient){var n=new Promise(function(n){(function(e){var t=this,n=e.pageContext,r=e.listId,i=e.getDataSyncClient;return i?i.then(function(i){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,s,o;return Object(a.__generator)(this,function(u){switch(u.label){case 0:t=void 0;s=void 0;return(o=i&&n&&r&&n.siteId)?[4,i.isListDataSyncEnabledAsync({listId:r,siteId:n.siteId})]:[3,2];case 1:o=u.sent();u.label=2;case 2:if(o){t=new ye({listId:r,siteId:n.siteId,dataSyncClient:i});s=void 0;return[2,Te(Object(a.__assign)(Object(a.__assign)({},e),{subscriptionService:s,pushChannelService:t}))]}return[2,Te(e)]}})})}):Promise.resolve(Te(e))})(e).then(function(e){var r=t(e);n(r.subscribe())})});return function(){n.then(function(e){return e()})}}return t(Te(e)).subscribe()},[]);return null}function Ce(e){var t=Object(le.t)();f.useLayoutEffect(function(){return t((function(e){var t=this,n=e.spPageContextKey,r=e.webAbsoluteUrl,i=e.listFullUrl,s=e.isTAB,o=e.driveAccessToken,u=e.pageContext,f=e.driveUrl,c=e.endpoint,h=e.itemsScopeItemKey;return function(e){var p=e(xe),d=Se.serialize({itemsScopeItemKey:h,spPageContextKey:n}),v=p[d];if(!v){var m,g,y=e(C.e).dataRequestor;g=new J({dataRequestor:y,rootItemKey:B.e.serialize({webAbsoluteUrl:r,listFullUrl:i,rootFolder:""})});m=new O.e({disableWebSockets:!0},{subscriptionService:new A.e({},{dataRequestor:y}),sessionTokenFetcher:function(){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,n,r;return Object(a.__generator)(this,function(i){switch(i.label){case 0:if(!u||!Object(_.t)(u).isActivated("60D2CD4A-EAEC-4EBC-94E9-B0FB14B7CBB5","01/23/2020","Use Graph auth for auto-refresh"))return[3,4];if(!s)return[3,1];t=o;return[3,3];case 1:return[4,e(Object(I.e)({url:f,disallowCookies:!0}))];case 2:t=i.sent();i.label=3;case 3:return[3,7];case 4:return(r=c)?[4,e(Object(k.t)(c,f))]:[3,6];case 5:r=i.sent();i.label=6;case 6:t=(n=r)&&n.accessToken;i.label=7;case 7:if(!t)throw new $.e({code:"authFailure"});return[2,{accessToken:t,tokenUrl:f}]}})})}});v=p[d]=new N({id:d,isTestMode:s,onPushChannelConnected:function(){return window._isPushChannelConnected=!0},onNotificationReceived:function(){return window._tabPushNotification=!0},driveUrl:f,dispatch:e,itemsScopeItemKey:h,template:g,pushChannelService:m,logQoS:function(t){var n=e(Object(l.e)(t));return function(t){return e(n(t))}},onUnsubscribe:function(e){0===e&&delete p[d]}})}return v}})(e)).subscribe()},[]);return null}var ke=Object(c.t)()(function(){return function(e){return function(e,t){var n,r=t.itemKey;if(!r)return{};var i=e.demandItem({key:o.e},r).key;if(!i||!i.webAbsoluteUrl||!i.listFullUrl)return{};var s=i.webAbsoluteUrl,u=i.listFullUrl,a=j.e.serialize({webAbsoluteUrl:s,listFullUrl:u}),l=e.demandItemFacet(H.Qt,a);if(!Object(P.e)(e,{feature:we,pageContext:l})||!Object(P.e)(e,{feature:Ee,pageContext:l}))return{};var c=Object(be.s)(function(t){return Object(P.e)(e,{feature:t})},be.e.SharePointList)?null===(n=e.demandItemFacet(H.Mt,me.e))||void 0===n?void 0:n.dataSyncClient:void 0,p=F.e.serialize({webAbsoluteUrl:s,listFullUrl:u}),d=e.demandItem({listFacets:H.Be,listMediaTransformSchema:D.t},p),v=d.listFacets,m=d.listMediaTransformSchema;if(!v||void 0===v.id||void 0===v.templateType)return{};var g=v.isDocumentLibrary,b=M.s(v.templateType);if(!g&&!b)return{};var w,E=Object(h.e)(e,{isTAB:L.m}).isTAB,S=m&&m[".driveUrl"],x=S&&Object(y.e)(S),T=x&&x.endpoint,N=Object(he.e)(e).itemsScopeItemKey||"itemsSCopeItemKey";if(g&&!S)return{};var C=Object(de.e)(e,{itemsScopeItemKey:N});if(C&&C.id===ve.e.id)return{};if(g){if(!m)return{};if(!S)return{};if(E){var k=m[".driveAccessToken"];w=k&&k.replace("access_token=","")}if(!x)return{};var A=x.driveId;return T&&A?{isAvailable:!0,itemSubscriber:f.createElement(Ce,{spPageContextKey:a,driveUrl:S,isTAB:E,listFullUrl:u,endpoint:T,driveAccessToken:w,webAbsoluteUrl:s,pageContext:l,itemsScopeItemKey:N})}:{}}return{isAvailable:!0,itemSubscriber:f.createElement(Ne,{spPageContextKey:a,isTAB:E,itemKey:r,listFullUrl:u,webAbsoluteUrl:s,listId:v.id,pageContext:l,driveUrl:S,itemsScopeItemKey:N,getDataSyncClient:c})}}}});n.d(t,"sharePointAddonAutoRefresh",function(){return Le});var Le=Object(i.t)(function(){return function(e){e(Object(s.e)(o.e,u.e)(ke))}})}],Array(45),[function(e,t,n){"use strict";n.r(t);var r=n(11),i=n(384),s=n(51),o=n(872),u=n("react-lib"),a=n(0),f=n(155),l=n(25),c=n(564),h=n(34),p=n(496),d=n(1212),v=Object(f.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("442")]).then(n.bind(null,4124))];case 1:return[2,e.sent().ItemSetQuickEditList]}})})}),m=Object(c.t)(p.e)(v),g=Object(l.n)()(Object(h.e)(function(e,t){return{isAvailable:Object(d.e)(e,t),allowEmptyFolder:!1,allowPinnedItems:!1}})(m)),y=n(10),b=Object(y.t)()(function(){return function(e){return function(e,t){return{quickEditLayout:u.createElement(g,null)}}}});var w=n(3138);n.d(t,"sharePointAddonQuickEdit",function(){return E});n.d(t,"QuickEditActionExecutor",function(){return w.QuickEditActionExecutor});var E=Object(r.t)(function(){return function(e){e(Object(i.e)(s.e,o.e)(b))}})},,,,function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(11),s=n(384),o=n(932),u=n(10),a=n("react-lib"),f=n(2),l=n(25),c=n(54),h=n(838),p=n(1149),d=n(866),v=n(34),m=Object(l.s)()(Object(l.r)()(p.e)),g=Object(v.t)(function(e,t){var n=Object(c.e)(e)||"";return e.demandItemFacet(h.e,n)?a.createElement(m,{rootItemKey:n,pinOperationType:t.pinOperationType}):null}),y={key:new f.e("pinSiteCommand").id,automationId:"pinSiteCommand",name:d.e.PinLibrary,ariaLabel:d.e.PinLibrary,action:a.createElement(g,{pinOperationType:"pin"})},b={key:new f.e("unpinSiteCommand").id,automationId:"unpinSiteCommand",name:d.e.UnpinLibrary,ariaLabel:d.e.UnpinLibrary,action:a.createElement(g,{pinOperationType:"unpin"})},w=Object(u.t)()(function(){return function(e){return function(e,t){var n=t.commands;return{commands:Object(r.__spreadArrays)([y,b],n||[])}}}});n.d(t,"sharePointHomeAddonDeferred",function(){return E});var E=Object(i.t)(function(){return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){e(Object(s.e)(h.e,o.e)(w));return[2]})})}})}],Array(19),[function(e,t,n){"use strict";n.r(t);var r,i=n(0),s=n(11),o=n(115),u=n(130),a=n(158),f=n(274),l=n(1039),c=n(3130),h=n(159),p=n(146),d=n(59),v=n(1623),m=Object(s.i)()(function(e){var t=this,n=e.itemKey,r=l.e.deserialize(n);return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,s,o,u,a,f,l,c,m,y,w,E,S;return Object(i.__generator)(this,function(i){switch(i.label){case 0:t=r.driveId||"me";s=r.endpoint.replace("v2.0","v2.1");o=s+"/drives/"+t;u=e(Object(p.e)({queryParams:d.N})).queryParams,a=void 0===u?{}:u;f=[];for(l=0,c=Object.keys(a);l<c.length;l++){m=c[l];f.push(g[m])}if(!f.length)return[2];y=o+"/root?$select="+f.join(",");return[4,e(Object(v.n)({url:y,driveUrl:o,endpoint:s,qosName:"GetUserFacts"}))];case 1:w=i.sent();(E=new h.e).resolveItems({items:(S={},S[n]=b(w,a),S)});e(E.execute());return[2]}})})}}),g={includeTeachingBubbles:"teachingBubbles_oneDrive"},y=((r={}).teachingBubbles_oneDrive=c.e,r);function b(e,t){for(var n={},r=0,i=Object.keys(t);r<i.length;r++){var s=i[r],o=g[s];n[y[o].id]=e[o]||{}}return n}n.d(t,"graphUserFactsAddon",function(){return w});var w=Object(s.t)(function(){return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(t){e(Object(u.e)(function(){e(Object(a.t)({keyFacet:l.e,facets:[l.e,c.e]}));e(Object(o.s)(l.e,f.e)(m))}));return[2]})})}})},,,,,,,,,,function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(1362),s=n(159),o=n(360),u=n(11),a=n(44),f=n(104),l=n(646);function c(e){var t=e.listMediaTransformSchema,n=e.itemMediaTransformSchema;if(t&&n){var i=t[".transformUrl"],s=n[".hasPdf"],o=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},t),n),{".method":"pdf"});if("True"===s&&i)return function(){return""+Object(l.n)(i,o)}}}var h=n(172),p=n(1067);n.d(t,"spItemPdfGetItemsOperationHandler",function(){return d});var d=Object(u.i)({maxParallelOperationCount:16})(function(e){var t=this,n=p.e.deserialize(e.itemKey).itemKey;return function(u){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,l,p,d;return Object(r.__generator)(this,function(v){switch(v.label){case 0:return[4,u(Object(i.e)(function(e){var t=e.demandItemFacet(a.e,n),r=t&&f.e.serialize(t);return{generator:c({listMediaTransformSchema:e.demandItemFacet(o.t,r),itemMediaTransformSchema:e.demandItemFacet(o.e,n)})}}))];case 1:t=v.sent().generator;(l=new s.e).resolveItems(((p={items:(d={},d[e.itemKey]=Object(r.__assign)({},o.n.pack(t)),d)})[n]=Object(r.__assign)({},Object(h.e)().forFacet(o.e).thenInvalidate(e.itemKey,o.n).pack()),p));u(l.execute());return[2]}})})}})},function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(11),s=n(44),o=n(379),u=n(1),a=n(116),f=n(786),l=n(2978),c=n(121),h=n(667),p=n(159),d=n(6),v=n(124),m=n(360),g=n(1067),y=new v.e("pdfUrlGenerator",function(e,t){var n=t.itemKey;return n&&e.demandItemFacet(m.n,g.e.serialize({itemKey:n}))||void 0});n.d(t,"spItemGetPrintFileUrlOperationHandler",function(){return b});var b=Object(i.i)()(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,f,l,c,v,m,g,b,E,S,x,T,N,C,k;return Object(r.__generator)(this,function(L){switch(L.label){case 0:t=e.itemKey;i=n(Object(a.e)(function(e){return e.demandItem({spItemKey:s.e,folderPath:u.le,fileName:d.h},t)})),f=i.spItemKey,l=i.folderPath,c=i.fileName;v=f&&o.e.serialize(f);m=n(Object(a.e)(function(e){return{pageContext:e.demandItemFacet(u.Qt,v),pdfUrlGenerator:e.demandItemFacet(y,t)}})),g=m.pageContext,b=m.pdfUrlGenerator;if(!(g&&f&&c&&l))return[2];E=f.webAbsoluteUrl,S=f.listFullUrl;x=g.layoutsUrl;T=c.extension;return[4,n(w({webAbsoluteUrl:E,listFullUrl:S,folderPath:l,layoutsUrl:x,extension:T,pdfGenerator:b}))];case 1:N=L.sent();(C=new p.e).resolveItems({items:(k={},k[t]=Object(r.__assign)({},h.n.pack(N)),k)});n(C.execute());return[2]}})})}});function w(e){var t=this,n=e.webAbsoluteUrl,i=e.listFullUrl,s=e.folderPath,o=e.extension,u=e.pdfGenerator;return".oxps"===o||".pdf"===o?function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,o,u,a,h,p;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=e(Object(c.n)({webAbsoluteUrl:n,listFullUrl:i})),o=t.dataRequestor,u=t.hasDigest;if(!t.hasTokenProvider)return[3,1];h=void 0;return[3,3];case 1:return[4,e(Object(c.e)({url:n||i,disallowCookies:!u}))];case 2:h=r.sent();r.label=3;case 3:a=h;p=Object(f.r)({webAbsoluteUrl:n,listOrItemFullUrl:i});return[4,Object(l.e)({dataRequestor:o,authToken:a,serverRelativeItemUrl:s,webApiUrl:p})];case 4:return[2,{fileUrl:r.sent()}]}})})}:function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return[2,{fileUrl:u&&u()}]})})}}}])]);